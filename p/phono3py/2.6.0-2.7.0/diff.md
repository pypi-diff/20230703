# Comparing `tmp/phono3py-2.6.0.tar.gz` & `tmp/phono3py-2.7.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "phono3py-2.6.0.tar", last modified: Mon Apr  3 10:41:43 2023, max compression
+gzip compressed data, was "phono3py-2.7.0.tar", last modified: Mon Jul  3 04:00:19 2023, max compression
```

## Comparing `phono3py-2.6.0.tar` & `phono3py-2.7.0.tar`

### file list

```diff
@@ -1,250 +1,260 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.854154 phono3py-2.6.0/
--rw-r--r--   0 runner    (1001) docker     (123)     1469 2023-04-03 10:37:16.000000 phono3py-2.6.0/LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)      120 2023-04-03 10:37:16.000000 phono3py-2.6.0/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)      254 2023-04-03 10:41:43.854154 phono3py-2.6.0/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     2446 2023-04-03 10:37:16.000000 phono3py-2.6.0/README.md
--rw-r--r--   0 runner    (1001) docker     (123)        6 2023-04-03 10:41:36.000000 phono3py-2.6.0/__nanoversion__.txt
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.826154 phono3py-2.6.0/c/
--rw-r--r--   0 runner    (1001) docker     (123)    68324 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/_phono3py.c
--rw-r--r--   0 runner    (1001) docker     (123)     8081 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/_phononcalc.c
--rw-r--r--   0 runner    (1001) docker     (123)    15045 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/bzgrid.c
--rw-r--r--   0 runner    (1001) docker     (123)     3674 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/bzgrid.h
--rw-r--r--   0 runner    (1001) docker     (123)    12441 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/collision_matrix.c
--rw-r--r--   0 runner    (1001) docker     (123)     2584 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/collision_matrix.h
--rw-r--r--   0 runner    (1001) docker     (123)    29801 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/dynmat.c
--rw-r--r--   0 runner    (1001) docker     (123)     5149 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/dynmat.h
--rw-r--r--   0 runner    (1001) docker     (123)    23953 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/fc3.c
--rw-r--r--   0 runner    (1001) docker     (123)     2805 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/fc3.h
--rw-r--r--   0 runner    (1001) docker     (123)    15184 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/grgrid.c
--rw-r--r--   0 runner    (1001) docker     (123)     3392 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/grgrid.h
--rw-r--r--   0 runner    (1001) docker     (123)    11533 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/gridsys.c
--rw-r--r--   0 runner    (1001) docker     (123)    13952 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/gridsys.h
--rw-r--r--   0 runner    (1001) docker     (123)    16536 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/imag_self_energy_with_g.c
--rw-r--r--   0 runner    (1001) docker     (123)     3183 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/imag_self_energy_with_g.h
--rw-r--r--   0 runner    (1001) docker     (123)    12983 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/interaction.c
--rw-r--r--   0 runner    (1001) docker     (123)     3167 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/interaction.h
--rw-r--r--   0 runner    (1001) docker     (123)     9128 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/isotope.c
--rw-r--r--   0 runner    (1001) docker     (123)     2588 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/isotope.h
--rw-r--r--   0 runner    (1001) docker     (123)     8032 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/lagrid.c
--rw-r--r--   0 runner    (1001) docker     (123)     3487 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/lagrid.h
--rw-r--r--   0 runner    (1001) docker     (123)     9063 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/lapack_wrapper.c
--rw-r--r--   0 runner    (1001) docker     (123)     2975 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/lapack_wrapper.h
--rw-r--r--   0 runner    (1001) docker     (123)    14541 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/niggli.c
--rw-r--r--   0 runner    (1001) docker     (123)     2109 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/niggli.h
--rw-r--r--   0 runner    (1001) docker     (123)    30490 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phono3py.c
--rw-r--r--   0 runner    (1001) docker     (123)    14028 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phono3py.h
--rw-r--r--   0 runner    (1001) docker     (123)     1986 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phonoc_array.h
--rw-r--r--   0 runner    (1001) docker     (123)     1813 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phonoc_const.h
--rw-r--r--   0 runner    (1001) docker     (123)     2199 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phonoc_utils.c
--rw-r--r--   0 runner    (1001) docker     (123)     1935 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phonoc_utils.h
--rw-r--r--   0 runner    (1001) docker     (123)    20519 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phonon.c
--rw-r--r--   0 runner    (1001) docker     (123)     3324 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phonon.h
--rw-r--r--   0 runner    (1001) docker     (123)     3514 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phononcalc.c
--rw-r--r--   0 runner    (1001) docker     (123)     2661 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/phononcalc.h
--rw-r--r--   0 runner    (1001) docker     (123)    12285 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/pp_collision.c
--rw-r--r--   0 runner    (1001) docker     (123)     3256 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/pp_collision.h
--rw-r--r--   0 runner    (1001) docker     (123)     9296 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/real_self_energy.c
--rw-r--r--   0 runner    (1001) docker     (123)     2514 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/real_self_energy.h
--rw-r--r--   0 runner    (1001) docker     (123)    13553 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/real_to_reciprocal.c
--rw-r--r--   0 runner    (1001) docker     (123)     2303 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/real_to_reciprocal.h
--rw-r--r--   0 runner    (1001) docker     (123)     7479 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/reciprocal_to_normal.c
--rw-r--r--   0 runner    (1001) docker     (123)     2290 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/reciprocal_to_normal.h
--rw-r--r--   0 runner    (1001) docker     (123)    14689 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/snf3x3.c
--rw-r--r--   0 runner    (1001) docker     (123)      267 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/snf3x3.h
--rw-r--r--   0 runner    (1001) docker     (123)    38926 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/tetrahedron_method.c
--rw-r--r--   0 runner    (1001) docker     (123)     2295 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/tetrahedron_method.h
--rw-r--r--   0 runner    (1001) docker     (123)     5959 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/triplet.c
--rw-r--r--   0 runner    (1001) docker     (123)     4163 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/triplet.h
--rw-r--r--   0 runner    (1001) docker     (123)    18558 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/triplet_grid.c
--rw-r--r--   0 runner    (1001) docker     (123)     2464 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/triplet_grid.h
--rw-r--r--   0 runner    (1001) docker     (123)    13634 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/triplet_iw.c
--rw-r--r--   0 runner    (1001) docker     (123)     2865 2023-04-03 10:37:16.000000 phono3py-2.6.0/c/triplet_iw.h
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.802153 phono3py-2.6.0/example/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.830154 phono3py-2.6.0/example/AlN-LDA/
--rw-r--r--   0 runner    (1001) docker     (123)      357 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/AlN-LDA/BORN
--rw-r--r--   0 runner    (1001) docker     (123)    86886 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/AlN-LDA/FORCES_FC2
--rw-r--r--   0 runner    (1001) docker     (123)   862253 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/AlN-LDA/FORCES_FC3.lzma
--rw-r--r--   0 runner    (1001) docker     (123)      487 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/AlN-LDA/POSCAR-unitcell
--rw-r--r--   0 runner    (1001) docker     (123)     2399 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/AlN-LDA/README.md
--rw-r--r--   0 runner    (1001) docker     (123)   143873 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/AlN-LDA/phono3py_disp.yaml
--rw-r--r--   0 runner    (1001) docker     (123)   176702 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/AlN-LDA/phono3py_disp_dimfc2.yaml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.830154 phono3py-2.6.0/example/Si-CRYSTAL/
--rw-r--r--   0 runner    (1001) docker     (123)     6225 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-CRYSTAL/FORCES_FC2
--rw-r--r--   0 runner    (1001) docker     (123)    52417 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-CRYSTAL/FORCES_FC3
--rw-r--r--   0 runner    (1001) docker     (123)     1213 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-CRYSTAL/README
--rw-r--r--   0 runner    (1001) docker     (123)      815 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-CRYSTAL/TEMPLATE
--rw-r--r--   0 runner    (1001) docker     (123)      815 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-CRYSTAL/TEMPLATE3
--rw-r--r--   0 runner    (1001) docker     (123)    50060 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-CRYSTAL/crystal.o
--rw-r--r--   0 runner    (1001) docker     (123)   801243 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-CRYSTAL/outputs.tar.gz
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.834154 phono3py-2.6.0/example/Si-LDA/
--rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-LDA/FORCES_FC3
--rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-LDA/POSCAR-unitcell
--rw-r--r--   0 runner    (1001) docker     (123)     1293 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-LDA/README.md
--rw-r--r--   0 runner    (1001) docker     (123)    32796 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-LDA/phono3py_disp.yaml
--rw-r--r--   0 runner    (1001) docker     (123)   305364 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-LDA/vasprun_xmls.tar.lzma
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.834154 phono3py-2.6.0/example/Si-PBE/
--rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBE/FORCES_FC3
--rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBE/POSCAR-unitcell
--rw-r--r--   0 runner    (1001) docker     (123)     1293 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBE/README.md
--rw-r--r--   0 runner    (1001) docker     (123)    32796 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBE/phono3py_disp.yaml
--rw-r--r--   0 runner    (1001) docker     (123)   314724 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBE/vasprun_xmls.tar.lzma
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.838154 phono3py-2.6.0/example/Si-PBEsol/
--rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/FORCES_FC3
--rw-r--r--   0 runner    (1001) docker     (123)      727 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/POSCAR-unitcell
--rw-r--r--   0 runner    (1001) docker     (123)     2844 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/README.md
--rw-r--r--   0 runner    (1001) docker     (123)    46793 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/Si-band-DOS.png
--rw-r--r--   0 runner    (1001) docker     (123)    28346 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/Si-kaccum.png
--rw-r--r--   0 runner    (1001) docker     (123)     1028 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/Si.py
--rw-r--r--   0 runner    (1001) docker     (123)    32796 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/phono3py_disp.yaml
--rw-r--r--   0 runner    (1001) docker     (123)    95766 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/phono3py_disp_dimfc2.yaml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.802153 phono3py-2.6.0/example/Si-PBEsol/vasprun_xml_fc2/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.838154 phono3py-2.6.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/
--rw-r--r--   0 runner    (1001) docker     (123)      267 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/INCAR
--rw-r--r--   0 runner    (1001) docker     (123)    31479 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/POSCAR
--rw-r--r--   0 runner    (1001) docker     (123)   291058 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/vasprun.xml
--rw-r--r--   0 runner    (1001) docker     (123)   300636 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-PBEsol/vasprun_xmls.tar.lzma
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.842154 phono3py-2.6.0/example/Si-QE/
--rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-QE/FORCES_FC3
--rw-r--r--   0 runner    (1001) docker     (123)     1039 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-QE/README.md
--rw-r--r--   0 runner    (1001) docker     (123)     1025 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-QE/Si.in
--rw-r--r--   0 runner    (1001) docker     (123)    16650 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-QE/disp_fc3.yaml
--rw-r--r--   0 runner    (1001) docker     (123)    32833 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-QE/phono3py_disp.yaml
--rw-r--r--   0 runner    (1001) docker     (123)   150928 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-QE/supercell_out.tar.lzma
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.842154 phono3py-2.6.0/example/Si-TURBOMOLE/
--rw-r--r--   0 runner    (1001) docker     (123)    10449 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-TURBOMOLE/FORCES_FC2
--rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-TURBOMOLE/FORCES_FC3
--rw-r--r--   0 runner    (1001) docker     (123)     1195 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-TURBOMOLE/README
--rw-r--r--   0 runner    (1001) docker     (123)      253 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-TURBOMOLE/control
--rw-r--r--   0 runner    (1001) docker     (123)      492 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-TURBOMOLE/coord
--rw-r--r--   0 runner    (1001) docker     (123)   278495 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Si-TURBOMOLE/outputs.tar.gz
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.846154 phono3py-2.6.0/example/Wigner_La2Zr2O7/
--rw-r--r--   0 runner    (1001) docker     (123)      598 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Wigner_La2Zr2O7/BORN
--rw-r--r--   0 runner    (1001) docker     (123)     1598 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Wigner_La2Zr2O7/POSCAR
--rw-r--r--   0 runner    (1001) docker     (123)      197 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Wigner_La2Zr2O7/command.sh
--rw-r--r--   0 runner    (1001) docker     (123)  1098761 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Wigner_La2Zr2O7/fc2.hdf5
--rw-r--r--   0 runner    (1001) docker     (123)   339529 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Wigner_La2Zr2O7/kappa-m191919.hdf5
--rw-r--r--   0 runner    (1001) docker     (123)   160648 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/Wigner_La2Zr2O7/tc_La2Zr2O7.out.xz
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.846154 phono3py-2.6.0/example/zb-ZnTe-PBEsol/
--rw-r--r--   0 runner    (1001) docker     (123)      551 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/zb-ZnTe-PBEsol/README.md
--rw-r--r--   0 runner    (1001) docker     (123)     4657 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/zb-ZnTe-PBEsol/launch_phono3py_ZnTe_PBEsol_222.py
--rw-r--r--   0 runner    (1001) docker     (123)   131412 2023-04-03 10:37:16.000000 phono3py-2.6.0/example/zb-ZnTe-PBEsol/phono3py_params_ZnTe.yaml.xz
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.810154 phono3py-2.6.0/phono3py/
--rw-r--r--   0 runner    (1001) docker     (123)     1929 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     5618 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/api_isotope.py
--rw-r--r--   0 runner    (1001) docker     (123)    11726 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/api_jointdos.py
--rw-r--r--   0 runner    (1001) docker     (123)    99737 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/api_phono3py.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.810154 phono3py-2.6.0/phono3py/conductivity/
--rw-r--r--   0 runner    (1001) docker     (123)       44 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/conductivity/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    31789 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/conductivity/base.py
--rw-r--r--   0 runner    (1001) docker     (123)    71692 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/conductivity/direct_solution.py
--rw-r--r--   0 runner    (1001) docker     (123)     5828 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/conductivity/kubo.py
--rw-r--r--   0 runner    (1001) docker     (123)    41492 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/conductivity/rta.py
--rw-r--r--   0 runner    (1001) docker     (123)    44514 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/conductivity/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     8628 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/conductivity/wigner.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.814154 phono3py-2.6.0/phono3py/cui/
--rw-r--r--   0 runner    (1001) docker     (123)       47 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    20470 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/create_force_constants.py
--rw-r--r--   0 runner    (1001) docker     (123)     5689 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/create_supercells.py
--rw-r--r--   0 runner    (1001) docker     (123)    17234 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/kaccum_script.py
--rw-r--r--   0 runner    (1001) docker     (123)    24132 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/load.py
--rw-r--r--   0 runner    (1001) docker     (123)    24751 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/phono3py_argparse.py
--rw-r--r--   0 runner    (1001) docker     (123)    50909 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/phono3py_script.py
--rw-r--r--   0 runner    (1001) docker     (123)    37233 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/settings.py
--rw-r--r--   0 runner    (1001) docker     (123)     9785 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/show_log.py
--rw-r--r--   0 runner    (1001) docker     (123)     5803 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/cui/triplets_info.py
--rw-r--r--   0 runner    (1001) docker     (123)    59956 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/file_IO.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.814154 phono3py-2.6.0/phono3py/interface/
--rw-r--r--   0 runner    (1001) docker     (123)       50 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/interface/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2057 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/interface/alm.py
--rw-r--r--   0 runner    (1001) docker     (123)     4272 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/interface/calculator.py
--rw-r--r--   0 runner    (1001) docker     (123)     3735 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/interface/fc_calculator.py
--rw-r--r--   0 runner    (1001) docker     (123)    22449 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/interface/phono3py_yaml.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.814154 phono3py-2.6.0/phono3py/other/
--rw-r--r--   0 runner    (1001) docker     (123)       40 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/other/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    14859 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/other/isotope.py
--rw-r--r--   0 runner    (1001) docker     (123)     7449 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/other/kaccum.py
--rw-r--r--   0 runner    (1001) docker     (123)     6940 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/other/tetrahedron_method.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.818154 phono3py-2.6.0/phono3py/phonon/
--rw-r--r--   0 runner    (1001) docker     (123)       55 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3289 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon/func.py
--rw-r--r--   0 runner    (1001) docker     (123)    41739 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon/grid.py
--rw-r--r--   0 runner    (1001) docker     (123)     7528 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon/group_velocity_matrix.py
--rw-r--r--   0 runner    (1001) docker     (123)     2955 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon/heat_capacity_matrix.py
--rw-r--r--   0 runner    (1001) docker     (123)     6687 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon/solver.py
--rw-r--r--   0 runner    (1001) docker     (123)     9058 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon/velocity_operator.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.818154 phono3py-2.6.0/phono3py/phonon3/
--rw-r--r--   0 runner    (1001) docker     (123)       42 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    11852 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/collision_matrix.py
--rw-r--r--   0 runner    (1001) docker     (123)     3900 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/dataset.py
--rw-r--r--   0 runner    (1001) docker     (123)    14164 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/displacement_fc3.py
--rw-r--r--   0 runner    (1001) docker     (123)    30142 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/fc3.py
--rw-r--r--   0 runner    (1001) docker     (123)    18247 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/gruneisen.py
--rw-r--r--   0 runner    (1001) docker     (123)    38049 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/imag_self_energy.py
--rw-r--r--   0 runner    (1001) docker     (123)    34150 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/interaction.py
--rw-r--r--   0 runner    (1001) docker     (123)    15875 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/joint_dos.py
--rw-r--r--   0 runner    (1001) docker     (123)    25947 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/real_self_energy.py
--rw-r--r--   0 runner    (1001) docker     (123)     4953 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/real_to_reciprocal.py
--rw-r--r--   0 runner    (1001) docker     (123)     4238 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/reciprocal_to_normal.py
--rw-r--r--   0 runner    (1001) docker     (123)    13785 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/spectral_function.py
--rw-r--r--   0 runner    (1001) docker     (123)    14955 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/phonon3/triplets.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.818154 phono3py-2.6.0/phono3py/sscha/
--rw-r--r--   0 runner    (1001) docker     (123)       26 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/sscha/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    19518 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/sscha/sscha.py
--rw-r--r--   0 runner    (1001) docker     (123)     1636 2023-04-03 10:37:16.000000 phono3py-2.6.0/phono3py/version.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.846154 phono3py-2.6.0/phono3py.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)      254 2023-04-03 10:41:43.000000 phono3py-2.6.0/phono3py.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     5993 2023-04-03 10:41:43.000000 phono3py-2.6.0/phono3py.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-03 10:41:43.000000 phono3py-2.6.0/phono3py.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       77 2023-04-03 10:41:43.000000 phono3py-2.6.0/phono3py.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)        9 2023-04-03 10:41:43.000000 phono3py-2.6.0/phono3py.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (123)      298 2023-04-03 10:37:16.000000 phono3py-2.6.0/pyproject.toml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.846154 phono3py-2.6.0/scripts/
--rwxr-xr-x   0 runner    (1001) docker     (123)     1831 2023-04-03 10:37:16.000000 phono3py-2.6.0/scripts/phono3py
--rwxr-xr-x   0 runner    (1001) docker     (123)     3845 2023-04-03 10:37:16.000000 phono3py-2.6.0/scripts/phono3py-coleigplot
--rwxr-xr-x   0 runner    (1001) docker     (123)     1688 2023-04-03 10:37:16.000000 phono3py-2.6.0/scripts/phono3py-kaccum
--rwxr-xr-x   0 runner    (1001) docker     (123)     9480 2023-04-03 10:37:16.000000 phono3py-2.6.0/scripts/phono3py-kdeplot
--rwxr-xr-x   0 runner    (1001) docker     (123)     1797 2023-04-03 10:37:16.000000 phono3py-2.6.0/scripts/phono3py-load
--rw-r--r--   0 runner    (1001) docker     (123)      120 2023-04-03 10:41:43.858154 phono3py-2.6.0/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)    10232 2023-04-03 10:37:16.000000 phono3py-2.6.0/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.854154 phono3py-2.6.0/test/
--rw-r--r--   0 runner    (1001) docker     (123)     1236 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/AgNO2_cell.yaml
--rw-r--r--   0 runner    (1001) docker     (123)      133 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/BORN_NaCl
--rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/FORCES_FC3_si_pbesol
--rw-r--r--   0 runner    (1001) docker     (123)     6282 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/FORCE_SETS_NaCl
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.854154 phono3py-2.6.0/test/conductivity/
--rw-r--r--   0 runner    (1001) docker     (123)       39 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/conductivity/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2975 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/conductivity/test_kappa_LBTE.py
--rw-r--r--   0 runner    (1001) docker     (123)     1839 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/conductivity/test_kappa_LBTE_Wigner.py
--rw-r--r--   0 runner    (1001) docker     (123)    11291 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/conductivity/test_kappa_RTA.py
--rw-r--r--   0 runner    (1001) docker     (123)     9763 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/conductivity/test_kappa_RTA_Wigner.py
--rw-r--r--   0 runner    (1001) docker     (123)    14076 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/conftest.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.854154 phono3py-2.6.0/test/other/
--rw-r--r--   0 runner    (1001) docker     (123)       37 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/other/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3870 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/other/test_isotope.py
--rw-r--r--   0 runner    (1001) docker     (123)     8583 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/other/test_kaccum.py
--rw-r--r--   0 runner    (1001) docker     (123)   943848 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phono3py_params_AlN332.yaml.xz
--rw-r--r--   0 runner    (1001) docker     (123)    26352 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phono3py_params_NaCl111.yaml
--rw-r--r--   0 runner    (1001) docker     (123)    69120 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phono3py_params_NaCl222.yaml.xz
--rw-r--r--   0 runner    (1001) docker     (123)    30693 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phono3py_params_Si-111-222.yaml
--rw-r--r--   0 runner    (1001) docker     (123)    18216 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phono3py_params_Si111.yaml
--rw-r--r--   0 runner    (1001) docker     (123)    32800 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phono3py_si_pbesol.yaml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.854154 phono3py-2.6.0/test/phonon/
--rw-r--r--   0 runner    (1001) docker     (123)       50 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    48674 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon/test_grid.py
--rw-r--r--   0 runner    (1001) docker     (123)    19748 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon/test_velocity_operator.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.854154 phono3py-2.6.0/test/phonon3/
--rw-r--r--   0 runner    (1001) docker     (123)       44 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4141 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_displacements.py
--rw-r--r--   0 runner    (1001) docker     (123)    11449 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_fc3.py
--rw-r--r--   0 runner    (1001) docker     (123)    20434 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_imag_self_energy.py
--rw-r--r--   0 runner    (1001) docker     (123)     8336 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_interaction.py
--rw-r--r--   0 runner    (1001) docker     (123)    13503 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_joint_dos.py
--rw-r--r--   0 runner    (1001) docker     (123)    13537 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_real_self_energy.py
--rw-r--r--   0 runner    (1001) docker     (123)     5596 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_spectral_function.py
--rw-r--r--   0 runner    (1001) docker     (123)    41085 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonon3/test_triplets.py
--rw-r--r--   0 runner    (1001) docker     (123)    12203 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonopy_disp_NaCl.yaml
--rw-r--r--   0 runner    (1001) docker     (123)   286407 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonopy_params-Si111-iterha.yaml.gz
--rw-r--r--   0 runner    (1001) docker     (123)     5587 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/phonopy_params_Si.yaml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-03 10:41:43.854154 phono3py-2.6.0/test/sscha/
--rw-r--r--   0 runner    (1001) docker     (123)       23 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/sscha/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     8800 2023-04-03 10:37:16.000000 phono3py-2.6.0/test/sscha/test_sscha.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.891734 phono3py-2.7.0/
+-rw-r--r--   0 runner    (1001) docker     (123)     1469 2023-07-03 03:56:16.000000 phono3py-2.7.0/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)      120 2023-07-03 03:56:16.000000 phono3py-2.7.0/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)      254 2023-07-03 04:00:19.891734 phono3py-2.7.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     2446 2023-07-03 03:56:16.000000 phono3py-2.7.0/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)        6 2023-07-03 04:00:14.000000 phono3py-2.7.0/__nanoversion__.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.867735 phono3py-2.7.0/c/
+-rw-r--r--   0 runner    (1001) docker     (123)    68324 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/_phono3py.c
+-rw-r--r--   0 runner    (1001) docker     (123)     8081 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/_phononcalc.c
+-rw-r--r--   0 runner    (1001) docker     (123)    15045 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/bzgrid.c
+-rw-r--r--   0 runner    (1001) docker     (123)     3674 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/bzgrid.h
+-rw-r--r--   0 runner    (1001) docker     (123)    12441 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/collision_matrix.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2584 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/collision_matrix.h
+-rw-r--r--   0 runner    (1001) docker     (123)    29801 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/dynmat.c
+-rw-r--r--   0 runner    (1001) docker     (123)     5149 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/dynmat.h
+-rw-r--r--   0 runner    (1001) docker     (123)    23953 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/fc3.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2805 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/fc3.h
+-rw-r--r--   0 runner    (1001) docker     (123)    15184 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/grgrid.c
+-rw-r--r--   0 runner    (1001) docker     (123)     3392 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/grgrid.h
+-rw-r--r--   0 runner    (1001) docker     (123)    11533 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/gridsys.c
+-rw-r--r--   0 runner    (1001) docker     (123)    13952 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/gridsys.h
+-rw-r--r--   0 runner    (1001) docker     (123)    16536 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/imag_self_energy_with_g.c
+-rw-r--r--   0 runner    (1001) docker     (123)     3183 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/imag_self_energy_with_g.h
+-rw-r--r--   0 runner    (1001) docker     (123)    12983 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/interaction.c
+-rw-r--r--   0 runner    (1001) docker     (123)     3167 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/interaction.h
+-rw-r--r--   0 runner    (1001) docker     (123)     9128 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/isotope.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2588 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/isotope.h
+-rw-r--r--   0 runner    (1001) docker     (123)     8032 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/lagrid.c
+-rw-r--r--   0 runner    (1001) docker     (123)     3487 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/lagrid.h
+-rw-r--r--   0 runner    (1001) docker     (123)     9063 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/lapack_wrapper.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2975 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/lapack_wrapper.h
+-rw-r--r--   0 runner    (1001) docker     (123)    14541 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/niggli.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2109 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/niggli.h
+-rw-r--r--   0 runner    (1001) docker     (123)    30490 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phono3py.c
+-rw-r--r--   0 runner    (1001) docker     (123)    14028 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phono3py.h
+-rw-r--r--   0 runner    (1001) docker     (123)     1986 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phonoc_array.h
+-rw-r--r--   0 runner    (1001) docker     (123)     1813 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phonoc_const.h
+-rw-r--r--   0 runner    (1001) docker     (123)     2199 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phonoc_utils.c
+-rw-r--r--   0 runner    (1001) docker     (123)     1935 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phonoc_utils.h
+-rw-r--r--   0 runner    (1001) docker     (123)    20519 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phonon.c
+-rw-r--r--   0 runner    (1001) docker     (123)     3324 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phonon.h
+-rw-r--r--   0 runner    (1001) docker     (123)     3514 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phononcalc.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2661 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/phononcalc.h
+-rw-r--r--   0 runner    (1001) docker     (123)    12285 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/pp_collision.c
+-rw-r--r--   0 runner    (1001) docker     (123)     3256 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/pp_collision.h
+-rw-r--r--   0 runner    (1001) docker     (123)     9296 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/real_self_energy.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2514 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/real_self_energy.h
+-rw-r--r--   0 runner    (1001) docker     (123)    13553 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/real_to_reciprocal.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2303 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/real_to_reciprocal.h
+-rw-r--r--   0 runner    (1001) docker     (123)     7479 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/reciprocal_to_normal.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2290 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/reciprocal_to_normal.h
+-rw-r--r--   0 runner    (1001) docker     (123)    14689 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/snf3x3.c
+-rw-r--r--   0 runner    (1001) docker     (123)      267 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/snf3x3.h
+-rw-r--r--   0 runner    (1001) docker     (123)    38926 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/tetrahedron_method.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2295 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/tetrahedron_method.h
+-rw-r--r--   0 runner    (1001) docker     (123)     5959 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/triplet.c
+-rw-r--r--   0 runner    (1001) docker     (123)     4163 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/triplet.h
+-rw-r--r--   0 runner    (1001) docker     (123)    18558 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/triplet_grid.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2464 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/triplet_grid.h
+-rw-r--r--   0 runner    (1001) docker     (123)    13634 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/triplet_iw.c
+-rw-r--r--   0 runner    (1001) docker     (123)     2865 2023-07-03 03:56:16.000000 phono3py-2.7.0/c/triplet_iw.h
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.855734 phono3py-2.7.0/example/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.871734 phono3py-2.7.0/example/AlN-LDA/
+-rw-r--r--   0 runner    (1001) docker     (123)      357 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/AlN-LDA/BORN
+-rw-r--r--   0 runner    (1001) docker     (123)    86886 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/AlN-LDA/FORCES_FC2
+-rw-r--r--   0 runner    (1001) docker     (123)   862253 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/AlN-LDA/FORCES_FC3.lzma
+-rw-r--r--   0 runner    (1001) docker     (123)      487 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/AlN-LDA/POSCAR-unitcell
+-rw-r--r--   0 runner    (1001) docker     (123)     2399 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/AlN-LDA/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)   143873 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/AlN-LDA/phono3py_disp.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)   176702 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/AlN-LDA/phono3py_disp_dimfc2.yaml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.871734 phono3py-2.7.0/example/NaCl-alm/
+-rw-r--r--   0 runner    (1001) docker     (123)     1429 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/NaCl-alm/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)   303332 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/NaCl-alm/phono3py_params_NaCl222.yaml.xz
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.871734 phono3py-2.7.0/example/Si-CRYSTAL/
+-rw-r--r--   0 runner    (1001) docker     (123)     6225 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-CRYSTAL/FORCES_FC2
+-rw-r--r--   0 runner    (1001) docker     (123)    52417 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-CRYSTAL/FORCES_FC3
+-rw-r--r--   0 runner    (1001) docker     (123)     1213 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-CRYSTAL/README
+-rw-r--r--   0 runner    (1001) docker     (123)      815 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-CRYSTAL/TEMPLATE
+-rw-r--r--   0 runner    (1001) docker     (123)      815 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-CRYSTAL/TEMPLATE3
+-rw-r--r--   0 runner    (1001) docker     (123)    50060 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-CRYSTAL/crystal.o
+-rw-r--r--   0 runner    (1001) docker     (123)   801243 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-CRYSTAL/outputs.tar.gz
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.875734 phono3py-2.7.0/example/Si-LDA/
+-rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-LDA/FORCES_FC3
+-rw-r--r--   0 runner    (1001) docker     (123)      727 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-LDA/POSCAR-unitcell
+-rw-r--r--   0 runner    (1001) docker     (123)     1293 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-LDA/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)    32796 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-LDA/phono3py_disp.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)   305364 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-LDA/vasprun_xmls.tar.lzma
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.875734 phono3py-2.7.0/example/Si-PBE/
+-rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBE/FORCES_FC3
+-rw-r--r--   0 runner    (1001) docker     (123)      727 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBE/POSCAR-unitcell
+-rw-r--r--   0 runner    (1001) docker     (123)     1293 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBE/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)    32796 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBE/phono3py_disp.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)   314724 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBE/vasprun_xmls.tar.lzma
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.879734 phono3py-2.7.0/example/Si-PBEsol/
+-rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/FORCES_FC3
+-rw-r--r--   0 runner    (1001) docker     (123)      727 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/POSCAR-unitcell
+-rw-r--r--   0 runner    (1001) docker     (123)     2844 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)    46793 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/Si-band-DOS.png
+-rw-r--r--   0 runner    (1001) docker     (123)    28346 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/Si-kaccum.png
+-rw-r--r--   0 runner    (1001) docker     (123)     1028 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/Si.py
+-rw-r--r--   0 runner    (1001) docker     (123)    32796 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/phono3py_disp.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)    95766 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/phono3py_disp_dimfc2.yaml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.855734 phono3py-2.7.0/example/Si-PBEsol/vasprun_xml_fc2/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.879734 phono3py-2.7.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/
+-rw-r--r--   0 runner    (1001) docker     (123)      267 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/INCAR
+-rw-r--r--   0 runner    (1001) docker     (123)    31479 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/POSCAR
+-rw-r--r--   0 runner    (1001) docker     (123)   291058 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/vasprun.xml
+-rw-r--r--   0 runner    (1001) docker     (123)   300636 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-PBEsol/vasprun_xmls.tar.lzma
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.879734 phono3py-2.7.0/example/Si-QE/
+-rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-QE/FORCES_FC3
+-rw-r--r--   0 runner    (1001) docker     (123)     1039 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-QE/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)     1025 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-QE/Si.in
+-rw-r--r--   0 runner    (1001) docker     (123)    16650 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-QE/disp_fc3.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)    32833 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-QE/phono3py_disp.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)   150928 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-QE/supercell_out.tar.lzma
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.879734 phono3py-2.7.0/example/Si-TURBOMOLE/
+-rw-r--r--   0 runner    (1001) docker     (123)    10449 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-TURBOMOLE/FORCES_FC2
+-rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-TURBOMOLE/FORCES_FC3
+-rw-r--r--   0 runner    (1001) docker     (123)     1195 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-TURBOMOLE/README
+-rw-r--r--   0 runner    (1001) docker     (123)      253 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-TURBOMOLE/control
+-rw-r--r--   0 runner    (1001) docker     (123)      492 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-TURBOMOLE/coord
+-rw-r--r--   0 runner    (1001) docker     (123)   278495 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Si-TURBOMOLE/outputs.tar.gz
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.883735 phono3py-2.7.0/example/Wigner_La2Zr2O7/
+-rw-r--r--   0 runner    (1001) docker     (123)      598 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Wigner_La2Zr2O7/BORN
+-rw-r--r--   0 runner    (1001) docker     (123)     1598 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Wigner_La2Zr2O7/POSCAR
+-rw-r--r--   0 runner    (1001) docker     (123)      197 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Wigner_La2Zr2O7/command.sh
+-rw-r--r--   0 runner    (1001) docker     (123)  1098761 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Wigner_La2Zr2O7/fc2.hdf5
+-rw-r--r--   0 runner    (1001) docker     (123)   339529 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Wigner_La2Zr2O7/kappa-m191919.hdf5
+-rw-r--r--   0 runner    (1001) docker     (123)   160648 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/Wigner_La2Zr2O7/tc_La2Zr2O7.out.xz
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.883735 phono3py-2.7.0/example/zb-ZnTe-PBEsol/
+-rw-r--r--   0 runner    (1001) docker     (123)      551 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/zb-ZnTe-PBEsol/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)     4657 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/zb-ZnTe-PBEsol/launch_phono3py_ZnTe_PBEsol_222.py
+-rw-r--r--   0 runner    (1001) docker     (123)   131412 2023-07-03 03:56:16.000000 phono3py-2.7.0/example/zb-ZnTe-PBEsol/phono3py_params_ZnTe.yaml.xz
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.855734 phono3py-2.7.0/phono3py/
+-rw-r--r--   0 runner    (1001) docker     (123)     1929 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5885 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/api_isotope.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11993 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/api_jointdos.py
+-rw-r--r--   0 runner    (1001) docker     (123)   100435 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/api_phono3py.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.859734 phono3py-2.7.0/phono3py/conductivity/
+-rw-r--r--   0 runner    (1001) docker     (123)       44 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/conductivity/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31789 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/conductivity/base.py
+-rw-r--r--   0 runner    (1001) docker     (123)    71692 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/conductivity/direct_solution.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5828 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/conductivity/kubo.py
+-rw-r--r--   0 runner    (1001) docker     (123)    41492 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/conductivity/rta.py
+-rw-r--r--   0 runner    (1001) docker     (123)    44514 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/conductivity/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8628 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/conductivity/wigner.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.859734 phono3py-2.7.0/phono3py/cui/
+-rw-r--r--   0 runner    (1001) docker     (123)       47 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20470 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/create_force_constants.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5689 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/create_supercells.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17234 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/kaccum_script.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24941 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/load.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24751 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/phono3py_argparse.py
+-rw-r--r--   0 runner    (1001) docker     (123)    51890 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/phono3py_script.py
+-rw-r--r--   0 runner    (1001) docker     (123)    37233 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/settings.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9785 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/show_log.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5803 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/cui/triplets_info.py
+-rw-r--r--   0 runner    (1001) docker     (123)    59956 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/file_IO.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.859734 phono3py-2.7.0/phono3py/interface/
+-rw-r--r--   0 runner    (1001) docker     (123)       50 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/interface/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2057 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/interface/alm.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4272 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/interface/calculator.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3735 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/interface/fc_calculator.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22533 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/interface/phono3py_yaml.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.859734 phono3py-2.7.0/phono3py/other/
+-rw-r--r--   0 runner    (1001) docker     (123)       40 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/other/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14859 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/other/isotope.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7449 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/other/kaccum.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6940 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/other/tetrahedron_method.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.859734 phono3py-2.7.0/phono3py/phonon/
+-rw-r--r--   0 runner    (1001) docker     (123)       55 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3289 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon/func.py
+-rw-r--r--   0 runner    (1001) docker     (123)    42764 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon/grid.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7528 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon/group_velocity_matrix.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2955 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon/heat_capacity_matrix.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6687 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon/solver.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9058 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon/velocity_operator.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.863735 phono3py-2.7.0/phono3py/phonon3/
+-rw-r--r--   0 runner    (1001) docker     (123)       42 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11852 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/collision_matrix.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3900 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/dataset.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14164 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/displacement_fc3.py
+-rw-r--r--   0 runner    (1001) docker     (123)    30142 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/fc3.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18247 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/gruneisen.py
+-rw-r--r--   0 runner    (1001) docker     (123)    38049 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/imag_self_energy.py
+-rw-r--r--   0 runner    (1001) docker     (123)    34150 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/interaction.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15875 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/joint_dos.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25947 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/real_self_energy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4953 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/real_to_reciprocal.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4238 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/reciprocal_to_normal.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13785 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/spectral_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14955 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/phonon3/triplets.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.863735 phono3py-2.7.0/phono3py/sscha/
+-rw-r--r--   0 runner    (1001) docker     (123)       26 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/sscha/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19518 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/sscha/sscha.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1636 2023-07-03 03:56:16.000000 phono3py-2.7.0/phono3py/version.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.883735 phono3py-2.7.0/phono3py.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)      254 2023-07-03 04:00:19.000000 phono3py-2.7.0/phono3py.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     6212 2023-07-03 04:00:19.000000 phono3py-2.7.0/phono3py.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-07-03 04:00:19.000000 phono3py-2.7.0/phono3py.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       92 2023-07-03 04:00:19.000000 phono3py-2.7.0/phono3py.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        9 2023-07-03 04:00:19.000000 phono3py-2.7.0/phono3py.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      298 2023-07-03 03:56:16.000000 phono3py-2.7.0/pyproject.toml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.883735 phono3py-2.7.0/scripts/
+-rwxr-xr-x   0 runner    (1001) docker     (123)     1831 2023-07-03 03:56:16.000000 phono3py-2.7.0/scripts/phono3py
+-rwxr-xr-x   0 runner    (1001) docker     (123)     3845 2023-07-03 03:56:16.000000 phono3py-2.7.0/scripts/phono3py-coleigplot
+-rwxr-xr-x   0 runner    (1001) docker     (123)     1688 2023-07-03 03:56:16.000000 phono3py-2.7.0/scripts/phono3py-kaccum
+-rwxr-xr-x   0 runner    (1001) docker     (123)     9488 2023-07-03 03:56:16.000000 phono3py-2.7.0/scripts/phono3py-kdeplot
+-rwxr-xr-x   0 runner    (1001) docker     (123)     1797 2023-07-03 03:56:16.000000 phono3py-2.7.0/scripts/phono3py-load
+-rw-r--r--   0 runner    (1001) docker     (123)      120 2023-07-03 04:00:19.891734 phono3py-2.7.0/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)    10247 2023-07-03 03:56:16.000000 phono3py-2.7.0/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.887735 phono3py-2.7.0/test/
+-rw-r--r--   0 runner    (1001) docker     (123)     1236 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/AgNO2_cell.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)      133 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/BORN_NaCl
+-rw-r--r--   0 runner    (1001) docker     (123)   357907 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/FORCES_FC3_si_pbesol
+-rw-r--r--   0 runner    (1001) docker     (123)     6282 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/FORCE_SETS_NaCl
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.887735 phono3py-2.7.0/test/api/
+-rw-r--r--   0 runner    (1001) docker     (123)     1124 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/api/test_api_phono3py.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.887735 phono3py-2.7.0/test/conductivity/
+-rw-r--r--   0 runner    (1001) docker     (123)       39 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/conductivity/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2975 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/conductivity/test_kappa_LBTE.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1839 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/conductivity/test_kappa_LBTE_Wigner.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11291 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/conductivity/test_kappa_RTA.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9763 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/conductivity/test_kappa_RTA_Wigner.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13692 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/conftest.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.887735 phono3py-2.7.0/test/cui/
+-rw-r--r--   0 runner    (1001) docker     (123)     2726 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/cui/test_phono3py_load_script.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.887735 phono3py-2.7.0/test/interface/
+-rw-r--r--   0 runner    (1001) docker     (123)     4557 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/interface/test_phono3py_yaml.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.891734 phono3py-2.7.0/test/other/
+-rw-r--r--   0 runner    (1001) docker     (123)       37 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/other/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3870 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/other/test_isotope.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8583 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/other/test_kaccum.py
+-rw-r--r--   0 runner    (1001) docker     (123)   177468 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phono3py_params-Si111-rd.yaml.xz
+-rw-r--r--   0 runner    (1001) docker     (123)   943848 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phono3py_params_AlN332.yaml.xz
+-rw-r--r--   0 runner    (1001) docker     (123)    26352 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phono3py_params_NaCl111.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)    69120 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phono3py_params_NaCl222.yaml.xz
+-rw-r--r--   0 runner    (1001) docker     (123)    30693 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phono3py_params_Si-111-222.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)    18216 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phono3py_params_Si111.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)    32800 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phono3py_si_pbesol.yaml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.891734 phono3py-2.7.0/test/phonon/
+-rw-r--r--   0 runner    (1001) docker     (123)       50 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    51827 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon/test_grid.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19748 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon/test_velocity_operator.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.891734 phono3py-2.7.0/test/phonon3/
+-rw-r--r--   0 runner    (1001) docker     (123)       44 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4141 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_displacements.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11449 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_fc3.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20434 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_imag_self_energy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8336 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_interaction.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13435 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_joint_dos.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13537 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_real_self_energy.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5596 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_spectral_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)    41085 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonon3/test_triplets.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12203 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonopy_disp_NaCl.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)   286407 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonopy_params-Si111-iterha.yaml.gz
+-rw-r--r--   0 runner    (1001) docker     (123)     5587 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/phonopy_params_Si.yaml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-03 04:00:19.891734 phono3py-2.7.0/test/sscha/
+-rw-r--r--   0 runner    (1001) docker     (123)       23 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/sscha/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8800 2023-07-03 03:56:16.000000 phono3py-2.7.0/test/sscha/test_sscha.py
```

### Comparing `phono3py-2.6.0/LICENSE` & `phono3py-2.7.0/LICENSE`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/README.md` & `phono3py-2.7.0/README.md`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/_phono3py.c` & `phono3py-2.7.0/c/_phono3py.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/_phononcalc.c` & `phono3py-2.7.0/c/_phononcalc.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/bzgrid.c` & `phono3py-2.7.0/c/bzgrid.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/bzgrid.h` & `phono3py-2.7.0/c/bzgrid.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/collision_matrix.c` & `phono3py-2.7.0/c/collision_matrix.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/collision_matrix.h` & `phono3py-2.7.0/c/collision_matrix.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/dynmat.c` & `phono3py-2.7.0/c/dynmat.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/dynmat.h` & `phono3py-2.7.0/c/dynmat.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/fc3.c` & `phono3py-2.7.0/c/fc3.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/fc3.h` & `phono3py-2.7.0/c/fc3.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/grgrid.c` & `phono3py-2.7.0/c/grgrid.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/grgrid.h` & `phono3py-2.7.0/c/grgrid.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/gridsys.c` & `phono3py-2.7.0/c/gridsys.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/gridsys.h` & `phono3py-2.7.0/c/gridsys.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/imag_self_energy_with_g.c` & `phono3py-2.7.0/c/imag_self_energy_with_g.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/imag_self_energy_with_g.h` & `phono3py-2.7.0/c/imag_self_energy_with_g.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/interaction.c` & `phono3py-2.7.0/c/interaction.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/interaction.h` & `phono3py-2.7.0/c/interaction.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/isotope.c` & `phono3py-2.7.0/c/isotope.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/isotope.h` & `phono3py-2.7.0/c/isotope.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/lagrid.c` & `phono3py-2.7.0/c/lagrid.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/lagrid.h` & `phono3py-2.7.0/c/lagrid.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/lapack_wrapper.c` & `phono3py-2.7.0/c/lapack_wrapper.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/lapack_wrapper.h` & `phono3py-2.7.0/c/lapack_wrapper.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/niggli.c` & `phono3py-2.7.0/c/niggli.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/niggli.h` & `phono3py-2.7.0/c/niggli.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phono3py.c` & `phono3py-2.7.0/c/phono3py.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phono3py.h` & `phono3py-2.7.0/c/phono3py.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phonoc_array.h` & `phono3py-2.7.0/c/phonoc_array.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phonoc_const.h` & `phono3py-2.7.0/c/phonoc_const.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phonoc_utils.c` & `phono3py-2.7.0/c/phonoc_utils.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phonoc_utils.h` & `phono3py-2.7.0/c/phonoc_utils.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phonon.c` & `phono3py-2.7.0/c/phonon.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phonon.h` & `phono3py-2.7.0/c/phonon.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phononcalc.c` & `phono3py-2.7.0/c/phononcalc.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/phononcalc.h` & `phono3py-2.7.0/c/phononcalc.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/pp_collision.c` & `phono3py-2.7.0/c/pp_collision.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/pp_collision.h` & `phono3py-2.7.0/c/pp_collision.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/real_self_energy.c` & `phono3py-2.7.0/c/real_self_energy.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/real_self_energy.h` & `phono3py-2.7.0/c/real_self_energy.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/real_to_reciprocal.c` & `phono3py-2.7.0/c/real_to_reciprocal.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/real_to_reciprocal.h` & `phono3py-2.7.0/c/real_to_reciprocal.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/reciprocal_to_normal.c` & `phono3py-2.7.0/c/reciprocal_to_normal.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/reciprocal_to_normal.h` & `phono3py-2.7.0/c/reciprocal_to_normal.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/snf3x3.c` & `phono3py-2.7.0/c/snf3x3.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/tetrahedron_method.c` & `phono3py-2.7.0/c/tetrahedron_method.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/tetrahedron_method.h` & `phono3py-2.7.0/c/tetrahedron_method.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/triplet.c` & `phono3py-2.7.0/c/triplet.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/triplet.h` & `phono3py-2.7.0/c/triplet.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/triplet_grid.c` & `phono3py-2.7.0/c/triplet_grid.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/triplet_grid.h` & `phono3py-2.7.0/c/triplet_grid.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/triplet_iw.c` & `phono3py-2.7.0/c/triplet_iw.c`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/c/triplet_iw.h` & `phono3py-2.7.0/c/triplet_iw.h`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/AlN-LDA/FORCES_FC2` & `phono3py-2.7.0/example/AlN-LDA/FORCES_FC2`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/AlN-LDA/FORCES_FC3.lzma` & `phono3py-2.7.0/example/AlN-LDA/FORCES_FC3.lzma`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/AlN-LDA/README.md` & `phono3py-2.7.0/example/AlN-LDA/README.md`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/AlN-LDA/phono3py_disp.yaml` & `phono3py-2.7.0/example/AlN-LDA/phono3py_disp.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/AlN-LDA/phono3py_disp_dimfc2.yaml` & `phono3py-2.7.0/example/AlN-LDA/phono3py_disp_dimfc2.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-CRYSTAL/FORCES_FC2` & `phono3py-2.7.0/example/Si-CRYSTAL/FORCES_FC2`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-CRYSTAL/FORCES_FC3` & `phono3py-2.7.0/example/Si-CRYSTAL/FORCES_FC3`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-CRYSTAL/README` & `phono3py-2.7.0/example/Si-CRYSTAL/README`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-CRYSTAL/TEMPLATE` & `phono3py-2.7.0/example/Si-CRYSTAL/TEMPLATE`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-CRYSTAL/TEMPLATE3` & `phono3py-2.7.0/example/Si-CRYSTAL/TEMPLATE3`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-CRYSTAL/crystal.o` & `phono3py-2.7.0/example/Si-CRYSTAL/crystal.o`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-CRYSTAL/outputs.tar.gz` & `phono3py-2.7.0/example/Si-CRYSTAL/outputs.tar.gz`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-LDA/FORCES_FC3` & `phono3py-2.7.0/example/Si-LDA/FORCES_FC3`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-LDA/POSCAR-unitcell` & `phono3py-2.7.0/example/Si-LDA/POSCAR-unitcell`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-LDA/README.md` & `phono3py-2.7.0/example/Si-LDA/README.md`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-LDA/phono3py_disp.yaml` & `phono3py-2.7.0/example/Si-LDA/phono3py_disp.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-LDA/vasprun_xmls.tar.lzma` & `phono3py-2.7.0/example/Si-LDA/vasprun_xmls.tar.lzma`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBE/FORCES_FC3` & `phono3py-2.7.0/example/Si-PBE/FORCES_FC3`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBE/POSCAR-unitcell` & `phono3py-2.7.0/example/Si-PBE/POSCAR-unitcell`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBE/README.md` & `phono3py-2.7.0/example/Si-PBE/README.md`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBE/phono3py_disp.yaml` & `phono3py-2.7.0/example/Si-PBE/phono3py_disp.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBE/vasprun_xmls.tar.lzma` & `phono3py-2.7.0/example/Si-PBE/vasprun_xmls.tar.lzma`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/FORCES_FC3` & `phono3py-2.7.0/example/Si-PBEsol/FORCES_FC3`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/POSCAR-unitcell` & `phono3py-2.7.0/example/Si-PBEsol/POSCAR-unitcell`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/README.md` & `phono3py-2.7.0/example/Si-PBEsol/README.md`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/Si-band-DOS.png` & `phono3py-2.7.0/example/Si-PBEsol/Si-band-DOS.png`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/Si-kaccum.png` & `phono3py-2.7.0/example/Si-PBEsol/Si-kaccum.png`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/Si.py` & `phono3py-2.7.0/example/Si-PBEsol/Si.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/phono3py_disp.yaml` & `phono3py-2.7.0/example/Si-PBEsol/phono3py_disp.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/phono3py_disp_dimfc2.yaml` & `phono3py-2.7.0/example/Si-PBEsol/phono3py_disp_dimfc2.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/POSCAR` & `phono3py-2.7.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/POSCAR`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/vasprun.xml` & `phono3py-2.7.0/example/Si-PBEsol/vasprun_xml_fc2/disp-fc2-00001/vasprun.xml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-PBEsol/vasprun_xmls.tar.lzma` & `phono3py-2.7.0/example/Si-PBEsol/vasprun_xmls.tar.lzma`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-QE/FORCES_FC3` & `phono3py-2.7.0/example/Si-QE/FORCES_FC3`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-QE/README.md` & `phono3py-2.7.0/example/Si-QE/README.md`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-QE/Si.in` & `phono3py-2.7.0/example/Si-QE/Si.in`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-QE/disp_fc3.yaml` & `phono3py-2.7.0/example/Si-QE/disp_fc3.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-QE/phono3py_disp.yaml` & `phono3py-2.7.0/example/Si-QE/phono3py_disp.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-QE/supercell_out.tar.lzma` & `phono3py-2.7.0/example/Si-QE/supercell_out.tar.lzma`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-TURBOMOLE/FORCES_FC2` & `phono3py-2.7.0/example/Si-TURBOMOLE/FORCES_FC2`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-TURBOMOLE/FORCES_FC3` & `phono3py-2.7.0/example/Si-TURBOMOLE/FORCES_FC3`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-TURBOMOLE/README` & `phono3py-2.7.0/example/Si-TURBOMOLE/README`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Si-TURBOMOLE/outputs.tar.gz` & `phono3py-2.7.0/example/Si-TURBOMOLE/outputs.tar.gz`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Wigner_La2Zr2O7/BORN` & `phono3py-2.7.0/example/Wigner_La2Zr2O7/BORN`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Wigner_La2Zr2O7/POSCAR` & `phono3py-2.7.0/example/Wigner_La2Zr2O7/POSCAR`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Wigner_La2Zr2O7/fc2.hdf5` & `phono3py-2.7.0/example/Wigner_La2Zr2O7/fc2.hdf5`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Wigner_La2Zr2O7/kappa-m191919.hdf5` & `phono3py-2.7.0/example/Wigner_La2Zr2O7/kappa-m191919.hdf5`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/Wigner_La2Zr2O7/tc_La2Zr2O7.out.xz` & `phono3py-2.7.0/example/Wigner_La2Zr2O7/tc_La2Zr2O7.out.xz`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/zb-ZnTe-PBEsol/README.md` & `phono3py-2.7.0/example/zb-ZnTe-PBEsol/README.md`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/zb-ZnTe-PBEsol/launch_phono3py_ZnTe_PBEsol_222.py` & `phono3py-2.7.0/example/zb-ZnTe-PBEsol/launch_phono3py_ZnTe_PBEsol_222.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/example/zb-ZnTe-PBEsol/phono3py_params_ZnTe.yaml.xz` & `phono3py-2.7.0/example/zb-ZnTe-PBEsol/phono3py_params_ZnTe.yaml.xz`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/__init__.py` & `phono3py-2.7.0/phono3py/__init__.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/api_isotope.py` & `phono3py-2.7.0/phono3py/api_isotope.py`

 * *Files 2% similar despite different names*

```diff
@@ -29,14 +29,16 @@
 # BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 # LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 # CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 # LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 # ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
+import warnings
+
 import numpy as np
 from phonopy.units import VaspToTHz
 
 from phono3py.other.isotope import Isotope
 
 
 class Phono3pyIsotope:
@@ -59,14 +61,22 @@
         """Init method."""
         if sigmas is None:
             self._sigmas = [
                 None,
             ]
         else:
             self._sigmas = sigmas
+
+        if not store_dense_gp_map:
+            warnings.warn(
+                "Phono3pyIsotope init parameter of store_dense_gp_map is deprecated. "
+                "This will be always set True.",
+                DeprecationWarning,
+            )
+
         self._iso = Isotope(
             mesh,
             primitive,
             mass_variances=mass_variances,
             band_indices=band_indices,
             frequency_factor_to_THz=frequency_factor_to_THz,
             use_grg=use_grg,
```

### Comparing `phono3py-2.6.0/phono3py/api_jointdos.py` & `phono3py-2.7.0/phono3py/api_jointdos.py`

 * *Files 2% similar despite different names*

```diff
@@ -29,14 +29,16 @@
 # BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 # LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 # CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 # LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 # ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
+import warnings
+
 import numpy as np
 from phonopy.structure.cells import Primitive, Supercell
 from phonopy.structure.symmetry import Symmetry
 from phonopy.units import VaspToTHz
 
 from phono3py.file_IO import write_joint_dos
 from phono3py.phonon3.imag_self_energy import (
@@ -66,15 +68,15 @@
         temperatures=None,
         frequency_factor_to_THz=VaspToTHz,
         frequency_scale_factor=None,
         use_grg=False,
         SNF_coordinates="reciprocal",
         is_mesh_symmetry=True,
         is_symmetry=True,
-        store_dense_gp_map=False,
+        store_dense_gp_map=True,
         symprec=1e-5,
         output_filename=None,
         log_level=0,
     ):
         """Init method."""
         self._primitive = primitive
         self._supercell = supercell
@@ -87,15 +89,23 @@
         else:
             self._sigmas = sigmas
         self._cutoff_frequency = cutoff_frequency
         self._frequency_factor_to_THz = frequency_factor_to_THz
         self._frequency_scale_factor = frequency_scale_factor
         self._is_mesh_symmetry = is_mesh_symmetry
         self._is_symmetry = is_symmetry
+
+        if not store_dense_gp_map:
+            warnings.warn(
+                "Phono3pyJointDos init parameter of store_dense_gp_map is deprecated. "
+                "This will be set always True.",
+                DeprecationWarning,
+            )
         self._store_dense_gp_map = store_dense_gp_map
+
         self._use_grg = use_grg
         self._SNF_coordinates = SNF_coordinates
         self._symprec = symprec
         self._filename = output_filename
         self._log_level = log_level
 
         self._bz_grid = None
```

### Comparing `phono3py-2.6.0/phono3py/api_phono3py.py` & `phono3py-2.7.0/phono3py/api_phono3py.py`

 * *Files 2% similar despite different names*

```diff
@@ -97,6138 +97,6182 @@
 00000600: 4520 4f46 2054 4849 5320 534f 4654 5741  E OF THIS SOFTWA
 00000610: 5245 2c20 4556 454e 2049 4620 4144 5649  RE, EVEN IF ADVI
 00000620: 5345 4420 4f46 2054 4845 0a23 2050 4f53  SED OF THE.# POS
 00000630: 5349 4249 4c49 5459 204f 4620 5355 4348  SIBILITY OF SUCH
 00000640: 2044 414d 4147 452e 0a0a 696d 706f 7274   DAMAGE...import
 00000650: 2077 6172 6e69 6e67 730a 0a69 6d70 6f72   warnings..impor
 00000660: 7420 6e75 6d70 7920 6173 206e 700a 6672  t numpy as np.fr
-00000670: 6f6d 2070 686f 6e6f 7079 2e68 6172 6d6f  om phonopy.harmo
-00000680: 6e69 632e 6469 7370 6c61 6365 6d65 6e74  nic.displacement
-00000690: 2069 6d70 6f72 7420 280a 2020 2020 6469   import (.    di
-000006a0: 7265 6374 696f 6e73 5f74 6f5f 6469 7370  rections_to_disp
-000006b0: 6c61 6365 6d65 6e74 5f64 6174 6173 6574  lacement_dataset
-000006c0: 2c0a 2020 2020 6765 745f 6c65 6173 745f  ,.    get_least_
-000006d0: 6469 7370 6c61 6365 6d65 6e74 732c 0a29  displacements,.)
-000006e0: 0a66 726f 6d20 7068 6f6e 6f70 792e 6861  .from phonopy.ha
-000006f0: 726d 6f6e 6963 2e66 6f72 6365 5f63 6f6e  rmonic.force_con
-00000700: 7374 616e 7473 2069 6d70 6f72 7420 6765  stants import ge
-00000710: 745f 6663 3220 6173 2067 6574 5f70 686f  t_fc2 as get_pho
-00000720: 6e6f 7079 5f66 6332 0a66 726f 6d20 7068  nopy_fc2.from ph
-00000730: 6f6e 6f70 792e 6861 726d 6f6e 6963 2e66  onopy.harmonic.f
-00000740: 6f72 6365 5f63 6f6e 7374 616e 7473 2069  orce_constants i
-00000750: 6d70 6f72 7420 280a 2020 2020 7365 745f  mport (.    set_
-00000760: 7065 726d 7574 6174 696f 6e5f 7379 6d6d  permutation_symm
-00000770: 6574 7279 2c0a 2020 2020 7365 745f 7472  etry,.    set_tr
-00000780: 616e 736c 6174 696f 6e61 6c5f 696e 7661  anslational_inva
-00000790: 7269 616e 6365 2c0a 2020 2020 7379 6d6d  riance,.    symm
-000007a0: 6574 7269 7a65 5f63 6f6d 7061 6374 5f66  etrize_compact_f
-000007b0: 6f72 6365 5f63 6f6e 7374 616e 7473 2c0a  orce_constants,.
-000007c0: 2020 2020 7379 6d6d 6574 7269 7a65 5f66      symmetrize_f
-000007d0: 6f72 6365 5f63 6f6e 7374 616e 7473 2c0a  orce_constants,.
-000007e0: 290a 6672 6f6d 2070 686f 6e6f 7079 2e69  ).from phonopy.i
-000007f0: 6e74 6572 6661 6365 2e66 635f 6361 6c63  nterface.fc_calc
-00000800: 756c 6174 6f72 2069 6d70 6f72 7420 6765  ulator import ge
-00000810: 745f 6663 320a 6672 6f6d 2070 686f 6e6f  t_fc2.from phono
-00000820: 7079 2e73 7472 7563 7475 7265 2e61 746f  py.structure.ato
-00000830: 6d73 2069 6d70 6f72 7420 5068 6f6e 6f70  ms import Phonop
-00000840: 7941 746f 6d73 0a66 726f 6d20 7068 6f6e  yAtoms.from phon
-00000850: 6f70 792e 7374 7275 6374 7572 652e 6365  opy.structure.ce
-00000860: 6c6c 7320 696d 706f 7274 2028 0a20 2020  lls import (.   
-00000870: 2050 7269 6d69 7469 7665 2c0a 2020 2020   Primitive,.    
-00000880: 5375 7065 7263 656c 6c2c 0a20 2020 2067  Supercell,.    g
-00000890: 6574 5f70 7269 6d69 7469 7665 2c0a 2020  et_primitive,.  
-000008a0: 2020 6765 745f 7072 696d 6974 6976 655f    get_primitive_
-000008b0: 6d61 7472 6978 2c0a 2020 2020 6765 745f  matrix,.    get_
-000008c0: 7375 7065 7263 656c 6c2c 0a20 2020 2067  supercell,.    g
-000008d0: 7565 7373 5f70 7269 6d69 7469 7665 5f6d  uess_primitive_m
-000008e0: 6174 7269 782c 0a20 2020 2073 6861 7065  atrix,.    shape
-000008f0: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
-00000900: 782c 0a29 0a66 726f 6d20 7068 6f6e 6f70  x,.).from phonop
-00000910: 792e 7374 7275 6374 7572 652e 6461 7461  y.structure.data
-00000920: 7365 7420 696d 706f 7274 2067 6574 5f64  set import get_d
-00000930: 6973 706c 6163 656d 656e 7473 5f61 6e64  isplacements_and
-00000940: 5f66 6f72 6365 730a 6672 6f6d 2070 686f  _forces.from pho
-00000950: 6e6f 7079 2e73 7472 7563 7475 7265 2e73  nopy.structure.s
-00000960: 796d 6d65 7472 7920 696d 706f 7274 2053  ymmetry import S
-00000970: 796d 6d65 7472 790a 6672 6f6d 2070 686f  ymmetry.from pho
-00000980: 6e6f 7079 2e75 6e69 7473 2069 6d70 6f72  nopy.units impor
-00000990: 7420 5661 7370 546f 5448 7a0a 0a66 726f  t VaspToTHz..fro
-000009a0: 6d20 7068 6f6e 6f33 7079 2e63 6f6e 6475  m phono3py.condu
-000009b0: 6374 6976 6974 792e 6469 7265 6374 5f73  ctivity.direct_s
-000009c0: 6f6c 7574 696f 6e20 696d 706f 7274 2067  olution import g
-000009d0: 6574 5f74 6865 726d 616c 5f63 6f6e 6475  et_thermal_condu
-000009e0: 6374 6976 6974 795f 4c42 5445 0a66 726f  ctivity_LBTE.fro
-000009f0: 6d20 7068 6f6e 6f33 7079 2e63 6f6e 6475  m phono3py.condu
-00000a00: 6374 6976 6974 792e 7274 6120 696d 706f  ctivity.rta impo
-00000a10: 7274 2067 6574 5f74 6865 726d 616c 5f63  rt get_thermal_c
-00000a20: 6f6e 6475 6374 6976 6974 795f 5254 410a  onductivity_RTA.
-00000a30: 6672 6f6d 2070 686f 6e6f 3370 792e 696e  from phono3py.in
-00000a40: 7465 7266 6163 652e 6663 5f63 616c 6375  terface.fc_calcu
-00000a50: 6c61 746f 7220 696d 706f 7274 2067 6574  lator import get
-00000a60: 5f66 6333 0a66 726f 6d20 7068 6f6e 6f33  _fc3.from phono3
-00000a70: 7079 2e69 6e74 6572 6661 6365 2e70 686f  py.interface.pho
-00000a80: 6e6f 3370 795f 7961 6d6c 2069 6d70 6f72  no3py_yaml impor
-00000a90: 7420 5068 6f6e 6f33 7079 5961 6d6c 0a66  t Phono3pyYaml.f
-00000aa0: 726f 6d20 7068 6f6e 6f33 7079 2e70 686f  rom phono3py.pho
-00000ab0: 6e6f 6e33 2e64 6174 6173 6574 2069 6d70  non3.dataset imp
-00000ac0: 6f72 7420 6765 745f 6469 7370 6c61 6365  ort get_displace
-00000ad0: 6d65 6e74 735f 616e 645f 666f 7263 6573  ments_and_forces
-00000ae0: 5f66 6333 0a66 726f 6d20 7068 6f6e 6f33  _fc3.from phono3
-00000af0: 7079 2e70 686f 6e6f 6e33 2e64 6973 706c  py.phonon3.displ
-00000b00: 6163 656d 656e 745f 6663 3320 696d 706f  acement_fc3 impo
-00000b10: 7274 2028 0a20 2020 2064 6972 6563 7469  rt (.    directi
-00000b20: 6f6e 5f74 6f5f 6469 7370 6c61 6365 6d65  on_to_displaceme
-00000b30: 6e74 2c0a 2020 2020 6765 745f 7468 6972  nt,.    get_thir
-00000b40: 645f 6f72 6465 725f 6469 7370 6c61 6365  d_order_displace
-00000b50: 6d65 6e74 732c 0a29 0a66 726f 6d20 7068  ments,.).from ph
-00000b60: 6f6e 6f33 7079 2e70 686f 6e6f 6e33 2e66  ono3py.phonon3.f
-00000b70: 6333 2069 6d70 6f72 7420 6375 746f 6666  c3 import cutoff
-00000b80: 5f66 6333 5f62 795f 7a65 726f 0a66 726f  _fc3_by_zero.fro
-00000b90: 6d20 7068 6f6e 6f33 7079 2e70 686f 6e6f  m phono3py.phono
-00000ba0: 6e33 2e66 6333 2069 6d70 6f72 7420 6765  n3.fc3 import ge
-00000bb0: 745f 6663 3320 6173 2067 6574 5f70 686f  t_fc3 as get_pho
-00000bc0: 6e6f 3370 795f 6663 330a 6672 6f6d 2070  no3py_fc3.from p
-00000bd0: 686f 6e6f 3370 792e 7068 6f6e 6f6e 332e  hono3py.phonon3.
-00000be0: 6663 3320 696d 706f 7274 2028 0a20 2020  fc3 import (.   
-00000bf0: 2073 6574 5f70 6572 6d75 7461 7469 6f6e   set_permutation
-00000c00: 5f73 796d 6d65 7472 795f 636f 6d70 6163  _symmetry_compac
-00000c10: 745f 6663 332c 0a20 2020 2073 6574 5f70  t_fc3,.    set_p
-00000c20: 6572 6d75 7461 7469 6f6e 5f73 796d 6d65  ermutation_symme
-00000c30: 7472 795f 6663 332c 0a20 2020 2073 6574  try_fc3,.    set
-00000c40: 5f74 7261 6e73 6c61 7469 6f6e 616c 5f69  _translational_i
-00000c50: 6e76 6172 6961 6e63 655f 636f 6d70 6163  nvariance_compac
-00000c60: 745f 6663 332c 0a20 2020 2073 6574 5f74  t_fc3,.    set_t
-00000c70: 7261 6e73 6c61 7469 6f6e 616c 5f69 6e76  ranslational_inv
-00000c80: 6172 6961 6e63 655f 6663 332c 0a29 0a66  ariance_fc3,.).f
-00000c90: 726f 6d20 7068 6f6e 6f33 7079 2e70 686f  rom phono3py.pho
-00000ca0: 6e6f 6e33 2e69 6d61 675f 7365 6c66 5f65  non3.imag_self_e
-00000cb0: 6e65 7267 7920 696d 706f 7274 2028 0a20  nergy import (. 
-00000cc0: 2020 2067 6574 5f69 6d61 675f 7365 6c66     get_imag_self
-00000cd0: 5f65 6e65 7267 792c 0a20 2020 2077 7269  _energy,.    wri
-00000ce0: 7465 5f69 6d61 675f 7365 6c66 5f65 6e65  te_imag_self_ene
-00000cf0: 7267 792c 0a29 0a66 726f 6d20 7068 6f6e  rgy,.).from phon
-00000d00: 6f33 7079 2e70 686f 6e6f 6e33 2e69 6e74  o3py.phonon3.int
-00000d10: 6572 6163 7469 6f6e 2069 6d70 6f72 7420  eraction import 
-00000d20: 496e 7465 7261 6374 696f 6e0a 6672 6f6d  Interaction.from
-00000d30: 2070 686f 6e6f 3370 792e 7068 6f6e 6f6e   phono3py.phonon
-00000d40: 332e 7265 616c 5f73 656c 665f 656e 6572  3.real_self_ener
-00000d50: 6779 2069 6d70 6f72 7420 280a 2020 2020  gy import (.    
-00000d60: 6765 745f 7265 616c 5f73 656c 665f 656e  get_real_self_en
-00000d70: 6572 6779 2c0a 2020 2020 7772 6974 655f  ergy,.    write_
-00000d80: 7265 616c 5f73 656c 665f 656e 6572 6779  real_self_energy
-00000d90: 2c0a 290a 6672 6f6d 2070 686f 6e6f 3370  ,.).from phono3p
-00000da0: 792e 7068 6f6e 6f6e 332e 7370 6563 7472  y.phonon3.spectr
-00000db0: 616c 5f66 756e 6374 696f 6e20 696d 706f  al_function impo
-00000dc0: 7274 2072 756e 5f73 7065 6374 7261 6c5f  rt run_spectral_
-00000dd0: 6675 6e63 7469 6f6e 0a66 726f 6d20 7068  function.from ph
-00000de0: 6f6e 6f33 7079 2e70 686f 6e6f 6e2e 6772  ono3py.phonon.gr
-00000df0: 6964 2069 6d70 6f72 7420 425a 4772 6964  id import BZGrid
-00000e00: 0a66 726f 6d20 7068 6f6e 6f33 7079 2e76  .from phono3py.v
-00000e10: 6572 7369 6f6e 2069 6d70 6f72 7420 5f5f  ersion import __
-00000e20: 7665 7273 696f 6e5f 5f0a 0a0a 636c 6173  version__...clas
-00000e30: 7320 5068 6f6e 6f33 7079 3a0a 2020 2020  s Phono3py:.    
-00000e40: 2222 2250 686f 6e6f 3370 7920 6d61 696e  """Phono3py main
-00000e50: 2063 6c61 7373 2e0a 0a20 2020 2041 7474   class...    Att
-00000e60: 7269 6275 7465 730a 2020 2020 2d2d 2d2d  ributes.    ----
-00000e70: 2d2d 2d2d 2d2d 0a20 2020 2076 6572 7369  ------.    versi
-00000e80: 6f6e 0a20 2020 2063 616c 6375 6c61 746f  on.    calculato
-00000e90: 720a 2020 2020 6663 3320 3a20 6765 7474  r.    fc3 : gett
-00000ea0: 6572 2061 6e64 2073 6574 7465 720a 2020  er and setter.  
-00000eb0: 2020 6663 3220 3a20 6765 7474 6572 2061    fc2 : getter a
-00000ec0: 6e64 2073 6574 7465 720a 2020 2020 666f  nd setter.    fo
-00000ed0: 7263 655f 636f 6e73 7461 6e74 730a 2020  rce_constants.  
-00000ee0: 2020 7369 676d 6120 3a20 6765 7474 6572    sigma : getter
-00000ef0: 2061 6e64 2073 6574 7465 720a 2020 2020   and setter.    
-00000f00: 7369 676d 615f 6375 746f 6666 203a 2067  sigma_cutoff : g
-00000f10: 6574 7465 7220 616e 6420 7365 7474 6572  etter and setter
-00000f20: 0a20 2020 206e 6163 5f70 6172 616d 7320  .    nac_params 
-00000f30: 3a20 6765 7474 6572 2061 6e64 2073 6574  : getter and set
-00000f40: 7465 720a 2020 2020 6479 6e61 6d69 6361  ter.    dynamica
-00000f50: 6c5f 6d61 7472 6978 0a20 2020 2070 7269  l_matrix.    pri
-00000f60: 6d69 7469 7665 0a20 2020 2075 6e69 7463  mitive.    unitc
-00000f70: 656c 6c0a 2020 2020 7375 7065 7263 656c  ell.    supercel
-00000f80: 6c0a 2020 2020 7068 6f6e 6f6e 5f73 7570  l.    phonon_sup
-00000f90: 6572 6365 6c6c 0a20 2020 2070 686f 6e6f  ercell.    phono
-00000fa0: 6e5f 7072 696d 6974 6976 650a 2020 2020  n_primitive.    
-00000fb0: 7379 6d6d 6574 7279 0a20 2020 2070 7269  symmetry.    pri
-00000fc0: 6d69 7469 7665 5f73 796d 6d65 7472 790a  mitive_symmetry.
-00000fd0: 2020 2020 7068 6f6e 6f6e 5f73 7570 6572      phonon_super
-00000fe0: 6365 6c6c 5f73 796d 6d65 7472 790a 2020  cell_symmetry.  
-00000ff0: 2020 7375 7065 7263 656c 6c5f 6d61 7472    supercell_matr
-00001000: 6978 0a20 2020 2070 686f 6e6f 6e5f 7375  ix.    phonon_su
-00001010: 7065 7263 656c 6c5f 6d61 7472 6978 0a20  percell_matrix. 
-00001020: 2020 2070 7269 6d69 7469 7665 5f6d 6174     primitive_mat
-00001030: 7269 780a 2020 2020 756e 6974 5f63 6f6e  rix.    unit_con
-00001040: 7665 7273 696f 6e5f 6661 6374 6f72 0a20  version_factor. 
-00001050: 2020 2064 6174 6173 6574 203a 2067 6574     dataset : get
-00001060: 7465 7220 616e 6420 7365 7474 6572 0a20  ter and setter. 
-00001070: 2020 2070 686f 6e6f 6e5f 6461 7461 7365     phonon_datase
-00001080: 7420 3a20 6765 7474 6572 2061 6e64 2073  t : getter and s
-00001090: 6574 7465 720a 2020 2020 6261 6e64 5f69  etter.    band_i
-000010a0: 6e64 6963 6573 203a 2067 6574 7465 7220  ndices : getter 
-000010b0: 616e 6420 7365 7474 6572 0a20 2020 2070  and setter.    p
-000010c0: 686f 6e6f 6e5f 7375 7065 7263 656c 6c73  honon_supercells
-000010d0: 5f77 6974 685f 6469 7370 6c61 6365 6d65  _with_displaceme
-000010e0: 6e74 730a 2020 2020 7375 7065 7263 656c  nts.    supercel
-000010f0: 6c73 5f77 6974 685f 6469 7370 6c61 6365  ls_with_displace
-00001100: 6d65 6e74 730a 2020 2020 6d65 7368 5f6e  ments.    mesh_n
-00001110: 756d 6265 7273 203a 2067 6574 7465 7220  umbers : getter 
-00001120: 616e 6420 7365 7474 6572 0a20 2020 2074  and setter.    t
-00001130: 6865 726d 616c 5f63 6f6e 6475 6374 6976  hermal_conductiv
-00001140: 6974 790a 2020 2020 6469 7370 6c61 6365  ity.    displace
-00001150: 6d65 6e74 7320 3a20 6765 7474 6572 2061  ments : getter a
-00001160: 6e64 2073 6574 7465 720a 2020 2020 666f  nd setter.    fo
-00001170: 7263 6573 203a 2067 6574 7465 7220 616e  rces : getter an
-00001180: 6420 7365 7474 6572 0a20 2020 2070 686f  d setter.    pho
-00001190: 6e6f 6e5f 6469 7370 6c61 6365 6d65 6e74  non_displacement
-000011a0: 7320 3a20 6765 7474 6572 2061 6e64 2073  s : getter and s
-000011b0: 6574 7465 720a 2020 2020 7068 6f6e 6f6e  etter.    phonon
-000011c0: 5f66 6f72 6365 7320 3a20 6765 7474 6572  _forces : getter
-000011d0: 2061 6e64 2073 6574 7465 720a 2020 2020   and setter.    
-000011e0: 7068 7068 5f69 6e74 6572 6163 7469 6f6e  phph_interaction
-000011f0: 0a0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
-00001200: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
-00001210: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00001220: 2020 2075 6e69 7463 656c 6c3a 2050 686f     unitcell: Pho
-00001230: 6e6f 7079 4174 6f6d 732c 0a20 2020 2020  nopyAtoms,.     
-00001240: 2020 2073 7570 6572 6365 6c6c 5f6d 6174     supercell_mat
-00001250: 7269 783d 4e6f 6e65 2c0a 2020 2020 2020  rix=None,.      
-00001260: 2020 7072 696d 6974 6976 655f 6d61 7472    primitive_matr
-00001270: 6978 3d4e 6f6e 652c 0a20 2020 2020 2020  ix=None,.       
-00001280: 2070 686f 6e6f 6e5f 7375 7065 7263 656c   phonon_supercel
-00001290: 6c5f 6d61 7472 6978 3d4e 6f6e 652c 0a20  l_matrix=None,. 
-000012a0: 2020 2020 2020 206d 6173 7365 733d 4e6f         masses=No
-000012b0: 6e65 2c0a 2020 2020 2020 2020 6261 6e64  ne,.        band
-000012c0: 5f69 6e64 6963 6573 3d4e 6f6e 652c 0a20  _indices=None,. 
-000012d0: 2020 2020 2020 2073 6967 6d61 733d 4e6f         sigmas=No
-000012e0: 6e65 2c0a 2020 2020 2020 2020 7369 676d  ne,.        sigm
-000012f0: 615f 6375 746f 6666 3d4e 6f6e 652c 0a20  a_cutoff=None,. 
-00001300: 2020 2020 2020 2063 7574 6f66 665f 6672         cutoff_fr
-00001310: 6571 7565 6e63 793d 3165 2d34 2c0a 2020  equency=1e-4,.  
-00001320: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
-00001330: 6661 6374 6f72 5f74 6f5f 5448 7a3d 5661  factor_to_THz=Va
-00001340: 7370 546f 5448 7a2c 0a20 2020 2020 2020  spToTHz,.       
-00001350: 2069 735f 7379 6d6d 6574 7279 3d54 7275   is_symmetry=Tru
-00001360: 652c 0a20 2020 2020 2020 2069 735f 6d65  e,.        is_me
-00001370: 7368 5f73 796d 6d65 7472 793d 5472 7565  sh_symmetry=True
-00001380: 2c0a 2020 2020 2020 2020 7573 655f 6772  ,.        use_gr
-00001390: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-000013a0: 2053 4e46 5f63 6f6f 7264 696e 6174 6573   SNF_coordinates
-000013b0: 3d22 7265 6369 7072 6f63 616c 222c 0a20  ="reciprocal",. 
-000013c0: 2020 2020 2020 2073 796d 6d65 7472 697a         symmetriz
-000013d0: 655f 6663 3371 3d4e 6f6e 652c 0a20 2020  e_fc3q=None,.   
-000013e0: 2020 2020 2073 746f 7265 5f64 656e 7365       store_dense
-000013f0: 5f67 705f 6d61 703d 5472 7565 2c0a 2020  _gp_map=True,.  
-00001400: 2020 2020 2020 7374 6f72 655f 6465 6e73        store_dens
-00001410: 655f 7376 6563 733d 5472 7565 2c0a 2020  e_svecs=True,.  
-00001420: 2020 2020 2020 7379 6d70 7265 633d 3165        symprec=1e
-00001430: 2d35 2c0a 2020 2020 2020 2020 6361 6c63  -5,.        calc
-00001440: 756c 6174 6f72 3d4e 6f6e 652c 0a20 2020  ulator=None,.   
-00001450: 2020 2020 206c 6f67 5f6c 6576 656c 3d30       log_level=0
-00001460: 2c0a 2020 2020 2020 2020 6c61 7061 636b  ,.        lapack
-00001470: 5f7a 6865 6576 5f75 706c 6f3d 4e6f 6e65  _zheev_uplo=None
-00001480: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00001490: 2022 2222 496e 6974 206d 6574 686f 642e   """Init method.
-000014a0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000014b0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-000014c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000014d0: 756e 6974 6365 6c6c 203a 2050 686f 6e6f  unitcell : Phono
-000014e0: 7079 4174 6f6d 732c 206f 7074 696f 6e61  pyAtoms, optiona
-000014f0: 6c0a 2020 2020 2020 2020 2020 2020 496e  l.            In
-00001500: 7075 7420 756e 6974 2063 656c 6c2e 0a20  put unit cell.. 
-00001510: 2020 2020 2020 2073 7570 6572 6365 6c6c         supercell
-00001520: 5f6d 6174 7269 7820 3a20 6172 7261 795f  _matrix : array_
-00001530: 6c69 6b65 2c20 6f70 7469 6f6e 616c 0a20  like, optional. 
-00001540: 2020 2020 2020 2020 2020 2053 7570 6572             Super
-00001550: 6365 6c6c 206d 6174 7269 7820 6d75 6c74  cell matrix mult
-00001560: 6970 6c69 6564 2074 6f20 696e 7075 7420  iplied to input 
-00001570: 6365 6c6c 2062 6173 6973 2076 6563 746f  cell basis vecto
-00001580: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
-00001590: 7368 6170 653d 2833 2c20 2920 6f72 2028  shape=(3, ) or (
-000015a0: 332c 2033 292c 2077 6865 7265 2074 6865  3, 3), where the
-000015b0: 2066 6f72 6d65 7220 6973 2063 6f6e 7369   former is consi
-000015c0: 6465 7265 6420 6120 6469 6167 6f6e 616c  dered a diagonal
-000015d0: 0a20 2020 2020 2020 2020 2020 206d 6174  .            mat
-000015e0: 7269 782e 2054 6865 2065 6c65 6d65 6e74  rix. The element
-000015f0: 7320 6861 7665 2074 6f20 6265 2067 6976  s have to be giv
-00001600: 656e 2062 7920 696e 7465 6765 7273 2e0a  en by integers..
-00001610: 2020 2020 2020 2020 2020 2020 416c 7468              Alth
-00001620: 6f75 6768 2074 6865 2064 6566 6175 6c74  ough the default
-00001630: 2069 7320 4e6f 6e65 2c20 7768 6963 6820   is None, which 
-00001640: 7265 7375 6c74 7320 696e 2069 6465 6e74  results in ident
-00001650: 6974 790a 2020 2020 2020 2020 2020 2020  ity.            
-00001660: 6d61 7472 6978 2c20 6974 2069 7320 7265  matrix, it is re
-00001670: 636f 6d6d 656e 6465 6420 746f 2067 6976  commended to giv
-00001680: 6520 6073 7570 6572 6365 6c6c 5f6d 6174  e `supercell_mat
-00001690: 7269 7860 2065 7870 6c69 6369 746c 792e  rix` explicitly.
-000016a0: 0a20 2020 2020 2020 2070 7269 6d69 7469  .        primiti
-000016b0: 7665 5f6d 6174 7269 7820 3a20 6172 7261  ve_matrix : arra
-000016c0: 795f 6c69 6b65 206f 7220 7374 722c 206f  y_like or str, o
-000016d0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-000016e0: 2020 2020 5072 696d 6974 6976 6520 6d61      Primitive ma
-000016f0: 7472 6978 206d 756c 7469 706c 6965 6420  trix multiplied 
-00001700: 746f 2069 6e70 7574 2063 656c 6c20 6261  to input cell ba
-00001710: 7369 7320 7665 6374 6f72 732e 2044 6566  sis vectors. Def
-00001720: 6175 6c74 2069 730a 2020 2020 2020 2020  ault is.        
-00001730: 2020 2020 7468 6520 6964 656e 7469 7479      the identity
-00001740: 206d 6174 7269 782e 0a20 2020 2020 2020   matrix..       
-00001750: 2020 2020 2057 6865 6e20 6769 7665 6e20       When given 
-00001760: 6173 2061 7272 6179 5f6c 696b 652c 2073  as array_like, s
-00001770: 6861 7065 3d28 332c 2033 292c 2064 7479  hape=(3, 3), dty
-00001780: 7065 3d66 6c6f 6174 2e0a 2020 2020 2020  pe=float..      
-00001790: 2020 2020 2020 5768 656e 2027 4627 2c20        When 'F', 
-000017a0: 2749 272c 2027 4127 2c20 2743 272c 206f  'I', 'A', 'C', o
-000017b0: 7220 2752 2720 6973 2067 6976 656e 2069  r 'R' is given i
-000017c0: 6e73 7465 6164 206f 6620 6120 3378 3320  nstead of a 3x3 
-000017d0: 6d61 7472 6978 2c0a 2020 2020 2020 2020  matrix,.        
-000017e0: 2020 2020 7468 6520 7072 696d 6974 6976      the primitiv
-000017f0: 6520 6d61 7472 6978 2064 6566 696e 6564  e matrix defined
-00001800: 2061 740a 2020 2020 2020 2020 2020 2020   at.            
-00001810: 6874 7470 733a 2f2f 7370 676c 6962 2e67  https://spglib.g
-00001820: 6974 6875 622e 696f 2f73 7067 6c69 622f  ithub.io/spglib/
-00001830: 6465 6669 6e69 7469 6f6e 2e68 746d 6c0a  definition.html.
-00001840: 2020 2020 2020 2020 2020 2020 6973 2075              is u
-00001850: 7365 642e 0a20 2020 2020 2020 2020 2020  sed..           
-00001860: 2057 6865 6e20 2761 7574 6f27 2069 7320   When 'auto' is 
-00001870: 6769 7665 6e2c 2074 6865 2063 656e 7472  given, the centr
-00001880: 696e 6720 7479 7065 2028 2746 272c 2027  ing type ('F', '
-00001890: 4927 2c20 2741 272c 2027 4327 2c20 2752  I', 'A', 'C', 'R
-000018a0: 272c 0a20 2020 2020 2020 2020 2020 206f  ',.            o
-000018b0: 7220 7072 696d 6974 6976 6520 2750 2729  r primitive 'P')
-000018c0: 2069 7320 6175 746f 6d61 7469 6361 6c6c   is automaticall
-000018d0: 7920 6368 6f73 656e 2e0a 2020 2020 2020  y chosen..      
-000018e0: 2020 7068 6f6e 6f6e 5f73 7570 6572 6365    phonon_superce
-000018f0: 6c6c 5f6d 6174 7269 7820 3a20 6172 7261  ll_matrix : arra
-00001900: 795f 6c69 6b65 2c20 6f70 7469 6f6e 616c  y_like, optional
-00001910: 0a20 2020 2020 2020 2020 2020 2053 7570  .            Sup
-00001920: 6572 6365 6c6c 206d 6174 7269 7820 7573  ercell matrix us
-00001930: 6564 2066 6f72 2066 6332 2e20 496e 2070  ed for fc2. In p
-00001940: 686f 6e6f 3370 792c 2073 7570 6572 6365  hono3py, superce
-00001950: 6c6c 206d 6174 7269 7820 666f 720a 2020  ll matrix for.  
-00001960: 2020 2020 2020 2020 2020 6663 3320 616e            fc3 an
-00001970: 6420 6663 3220 6361 6e20 6265 2064 6966  d fc2 can be dif
-00001980: 6665 7265 6e74 2074 6f20 7375 7070 6f72  ferent to suppor
-00001990: 7420 6c6f 6e67 6572 2072 616e 6765 2069  t longer range i
-000019a0: 6e74 6572 6163 7469 6f6e 206f 660a 2020  nteraction of.  
-000019b0: 2020 2020 2020 2020 2020 6663 3220 7468            fc2 th
-000019c0: 616e 2074 6861 7420 6f66 2066 6333 2e20  an that of fc3. 
-000019d0: 556e 6c65 7373 2073 6574 7469 6e67 2074  Unless setting t
-000019e0: 6869 732c 2073 7570 6572 6365 6c6c 5f6d  his, supercell_m
-000019f0: 6174 7269 7820 6973 0a20 2020 2020 2020  atrix is.       
-00001a00: 2020 2020 2075 7365 642e 2054 6869 7320       used. This 
-00001a10: 6973 206f 6e6c 7920 7661 6c69 6465 2077  is only valide w
-00001a20: 6865 6e20 756e 6974 6365 6c6c 206f 7220  hen unitcell or 
-00001a30: 756e 6974 6365 6c6c 5f66 696c 656e 616d  unitcell_filenam
-00001a40: 6520 6973 0a20 2020 2020 2020 2020 2020  e is.           
-00001a50: 2067 6976 656e 2e20 4465 6661 756c 7420   given. Default 
-00001a60: 6973 204e 6f6e 652e 0a20 2020 2020 2020  is None..       
-00001a70: 206d 6173 7365 7320 3a20 4465 7072 6563   masses : Deprec
-00001a80: 6174 6564 2e0a 2020 2020 2020 2020 2020  ated..          
-00001a90: 2020 5573 6520 5068 6f6e 6f33 7079 2e6d    Use Phono3py.m
-00001aa0: 6173 7365 7320 6174 7472 6962 7574 6520  asses attribute 
-00001ab0: 6166 7465 7220 696e 7374 616e 6369 6174  after instanciat
-00001ac0: 696f 6e2e 0a20 2020 2020 2020 2062 616e  ion..        ban
-00001ad0: 645f 696e 6469 6365 7320 3a20 4465 7072  d_indices : Depr
-00001ae0: 6563 6174 6564 2e0a 2020 2020 2020 2020  ecated..        
-00001af0: 2020 2020 5573 6520 5068 6f6e 6f33 7079      Use Phono3py
-00001b00: 2e62 616e 645f 696e 6469 6365 7320 6174  .band_indices at
-00001b10: 7472 6962 7574 6520 6166 7465 7220 696e  tribute after in
-00001b20: 7374 616e 6369 6174 696f 6e2e 0a20 2020  stanciation..   
-00001b30: 2020 2020 2073 6967 6d61 7320 3a20 4465       sigmas : De
-00001b40: 7072 6563 6174 6564 2e0a 2020 2020 2020  precated..      
-00001b50: 2020 2020 2020 5573 6520 5068 6f6e 6f33        Use Phono3
-00001b60: 7079 2e73 6967 6d61 7320 6174 7472 6962  py.sigmas attrib
-00001b70: 7574 6520 6166 7465 7220 696e 7374 616e  ute after instan
-00001b80: 6369 6174 696f 6e2e 0a20 2020 2020 2020  ciation..       
-00001b90: 2073 6967 6d61 5f63 7574 6f66 6620 3a20   sigma_cutoff : 
-00001ba0: 4465 7072 6563 6174 6564 2e0a 2020 2020  Deprecated..    
-00001bb0: 2020 2020 2020 2020 5573 6520 5068 6f6e          Use Phon
-00001bc0: 6f33 7079 2e73 6967 6d61 5f63 7574 6f66  o3py.sigma_cutof
-00001bd0: 6620 6174 7472 6962 7574 6520 6166 7465  f attribute afte
-00001be0: 7220 696e 7374 616e 6369 6174 696f 6e2e  r instanciation.
-00001bf0: 0a20 2020 2020 2020 2063 7574 6f66 665f  .        cutoff_
-00001c00: 6672 6571 7565 6e63 7920 3a20 666c 6f61  frequency : floa
-00001c10: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00001c20: 2020 2020 2020 2020 5068 6f6e 6f6e 2066          Phonon f
-00001c30: 7265 7175 656e 6379 2062 656c 6f77 2074  requency below t
-00001c40: 6869 7320 7661 6c75 6520 6973 2069 676e  his value is ign
-00001c50: 6f72 6564 2077 6865 6e20 7468 6520 6375  ored when the cu
-00001c60: 746f 6666 2069 730a 2020 2020 2020 2020  toff is.        
-00001c70: 2020 2020 6e65 6564 6564 2066 6f72 2074      needed for t
-00001c80: 6865 2063 6f6d 7075 7461 7469 6f6e 2e20  he computation. 
-00001c90: 4465 6661 756c 7420 6973 2031 652d 342e  Default is 1e-4.
-00001ca0: 0a20 2020 2020 2020 2066 7265 7175 656e  .        frequen
-00001cb0: 6379 5f66 6163 746f 725f 746f 5f54 487a  cy_factor_to_THz
-00001cc0: 203a 2066 6c6f 6174 2c20 6f70 7469 6f6e   : float, option
-00001cd0: 616c 0a20 2020 2020 2020 2020 2020 2050  al.            P
-00001ce0: 686f 6e6f 6e20 6672 6571 7565 6e63 7920  honon frequency 
-00001cf0: 756e 6974 2063 6f6e 7665 7273 696f 6e20  unit conversion 
-00001d00: 6661 6374 6f72 2e20 556e 6c65 7373 2073  factor. Unless s
-00001d10: 7065 6369 6669 6564 2c20 6465 6661 756c  pecified, defaul
-00001d20: 740a 2020 2020 2020 2020 2020 2020 756e  t.            un
-00001d30: 6974 2063 6f6e 7665 7273 696f 6e20 6661  it conversion fa
-00001d40: 6374 6f72 2066 6f72 2065 6163 6820 6361  ctor for each ca
-00001d50: 6c63 756c 6174 6f72 2069 7320 7573 6564  lculator is used
-00001d60: 2e0a 2020 2020 2020 2020 6973 5f73 796d  ..        is_sym
-00001d70: 6d65 7472 7920 3a20 626f 6f6c 2c20 6f70  metry : bool, op
-00001d80: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00001d90: 2020 2055 7365 2063 7279 7374 616c 2073     Use crystal s
-00001da0: 796d 6d65 7472 7920 696e 206d 6f73 7420  ymmetry in most 
-00001db0: 6361 6c63 756c 6174 696f 6e73 2077 6865  calculations whe
-00001dc0: 6e20 5472 7565 2e20 4465 6661 756c 7420  n True. Default 
-00001dd0: 6973 0a20 2020 2020 2020 2020 2020 2054  is.            T
-00001de0: 7275 652e 0a20 2020 2020 2020 2069 735f  rue..        is_
-00001df0: 6d65 7368 5f73 796d 6d65 7472 7920 3a20  mesh_symmetry : 
-00001e00: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-00001e10: 2020 2020 2020 2020 2020 2055 7365 2063             Use c
-00001e20: 7279 7374 616c 2073 796d 6d65 7472 7920  rystal symmetry 
-00001e30: 696e 2072 6563 6970 726f 6361 6c20 7370  in reciprocal sp
-00001e40: 6163 6520 6772 6964 2068 616e 646c 696e  ace grid handlin
-00001e50: 6720 7768 656e 2054 7275 652e 0a20 2020  g when True..   
-00001e60: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
-00001e70: 2069 7320 5472 7565 2e0a 2020 2020 2020   is True..      
-00001e80: 2020 7573 655f 6772 6720 3a20 626f 6f6c    use_grg : bool
-00001e90: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00001ea0: 2020 2020 2020 2055 7365 2067 656e 6572         Use gener
-00001eb0: 616c 697a 6564 2072 6567 756c 6172 2067  alized regular g
-00001ec0: 7269 6420 7768 656e 2054 7275 652e 2044  rid when True. D
-00001ed0: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
-00001ee0: 0a20 2020 2020 2020 2053 4e46 5f63 6f6f  .        SNF_coo
-00001ef0: 7264 696e 6174 6573 203a 2073 7472 2c20  rdinates : str, 
-00001f00: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00001f10: 2020 2020 2060 7265 6369 7072 6f63 616c       `reciprocal
-00001f20: 6020 6f72 2060 6469 7265 6374 602e 0a20  ` or `direct`.. 
-00001f30: 2020 2020 2020 2020 2020 2053 7061 6365             Space
-00001f40: 206f 6620 636f 6f72 6469 6e61 7465 7320   of coordinates 
-00001f50: 746f 2067 656e 6572 6174 6520 6772 6964  to generate grid
-00001f60: 2067 656e 6572 6174 696e 6720 6d61 7472   generating matr
-00001f70: 6978 2065 6974 6865 7220 696e 2064 6972  ix either in dir
-00001f80: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
-00001f90: 6f72 2072 6563 6970 726f 6361 6c20 7370  or reciprocal sp
-00001fa0: 6163 652e 2054 6865 2064 6566 6175 6c74  ace. The default
-00001fb0: 2069 7320 6072 6563 6970 726f 6361 6c60   is `reciprocal`
-00001fc0: 2e0a 2020 2020 2020 2020 7379 6d6d 6574  ..        symmet
-00001fd0: 7269 7a65 5f66 6333 7120 3a20 4465 7072  rize_fc3q : Depr
-00001fe0: 6563 6174 6564 2e0a 2020 2020 2020 2020  ecated..        
-00001ff0: 2020 2020 5365 6520 5068 6f6e 6f33 7079      See Phono3py
-00002000: 2e69 6e69 745f 7068 7068 5f69 6e74 6572  .init_phph_inter
-00002010: 6163 7469 6f6e 2829 2e0a 2020 2020 2020  action()..      
-00002020: 2020 7374 6f72 655f 6465 6e73 655f 6770    store_dense_gp
-00002030: 5f6d 6170 203a 2062 6f6f 6c2c 206f 7074  _map : bool, opt
-00002040: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00002050: 2020 5573 6520 6465 6e73 6520 666f 726d    Use dense form
-00002060: 6174 206f 6620 425a 2067 7269 6420 7379  at of BZ grid sy
-00002070: 7374 656d 2e20 4465 6661 756c 7420 6973  stem. Default is
-00002080: 2054 7275 652e 0a20 2020 2020 2020 2073   True..        s
-00002090: 746f 7265 5f64 656e 7365 5f73 7665 6373  tore_dense_svecs
-000020a0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-000020b0: 6c0a 2020 2020 2020 2020 2020 2020 5368  l.            Sh
-000020c0: 6f72 7465 7374 2076 6563 746f 7273 2061  ortest vectors a
-000020d0: 7265 2073 746f 7265 6420 696e 2074 6865  re stored in the
-000020e0: 2064 656e 7365 2061 7272 6179 2066 6f72   dense array for
-000020f0: 6d61 742e 2054 6869 7320 6973 0a20 2020  mat. This is.   
-00002100: 2020 2020 2020 2020 2065 7870 6563 7465           expecte
-00002110: 6420 746f 2062 6520 616c 7761 7973 2054  d to be always T
-00002120: 7275 652e 2053 6574 7469 6e67 2046 616c  rue. Setting Fal
-00002130: 7365 2069 7320 666f 7220 726f 7567 680a  se is for rough.
-00002140: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00002150: 6174 6962 696c 6974 7920 7769 7468 2076  atibility with v
-00002160: 312e 782e 2044 6566 6175 6c74 2069 7320  1.x. Default is 
-00002170: 5472 7565 2e0a 2020 2020 2020 2020 7379  True..        sy
-00002180: 6d70 7265 6320 3a20 666c 6f61 742c 206f  mprec : float, o
-00002190: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-000021a0: 2020 2020 546f 6c65 7261 6e63 6520 7573      Tolerance us
-000021b0: 6564 2074 6f20 6669 6e64 2063 7279 7374  ed to find cryst
-000021c0: 616c 2073 796d 6d65 7472 792e 2044 6566  al symmetry. Def
-000021d0: 6175 6c74 2069 7320 3165 2d35 2e0a 2020  ault is 1e-5..  
-000021e0: 2020 2020 2020 6361 6c63 756c 6174 6f72        calculator
-000021f0: 203a 2073 7472 2c20 6f70 7469 6f6e 616c   : str, optional
-00002200: 2e0a 2020 2020 2020 2020 2020 2020 4361  ..            Ca
-00002210: 6c63 756c 6174 6f72 2075 7365 6420 666f  lculator used fo
-00002220: 7220 636f 6d70 7574 696e 6720 666f 7263  r computing forc
-00002230: 6573 2e20 5468 6973 2069 7320 7573 6564  es. This is used
-00002240: 2074 6f20 7377 6974 6368 0a20 2020 2020   to switch.     
-00002250: 2020 2020 2020 2074 6865 2073 6574 206f         the set o
-00002260: 6620 7068 7973 6963 616c 2075 6e69 7473  f physical units
-00002270: 2e20 4465 6661 756c 7420 6973 204e 6f6e  . Default is Non
-00002280: 652c 2077 6869 6368 2069 7320 6571 7569  e, which is equi
-00002290: 7661 6c65 6e74 0a20 2020 2020 2020 2020  valent.         
-000022a0: 2020 2074 6f20 2276 6173 7022 2e0a 2020     to "vasp"..  
-000022b0: 2020 2020 2020 6c6f 675f 6c65 7665 6c20        log_level 
-000022c0: 3a20 696e 742c 206f 7074 696f 6e61 6c0a  : int, optional.
-000022d0: 2020 2020 2020 2020 2020 2020 5665 7262              Verb
-000022e0: 6f73 6974 7920 636f 6e74 726f 6c2e 2044  osity control. D
-000022f0: 6566 6175 6c74 2069 7320 302e 2054 6869  efault is 0. Thi
-00002300: 7320 6361 6e20 6265 2030 2c20 312c 206f  s can be 0, 1, o
-00002310: 7220 322e 0a20 2020 2020 2020 206c 6170  r 2..        lap
-00002320: 6163 6b5f 7a68 6565 765f 7570 6c6f 203a  ack_zheev_uplo :
-00002330: 2044 6570 7265 6361 7465 642e 0a20 2020   Deprecated..   
-00002340: 2020 2020 2020 2020 2053 6565 2050 686f           See Pho
-00002350: 6e6f 3370 792e 696e 6974 5f70 6870 685f  no3py.init_phph_
-00002360: 696e 7465 7261 6374 696f 6e28 292e 0a0a  interaction()...
-00002370: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00002380: 2020 2020 7365 6c66 2e5f 7379 6d70 7265      self._sympre
-00002390: 6320 3d20 7379 6d70 7265 630a 2020 2020  c = symprec.    
-000023a0: 2020 2020 7365 6c66 2e5f 6672 6571 7565      self._freque
-000023b0: 6e63 795f 6661 6374 6f72 5f74 6f5f 5448  ncy_factor_to_TH
-000023c0: 7a20 3d20 6672 6571 7565 6e63 795f 6661  z = frequency_fa
-000023d0: 6374 6f72 5f74 6f5f 5448 7a0a 2020 2020  ctor_to_THz.    
-000023e0: 2020 2020 7365 6c66 2e5f 6973 5f73 796d      self._is_sym
-000023f0: 6d65 7472 7920 3d20 6973 5f73 796d 6d65  metry = is_symme
-00002400: 7472 790a 2020 2020 2020 2020 7365 6c66  try.        self
-00002410: 2e5f 6973 5f6d 6573 685f 7379 6d6d 6574  ._is_mesh_symmet
-00002420: 7279 203d 2069 735f 6d65 7368 5f73 796d  ry = is_mesh_sym
-00002430: 6d65 7472 790a 2020 2020 2020 2020 7365  metry.        se
-00002440: 6c66 2e5f 7573 655f 6772 6720 3d20 7573  lf._use_grg = us
-00002450: 655f 6772 670a 2020 2020 2020 2020 7365  e_grg.        se
-00002460: 6c66 2e5f 534e 465f 636f 6f72 6469 6e61  lf._SNF_coordina
-00002470: 7465 7320 3d20 534e 465f 636f 6f72 6469  tes = SNF_coordi
-00002480: 6e61 7465 730a 2020 2020 2020 2020 7365  nates.        se
-00002490: 6c66 2e5f 7374 6f72 655f 6465 6e73 655f  lf._store_dense_
-000024a0: 6770 5f6d 6170 203d 2073 746f 7265 5f64  gp_map = store_d
-000024b0: 656e 7365 5f67 705f 6d61 700a 2020 2020  ense_gp_map.    
-000024c0: 2020 2020 7365 6c66 2e5f 7374 6f72 655f      self._store_
-000024d0: 6465 6e73 655f 7376 6563 7320 3d20 7374  dense_svecs = st
-000024e0: 6f72 655f 6465 6e73 655f 7376 6563 730a  ore_dense_svecs.
-000024f0: 2020 2020 2020 2020 7365 6c66 2e5f 6375          self._cu
-00002500: 746f 6666 5f66 7265 7175 656e 6379 203d  toff_frequency =
-00002510: 2063 7574 6f66 665f 6672 6571 7565 6e63   cutoff_frequenc
-00002520: 790a 2020 2020 2020 2020 7365 6c66 2e5f  y.        self._
-00002530: 6361 6c63 756c 6174 6f72 203d 2063 616c  calculator = cal
-00002540: 6375 6c61 746f 720a 2020 2020 2020 2020  culator.        
-00002550: 7365 6c66 2e5f 6c6f 675f 6c65 7665 6c20  self._log_level 
-00002560: 3d20 6c6f 675f 6c65 7665 6c0a 0a20 2020  = log_level..   
-00002570: 2020 2020 2023 2043 7265 6174 6520 7375       # Create su
-00002580: 7065 7263 656c 6c20 616e 6420 7072 696d  percell and prim
-00002590: 6974 6976 6520 6365 6c6c 0a20 2020 2020  itive cell.     
-000025a0: 2020 2073 656c 662e 5f75 6e69 7463 656c     self._unitcel
-000025b0: 6c20 3d20 756e 6974 6365 6c6c 0a20 2020  l = unitcell.   
-000025c0: 2020 2020 2073 656c 662e 5f73 7570 6572       self._super
-000025d0: 6365 6c6c 5f6d 6174 7269 7820 3d20 6e70  cell_matrix = np
-000025e0: 2e61 7272 6179 280a 2020 2020 2020 2020  .array(.        
-000025f0: 2020 2020 7368 6170 655f 7375 7065 7263      shape_superc
-00002600: 656c 6c5f 6d61 7472 6978 2873 7570 6572  ell_matrix(super
-00002610: 6365 6c6c 5f6d 6174 7269 7829 2c20 6474  cell_matrix), dt
-00002620: 7970 653d 2269 6e74 5f22 2c20 6f72 6465  ype="int_", orde
-00002630: 723d 2243 220a 2020 2020 2020 2020 290a  r="C".        ).
-00002640: 2020 2020 2020 2020 706d 6174 203d 2073          pmat = s
-00002650: 656c 662e 5f64 6574 6572 6d69 6e65 5f70  elf._determine_p
-00002660: 7269 6d69 7469 7665 5f6d 6174 7269 7828  rimitive_matrix(
-00002670: 7072 696d 6974 6976 655f 6d61 7472 6978  primitive_matrix
-00002680: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00002690: 7072 696d 6974 6976 655f 6d61 7472 6978  primitive_matrix
-000026a0: 203d 2070 6d61 740a 2020 2020 2020 2020   = pmat.        
-000026b0: 7365 6c66 2e5f 6e61 635f 7061 7261 6d73  self._nac_params
-000026c0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-000026d0: 6966 2070 686f 6e6f 6e5f 7375 7065 7263  if phonon_superc
-000026e0: 656c 6c5f 6d61 7472 6978 2069 7320 6e6f  ell_matrix is no
-000026f0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00002700: 2020 2020 7365 6c66 2e5f 7068 6f6e 6f6e      self._phonon
-00002710: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
-00002720: 7820 3d20 6e70 2e61 7272 6179 280a 2020  x = np.array(.  
-00002730: 2020 2020 2020 2020 2020 2020 2020 7368                sh
-00002740: 6170 655f 7375 7065 7263 656c 6c5f 6d61  ape_supercell_ma
-00002750: 7472 6978 2870 686f 6e6f 6e5f 7375 7065  trix(phonon_supe
-00002760: 7263 656c 6c5f 6d61 7472 6978 292c 2064  rcell_matrix), d
-00002770: 7479 7065 3d22 696e 745f 222c 206f 7264  type="int_", ord
-00002780: 6572 3d22 4322 0a20 2020 2020 2020 2020  er="C".         
-00002790: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-000027a0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000027b0: 656c 662e 5f70 686f 6e6f 6e5f 7375 7065  elf._phonon_supe
-000027c0: 7263 656c 6c5f 6d61 7472 6978 203d 204e  rcell_matrix = N
-000027d0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
-000027e0: 2e5f 7375 7065 7263 656c 6c20 3d20 4e6f  ._supercell = No
-000027f0: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-00002800: 5f70 7269 6d69 7469 7665 203d 204e 6f6e  _primitive = Non
-00002810: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-00002820: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
-00002830: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00002840: 7365 6c66 2e5f 7068 6f6e 6f6e 5f70 7269  self._phonon_pri
-00002850: 6d69 7469 7665 203d 204e 6f6e 650a 2020  mitive = None.  
-00002860: 2020 2020 2020 7365 6c66 2e5f 6275 696c        self._buil
-00002870: 645f 7375 7065 7263 656c 6c28 290a 2020  d_supercell().  
-00002880: 2020 2020 2020 7365 6c66 2e5f 6275 696c        self._buil
-00002890: 645f 7072 696d 6974 6976 655f 6365 6c6c  d_primitive_cell
-000028a0: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-000028b0: 5f62 7569 6c64 5f70 686f 6e6f 6e5f 7375  _build_phonon_su
-000028c0: 7065 7263 656c 6c28 290a 2020 2020 2020  percell().      
-000028d0: 2020 7365 6c66 2e5f 6275 696c 645f 7068    self._build_ph
-000028e0: 6f6e 6f6e 5f70 7269 6d69 7469 7665 5f63  onon_primitive_c
-000028f0: 656c 6c28 290a 0a20 2020 2020 2020 2073  ell()..        s
-00002900: 656c 662e 5f73 6967 6d61 7320 3d20 5b0a  elf._sigmas = [.
-00002910: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00002920: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
-00002930: 2020 2020 7365 6c66 2e5f 7369 676d 615f      self._sigma_
-00002940: 6375 746f 6666 203d 204e 6f6e 650a 0a20  cutoff = None.. 
-00002950: 2020 2020 2020 2023 2047 7269 640a 2020         # Grid.  
-00002960: 2020 2020 2020 7365 6c66 2e5f 627a 5f67        self._bz_g
-00002970: 7269 6420 3d20 4e6f 6e65 0a0a 2020 2020  rid = None..    
-00002980: 2020 2020 2320 5365 7420 7375 7065 7263      # Set superc
-00002990: 656c 6c2c 2070 7269 6d69 7469 7665 2c20  ell, primitive, 
-000029a0: 616e 6420 7068 6f6e 6f6e 2073 7570 6572  and phonon super
-000029b0: 6365 6c6c 2073 796d 6d65 7472 6965 730a  cell symmetries.
-000029c0: 2020 2020 2020 2020 7365 6c66 2e5f 7379          self._sy
-000029d0: 6d6d 6574 7279 203d 204e 6f6e 650a 2020  mmetry = None.  
-000029e0: 2020 2020 2020 7365 6c66 2e5f 7072 696d        self._prim
-000029f0: 6974 6976 655f 7379 6d6d 6574 7279 203d  itive_symmetry =
-00002a00: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00002a10: 6c66 2e5f 7068 6f6e 6f6e 5f73 7570 6572  lf._phonon_super
-00002a20: 6365 6c6c 5f73 796d 6d65 7472 7920 3d20  cell_symmetry = 
-00002a30: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
-00002a40: 662e 5f73 6561 7263 685f 7379 6d6d 6574  f._search_symmet
-00002a50: 7279 2829 0a20 2020 2020 2020 2073 656c  ry().        sel
-00002a60: 662e 5f73 6561 7263 685f 7072 696d 6974  f._search_primit
-00002a70: 6976 655f 7379 6d6d 6574 7279 2829 0a20  ive_symmetry(). 
-00002a80: 2020 2020 2020 2073 656c 662e 5f73 6561         self._sea
-00002a90: 7263 685f 7068 6f6e 6f6e 5f73 7570 6572  rch_phonon_super
-00002aa0: 6365 6c6c 5f73 796d 6d65 7472 7928 290a  cell_symmetry().
-00002ab0: 0a20 2020 2020 2020 2023 2044 6973 706c  .        # Displ
-00002ac0: 6163 656d 656e 7473 2061 6e64 2073 7570  acements and sup
-00002ad0: 6572 6365 6c6c 730a 2020 2020 2020 2020  ercells.        
-00002ae0: 7365 6c66 2e5f 7375 7065 7263 656c 6c73  self._supercells
-00002af0: 5f77 6974 685f 6469 7370 6c61 6365 6d65  _with_displaceme
-00002b00: 6e74 7320 3d20 4e6f 6e65 0a20 2020 2020  nts = None.     
-00002b10: 2020 2073 656c 662e 5f64 6174 6173 6574     self._dataset
-00002b20: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00002b30: 7365 6c66 2e5f 7068 6f6e 6f6e 5f64 6174  self._phonon_dat
-00002b40: 6173 6574 203d 204e 6f6e 650a 2020 2020  aset = None.    
-00002b50: 2020 2020 7365 6c66 2e5f 7068 6f6e 6f6e      self._phonon
-00002b60: 5f73 7570 6572 6365 6c6c 735f 7769 7468  _supercells_with
-00002b70: 5f64 6973 706c 6163 656d 656e 7473 203d  _displacements =
-00002b80: 204e 6f6e 650a 0a20 2020 2020 2020 2023   None..        #
-00002b90: 2054 6865 726d 616c 2063 6f6e 6475 6374   Thermal conduct
-00002ba0: 6976 6974 790a 2020 2020 2020 2020 2320  ivity.        # 
-00002bb0: 636f 6e64 7563 7469 7669 7479 5f52 5441  conductivity_RTA
-00002bc0: 206f 7220 636f 6e64 7563 7469 7669 7479   or conductivity
-00002bd0: 5f4c 4254 4520 636c 6173 7320 696e 7374  _LBTE class inst
-00002be0: 616e 6365 0a20 2020 2020 2020 2073 656c  ance.        sel
-00002bf0: 662e 5f74 6865 726d 616c 5f63 6f6e 6475  f._thermal_condu
-00002c00: 6374 6976 6974 7920 3d20 4e6f 6e65 0a0a  ctivity = None..
-00002c10: 2020 2020 2020 2020 2320 496d 6167 696e          # Imagin
-00002c20: 6172 7920 7061 7274 206f 6620 7365 6c66  ary part of self
-00002c30: 2065 6e65 7267 7920 6174 2066 7265 7175   energy at frequ
-00002c40: 656e 6379 2070 6f69 6e74 730a 2020 2020  ency points.    
-00002c50: 2020 2020 7365 6c66 2e5f 6761 6d6d 6173      self._gammas
-00002c60: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00002c70: 7365 6c66 2e5f 7363 6174 7465 7269 6e67  self._scattering
-00002c80: 5f65 7665 6e74 5f63 6c61 7373 203d 204e  _event_class = N
-00002c90: 6f6e 650a 0a20 2020 2020 2020 2023 2046  one..        # F
-00002ca0: 7265 7175 656e 6379 2073 6869 6674 2028  requency shift (
-00002cb0: 7265 616c 2070 6172 7420 6f66 2062 7562  real part of bub
-00002cc0: 626c 6520 6469 6167 7261 6d29 0a20 2020  ble diagram).   
-00002cd0: 2020 2020 2073 656c 662e 5f72 6561 6c5f       self._real_
-00002ce0: 7365 6c66 5f65 6e65 7267 7920 3d20 4e6f  self_energy = No
-00002cf0: 6e65 0a0a 2020 2020 2020 2020 7365 6c66  ne..        self
-00002d00: 2e5f 6772 6964 5f70 6f69 6e74 7320 3d20  ._grid_points = 
-00002d10: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
-00002d20: 662e 5f66 7265 7175 656e 6379 5f70 6f69  f._frequency_poi
-00002d30: 6e74 7320 3d20 4e6f 6e65 0a20 2020 2020  nts = None.     
-00002d40: 2020 2073 656c 662e 5f74 656d 7065 7261     self._tempera
-00002d50: 7475 7265 7320 3d20 4e6f 6e65 0a0a 2020  tures = None..  
-00002d60: 2020 2020 2020 2320 4f74 6865 7220 7661        # Other va
-00002d70: 7269 6162 6c65 730a 2020 2020 2020 2020  riables.        
-00002d80: 7365 6c66 2e5f 6663 3220 3d20 4e6f 6e65  self._fc2 = None
-00002d90: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
-00002da0: 6333 203d 204e 6f6e 650a 0a20 2020 2020  c3 = None..     
-00002db0: 2020 2023 2053 6574 7570 2069 6e74 6572     # Setup inter
-00002dc0: 6163 7469 6f6e 0a20 2020 2020 2020 2073  action.        s
-00002dd0: 656c 662e 5f69 6e74 6572 6163 7469 6f6e  elf._interaction
-00002de0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00002df0: 7365 6c66 2e5f 6261 6e64 5f69 6e64 6963  self._band_indic
-00002e00: 6573 203d 204e 6f6e 650a 2020 2020 2020  es = None.      
-00002e10: 2020 7365 6c66 2e5f 6261 6e64 5f69 6e64    self._band_ind
-00002e20: 6963 6573 5f66 6c61 7474 656e 203d 204e  ices_flatten = N
-00002e30: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
-00002e40: 2e5f 7365 745f 6261 6e64 5f69 6e64 6963  ._set_band_indic
-00002e50: 6573 2829 0a0a 2020 2020 2020 2020 6966  es()..        if
-00002e60: 206d 6173 7365 7320 6973 206e 6f74 204e   masses is not N
-00002e70: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00002e80: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00002e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ea0: 2250 686f 6e6f 3370 7920 696e 6974 2070  "Phono3py init p
-00002eb0: 6172 616d 6574 6572 206f 6620 6d61 7373  arameter of mass
-00002ec0: 6573 2069 7320 6465 7072 6563 6174 6564  es is deprecated
-00002ed0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00002ee0: 2020 2020 2255 7365 2050 686f 6e6f 3370      "Use Phono3p
-00002ef0: 792e 6d61 7373 6573 2061 7474 7269 6275  y.masses attribu
-00002f00: 7465 2069 6e73 7465 6164 2e22 2c0a 2020  te instead.",.  
-00002f10: 2020 2020 2020 2020 2020 2020 2020 4465                De
-00002f20: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
-00002f30: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00002f40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00002f50: 2e6d 6173 7365 7320 3d20 6d61 7373 6573  .masses = masses
-00002f60: 0a0a 2020 2020 2020 2020 6966 2062 616e  ..        if ban
-00002f70: 645f 696e 6469 6365 7320 6973 206e 6f74  d_indices is not
-00002f80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00002f90: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00002fa0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00002fb0: 2020 2250 686f 6e6f 3370 7920 696e 6974    "Phono3py init
-00002fc0: 2070 6172 616d 6574 6572 206f 6620 6261   parameter of ba
-00002fd0: 6e64 5f69 6e64 6963 6573 2069 7320 6465  nd_indices is de
-00002fe0: 7072 6563 6174 6564 2e20 220a 2020 2020  precated. ".    
-00002ff0: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
-00003000: 2050 686f 6e6f 3370 792e 6261 6e64 5f69   Phono3py.band_i
-00003010: 6e64 6963 6573 2061 7474 7269 6275 7465  ndices attribute
-00003020: 2069 6e73 7465 6164 2e22 2c0a 2020 2020   instead.",.    
-00003030: 2020 2020 2020 2020 2020 2020 4465 7072              Depr
-00003040: 6563 6174 696f 6e57 6172 6e69 6e67 2c0a  ecationWarning,.
-00003050: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00003060: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-00003070: 616e 645f 696e 6469 6365 7320 3d20 6261  and_indices = ba
-00003080: 6e64 5f69 6e64 6963 6573 0a0a 2020 2020  nd_indices..    
-00003090: 2020 2020 6966 2073 6967 6d61 7320 6973      if sigmas is
-000030a0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-000030b0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-000030c0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-000030d0: 2020 2020 2020 2250 686f 6e6f 3370 7920        "Phono3py 
-000030e0: 696e 6974 2070 6172 616d 6574 6572 206f  init parameter o
-000030f0: 6620 7369 676d 6173 2069 7320 6465 7072  f sigmas is depr
-00003100: 6563 6174 6564 2e20 220a 2020 2020 2020  ecated. ".      
-00003110: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
-00003120: 686f 6e6f 3370 792e 7369 676d 6173 2061  hono3py.sigmas a
-00003130: 7474 7269 6275 7465 2069 6e73 7465 6164  ttribute instead
-00003140: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00003150: 2020 2020 4465 7072 6563 6174 696f 6e57      DeprecationW
-00003160: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00003170: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00003180: 2020 7365 6c66 2e73 6967 6d61 7320 3d20    self.sigmas = 
-00003190: 7369 676d 6173 0a0a 2020 2020 2020 2020  sigmas..        
-000031a0: 6966 2073 6967 6d61 5f63 7574 6f66 6620  if sigma_cutoff 
-000031b0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000031c0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-000031d0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
-000031e0: 2020 2020 2020 2020 2250 686f 6e6f 3370          "Phono3p
-000031f0: 7920 696e 6974 2070 6172 616d 6574 6572  y init parameter
-00003200: 206f 6620 7369 676d 615f 6375 746f 6666   of sigma_cutoff
-00003210: 2069 7320 6465 7072 6563 6174 6564 2e20   is deprecated. 
-00003220: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00003230: 2020 2255 7365 2050 686f 6e6f 3370 792e    "Use Phono3py.
-00003240: 7369 676d 615f 6375 746f 6666 2061 7474  sigma_cutoff att
-00003250: 7269 6275 7465 2069 6e73 7465 6164 2e22  ribute instead."
-00003260: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003270: 2020 4465 7072 6563 6174 696f 6e57 6172    DeprecationWar
-00003280: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-00003290: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000032a0: 7365 6c66 2e73 6967 6d61 5f63 7574 6f66  self.sigma_cutof
-000032b0: 6620 3d20 7369 676d 615f 6375 746f 6666  f = sigma_cutoff
-000032c0: 0a0a 2020 2020 2020 2020 6966 2073 796d  ..        if sym
-000032d0: 6d65 7472 697a 655f 6663 3371 2069 7320  metrize_fc3q is 
-000032e0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000032f0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00003300: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00003310: 2020 2020 2022 5068 6f6e 6f33 7079 2069       "Phono3py i
-00003320: 6e69 7420 7061 7261 6d65 7465 7220 6f66  nit parameter of
-00003330: 2073 796d 6d65 7472 697a 655f 6663 3371   symmetrize_fc3q
-00003340: 2069 7320 6465 7072 6563 6174 6564 2e20   is deprecated. 
-00003350: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00003360: 2020 2253 6574 2074 6869 7320 6174 2050    "Set this at P
-00003370: 686f 6e6f 3370 792e 696e 6974 5f70 6870  hono3py.init_php
-00003380: 685f 696e 7465 7261 6374 696f 6e28 292e  h_interaction().
-00003390: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000033a0: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
-000033b0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
-000033c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000033d0: 2073 656c 662e 5f73 796d 6d65 7472 697a   self._symmetriz
-000033e0: 655f 6663 3371 203d 2073 796d 6d65 7472  e_fc3q = symmetr
-000033f0: 697a 655f 6663 3371 0a20 2020 2020 2020  ize_fc3q.       
-00003400: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00003410: 2020 2073 656c 662e 5f73 796d 6d65 7472     self._symmetr
-00003420: 697a 655f 6663 3371 203d 204e 6f6e 650a  ize_fc3q = None.
-00003430: 0a20 2020 2020 2020 2069 6620 6c61 7061  .        if lapa
-00003440: 636b 5f7a 6865 6576 5f75 706c 6f20 6973  ck_zheev_uplo is
-00003450: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00003460: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00003470: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-00003480: 2020 2020 2020 2250 686f 6e6f 3370 7920        "Phono3py 
-00003490: 696e 6974 2070 6172 616d 6574 6572 206f  init parameter o
-000034a0: 6620 6c61 7061 636b 5f7a 6865 6576 5f75  f lapack_zheev_u
-000034b0: 706c 6f20 6973 2064 6570 7265 6361 7465  plo is deprecate
-000034c0: 642e 2022 0a20 2020 2020 2020 2020 2020  d. ".           
-000034d0: 2020 2020 2022 5365 7420 7468 6973 2061       "Set this a
-000034e0: 7420 5068 6f6e 6f33 7079 2e69 6e69 745f  t Phono3py.init_
-000034f0: 7068 7068 5f69 6e74 6572 6163 7469 6f6e  phph_interaction
-00003500: 2829 2e22 2c0a 2020 2020 2020 2020 2020  ().",.          
-00003510: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-00003520: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
-00003530: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00003540: 2020 2020 7365 6c66 2e5f 6c61 7061 636b      self._lapack
-00003550: 5f7a 6865 6576 5f75 706c 6f20 3d20 6c61  _zheev_uplo = la
-00003560: 7061 636b 5f7a 6865 6576 5f75 706c 6f0a  pack_zheev_uplo.
-00003570: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00003580: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00003590: 6c61 7061 636b 5f7a 6865 6576 5f75 706c  lapack_zheev_upl
-000035a0: 6f20 3d20 4e6f 6e65 0a0a 2020 2020 4070  o = None..    @p
-000035b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000035c0: 7665 7273 696f 6e28 7365 6c66 293a 0a20  version(self):. 
-000035d0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000035e0: 2070 686f 6e6f 3370 7920 7265 6c65 6173   phono3py releas
-000035f0: 6520 7665 7273 696f 6e20 6e75 6d62 6572  e version number
-00003600: 2e0a 0a20 2020 2020 2020 2073 7472 0a20  ...        str. 
-00003610: 2020 2020 2020 2020 2020 2050 686f 6e6f             Phono
-00003620: 3370 7920 7265 6c65 6173 6520 7665 7273  3py release vers
-00003630: 696f 6e20 6e75 6d62 6572 0a0a 2020 2020  ion number..    
-00003640: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00003650: 7265 7475 726e 205f 5f76 6572 7369 6f6e  return __version
-00003660: 5f5f 0a0a 2020 2020 6465 6620 6765 745f  __..    def get_
-00003670: 7665 7273 696f 6e28 7365 6c66 293a 0a20  version(self):. 
-00003680: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00003690: 2070 686f 6e6f 3370 7920 7265 6c65 6173   phono3py releas
-000036a0: 6520 7665 7273 696f 6e20 6e75 6d62 6572  e version number
-000036b0: 2e22 2222 0a20 2020 2020 2020 2077 6172  .""".        war
-000036c0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-000036d0: 2020 2020 2020 2020 2250 686f 6e6f 3370          "Phono3p
-000036e0: 792e 6765 745f 7665 7273 696f 6e28 2920  y.get_version() 
-000036f0: 6973 2064 6570 7265 6361 7465 642e 220a  is deprecated.".
-00003700: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
-00003710: 2050 686f 6e6f 3370 792e 7665 7273 696f   Phono3py.versio
-00003720: 6e20 6174 7472 6962 7574 6520 696e 7374  n attribute inst
-00003730: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
-00003740: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
-00003750: 726e 696e 672c 0a20 2020 2020 2020 2029  rning,.        )
-00003760: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003770: 7365 6c66 2e76 6572 7369 6f6e 0a0a 2020  self.version..  
-00003780: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00003790: 6465 6620 6361 6c63 756c 6174 6f72 2873  def calculator(s
-000037a0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000037b0: 2252 6574 7572 6e20 6361 6c63 756c 6174  "Return calculat
-000037c0: 6f72 2069 6e74 6572 6661 6365 206e 616d  or interface nam
-000037d0: 652e 0a0a 2020 2020 2020 2020 7374 720a  e...        str.
-000037e0: 2020 2020 2020 2020 2020 2020 4361 6c63              Calc
-000037f0: 756c 6174 6f72 206e 616d 6520 7375 6368  ulator name such
-00003800: 2061 7320 2776 6173 7027 2c20 2771 6527   as 'vasp', 'qe'
-00003810: 2c20 6574 632e 0a0a 2020 2020 2020 2020  , etc...        
-00003820: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00003830: 726e 2073 656c 662e 5f63 616c 6375 6c61  rn self._calcula
-00003840: 746f 720a 0a20 2020 2040 7072 6f70 6572  tor..    @proper
-00003850: 7479 0a20 2020 2064 6566 2066 6333 2873  ty.    def fc3(s
-00003860: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00003870: 2253 6574 7465 7220 616e 6420 6765 7474  "Setter and gett
-00003880: 6572 206f 6620 7468 6972 6420 6f72 6465  er of third orde
-00003890: 7220 666f 7263 6520 636f 6e73 7461 6e74  r force constant
-000038a0: 7320 2866 6333 292e 0a0a 2020 2020 2020  s (fc3)...      
-000038b0: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
-000038c0: 2020 2020 2020 6663 3320 7368 6170 6520        fc3 shape 
-000038d0: 6973 2065 6974 6865 7220 2873 7570 6572  is either (super
-000038e0: 6365 6c6c 2c20 7375 7065 6365 6c6c 2c20  cell, supecell, 
-000038f0: 7375 7065 7263 656c 6c2c 2033 2c20 332c  supercell, 3, 3,
-00003900: 2033 2920 6f72 0a20 2020 2020 2020 2020   3) or.         
-00003910: 2020 2028 7072 696d 6974 6976 652c 2073     (primitive, s
-00003920: 7570 6572 6365 6c6c 2c20 7375 7065 6365  upercell, supece
-00003930: 6c6c 2c20 332c 2033 2c20 3329 2c0a 2020  ll, 3, 3, 3),.  
-00003940: 2020 2020 2020 2020 2020 7768 6572 6520            where 
-00003950: 2773 7570 6572 6365 6c6c 2720 616e 6420  'supercell' and 
-00003960: 2770 7269 6d69 7469 7665 2720 696e 6469  'primitive' indi
-00003970: 6361 7465 206e 756d 6265 7220 6f66 2061  cate number of a
-00003980: 746f 6d73 2069 6e0a 2020 2020 2020 2020  toms in.        
-00003990: 2020 2020 7468 6573 6520 6365 6c6c 732e      these cells.
-000039a0: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000039b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000039c0: 662e 5f66 6333 0a0a 2020 2020 4066 6333  f._fc3..    @fc3
-000039d0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-000039e0: 6663 3328 7365 6c66 2c20 6663 3329 3a0a  fc3(self, fc3):.
-000039f0: 2020 2020 2020 2020 7365 6c66 2e5f 6663          self._fc
-00003a00: 3320 3d20 6663 330a 0a20 2020 2064 6566  3 = fc3..    def
-00003a10: 2067 6574 5f66 6333 2873 656c 6629 3a0a   get_fc3(self):.
-00003a20: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00003a30: 6e20 7468 6972 6420 6f72 6465 7220 666f  n third order fo
-00003a40: 7263 6520 636f 6e73 7461 6e74 7320 2866  rce constants (f
-00003a50: 6333 292e 2222 220a 2020 2020 2020 2020  c3).""".        
-00003a60: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-00003a70: 2020 2020 2020 2020 2020 2022 5068 6f6e             "Phon
-00003a80: 6f33 7079 2e67 6574 5f66 6333 2829 2069  o3py.get_fc3() i
-00003a90: 7320 6465 7072 6563 6174 6564 2e22 2022  s deprecated." "
-00003aa0: 5573 6520 5068 6f6e 6f33 7079 2e66 6333  Use Phono3py.fc3
-00003ab0: 2061 7474 7269 6275 7465 2069 6e73 7465   attribute inste
-00003ac0: 6164 2e22 2c0a 2020 2020 2020 2020 2020  ad.",.          
-00003ad0: 2020 4465 7072 6563 6174 696f 6e57 6172    DeprecationWar
-00003ae0: 6e69 6e67 2c0a 2020 2020 2020 2020 290a  ning,.        ).
-00003af0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00003b00: 656c 662e 6663 330a 0a20 2020 2064 6566  elf.fc3..    def
-00003b10: 2073 6574 5f66 6333 2873 656c 662c 2066   set_fc3(self, f
-00003b20: 6333 293a 0a20 2020 2020 2020 2022 2222  c3):.        """
-00003b30: 5365 7420 6663 332e 2222 220a 2020 2020  Set fc3.""".    
-00003b40: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00003b50: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
-00003b60: 5068 6f6e 6f33 7079 2e73 6574 5f66 6333  Phono3py.set_fc3
-00003b70: 2829 2069 7320 6465 7072 6563 6174 6564  () is deprecated
-00003b80: 2e22 2022 5573 6520 5068 6f6e 6f33 7079  ." "Use Phono3py
-00003b90: 2e66 6333 2061 7474 7269 6275 7465 2069  .fc3 attribute i
-00003ba0: 6e73 7465 6164 2e22 2c0a 2020 2020 2020  nstead.",.      
-00003bb0: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-00003bc0: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
-00003bd0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00003be0: 2e66 6333 203d 2066 6333 0a0a 2020 2020  .fc3 = fc3..    
-00003bf0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00003c00: 6620 6663 3228 7365 6c66 293a 0a20 2020  f fc2(self):.   
-00003c10: 2020 2020 2022 2222 5365 7474 6572 2061       """Setter a
-00003c20: 6e64 2067 6574 7465 7220 6f66 2073 6563  nd getter of sec
-00003c30: 6f6e 6420 6f72 6465 7220 666f 7263 6520  ond order force 
-00003c40: 636f 6e73 7461 6e74 7320 2866 6332 292e  constants (fc2).
-00003c50: 0a0a 2020 2020 2020 2020 6e64 6172 7261  ..        ndarra
-00003c60: 790a 2020 2020 2020 2020 2020 2020 6663  y.            fc
-00003c70: 3220 7368 6170 6520 6973 2065 6974 6865  2 shape is eithe
-00003c80: 7220 2873 7570 6572 6365 6c6c 2c20 7375  r (supercell, su
-00003c90: 7065 6365 6c6c 2c20 332c 2033 2920 6f72  pecell, 3, 3) or
-00003ca0: 0a20 2020 2020 2020 2020 2020 2028 7072  .            (pr
-00003cb0: 696d 6974 6976 652c 2073 7570 6563 656c  imitive, supecel
-00003cc0: 6c2c 2033 2c20 3329 2c0a 2020 2020 2020  l, 3, 3),.      
-00003cd0: 2020 2020 2020 7768 6572 6520 2773 7570        where 'sup
-00003ce0: 6572 6365 6c6c 2720 616e 6420 2770 7269  ercell' and 'pri
-00003cf0: 6d69 7469 7665 2720 696e 6469 6361 7465  mitive' indicate
-00003d00: 206e 756d 6265 7220 6f66 2061 746f 6d73   number of atoms
-00003d10: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
-00003d20: 7468 6573 6520 6365 6c6c 732e 0a0a 2020  these cells...  
-00003d30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00003d40: 2020 7265 7475 726e 2073 656c 662e 5f66    return self._f
-00003d50: 6332 0a0a 2020 2020 4066 6332 2e73 6574  c2..    @fc2.set
-00003d60: 7465 720a 2020 2020 6465 6620 6663 3228  ter.    def fc2(
-00003d70: 7365 6c66 2c20 6663 3229 3a0a 2020 2020  self, fc2):.    
-00003d80: 2020 2020 7365 6c66 2e5f 6663 3220 3d20      self._fc2 = 
-00003d90: 6663 320a 0a20 2020 2064 6566 2067 6574  fc2..    def get
-00003da0: 5f66 6332 2873 656c 6629 3a0a 2020 2020  _fc2(self):.    
-00003db0: 2020 2020 2222 2252 6574 7572 6e20 7365      """Return se
-00003dc0: 636f 6e64 206f 7264 6572 2066 6f72 6365  cond order force
-00003dd0: 2063 6f6e 7374 616e 7473 2028 6663 3229   constants (fc2)
-00003de0: 2e22 2222 0a20 2020 2020 2020 2077 6172  .""".        war
-00003df0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00003e00: 2020 2020 2020 2020 2250 686f 6e6f 3370          "Phono3p
-00003e10: 792e 6765 745f 6663 3228 2920 6973 2064  y.get_fc2() is d
-00003e20: 6570 7265 6361 7465 642e 2220 2255 7365  eprecated." "Use
-00003e30: 2050 686f 6e6f 3370 792e 6663 3220 6174   Phono3py.fc2 at
-00003e40: 7472 6962 7574 6520 696e 7374 6561 642e  tribute instead.
-00003e50: 222c 0a20 2020 2020 2020 2020 2020 2044  ",.            D
-00003e60: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
-00003e70: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
-00003e80: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00003e90: 2e66 6332 0a0a 2020 2020 6465 6620 7365  .fc2..    def se
-00003ea0: 745f 6663 3228 7365 6c66 2c20 6663 3229  t_fc2(self, fc2)
-00003eb0: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
-00003ec0: 2066 6332 2e22 2222 0a20 2020 2020 2020   fc2.""".       
-00003ed0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00003ee0: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
-00003ef0: 6e6f 3370 792e 7365 745f 6663 3228 2920  no3py.set_fc2() 
-00003f00: 6973 2064 6570 7265 6361 7465 642e 2220  is deprecated." 
-00003f10: 2255 7365 2050 686f 6e6f 3370 792e 6663  "Use Phono3py.fc
-00003f20: 3220 6174 7472 6962 7574 6520 696e 7374  2 attribute inst
-00003f30: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
-00003f40: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
-00003f50: 726e 696e 672c 0a20 2020 2020 2020 2029  rning,.        )
-00003f60: 0a20 2020 2020 2020 2073 656c 662e 6663  .        self.fc
-00003f70: 3220 3d20 6663 320a 0a20 2020 2040 7072  2 = fc2..    @pr
-00003f80: 6f70 6572 7479 0a20 2020 2064 6566 2066  operty.    def f
-00003f90: 6f72 6365 5f63 6f6e 7374 616e 7473 2873  orce_constants(s
-00003fa0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00003fb0: 2252 6574 7572 6e20 6663 322e 2054 6869  "Return fc2. Thi
-00003fc0: 7320 6973 2073 616d 6520 6173 2074 6865  s is same as the
-00003fd0: 2067 6574 7465 7220 6174 7472 6962 7574   getter attribut
-00003fe0: 6520 6066 6332 602e 2222 220a 2020 2020  e `fc2`.""".    
-00003ff0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00004000: 6663 320a 0a20 2020 2040 7072 6f70 6572  fc2..    @proper
-00004010: 7479 0a20 2020 2064 6566 2073 6967 6d61  ty.    def sigma
-00004020: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-00004030: 2022 2222 5365 7474 6572 2061 6e64 2067   """Setter and g
-00004040: 6574 7465 7220 6f66 2073 6d65 6172 696e  etter of smearin
-00004050: 6720 7769 6474 6873 2e0a 0a20 2020 2020  g widths...     
-00004060: 2020 206c 6973 740a 2020 2020 2020 2020     list.        
-00004070: 2020 2020 5468 6520 666c 6f61 7420 7661      The float va
-00004080: 6c75 6573 2061 7265 2067 6976 656e 2061  lues are given a
-00004090: 7320 7468 6520 7374 616e 6461 7264 2064  s the standard d
-000040a0: 6576 6961 7469 6f6e 7320 6f66 2047 6175  eviations of Gau
-000040b0: 7373 6961 6e0a 2020 2020 2020 2020 2020  ssian.          
-000040c0: 2020 6675 6e63 7469 6f6e 2e20 4966 204e    function. If N
-000040d0: 6f6e 6520 6973 2067 6976 656e 2061 7320  one is given as 
-000040e0: 616e 2065 6c65 6d65 6e74 206f 6620 7468  an element of th
-000040f0: 6973 206c 6973 742c 206c 696e 6561 720a  is list, linear.
-00004100: 2020 2020 2020 2020 2020 2020 7465 7472              tetr
-00004110: 6168 6564 726f 6e20 6d65 7468 6f64 2069  ahedron method i
-00004120: 7320 7573 6564 2069 6e73 7465 6164 206f  s used instead o
-00004130: 6620 736d 6561 7269 6e67 206d 6574 686f  f smearing metho
-00004140: 642e 0a0a 2020 2020 2020 2020 2222 220a  d...        """.
-00004150: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00004160: 656c 662e 5f73 6967 6d61 730a 0a20 2020  elf._sigmas..   
-00004170: 2040 7369 676d 6173 2e73 6574 7465 720a   @sigmas.setter.
-00004180: 2020 2020 6465 6620 7369 676d 6173 2873      def sigmas(s
-00004190: 656c 662c 2073 6967 6d61 7329 3a0a 2020  elf, sigmas):.  
-000041a0: 2020 2020 2020 6966 2073 6967 6d61 7320        if sigmas 
-000041b0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-000041c0: 2020 2020 2073 656c 662e 5f73 6967 6d61       self._sigma
-000041d0: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
-000041e0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-000041f0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-00004200: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00004210: 6528 7369 676d 6173 2c20 666c 6f61 7429  e(sigmas, float)
-00004220: 206f 7220 6973 696e 7374 616e 6365 2873   or isinstance(s
-00004230: 6967 6d61 732c 2069 6e74 293a 0a20 2020  igmas, int):.   
-00004240: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
-00004250: 6967 6d61 7320 3d20 5b0a 2020 2020 2020  igmas = [.      
-00004260: 2020 2020 2020 2020 2020 666c 6f61 7428            float(
-00004270: 7369 676d 6173 292c 0a20 2020 2020 2020  sigmas),.       
-00004280: 2020 2020 205d 0a20 2020 2020 2020 2065       ].        e
-00004290: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000042a0: 2073 656c 662e 5f73 6967 6d61 7320 3d20   self._sigmas = 
-000042b0: 5b5d 0a20 2020 2020 2020 2020 2020 2066  [].            f
-000042c0: 6f72 2073 2069 6e20 7369 676d 6173 3a0a  or s in sigmas:.
-000042d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000042e0: 6966 2069 7369 6e73 7461 6e63 6528 732c  if isinstance(s,
-000042f0: 2066 6c6f 6174 2920 6f72 2069 7369 6e73   float) or isins
-00004300: 7461 6e63 6528 732c 2069 6e74 293a 0a20  tance(s, int):. 
-00004310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004320: 2020 2073 656c 662e 5f73 6967 6d61 732e     self._sigmas.
-00004330: 6170 7065 6e64 2866 6c6f 6174 2873 2929  append(float(s))
-00004340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004350: 2065 6c69 6620 7320 6973 204e 6f6e 653a   elif s is None:
-00004360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004370: 2020 2020 2073 656c 662e 5f73 6967 6d61       self._sigma
-00004380: 732e 6170 7065 6e64 284e 6f6e 6529 0a0a  s.append(None)..
-00004390: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-000043a0: 2020 6465 6620 7369 676d 615f 6375 746f    def sigma_cuto
-000043b0: 6666 2873 656c 6629 3a0a 2020 2020 2020  ff(self):.      
-000043c0: 2020 2222 2253 6574 7465 7220 616e 6420    """Setter and 
-000043d0: 6765 7474 6572 206f 6620 536d 6561 7269  getter of Smeari
-000043e0: 6e67 2063 7574 6f66 6620 7769 6474 682e  ng cutoff width.
-000043f0: 0a0a 2020 2020 2020 2020 5468 6973 2069  ..        This i
-00004400: 7320 6769 7665 6e20 6173 2061 206d 756c  s given as a mul
-00004410: 7469 706c 6520 6f66 2074 6865 2073 7461  tiple of the sta
-00004420: 6e64 6172 6420 6465 7669 6174 696f 6e2e  ndard deviation.
-00004430: 0a0a 2020 2020 2020 2020 666c 6f61 740a  ..        float.
-00004440: 2020 2020 2020 2020 2020 2020 466f 7220              For 
-00004450: 6578 616d 706c 652c 2069 6620 7468 6973  example, if this
-00004460: 2076 616c 7565 2069 7320 352c 2074 6865   value is 5, the
-00004470: 2074 6169 6c20 6f66 2074 6865 2047 6175   tail of the Gau
-00004480: 7373 6961 6e20 6675 6e63 7469 6f6e 0a20  ssian function. 
-00004490: 2020 2020 2020 2020 2020 2069 7320 6375             is cu
-000044a0: 7420 6174 2035 2073 6967 6d61 2e0a 0a20  t at 5 sigma... 
-000044b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000044c0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000044d0: 7369 676d 615f 6375 746f 6666 0a0a 2020  sigma_cutoff..  
-000044e0: 2020 4073 6967 6d61 5f63 7574 6f66 662e    @sigma_cutoff.
-000044f0: 7365 7474 6572 0a20 2020 2064 6566 2073  setter.    def s
-00004500: 6967 6d61 5f63 7574 6f66 6628 7365 6c66  igma_cutoff(self
-00004510: 2c20 7369 676d 615f 6375 746f 6666 293a  , sigma_cutoff):
-00004520: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
-00004530: 6967 6d61 5f63 7574 6f66 6620 3d20 7369  igma_cutoff = si
-00004540: 676d 615f 6375 746f 6666 0a0a 2020 2020  gma_cutoff..    
-00004550: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00004560: 6620 6e61 635f 7061 7261 6d73 2873 656c  f nac_params(sel
-00004570: 6629 3a0a 2020 2020 2020 2020 2222 2253  f):.        """S
-00004580: 6574 7465 7220 616e 6420 6765 7474 6572  etter and getter
-00004590: 206f 6620 7061 7261 6d65 7465 7273 2066   of parameters f
-000045a0: 6f72 206e 6f6e 2d61 6e61 6c79 7469 6361  or non-analytica
-000045b0: 6c20 7465 726d 2063 6f72 7265 6374 696f  l term correctio
-000045c0: 6e2e 0a0a 2020 2020 2020 2020 6469 6374  n...        dict
-000045d0: 0a20 2020 2020 2020 2020 2020 2050 6172  .            Par
-000045e0: 616d 6574 6572 7320 7573 6564 2066 6f72  ameters used for
-000045f0: 206e 6f6e 2d61 6e61 6c79 7469 6361 6c20   non-analytical 
-00004600: 7465 726d 2063 6f72 7265 6374 696f 6e0a  term correction.
-00004610: 2020 2020 2020 2020 2020 2020 2762 6f72              'bor
-00004620: 6e27 3a20 6e64 6172 7261 790a 2020 2020  n': ndarray.    
-00004630: 2020 2020 2020 2020 2020 2020 426f 726e              Born
-00004640: 2065 6666 6563 7469 7665 2063 6861 7267   effective charg
-00004650: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-00004660: 2020 2073 6861 7065 3d28 7072 696d 6974     shape=(primit
-00004670: 6976 6520 6365 6c6c 2061 746f 6d73 2c20  ive cell atoms, 
-00004680: 332c 2033 292c 2064 7479 7065 3d27 646f  3, 3), dtype='do
-00004690: 7562 6c65 272c 206f 7264 6572 3d27 4327  uble', order='C'
-000046a0: 0a20 2020 2020 2020 2020 2020 2027 6661  .            'fa
-000046b0: 6374 6f72 273a 2066 6c6f 6174 0a20 2020  ctor': float.   
-000046c0: 2020 2020 2020 2020 2020 2020 2055 6e69               Uni
-000046d0: 7420 636f 6e76 6572 7369 6f6e 2066 6163  t conversion fac
-000046e0: 746f 720a 2020 2020 2020 2020 2020 2020  tor.            
-000046f0: 2764 6965 6c65 6374 7269 6327 3a20 6e64  'dielectric': nd
-00004700: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-00004710: 2020 2020 2020 4469 656c 6563 7472 6963        Dielectric
-00004720: 2063 6f6e 7374 616e 7420 7465 6e73 6f72   constant tensor
-00004730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004740: 2073 6861 7065 3d28 332c 2033 292c 2064   shape=(3, 3), d
-00004750: 7479 7065 3d27 646f 7562 6c65 272c 206f  type='double', o
-00004760: 7264 6572 3d27 4327 0a0a 2020 2020 2020  rder='C'..      
-00004770: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00004780: 7475 726e 2073 656c 662e 5f6e 6163 5f70  turn self._nac_p
-00004790: 6172 616d 730a 0a20 2020 2040 6e61 635f  arams..    @nac_
-000047a0: 7061 7261 6d73 2e73 6574 7465 720a 2020  params.setter.  
-000047b0: 2020 6465 6620 6e61 635f 7061 7261 6d73    def nac_params
-000047c0: 2873 656c 662c 206e 6163 5f70 6172 616d  (self, nac_param
-000047d0: 7329 3a0a 2020 2020 2020 2020 7365 6c66  s):.        self
-000047e0: 2e5f 6e61 635f 7061 7261 6d73 203d 206e  ._nac_params = n
-000047f0: 6163 5f70 6172 616d 730a 2020 2020 2020  ac_params.      
-00004800: 2020 6966 2073 656c 662e 5f69 6e74 6572    if self._inter
-00004810: 6163 7469 6f6e 2069 7320 6e6f 7420 4e6f  action is not No
-00004820: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00004830: 7365 6c66 2e5f 696e 6974 5f64 796e 616d  self._init_dynam
-00004840: 6963 616c 5f6d 6174 7269 7828 290a 0a20  ical_matrix().. 
-00004850: 2020 2064 6566 2067 6574 5f6e 6163 5f70     def get_nac_p
-00004860: 6172 616d 7328 7365 6c66 293a 0a20 2020  arams(self):.   
-00004870: 2020 2020 2022 2222 5265 7475 726e 204e       """Return N
-00004880: 4143 2070 6172 616d 6574 6572 732e 2222  AC parameters.""
-00004890: 220a 2020 2020 2020 2020 7761 726e 696e  ".        warnin
-000048a0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-000048b0: 2020 2020 2022 5068 6f6e 6f33 7079 2e67       "Phono3py.g
-000048c0: 6574 5f6e 6163 5f70 6172 616d 7328 2920  et_nac_params() 
-000048d0: 6973 2064 6570 7265 6361 7465 642e 220a  is deprecated.".
-000048e0: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
-000048f0: 2050 686f 6e6f 3370 792e 6e61 635f 7061   Phono3py.nac_pa
-00004900: 7261 6d73 2061 7474 7269 6275 7465 2069  rams attribute i
-00004910: 6e73 7465 6164 2e22 2c0a 2020 2020 2020  nstead.",.      
-00004920: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-00004930: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
-00004940: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00004950: 726e 2073 656c 662e 6e61 635f 7061 7261  rn self.nac_para
-00004960: 6d73 0a0a 2020 2020 6465 6620 7365 745f  ms..    def set_
-00004970: 6e61 635f 7061 7261 6d73 2873 656c 662c  nac_params(self,
-00004980: 206e 6163 5f70 6172 616d 7329 3a0a 2020   nac_params):.  
-00004990: 2020 2020 2020 2222 2253 6574 204e 4143        """Set NAC
-000049a0: 2070 6172 616d 6574 6572 732e 2222 220a   parameters.""".
-000049b0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-000049c0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-000049d0: 2020 2022 5068 6f6e 6f33 7079 2e73 6574     "Phono3py.set
-000049e0: 5f6e 6163 5f70 6172 616d 7328 2920 6973  _nac_params() is
-000049f0: 2064 6570 7265 6361 7465 642e 220a 2020   deprecated.".  
-00004a00: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
-00004a10: 686f 6e6f 3370 792e 6e61 635f 7061 7261  hono3py.nac_para
-00004a20: 6d73 2061 7474 7269 6275 7465 2069 6e73  ms attribute ins
-00004a30: 7465 6164 2e22 2c0a 2020 2020 2020 2020  tead.",.        
-00004a40: 2020 2020 4465 7072 6563 6174 696f 6e57      DeprecationW
-00004a50: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00004a60: 290a 2020 2020 2020 2020 7365 6c66 2e6e  ).        self.n
-00004a70: 6163 5f70 6172 616d 7320 3d20 6e61 635f  ac_params = nac_
-00004a80: 7061 7261 6d73 0a0a 2020 2020 4070 726f  params..    @pro
-00004a90: 7065 7274 790a 2020 2020 6465 6620 6479  perty.    def dy
-00004aa0: 6e61 6d69 6361 6c5f 6d61 7472 6978 2873  namical_matrix(s
-00004ab0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00004ac0: 2252 6574 7572 6e20 4479 6e61 6d69 6361  "Return Dynamica
-00004ad0: 6c4d 6174 7269 7820 696e 7374 616e 6365  lMatrix instance
-00004ae0: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-00004af0: 6973 206e 6f74 2064 796e 616d 6963 616c  is not dynamical
-00004b00: 206d 6174 7269 6365 7320 6275 7420 7468   matrices but th
-00004b10: 6520 696e 7374 616e 6365 206f 6620 4479  e instance of Dy
-00004b20: 6e61 6d69 6361 6c4d 6174 7269 780a 2020  namicalMatrix.  
-00004b30: 2020 2020 2020 636c 6173 732e 0a0a 2020        class...  
-00004b40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004b50: 2020 6966 2073 656c 662e 5f69 6e74 6572    if self._inter
-00004b60: 6163 7469 6f6e 2069 7320 4e6f 6e65 3a0a  action is None:.
-00004b70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00004b80: 726e 204e 6f6e 650a 2020 2020 2020 2020  rn None.        
-00004b90: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00004ba0: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
-00004bb0: 6e74 6572 6163 7469 6f6e 2e64 796e 616d  nteraction.dynam
-00004bc0: 6963 616c 5f6d 6174 7269 780a 0a20 2020  ical_matrix..   
-00004bd0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00004be0: 6566 2070 7269 6d69 7469 7665 2873 656c  ef primitive(sel
-00004bf0: 6629 202d 3e20 5072 696d 6974 6976 653a  f) -> Primitive:
-00004c00: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00004c10: 726e 2070 7269 6d69 7469 7665 2063 656c  rn primitive cel
-00004c20: 6c2e 0a0a 2020 2020 2020 2020 5072 696d  l...        Prim
-00004c30: 6974 6976 650a 2020 2020 2020 2020 2020  itive.          
-00004c40: 2020 5072 696d 6974 6976 6520 6365 6c6c    Primitive cell
-00004c50: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00004c60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00004c70: 6c66 2e5f 7072 696d 6974 6976 650a 0a20  lf._primitive.. 
-00004c80: 2020 2064 6566 2067 6574 5f70 7269 6d69     def get_primi
-00004c90: 7469 7665 2873 656c 6629 3a0a 2020 2020  tive(self):.    
-00004ca0: 2020 2020 2222 2252 6574 7572 6e20 7072      """Return pr
-00004cb0: 696d 6974 6976 6520 6365 6c6c 2e22 2222  imitive cell."""
-00004cc0: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
-00004cd0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
-00004ce0: 2020 2020 2250 686f 6e6f 3370 792e 6765      "Phono3py.ge
-00004cf0: 745f 7072 696d 6974 6976 6528 2920 6973  t_primitive() is
-00004d00: 2064 6570 7265 6361 7465 642e 220a 2020   deprecated.".  
-00004d10: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
-00004d20: 686f 6e6f 3370 792e 7072 696d 6974 6976  hono3py.primitiv
-00004d30: 6520 6174 7472 6962 7574 6520 696e 7374  e attribute inst
-00004d40: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
-00004d50: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
-00004d60: 726e 696e 672c 0a20 2020 2020 2020 2029  rning,.        )
-00004d70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004d80: 7365 6c66 2e70 7269 6d69 7469 7665 0a0a  self.primitive..
-00004d90: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00004da0: 2020 6465 6620 756e 6974 6365 6c6c 2873    def unitcell(s
-00004db0: 656c 6629 202d 3e20 5068 6f6e 6f70 7941  elf) -> PhonopyA
-00004dc0: 746f 6d73 3a0a 2020 2020 2020 2020 2222  toms:.        ""
-00004dd0: 2252 6574 7572 6e20 556e 6974 2063 656c  "Return Unit cel
-00004de0: 6c2e 0a0a 2020 2020 2020 2020 5068 6f6e  l...        Phon
-00004df0: 6f70 7941 746f 6d73 0a20 2020 2020 2020  opyAtoms.       
-00004e00: 2020 2020 2055 6e69 7420 6365 6c6c 2e0a       Unit cell..
-00004e10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00004e20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00004e30: 2e5f 756e 6974 6365 6c6c 0a0a 2020 2020  ._unitcell..    
-00004e40: 6465 6620 6765 745f 756e 6974 6365 6c6c  def get_unitcell
-00004e50: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00004e60: 2222 2252 6574 7572 6e20 556e 6974 2063  """Return Unit c
-00004e70: 656c 6c2e 2222 220a 2020 2020 2020 2020  ell.""".        
-00004e80: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-00004e90: 2020 2020 2020 2020 2020 2022 5068 6f6e             "Phon
-00004ea0: 6f33 7079 2e67 6574 5f75 6e69 7463 656c  o3py.get_unitcel
-00004eb0: 6c28 2920 6973 2064 6570 7265 6361 7465  l() is deprecate
-00004ec0: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
-00004ed0: 2255 7365 2050 686f 6e6f 3370 792e 756e  "Use Phono3py.un
-00004ee0: 6974 6365 6c6c 2061 7474 7269 6275 7465  itcell attribute
-00004ef0: 2069 6e73 7465 6164 2e22 2c0a 2020 2020   instead.",.    
-00004f00: 2020 2020 2020 2020 4465 7072 6563 6174          Deprecat
-00004f10: 696f 6e57 6172 6e69 6e67 2c0a 2020 2020  ionWarning,.    
-00004f20: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00004f30: 7475 726e 2073 656c 662e 756e 6974 6365  turn self.unitce
-00004f40: 6c6c 0a0a 2020 2020 4070 726f 7065 7274  ll..    @propert
-00004f50: 790a 2020 2020 6465 6620 7375 7065 7263  y.    def superc
-00004f60: 656c 6c28 7365 6c66 2920 2d3e 2053 7570  ell(self) -> Sup
-00004f70: 6572 6365 6c6c 3a0a 2020 2020 2020 2020  ercell:.        
-00004f80: 2222 2252 6574 7572 6e20 7375 7065 7263  """Return superc
-00004f90: 656c 6c2e 0a0a 2020 2020 2020 2020 5375  ell...        Su
-00004fa0: 7065 7263 656c 6c0a 2020 2020 2020 2020  percell.        
-00004fb0: 2020 2020 5375 7065 7263 656c 6c2e 0a0a      Supercell...
-00004fc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00004fd0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00004fe0: 5f73 7570 6572 6365 6c6c 0a0a 2020 2020  _supercell..    
-00004ff0: 6465 6620 6765 745f 7375 7065 7263 656c  def get_supercel
-00005000: 6c28 7365 6c66 293a 0a20 2020 2020 2020  l(self):.       
-00005010: 2022 2222 5265 7475 726e 2073 7570 6572   """Return super
-00005020: 6365 6c6c 2e22 2222 0a20 2020 2020 2020  cell.""".       
-00005030: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00005040: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
-00005050: 6e6f 3370 792e 6765 745f 7375 7065 7263  no3py.get_superc
-00005060: 656c 6c28 2920 6973 2064 6570 7265 6361  ell() is depreca
-00005070: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
-00005080: 2020 2255 7365 2050 686f 6e6f 3370 792e    "Use Phono3py.
-00005090: 7375 7065 7263 656c 6c20 6174 7472 6962  supercell attrib
-000050a0: 7574 6520 696e 7374 6561 642e 222c 0a20  ute instead.",. 
-000050b0: 2020 2020 2020 2020 2020 2044 6570 7265             Depre
-000050c0: 6361 7469 6f6e 5761 726e 696e 672c 0a20  cationWarning,. 
-000050d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000050e0: 2072 6574 7572 6e20 7365 6c66 2e73 7570   return self.sup
-000050f0: 6572 6365 6c6c 0a0a 2020 2020 4070 726f  ercell..    @pro
-00005100: 7065 7274 790a 2020 2020 6465 6620 7068  perty.    def ph
-00005110: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 2873  onon_supercell(s
-00005120: 656c 6629 202d 3e20 5375 7065 7263 656c  elf) -> Supercel
-00005130: 6c3a 0a20 2020 2020 2020 2022 2222 5265  l:.        """Re
-00005140: 7475 726e 2073 7570 6572 6365 6c6c 2066  turn supercell f
-00005150: 6f72 2066 6332 2e0a 0a20 2020 2020 2020  or fc2...       
-00005160: 2053 7570 6572 6365 6c6c 0a20 2020 2020   Supercell.     
-00005170: 2020 2020 2020 2053 7570 6572 6365 6c6c         Supercell
-00005180: 2066 6f72 2066 6332 2e0a 0a20 2020 2020   for fc2...     
-00005190: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-000051a0: 6574 7572 6e20 7365 6c66 2e5f 7068 6f6e  eturn self._phon
-000051b0: 6f6e 5f73 7570 6572 6365 6c6c 0a0a 2020  on_supercell..  
-000051c0: 2020 6465 6620 6765 745f 7068 6f6e 6f6e    def get_phonon
-000051d0: 5f73 7570 6572 6365 6c6c 2873 656c 6629  _supercell(self)
-000051e0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000051f0: 7572 6e20 7375 7065 7263 656c 6c20 666f  urn supercell fo
-00005200: 7220 6663 322e 2222 220a 2020 2020 2020  r fc2.""".      
-00005210: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-00005220: 0a20 2020 2020 2020 2020 2020 2022 5068  .            "Ph
-00005230: 6f6e 6f33 7079 2e67 6574 5f70 686f 6e6f  ono3py.get_phono
-00005240: 6e5f 7375 7065 7263 656c 6c28 2920 6973  n_supercell() is
-00005250: 2064 6570 7265 6361 7465 642e 220a 2020   deprecated.".  
-00005260: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
-00005270: 686f 6e6f 3370 792e 7068 6f6e 6f6e 5f73  hono3py.phonon_s
-00005280: 7570 6572 6365 6c6c 2061 7474 7269 6275  upercell attribu
-00005290: 7465 2069 6e73 7465 6164 2e22 2c0a 2020  te instead.",.  
-000052a0: 2020 2020 2020 2020 2020 4465 7072 6563            Deprec
-000052b0: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
-000052c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000052d0: 7265 7475 726e 2073 656c 662e 7068 6f6e  return self.phon
-000052e0: 6f6e 5f73 7570 6572 6365 6c6c 0a0a 2020  on_supercell..  
-000052f0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00005300: 6465 6620 7068 6f6e 6f6e 5f70 7269 6d69  def phonon_primi
-00005310: 7469 7665 2873 656c 6629 202d 3e20 5072  tive(self) -> Pr
-00005320: 696d 6974 6976 653a 0a20 2020 2020 2020  imitive:.       
-00005330: 2022 2222 5265 7475 726e 2070 7269 6d69   """Return primi
-00005340: 7469 7665 2063 656c 6c20 666f 7220 6663  tive cell for fc
-00005350: 322e 0a0a 2020 2020 2020 2020 5072 696d  2...        Prim
-00005360: 6974 6976 650a 2020 2020 2020 2020 2020  itive.          
-00005370: 2020 5072 696d 6974 6976 6520 6365 6c6c    Primitive cell
-00005380: 2066 6f72 2066 6332 2e20 5468 6973 2073   for fc2. This s
-00005390: 686f 756c 6420 6265 2074 6865 2073 616d  hould be the sam
-000053a0: 6520 6173 2074 6865 2070 7269 6d69 7469  e as the primiti
-000053b0: 7665 0a20 2020 2020 2020 2020 2020 2063  ve.            c
-000053c0: 656c 6c20 666f 7220 6663 332c 2062 7574  ell for fc3, but
-000053d0: 2074 6869 7320 6973 2063 7265 6174 6564   this is created
-000053e0: 2066 726f 6d20 7375 7065 7263 656c 6c20   from supercell 
-000053f0: 666f 7220 6663 3220 616e 640a 2020 2020  for fc2 and.    
-00005400: 2020 2020 2020 2020 6361 6e20 6265 206e          can be n
-00005410: 6f74 206e 756d 6572 6963 616c 6c79 2070  ot numerically p
-00005420: 6572 6665 6374 6c79 2069 6465 6e74 6963  erfectly identic
-00005430: 616c 2e0a 0a20 2020 2020 2020 2022 2222  al...        """
-00005440: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005450: 7365 6c66 2e5f 7068 6f6e 6f6e 5f70 7269  self._phonon_pri
-00005460: 6d69 7469 7665 0a0a 2020 2020 6465 6620  mitive..    def 
-00005470: 6765 745f 7068 6f6e 6f6e 5f70 7269 6d69  get_phonon_primi
-00005480: 7469 7665 2873 656c 6629 3a0a 2020 2020  tive(self):.    
-00005490: 2020 2020 2222 2252 6574 7572 6e20 7072      """Return pr
-000054a0: 696d 6974 6976 6520 6365 6c6c 2066 6f72  imitive cell for
-000054b0: 2066 6332 2e22 2222 0a20 2020 2020 2020   fc2.""".       
-000054c0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-000054d0: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
-000054e0: 6e6f 3370 792e 6765 745f 7068 6f6e 6f6e  no3py.get_phonon
-000054f0: 5f70 7269 6d69 7469 7665 2829 2069 7320  _primitive() is 
-00005500: 6465 7072 6563 6174 6564 2e22 0a20 2020  deprecated.".   
-00005510: 2020 2020 2020 2020 2022 5573 6520 5068           "Use Ph
-00005520: 6f6e 6f33 7079 2e70 686f 6e6f 6e5f 7072  ono3py.phonon_pr
-00005530: 696d 6974 6976 6520 6174 7472 6962 7574  imitive attribut
-00005540: 6520 696e 7374 6561 642e 222c 0a20 2020  e instead.",.   
-00005550: 2020 2020 2020 2020 2044 6570 7265 6361           Depreca
-00005560: 7469 6f6e 5761 726e 696e 672c 0a20 2020  tionWarning,.   
-00005570: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00005580: 6574 7572 6e20 7365 6c66 2e70 686f 6e6f  eturn self.phono
-00005590: 6e5f 7072 696d 6974 6976 650a 0a20 2020  n_primitive..   
-000055a0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000055b0: 6566 2073 796d 6d65 7472 7928 7365 6c66  ef symmetry(self
-000055c0: 2920 2d3e 2053 796d 6d65 7472 793a 0a20  ) -> Symmetry:. 
-000055d0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000055e0: 2073 796d 6d65 7472 7920 6f66 2073 7570   symmetry of sup
-000055f0: 6572 6365 6c6c 2e0a 0a20 2020 2020 2020  ercell...       
-00005600: 2053 796d 6d65 7472 790a 2020 2020 2020   Symmetry.      
-00005610: 2020 2020 2020 5379 6d6d 6574 7279 206f        Symmetry o
-00005620: 6620 7375 7065 7263 656c 6c0a 0a20 2020  f supercell..   
-00005630: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00005640: 2072 6574 7572 6e20 7365 6c66 2e5f 7379   return self._sy
-00005650: 6d6d 6574 7279 0a0a 2020 2020 6465 6620  mmetry..    def 
-00005660: 6765 745f 7379 6d6d 6574 7279 2873 656c  get_symmetry(sel
-00005670: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00005680: 6574 7572 6e20 7379 6d6d 6574 7279 206f  eturn symmetry o
-00005690: 6620 7375 7065 7263 656c 6c2e 2222 220a  f supercell.""".
-000056a0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-000056b0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-000056c0: 2020 2022 5068 6f6e 6f33 7079 2e67 6574     "Phono3py.get
-000056d0: 5f73 796d 6d65 7472 7928 2920 6973 2064  _symmetry() is d
-000056e0: 6570 7265 6361 7465 642e 220a 2020 2020  eprecated.".    
-000056f0: 2020 2020 2020 2020 2255 7365 2050 686f          "Use Pho
-00005700: 6e6f 3370 792e 7379 6d6d 6574 7279 2061  no3py.symmetry a
-00005710: 7474 7269 6275 7465 2069 6e73 7465 6164  ttribute instead
-00005720: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00005730: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00005740: 6e67 2c0a 2020 2020 2020 2020 290a 2020  ng,.        ).  
-00005750: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00005760: 662e 7379 6d6d 6574 7279 0a0a 2020 2020  f.symmetry..    
-00005770: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00005780: 6620 7072 696d 6974 6976 655f 7379 6d6d  f primitive_symm
-00005790: 6574 7279 2873 656c 6629 202d 3e20 5379  etry(self) -> Sy
-000057a0: 6d6d 6574 7279 3a0a 2020 2020 2020 2020  mmetry:.        
-000057b0: 2222 2252 6574 7572 6e20 7379 6d6d 6574  """Return symmet
-000057c0: 7279 206f 6620 7072 696d 6974 6976 6520  ry of primitive 
-000057d0: 6365 6c6c 2e0a 0a20 2020 2020 2020 2053  cell...        S
-000057e0: 796d 6d65 7472 790a 2020 2020 2020 2020  ymmetry.        
-000057f0: 2020 2020 5379 6d6d 6574 7279 206f 6620      Symmetry of 
-00005800: 7072 696d 6974 6976 6520 6365 6c6c 2e0a  primitive cell..
-00005810: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00005820: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00005830: 2e5f 7072 696d 6974 6976 655f 7379 6d6d  ._primitive_symm
-00005840: 6574 7279 0a0a 2020 2020 6465 6620 6765  etry..    def ge
-00005850: 745f 7072 696d 6974 6976 655f 7379 6d6d  t_primitive_symm
-00005860: 6574 7279 2873 656c 6629 3a0a 2020 2020  etry(self):.    
-00005870: 2020 2020 2222 2252 6574 7572 6e20 7379      """Return sy
-00005880: 6d6d 6574 7279 206f 6620 7072 696d 6974  mmetry of primit
-00005890: 6976 6520 6365 6c6c 2e22 2222 0a20 2020  ive cell.""".   
-000058a0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-000058b0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-000058c0: 2250 686f 6e6f 3370 792e 6765 745f 7072  "Phono3py.get_pr
-000058d0: 696d 6974 6976 655f 7379 6d6d 6574 7279  imitive_symmetry
-000058e0: 2829 2069 7320 6465 7072 6563 6174 6564  () is deprecated
-000058f0: 2e22 0a20 2020 2020 2020 2020 2020 2022  .".            "
-00005900: 5573 6520 5068 6f6e 6f33 7079 2e70 7269  Use Phono3py.pri
-00005910: 6d69 7469 7665 5f73 796d 6d65 7472 7920  mitive_symmetry 
-00005920: 6174 7472 6962 7574 6520 696e 7374 6561  attribute instea
-00005930: 642e 222c 0a20 2020 2020 2020 2020 2020  d.",.           
-00005940: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
-00005950: 696e 672c 0a20 2020 2020 2020 2029 0a20  ing,.        ). 
-00005960: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00005970: 6c66 2e70 7269 6d69 7469 7665 5f73 796d  lf.primitive_sym
-00005980: 6d65 7472 790a 0a20 2020 2040 7072 6f70  metry..    @prop
-00005990: 6572 7479 0a20 2020 2064 6566 2070 686f  erty.    def pho
-000059a0: 6e6f 6e5f 7375 7065 7263 656c 6c5f 7379  non_supercell_sy
-000059b0: 6d6d 6574 7279 2873 656c 6629 202d 3e20  mmetry(self) -> 
-000059c0: 5379 6d6d 6574 7279 3a0a 2020 2020 2020  Symmetry:.      
-000059d0: 2020 2222 2252 6574 7572 6e20 7379 6d6d    """Return symm
-000059e0: 6574 7279 206f 6620 7375 7065 7263 656c  etry of supercel
-000059f0: 6c20 666f 7220 6663 322e 0a0a 2020 2020  l for fc2...    
-00005a00: 2020 2020 5379 6d6d 6574 7279 0a20 2020      Symmetry.   
-00005a10: 2020 2020 2020 2020 2053 796d 6d65 7472           Symmetr
-00005a20: 7920 6f66 2073 7570 6572 6365 6c6c 2066  y of supercell f
-00005a30: 6f72 2066 6332 2028 7068 6f6e 6f6e 5f73  or fc2 (phonon_s
-00005a40: 7570 6572 6365 6c6c 292e 0a0a 2020 2020  upercell)...    
-00005a50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00005a60: 7265 7475 726e 2073 656c 662e 5f70 686f  return self._pho
-00005a70: 6e6f 6e5f 7375 7065 7263 656c 6c5f 7379  non_supercell_sy
-00005a80: 6d6d 6574 7279 0a0a 2020 2020 6465 6620  mmetry..    def 
-00005a90: 6765 745f 7068 6f6e 6f6e 5f73 7570 6572  get_phonon_super
-00005aa0: 6365 6c6c 5f73 796d 6d65 7472 7928 7365  cell_symmetry(se
-00005ab0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00005ac0: 5265 7475 726e 2073 796d 6d65 7472 7920  Return symmetry 
-00005ad0: 6f66 2073 7570 6572 6365 6c6c 2066 6f72  of supercell for
-00005ae0: 2066 6332 2e22 2222 0a20 2020 2020 2020   fc2.""".       
-00005af0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00005b00: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
-00005b10: 6e6f 3370 792e 6765 745f 7068 6f6e 6f6e  no3py.get_phonon
-00005b20: 5f73 7570 6572 6365 6c6c 5f73 796d 6d65  _supercell_symme
-00005b30: 7472 7928 2920 6973 2064 6570 7265 6361  try() is depreca
-00005b40: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
-00005b50: 2020 2255 7365 2050 686f 6e6f 3370 792e    "Use Phono3py.
-00005b60: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
-00005b70: 5f73 796d 6d65 7472 7920 6174 7472 6962  _symmetry attrib
-00005b80: 7574 6520 696e 7374 6561 642e 222c 0a20  ute instead.",. 
-00005b90: 2020 2020 2020 2020 2020 2044 6570 7265             Depre
-00005ba0: 6361 7469 6f6e 5761 726e 696e 672c 0a20  cationWarning,. 
-00005bb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00005bc0: 2072 6574 7572 6e20 7365 6c66 2e70 686f   return self.pho
-00005bd0: 6e6f 6e5f 7375 7065 7263 656c 6c5f 7379  non_supercell_sy
-00005be0: 6d6d 6574 7279 0a0a 2020 2020 4070 726f  mmetry..    @pro
-00005bf0: 7065 7274 790a 2020 2020 6465 6620 7375  perty.    def su
-00005c00: 7065 7263 656c 6c5f 6d61 7472 6978 2873  percell_matrix(s
-00005c10: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00005c20: 2252 6574 7572 6e20 7472 616e 7366 6f72  "Return transfor
-00005c30: 6d61 7469 6f6e 206d 6174 7269 7820 746f  mation matrix to
-00005c40: 2073 7570 6572 6365 6c6c 2063 656c 6c20   supercell cell 
-00005c50: 6672 6f6d 2075 6e69 7420 6365 6c6c 2e0a  from unit cell..
-00005c60: 0a20 2020 2020 2020 206e 6461 7272 6179  .        ndarray
-00005c70: 0a20 2020 2020 2020 2020 2020 2053 7570  .            Sup
-00005c80: 6572 6365 6c6c 206d 6174 7269 7820 7769  ercell matrix wi
-00005c90: 7468 2072 6573 7065 6374 2074 6f20 756e  th respect to un
-00005ca0: 6974 2063 656c 6c2e 0a20 2020 2020 2020  it cell..       
-00005cb0: 2020 2020 2073 6861 7065 3d28 332c 2033       shape=(3, 3
-00005cc0: 292c 2064 7479 7065 3d27 696e 745f 272c  ), dtype='int_',
-00005cd0: 206f 7264 6572 3d27 4327 0a0a 2020 2020   order='C'..    
-00005ce0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00005cf0: 7265 7475 726e 2073 656c 662e 5f73 7570  return self._sup
-00005d00: 6572 6365 6c6c 5f6d 6174 7269 780a 0a20  ercell_matrix.. 
-00005d10: 2020 2064 6566 2067 6574 5f73 7570 6572     def get_super
-00005d20: 6365 6c6c 5f6d 6174 7269 7828 7365 6c66  cell_matrix(self
-00005d30: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-00005d40: 7475 726e 2074 7261 6e73 666f 726d 6174  turn transformat
-00005d50: 696f 6e20 6d61 7472 6978 2074 6f20 7375  ion matrix to su
-00005d60: 7065 7263 656c 6c20 6365 6c6c 2066 726f  percell cell fro
-00005d70: 6d20 756e 6974 2063 656c 6c2e 2222 220a  m unit cell.""".
-00005d80: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00005d90: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-00005da0: 2020 2022 5068 6f6e 6f33 7079 2e67 6574     "Phono3py.get
-00005db0: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
-00005dc0: 7828 2920 6973 2064 6570 7265 6361 7465  x() is deprecate
-00005dd0: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
-00005de0: 2255 7365 2050 686f 6e6f 3370 792e 7375  "Use Phono3py.su
-00005df0: 7065 7263 656c 6c5f 6d61 7472 6978 2061  percell_matrix a
-00005e00: 7474 7269 6275 7465 2069 6e73 7465 6164  ttribute instead
-00005e10: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00005e20: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00005e30: 6e67 2c0a 2020 2020 2020 2020 290a 2020  ng,.        ).  
-00005e40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00005e50: 662e 7375 7065 7263 656c 6c5f 6d61 7472  f.supercell_matr
-00005e60: 6978 0a0a 2020 2020 4070 726f 7065 7274  ix..    @propert
-00005e70: 790a 2020 2020 6465 6620 7068 6f6e 6f6e  y.    def phonon
-00005e80: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
-00005e90: 7828 7365 6c66 293a 0a20 2020 2020 2020  x(self):.       
-00005ea0: 2022 2222 5265 7475 726e 2074 7261 6e73   """Return trans
-00005eb0: 666f 726d 6174 696f 6e20 6d61 7472 6978  formation matrix
-00005ec0: 2074 6f20 7068 6f6e 6f6e 2073 7570 6572   to phonon super
-00005ed0: 6365 6c6c 2066 726f 6d20 756e 6974 2063  cell from unit c
-00005ee0: 656c 6c2e 0a0a 2020 2020 2020 2020 6e64  ell...        nd
-00005ef0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-00005f00: 2020 5375 7065 7263 656c 6c20 6d61 7472    Supercell matr
-00005f10: 6978 2077 6974 6820 7265 7370 6563 7420  ix with respect 
-00005f20: 746f 2075 6e69 7420 6365 6c6c 2e0a 2020  to unit cell..  
-00005f30: 2020 2020 2020 2020 2020 7368 6170 653d            shape=
-00005f40: 2833 2c20 3329 2c20 6474 7970 653d 2769  (3, 3), dtype='i
-00005f50: 6e74 5f27 2c20 6f72 6465 723d 2743 270a  nt_', order='C'.
-00005f60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00005f70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00005f80: 2e5f 7068 6f6e 6f6e 5f73 7570 6572 6365  ._phonon_superce
-00005f90: 6c6c 5f6d 6174 7269 780a 0a20 2020 2064  ll_matrix..    d
-00005fa0: 6566 2067 6574 5f70 686f 6e6f 6e5f 7375  ef get_phonon_su
-00005fb0: 7065 7263 656c 6c5f 6d61 7472 6978 2873  percell_matrix(s
-00005fc0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00005fd0: 2252 6574 7572 6e20 7472 616e 7366 6f72  "Return transfor
-00005fe0: 6d61 7469 6f6e 206d 6174 7269 7820 746f  mation matrix to
-00005ff0: 2070 686f 6e6f 6e20 7375 7065 7263 656c   phonon supercel
-00006000: 6c20 6672 6f6d 2075 6e69 7420 6365 6c6c  l from unit cell
-00006010: 2e22 2222 0a20 2020 2020 2020 2077 6172  .""".        war
-00006020: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00006030: 2020 2020 2020 2020 2250 686f 6e6f 3370          "Phono3p
-00006040: 792e 6765 745f 7068 6f6e 6f6e 5f73 7570  y.get_phonon_sup
-00006050: 6572 6365 6c6c 5f6d 6174 7269 7828 2920  ercell_matrix() 
-00006060: 6973 2064 6570 7265 6361 7465 642e 220a  is deprecated.".
-00006070: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
-00006080: 2050 686f 6e6f 3370 792e 7068 6f6e 6f6e   Phono3py.phonon
-00006090: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
-000060a0: 7820 6174 7472 6962 7574 6520 696e 7374  x attribute inst
-000060b0: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
-000060c0: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
-000060d0: 726e 696e 672c 0a20 2020 2020 2020 2029  rning,.        )
-000060e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000060f0: 7365 6c66 2e70 686f 6e6f 6e5f 7375 7065  self.phonon_supe
-00006100: 7263 656c 6c5f 6d61 7472 6978 0a0a 2020  rcell_matrix..  
-00006110: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00006120: 6465 6620 7072 696d 6974 6976 655f 6d61  def primitive_ma
-00006130: 7472 6978 2873 656c 6629 3a0a 2020 2020  trix(self):.    
-00006140: 2020 2020 2222 2252 6574 7572 6e20 7472      """Return tr
-00006150: 616e 7366 6f72 6d61 7469 6f6e 206d 6174  ansformation mat
-00006160: 7269 7820 746f 2070 7269 6d69 7469 7665  rix to primitive
-00006170: 2063 656c 6c20 6672 6f6d 2075 6e69 7420   cell from unit 
-00006180: 6365 6c6c 2e0a 0a20 2020 2020 2020 206e  cell...        n
-00006190: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
-000061a0: 2020 2050 7269 6d69 7469 7665 206d 6174     Primitive mat
-000061b0: 7269 7820 7769 7468 2072 6573 7065 6374  rix with respect
-000061c0: 2074 6f20 756e 6974 2063 656c 6c2e 0a20   to unit cell.. 
-000061d0: 2020 2020 2020 2020 2020 2073 6861 7065             shape
-000061e0: 3d28 332c 2033 292c 2064 7479 7065 3d27  =(3, 3), dtype='
-000061f0: 646f 7562 6c65 272c 206f 7264 6572 3d27  double', order='
-00006200: 4327 0a0a 2020 2020 2020 2020 2222 220a  C'..        """.
-00006210: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00006220: 656c 662e 5f70 7269 6d69 7469 7665 5f6d  elf._primitive_m
-00006230: 6174 7269 780a 0a20 2020 2064 6566 2067  atrix..    def g
-00006240: 6574 5f70 7269 6d69 7469 7665 5f6d 6174  et_primitive_mat
-00006250: 7269 7828 7365 6c66 293a 0a20 2020 2020  rix(self):.     
-00006260: 2020 2022 2222 5265 7475 726e 2074 7261     """Return tra
-00006270: 6e73 666f 726d 6174 696f 6e20 6d61 7472  nsformation matr
-00006280: 6978 2074 6f20 7072 696d 6974 6976 6520  ix to primitive 
-00006290: 6365 6c6c 2066 726f 6d20 756e 6974 2063  cell from unit c
-000062a0: 656c 6c2e 2222 220a 2020 2020 2020 2020  ell.""".        
-000062b0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-000062c0: 2020 2020 2020 2020 2020 2022 5068 6f6e             "Phon
-000062d0: 6f33 7079 2e67 6574 5f70 7269 6d69 7469  o3py.get_primiti
-000062e0: 7665 5f6d 6174 7269 7828 2920 6973 2064  ve_matrix() is d
-000062f0: 6570 7265 6361 7465 642e 220a 2020 2020  eprecated.".    
-00006300: 2020 2020 2020 2020 2255 7365 2050 686f          "Use Pho
-00006310: 6e6f 3370 792e 7072 696d 6974 6976 655f  no3py.primitive_
-00006320: 6d61 7472 6978 2061 7474 7269 6275 7465  matrix attribute
-00006330: 2069 6e73 7465 6164 2e22 2c0a 2020 2020   instead.",.    
-00006340: 2020 2020 2020 2020 4465 7072 6563 6174          Deprecat
-00006350: 696f 6e57 6172 6e69 6e67 2c0a 2020 2020  ionWarning,.    
-00006360: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00006370: 7475 726e 2073 656c 662e 7072 696d 6974  turn self.primit
-00006380: 6976 655f 6d61 7472 6978 0a0a 2020 2020  ive_matrix..    
-00006390: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000063a0: 6620 756e 6974 5f63 6f6e 7665 7273 696f  f unit_conversio
-000063b0: 6e5f 6661 6374 6f72 2873 656c 6629 3a0a  n_factor(self):.
-000063c0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-000063d0: 6e20 7068 6f6e 6f6e 2066 7265 7175 656e  n phonon frequen
-000063e0: 6379 2075 6e69 7420 636f 6e76 6572 7369  cy unit conversi
-000063f0: 6f6e 2066 6163 746f 722e 0a0a 2020 2020  on factor...    
-00006400: 2020 2020 666c 6f61 740a 2020 2020 2020      float.      
-00006410: 2020 2020 2020 5068 6f6e 6f6e 2066 7265        Phonon fre
-00006420: 7175 656e 6379 2075 6e69 7420 636f 6e76  quency unit conv
-00006430: 6572 7369 6f6e 2066 6163 746f 722e 2054  ersion factor. T
-00006440: 6869 7320 6661 6374 6f72 0a20 2020 2020  his factor.     
-00006450: 2020 2020 2020 2063 6f6e 7665 7274 7320         converts 
-00006460: 7371 7274 283c 666f 7263 653e 2f3c 6469  sqrt(<force>/<di
-00006470: 7374 616e 6365 3e2f 3c41 4d55 3e29 2f32  stance>/<AMU>)/2
-00006480: 7069 2f31 6531 3220 746f 2054 487a 0a20  pi/1e12 to THz. 
-00006490: 2020 2020 2020 2020 2020 2028 6f72 6469             (ordi
-000064a0: 6e61 7279 2066 7265 7175 656e 6379 292e  nary frequency).
-000064b0: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000064c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000064d0: 662e 5f66 7265 7175 656e 6379 5f66 6163  f._frequency_fac
-000064e0: 746f 725f 746f 5f54 487a 0a0a 2020 2020  tor_to_THz..    
-000064f0: 6465 6620 7365 745f 6469 7370 6c61 6365  def set_displace
-00006500: 6d65 6e74 5f64 6174 6173 6574 2873 656c  ment_dataset(sel
-00006510: 662c 2064 6174 6173 6574 293a 0a20 2020  f, dataset):.   
-00006520: 2020 2020 2022 2222 5365 7420 6469 7370       """Set disp
-00006530: 6c61 6365 6d65 6e74 2d66 6f72 6365 2064  lacement-force d
-00006540: 6174 6173 6574 2e22 2222 0a20 2020 2020  ataset.""".     
-00006550: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00006560: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
-00006570: 686f 6e6f 3370 792e 7365 745f 6469 7370  hono3py.set_disp
-00006580: 6c61 6365 6d65 6e74 5f64 6174 6173 6574  lacement_dataset
-00006590: 2829 2069 7320 6465 7072 6563 6174 6564  () is deprecated
-000065a0: 2e22 0a20 2020 2020 2020 2020 2020 2022  .".            "
-000065b0: 5573 6520 5068 6f6e 6f33 7079 2e64 6174  Use Phono3py.dat
-000065c0: 6173 6574 2061 7474 7269 6275 7465 2069  aset attribute i
-000065d0: 6e73 7465 6164 2e22 2c0a 2020 2020 2020  nstead.",.      
-000065e0: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-000065f0: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
-00006600: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00006610: 2e5f 6461 7461 7365 7420 3d20 6461 7461  ._dataset = data
-00006620: 7365 740a 0a20 2020 2040 7072 6f70 6572  set..    @proper
-00006630: 7479 0a20 2020 2064 6566 2064 6174 6173  ty.    def datas
-00006640: 6574 2873 656c 6629 3a0a 2020 2020 2020  et(self):.      
-00006650: 2020 2222 2253 6574 7465 7220 616e 6420    """Setter and 
-00006660: 6765 7474 6572 206f 6620 6469 7370 6c61  getter of displa
-00006670: 6365 6d65 6e74 2d66 6f72 6365 2064 6174  cement-force dat
-00006680: 6173 6574 2e0a 0a20 2020 2020 2020 2064  aset...        d
-00006690: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
-000066a0: 4469 7370 6c61 6365 6d65 6e74 7320 696e  Displacements in
-000066b0: 2073 7570 6572 6365 6c6c 732e 2054 6865   supercells. The
-000066c0: 7265 2061 7265 2074 776f 2074 7970 6573  re are two types
-000066d0: 206f 6620 666f 726d 6174 732e 0a20 2020   of formats..   
-000066e0: 2020 2020 2020 2020 2054 7970 6520 312e           Type 1.
-000066f0: 2054 776f 2061 746f 6d69 6320 6469 7370   Two atomic disp
-00006700: 6c61 6365 6d65 6e74 2069 6e20 6561 6368  lacement in each
-00006710: 2073 7570 6572 6365 6c6c 3a0a 2020 2020   supercell:.    
-00006720: 2020 2020 2020 2020 2020 2020 7b27 6e61              {'na
-00006730: 746f 6d27 3a20 6e75 6d62 6572 206f 6620  tom': number of 
-00006740: 6174 6f6d 7320 696e 2073 7570 6572 6365  atoms in superce
-00006750: 6c6c 2c0a 2020 2020 2020 2020 2020 2020  ll,.            
-00006760: 2020 2020 2027 6669 7273 745f 6174 6f6d       'first_atom
-00006770: 7327 3a20 5b0a 2020 2020 2020 2020 2020  s': [.          
-00006780: 2020 2020 2020 2020 207b 276e 756d 6265           {'numbe
-00006790: 7227 3a20 6174 6f6d 2069 6e64 6578 206f  r': atom index o
-000067a0: 6620 6669 7273 7420 6469 7370 6c61 6365  f first displace
-000067b0: 6420 6174 6f6d 2c0a 2020 2020 2020 2020  d atom,.        
-000067c0: 2020 2020 2020 2020 2020 2020 2764 6973              'dis
-000067d0: 706c 6163 656d 656e 7427 3a20 6469 7370  placement': disp
-000067e0: 6c61 6365 6d65 6e74 2069 6e20 4361 7274  lacement in Cart
-000067f0: 6573 6961 6e20 636f 6f72 6469 6e61 7465  esian coordinate
-00006800: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00006810: 2020 2020 2020 2027 666f 7263 6573 273a         'forces':
-00006820: 2066 6f72 6365 7320 6f6e 2061 746f 6d73   forces on atoms
-00006830: 2069 6e20 7375 7065 7263 656c 6c2c 0a20   in supercell,. 
-00006840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006850: 2020 2027 6964 273a 2064 6973 706c 6163     'id': displac
-00006860: 656d 656e 7420 6964 2028 312c 2032 2c2e  ement id (1, 2,.
-00006870: 2e2e 2c6e 5f66 6972 7374 5f61 746f 6d73  ..,n_first_atoms
-00006880: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00006890: 2020 2020 2020 2773 6563 6f6e 645f 6174        'second_at
-000068a0: 6f6d 7327 3a20 5b0a 2020 2020 2020 2020  oms': [.        
-000068b0: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
-000068c0: 6e75 6d62 6572 273a 2061 746f 6d20 696e  number': atom in
-000068d0: 6465 7820 6f66 2073 6563 6f6e 6420 6469  dex of second di
-000068e0: 7370 6c61 6365 6420 6174 6f6d 2c0a 2020  splaced atom,.  
-000068f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006900: 2020 2020 2027 6469 7370 6c61 6365 6d65       'displaceme
-00006910: 6e74 273a 2064 6973 706c 6163 656d 656e  nt': displacemen
-00006920: 7420 696e 2043 6172 7465 7369 616e 2063  t in Cartesian c
-00006930: 6f6f 7264 696e 6174 6573 7d2c 0a20 2020  oordinates},.   
-00006940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006950: 2020 2020 2766 6f72 6365 7327 3a20 666f      'forces': fo
-00006960: 7263 6573 206f 6e20 6174 6f6d 7320 696e  rces on atoms in
-00006970: 2073 7570 6572 6365 6c6c 2c0a 2020 2020   supercell,.    
-00006980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006990: 2020 2027 7061 6972 5f64 6973 7461 6e63     'pair_distanc
-000069a0: 6527 3a20 6469 7374 616e 6365 2062 6574  e': distance bet
-000069b0: 7765 656e 2070 6169 7265 6420 6174 6f6d  ween paired atom
-000069c0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-000069d0: 2020 2020 2020 2020 2020 2769 6e63 6c75            'inclu
-000069e0: 6465 6427 3a20 7769 7468 2063 7574 6f66  ded': with cutof
-000069f0: 6620 7061 6972 2064 6973 7461 6e63 6520  f pair distance 
-00006a00: 696e 2064 6973 706c 6163 656d 656e 740a  in displacement.
-00006a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a30: 2020 2070 6169 7220 6765 6e65 7261 7469     pair generati
-00006a40: 6f6e 2c20 7468 6973 2069 6e64 6963 6174  on, this indicat
-00006a50: 6573 2069 6620 7468 6973 0a20 2020 2020  es if this.     
-00006a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a70: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00006a80: 6972 2064 6973 706c 6163 656d 656e 7473  ir displacements
-00006a90: 2069 7320 696e 636c 7564 6564 2074 6f20   is included to 
-00006aa0: 636f 6d70 7574 650a 2020 2020 2020 2020  compute.        
-00006ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ac0: 2020 2020 2020 2020 2020 2066 6333 206f             fc3 o
-00006ad0: 7220 6e6f 742c 0a20 2020 2020 2020 2020  r not,.         
-00006ae0: 2020 2020 2020 2020 2020 2020 2020 2769                'i
-00006af0: 6427 3a20 6469 7370 6c61 6365 6d65 6e74  d': displacement
-00006b00: 2069 642e 2028 6e5f 6669 7273 745f 6174   id. (n_first_at
-00006b10: 6f6d 7320 2b20 312c 202e 2e2e 290a 2020  oms + 1, ...).  
-00006b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b30: 2020 2020 2e2e 2e20 5d20 7d2c 202e 2e2e      ... ] }, ...
-00006b40: 205d 207d 0a20 2020 2020 2020 2020 2020   ] }.           
-00006b50: 2054 7970 6520 322e 2041 6c6c 2061 746f   Type 2. All ato
-00006b60: 6d69 6320 6469 7370 6c61 6365 6d65 6e74  mic displacement
-00006b70: 7320 696e 2065 6163 6820 7375 7065 7263  s in each superc
-00006b80: 656c 6c3a 0a20 2020 2020 2020 2020 2020  ell:.           
-00006b90: 2020 2020 207b 2764 6973 706c 6163 656d       {'displacem
-00006ba0: 656e 7473 273a 206e 6461 7272 6179 2c20  ents': ndarray, 
-00006bb0: 6474 7970 653d 2764 6f75 626c 6527 2c20  dtype='double', 
-00006bc0: 6f72 6465 723d 2743 272c 0a20 2020 2020  order='C',.     
-00006bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006be0: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-00006bf0: 7065 3d28 7375 7065 7263 656c 6c73 2c20  pe=(supercells, 
-00006c00: 6174 6f6d 7320 696e 2073 7570 6572 6365  atoms in superce
-00006c10: 6c6c 2c20 3329 0a20 2020 2020 2020 2020  ll, 3).         
-00006c20: 2020 2020 2020 2020 2766 6f72 6365 7327          'forces'
-00006c30: 3a20 6e64 6172 7261 792c 2064 7479 7065  : ndarray, dtype
-00006c40: 3d27 646f 7562 6c65 272c 2c20 6f72 6465  ='double',, orde
-00006c50: 723d 2743 272c 0a20 2020 2020 2020 2020  r='C',.         
-00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c70: 2020 2020 2020 2020 2073 6861 7065 3d28           shape=(
-00006c80: 7375 7065 7263 656c 6c73 2c20 6174 6f6d  supercells, atom
-00006c90: 7320 696e 2073 7570 6572 6365 6c6c 2c20  s in supercell, 
-00006ca0: 3329 7d0a 2020 2020 2020 2020 2020 2020  3)}.            
-00006cb0: 496e 2074 7970 6520 322c 2064 6973 706c  In type 2, displ
-00006cc0: 6163 656d 656e 7473 2061 6e64 2066 6f72  acements and for
-00006cd0: 6365 7320 6361 6e20 6265 2067 6976 656e  ces can be given
-00006ce0: 2062 7920 6e75 6d70 7920 6172 7261 790a   by numpy array.
-00006cf0: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00006d00: 2064 6966 6665 7265 6e74 2073 6861 7065   different shape
-00006d10: 2062 7574 2074 6861 7420 6361 6e20 6265   but that can be
-00006d20: 2072 6573 6861 7065 6420 746f 0a20 2020   reshaped to.   
-00006d30: 2020 2020 2020 2020 2028 7375 7065 7263           (superc
-00006d40: 656c 6c73 2c20 6e61 746f 6d2c 2033 292e  ells, natom, 3).
-00006d50: 0a0a 2020 2020 2020 2020 2020 2020 496e  ..            In
-00006d60: 2061 6464 6974 696f 6e2c 2027 6475 706c   addition, 'dupl
-00006d70: 6963 6174 6573 2720 616e 6420 2763 7574  icates' and 'cut
-00006d80: 6f66 665f 6469 7374 616e 6365 2720 6361  off_distance' ca
-00006d90: 6e20 6578 6973 7420 696e 2074 6869 730a  n exist in this.
-00006da0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00006db0: 7365 7420 696e 2064 6973 706c 6163 656d  set in displacem
-00006dc0: 656e 7420 7061 6972 2067 656e 6572 6174  ent pair generat
-00006dd0: 696f 6e2e 2027 6475 706c 6963 6174 6573  ion. 'duplicates
-00006de0: 2720 6769 7665 730a 2020 2020 2020 2020  ' gives.        
-00006df0: 2020 2020 6475 706c 6963 6174 6564 2073      duplicated s
-00006e00: 7570 6572 6365 6c6c 2069 6473 2061 7320  upercell ids as 
-00006e10: 7061 6972 732e 0a0a 2020 2020 2020 2020  pairs...        
-00006e20: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00006e30: 726e 2073 656c 662e 5f64 6174 6173 6574  rn self._dataset
-00006e40: 0a0a 2020 2020 4064 6174 6173 6574 2e73  ..    @dataset.s
-00006e50: 6574 7465 720a 2020 2020 6465 6620 6461  etter.    def da
-00006e60: 7461 7365 7428 7365 6c66 2c20 6461 7461  taset(self, data
-00006e70: 7365 7429 3a0a 2020 2020 2020 2020 7365  set):.        se
-00006e80: 6c66 2e5f 6461 7461 7365 7420 3d20 6461  lf._dataset = da
-00006e90: 7461 7365 740a 2020 2020 2020 2020 7365  taset.        se
-00006ea0: 6c66 2e5f 7375 7065 7263 656c 6c73 5f77  lf._supercells_w
-00006eb0: 6974 685f 6469 7370 6c61 6365 6d65 6e74  ith_displacement
-00006ec0: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
-00006ed0: 2073 656c 662e 5f70 686f 6e6f 6e5f 7375   self._phonon_su
-00006ee0: 7065 7263 656c 6c73 5f77 6974 685f 6469  percells_with_di
-00006ef0: 7370 6c61 6365 6d65 6e74 7320 3d20 4e6f  splacements = No
-00006f00: 6e65 0a0a 2020 2020 4070 726f 7065 7274  ne..    @propert
-00006f10: 790a 2020 2020 6465 6620 6469 7370 6c61  y.    def displa
-00006f20: 6365 6d65 6e74 5f64 6174 6173 6574 2873  cement_dataset(s
-00006f30: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00006f40: 2252 6574 7572 6e20 6469 7370 6c61 6365  "Return displace
-00006f50: 6d65 6e74 2d66 6f72 6365 2064 6174 6173  ment-force datas
-00006f60: 6574 2e22 2222 0a20 2020 2020 2020 2077  et.""".        w
-00006f70: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-00006f80: 2020 2020 2020 2020 2020 2250 686f 6e6f            "Phono
-00006f90: 3370 792e 6469 7370 6c61 6365 6d65 6e74  3py.displacement
-00006fa0: 5f64 6174 6173 6574 2069 7320 6465 7072  _dataset is depr
-00006fb0: 6563 6174 6564 2e22 2022 5573 6520 5068  ecated." "Use Ph
-00006fc0: 6f6e 6f33 7079 2e64 6174 6173 6574 2e22  ono3py.dataset."
-00006fd0: 2c0a 2020 2020 2020 2020 2020 2020 4465  ,.            De
-00006fe0: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
-00006ff0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00007000: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00007010: 6461 7461 7365 740a 0a20 2020 2064 6566  dataset..    def
-00007020: 2067 6574 5f64 6973 706c 6163 656d 656e   get_displacemen
-00007030: 745f 6461 7461 7365 7428 7365 6c66 293a  t_dataset(self):
-00007040: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00007050: 726e 2064 6973 706c 6163 656d 656e 742d  rn displacement-
-00007060: 666f 7263 6520 6461 7461 7365 742e 2222  force dataset.""
-00007070: 220a 2020 2020 2020 2020 7761 726e 696e  ".        warnin
-00007080: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-00007090: 2020 2020 2022 5068 6f6e 6f33 7079 2e67       "Phono3py.g
-000070a0: 6574 5f64 6973 706c 6163 656d 656e 745f  et_displacement_
-000070b0: 6461 7461 7365 7428 2920 6973 2064 6570  dataset() is dep
-000070c0: 7265 6361 7465 642e 220a 2020 2020 2020  recated.".      
-000070d0: 2020 2020 2020 2255 7365 2050 686f 6e6f        "Use Phono
-000070e0: 3370 792e 6461 7461 7365 742e 222c 0a20  3py.dataset.",. 
-000070f0: 2020 2020 2020 2020 2020 2044 6570 7265             Depre
-00007100: 6361 7469 6f6e 5761 726e 696e 672c 0a20  cationWarning,. 
-00007110: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00007120: 2072 6574 7572 6e20 7365 6c66 2e64 6973   return self.dis
-00007130: 706c 6163 656d 656e 745f 6461 7461 7365  placement_datase
-00007140: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
-00007150: 0a20 2020 2064 6566 2070 686f 6e6f 6e5f  .    def phonon_
-00007160: 6461 7461 7365 7428 7365 6c66 293a 0a20  dataset(self):. 
-00007170: 2020 2020 2020 2022 2222 5365 7474 6572         """Setter
-00007180: 2061 6e64 2067 6574 7465 7220 6f66 2064   and getter of d
-00007190: 6973 706c 6163 656d 656e 742d 666f 7263  isplacement-forc
-000071a0: 6520 6461 7461 7365 7420 666f 7220 6663  e dataset for fc
-000071b0: 322e 0a0a 2020 2020 2020 2020 6469 6374  2...        dict
-000071c0: 0a20 2020 2020 2020 2020 2020 2044 6973  .            Dis
-000071d0: 706c 6163 656d 656e 7473 2069 6e20 7375  placements in su
-000071e0: 7065 7263 656c 6c73 2e20 5468 6572 6520  percells. There 
-000071f0: 6172 6520 7477 6f20 7479 7065 7320 6f66  are two types of
-00007200: 2066 6f72 6d61 7473 2e0a 2020 2020 2020   formats..      
-00007210: 2020 2020 2020 5479 7065 2031 2e20 5477        Type 1. Tw
-00007220: 6f20 6174 6f6d 6963 2064 6973 706c 6163  o atomic displac
-00007230: 656d 656e 7420 696e 2065 6163 6820 7375  ement in each su
-00007240: 7065 7263 656c 6c3a 0a20 2020 2020 2020  percell:.       
-00007250: 2020 2020 2020 2020 207b 276e 6174 6f6d           {'natom
-00007260: 273a 206e 756d 6265 7220 6f66 2061 746f  ': number of ato
-00007270: 6d73 2069 6e20 7375 7065 7263 656c 6c2c  ms in supercell,
-00007280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007290: 2020 2766 6972 7374 5f61 746f 6d73 273a    'first_atoms':
-000072a0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000072b0: 2020 2020 2020 7b27 6e75 6d62 6572 273a        {'number':
-000072c0: 2061 746f 6d20 696e 6465 7820 6f66 2066   atom index of f
-000072d0: 6972 7374 2064 6973 706c 6163 6564 2061  irst displaced a
-000072e0: 746f 6d2c 0a20 2020 2020 2020 2020 2020  tom,.           
-000072f0: 2020 2020 2020 2020 2027 6469 7370 6c61           'displa
-00007300: 6365 6d65 6e74 273a 2064 6973 706c 6163  cement': displac
-00007310: 656d 656e 7420 696e 2043 6172 7465 7369  ement in Cartesi
-00007320: 616e 2063 6f6f 7264 696e 6174 6573 2c0a  an coordinates,.
-00007330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007340: 2020 2020 2766 6f72 6365 7327 3a20 666f      'forces': fo
-00007350: 7263 6573 206f 6e20 6174 6f6d 7320 696e  rces on atoms in
-00007360: 2073 7570 6572 6365 6c6c 7d20 2e2e 2e20   supercell} ... 
-00007370: 5d7d 0a20 2020 2020 2020 2020 2020 2054  ]}.            T
-00007380: 7970 6520 322e 2041 6c6c 2061 746f 6d69  ype 2. All atomi
-00007390: 6320 6469 7370 6c61 6365 6d65 6e74 7320  c displacements 
-000073a0: 696e 2065 6163 6820 7375 7065 7263 656c  in each supercel
-000073b0: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
-000073c0: 2020 207b 2764 6973 706c 6163 656d 656e     {'displacemen
-000073d0: 7473 273a 206e 6461 7272 6179 2c20 6474  ts': ndarray, dt
-000073e0: 7970 653d 2764 6f75 626c 6527 2c20 6f72  ype='double', or
-000073f0: 6465 723d 2743 272c 0a20 2020 2020 2020  der='C',.       
-00007400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007410: 2020 2020 2020 2020 2020 2073 6861 7065             shape
-00007420: 3d28 7375 7065 7263 656c 6c73 2c20 6174  =(supercells, at
-00007430: 6f6d 7320 696e 2073 7570 6572 6365 6c6c  oms in supercell
-00007440: 2c20 3329 0a20 2020 2020 2020 2020 2020  , 3).           
-00007450: 2020 2020 2020 2766 6f72 6365 7327 3a20        'forces': 
-00007460: 6e64 6172 7261 792c 2064 7479 7065 3d27  ndarray, dtype='
-00007470: 646f 7562 6c65 272c 2c20 6f72 6465 723d  double',, order=
-00007480: 2743 272c 0a20 2020 2020 2020 2020 2020  'C',.           
-00007490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074a0: 2020 2020 2020 2073 6861 7065 3d28 7375         shape=(su
-000074b0: 7065 7263 656c 6c73 2c20 6174 6f6d 7320  percells, atoms 
-000074c0: 696e 2073 7570 6572 6365 6c6c 2c20 3329  in supercell, 3)
-000074d0: 7d0a 2020 2020 2020 2020 2020 2020 496e  }.            In
-000074e0: 2074 7970 6520 322c 2064 6973 706c 6163   type 2, displac
-000074f0: 656d 656e 7473 2061 6e64 2066 6f72 6365  ements and force
-00007500: 7320 6361 6e20 6265 2067 6976 656e 2062  s can be given b
-00007510: 7920 6e75 6d70 7920 6172 7261 790a 2020  y numpy array.  
-00007520: 2020 2020 2020 2020 2020 7769 7468 2064            with d
-00007530: 6966 6665 7265 6e74 2073 6861 7065 2062  ifferent shape b
-00007540: 7574 2074 6861 7420 6361 6e20 6265 2072  ut that can be r
-00007550: 6573 6861 7065 6420 746f 0a20 2020 2020  eshaped to.     
-00007560: 2020 2020 2020 2028 7375 7065 7263 656c         (supercel
-00007570: 6c73 2c20 6e61 746f 6d2c 2033 292e 0a0a  ls, natom, 3)...
-00007580: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00007590: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000075a0: 5f70 686f 6e6f 6e5f 6461 7461 7365 740a  _phonon_dataset.
-000075b0: 0a20 2020 2040 7068 6f6e 6f6e 5f64 6174  .    @phonon_dat
-000075c0: 6173 6574 2e73 6574 7465 720a 2020 2020  aset.setter.    
-000075d0: 6465 6620 7068 6f6e 6f6e 5f64 6174 6173  def phonon_datas
-000075e0: 6574 2873 656c 662c 2064 6174 6173 6574  et(self, dataset
-000075f0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00007600: 5f70 686f 6e6f 6e5f 6461 7461 7365 7420  _phonon_dataset 
-00007610: 3d20 6461 7461 7365 740a 0a20 2020 2040  = dataset..    @
-00007620: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00007630: 2070 686f 6e6f 6e5f 6469 7370 6c61 6365   phonon_displace
-00007640: 6d65 6e74 5f64 6174 6173 6574 2873 656c  ment_dataset(sel
-00007650: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00007660: 6574 7572 6e20 7068 6f6e 6f6e 2064 6973  eturn phonon dis
-00007670: 7061 6c63 656d 656e 742d 666f 7263 6520  palcement-force 
-00007680: 6461 7461 7365 742e 2222 220a 2020 2020  dataset.""".    
-00007690: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-000076a0: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
-000076b0: 5068 6f6e 6f33 7079 2e70 686f 6e6f 6e5f  Phono3py.phonon_
-000076c0: 6469 7370 6c61 6365 6d65 6e74 5f64 6174  displacement_dat
-000076d0: 6173 6574 2069 7320 6465 7072 6563 6174  aset is deprecat
-000076e0: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
-000076f0: 2022 5573 6520 5068 6f6e 6f33 7079 2e70   "Use Phono3py.p
-00007700: 686f 6e6f 6e5f 6461 7461 7365 742e 222c  honon_dataset.",
-00007710: 0a20 2020 2020 2020 2020 2020 2044 6570  .            Dep
-00007720: 7265 6361 7469 6f6e 5761 726e 696e 672c  recationWarning,
-00007730: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00007740: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00007750: 7068 6f6e 6f6e 5f64 6174 6173 6574 0a0a  phonon_dataset..
-00007760: 2020 2020 6465 6620 6765 745f 7068 6f6e      def get_phon
-00007770: 6f6e 5f64 6973 706c 6163 656d 656e 745f  on_displacement_
-00007780: 6461 7461 7365 7428 7365 6c66 293a 0a20  dataset(self):. 
-00007790: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000077a0: 2070 686f 6e6f 6e20 6469 7370 616c 6365   phonon dispalce
-000077b0: 6d65 6e74 2d66 6f72 6365 2064 6174 6173  ment-force datas
-000077c0: 6574 2e22 2222 0a20 2020 2020 2020 2077  et.""".        w
-000077d0: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-000077e0: 2020 2020 2020 2020 2020 2250 686f 6e6f            "Phono
-000077f0: 3370 792e 6765 745f 7068 6f6e 6f6e 5f64  3py.get_phonon_d
-00007800: 6973 706c 6163 656d 656e 745f 6461 7461  isplacement_data
-00007810: 7365 7428 2920 6973 2064 6570 7265 6361  set() is depreca
-00007820: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
-00007830: 2020 2255 7365 2050 686f 6e6f 3370 792e    "Use Phono3py.
-00007840: 7068 6f6e 6f6e 5f64 6174 6173 6574 2e22  phonon_dataset."
-00007850: 2c0a 2020 2020 2020 2020 2020 2020 4465  ,.            De
-00007860: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
-00007870: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00007880: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00007890: 7068 6f6e 6f6e 5f64 6973 706c 6163 656d  phonon_displacem
-000078a0: 656e 745f 6461 7461 7365 740a 0a20 2020  ent_dataset..   
-000078b0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000078c0: 6566 2062 616e 645f 696e 6469 6365 7328  ef band_indices(
-000078d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000078e0: 2222 5365 7474 6572 2061 6e64 2067 6574  ""Setter and get
-000078f0: 7465 7220 6f66 2062 616e 6420 696e 6469  ter of band indi
-00007900: 6365 732e 0a0a 2020 2020 2020 2020 6172  ces...        ar
-00007910: 7261 795f 6c69 6b65 0a20 2020 2020 2020  ray_like.       
-00007920: 2020 2020 204c 6973 7420 6f66 2062 616e       List of ban
-00007930: 6420 696e 6469 6365 7320 7370 6563 6966  d indices specif
-00007940: 6965 6420 746f 2073 656c 6563 7420 7370  ied to select sp
-00007950: 6563 6966 6963 2062 616e 6473 0a20 2020  ecific bands.   
-00007960: 2020 2020 2020 2020 2074 6f20 636f 6d70           to comp
-00007970: 7574 6572 2070 682d 7068 2069 6e74 6572  uter ph-ph inter
-00007980: 6163 7469 6f6e 2072 656c 6174 6564 2070  action related p
-00007990: 726f 7065 7274 6965 732e 0a0a 2020 2020  roperties...    
-000079a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000079b0: 7265 7475 726e 2073 656c 662e 5f62 616e  return self._ban
-000079c0: 645f 696e 6469 6365 730a 0a20 2020 2040  d_indices..    @
-000079d0: 6261 6e64 5f69 6e64 6963 6573 2e73 6574  band_indices.set
-000079e0: 7465 720a 2020 2020 6465 6620 6261 6e64  ter.    def band
-000079f0: 5f69 6e64 6963 6573 2873 656c 662c 2062  _indices(self, b
-00007a00: 616e 645f 696e 6469 6365 7329 3a0a 2020  and_indices):.  
-00007a10: 2020 2020 2020 7365 6c66 2e5f 7365 745f        self._set_
-00007a20: 6261 6e64 5f69 6e64 6963 6573 2862 616e  band_indices(ban
-00007a30: 645f 696e 6469 6365 733d 6261 6e64 5f69  d_indices=band_i
-00007a40: 6e64 6963 6573 290a 0a20 2020 2064 6566  ndices)..    def
-00007a50: 2073 6574 5f62 616e 645f 696e 6469 6365   set_band_indice
-00007a60: 7328 7365 6c66 2c20 6261 6e64 5f69 6e64  s(self, band_ind
-00007a70: 6963 6573 293a 0a20 2020 2020 2020 2022  ices):.        "
-00007a80: 2222 5365 7420 6261 6e64 2069 6e64 6963  ""Set band indic
-00007a90: 6573 2e22 2222 0a20 2020 2020 2020 2077  es.""".        w
-00007aa0: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-00007ab0: 2020 2020 2020 2020 2020 2250 686f 6e6f            "Phono
-00007ac0: 3370 792e 7365 745f 6261 6e64 5f69 6e64  3py.set_band_ind
-00007ad0: 6963 6573 2829 2069 7320 6465 7072 6563  ices() is deprec
-00007ae0: 6174 6564 2e22 0a20 2020 2020 2020 2020  ated.".         
-00007af0: 2020 2022 5573 6520 5068 6f6e 6f33 7079     "Use Phono3py
-00007b00: 2e62 616e 645f 696e 6469 6365 7320 6174  .band_indices at
-00007b10: 7472 6962 7574 6520 696e 7374 6561 642e  tribute instead.
-00007b20: 222c 0a20 2020 2020 2020 2020 2020 2044  ",.            D
-00007b30: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
-00007b40: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
-00007b50: 2020 2020 2073 656c 662e 6261 6e64 5f69       self.band_i
-00007b60: 6e64 6963 6573 203d 2062 616e 645f 696e  ndices = band_in
-00007b70: 6469 6365 730a 0a20 2020 2064 6566 205f  dices..    def _
-00007b80: 7365 745f 6261 6e64 5f69 6e64 6963 6573  set_band_indices
-00007b90: 2873 656c 662c 2062 616e 645f 696e 6469  (self, band_indi
-00007ba0: 6365 733d 4e6f 6e65 293a 0a20 2020 2020  ces=None):.     
-00007bb0: 2020 2069 6620 6261 6e64 5f69 6e64 6963     if band_indic
-00007bc0: 6573 2069 7320 4e6f 6e65 3a0a 2020 2020  es is None:.    
-00007bd0: 2020 2020 2020 2020 6e75 6d5f 6261 6e64          num_band
-00007be0: 203d 206c 656e 2873 656c 662e 5f70 7269   = len(self._pri
-00007bf0: 6d69 7469 7665 2920 2a20 330a 2020 2020  mitive) * 3.    
-00007c00: 2020 2020 2020 2020 7365 6c66 2e5f 6261          self._ba
-00007c10: 6e64 5f69 6e64 6963 6573 203d 205b 6e70  nd_indices = [np
-00007c20: 2e61 7261 6e67 6528 6e75 6d5f 6261 6e64  .arange(num_band
-00007c30: 2c20 6474 7970 653d 2269 6e74 5f22 295d  , dtype="int_")]
-00007c40: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00007c50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00007c60: 5f62 616e 645f 696e 6469 6365 7320 3d20  _band_indices = 
-00007c70: 6261 6e64 5f69 6e64 6963 6573 0a20 2020  band_indices.   
-00007c80: 2020 2020 2073 656c 662e 5f62 616e 645f       self._band_
-00007c90: 696e 6469 6365 735f 666c 6174 7465 6e20  indices_flatten 
-00007ca0: 3d20 6e70 2e68 7374 6163 6b28 7365 6c66  = np.hstack(self
-00007cb0: 2e5f 6261 6e64 5f69 6e64 6963 6573 292e  ._band_indices).
-00007cc0: 6173 7479 7065 2822 696e 745f 2229 0a0a  astype("int_")..
-00007cd0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00007ce0: 2020 6465 6620 6d61 7373 6573 2873 656c    def masses(sel
-00007cf0: 6629 3a0a 2020 2020 2020 2020 2222 2253  f):.        """S
-00007d00: 6574 7465 7220 616e 6420 6765 7474 6572  etter and getter
-00007d10: 206f 6620 6174 6f6d 6963 206d 6173 7365   of atomic masse
-00007d20: 7320 6f66 2070 7269 6d69 7469 7665 2063  s of primitive c
-00007d30: 656c 6c2e 2222 220a 2020 2020 2020 2020  ell.""".        
-00007d40: 7265 7475 726e 2073 656c 662e 5f70 7269  return self._pri
-00007d50: 6d69 7469 7665 2e6d 6173 7365 730a 0a20  mitive.masses.. 
-00007d60: 2020 2040 6d61 7373 6573 2e73 6574 7465     @masses.sette
-00007d70: 720a 2020 2020 6465 6620 6d61 7373 6573  r.    def masses
-00007d80: 2873 656c 662c 206d 6173 7365 7329 3a0a  (self, masses):.
-00007d90: 2020 2020 2020 2020 6966 206d 6173 7365          if masse
-00007da0: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-00007db0: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
-00007dc0: 2020 2020 2020 705f 6d61 7373 6573 203d        p_masses =
-00007dd0: 206e 702e 6172 7261 7928 6d61 7373 6573   np.array(masses
-00007de0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00007df0: 7072 696d 6974 6976 652e 6d61 7373 6573  primitive.masses
-00007e00: 203d 2070 5f6d 6173 7365 730a 2020 2020   = p_masses.    
-00007e10: 2020 2020 7032 705f 6d61 7020 3d20 7365      p2p_map = se
-00007e20: 6c66 2e5f 7072 696d 6974 6976 652e 7032  lf._primitive.p2
-00007e30: 705f 6d61 700a 2020 2020 2020 2020 735f  p_map.        s_
-00007e40: 6d61 7373 6573 203d 2070 5f6d 6173 7365  masses = p_masse
-00007e50: 735b 5b70 3270 5f6d 6170 5b78 5d20 666f  s[[p2p_map[x] fo
-00007e60: 7220 7820 696e 2073 656c 662e 5f70 7269  r x in self._pri
-00007e70: 6d69 7469 7665 2e73 3270 5f6d 6170 5d5d  mitive.s2p_map]]
-00007e80: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
-00007e90: 7570 6572 6365 6c6c 2e6d 6173 7365 7320  upercell.masses 
-00007ea0: 3d20 735f 6d61 7373 6573 0a20 2020 2020  = s_masses.     
-00007eb0: 2020 2075 3273 5f6d 6170 203d 2073 656c     u2s_map = sel
-00007ec0: 662e 5f73 7570 6572 6365 6c6c 2e75 3273  f._supercell.u2s
-00007ed0: 5f6d 6170 0a20 2020 2020 2020 2075 5f6d  _map.        u_m
-00007ee0: 6173 7365 7320 3d20 735f 6d61 7373 6573  asses = s_masses
-00007ef0: 5b75 3273 5f6d 6170 5d0a 2020 2020 2020  [u2s_map].      
-00007f00: 2020 7365 6c66 2e5f 756e 6974 6365 6c6c    self._unitcell
-00007f10: 2e6d 6173 7365 7320 3d20 755f 6d61 7373  .masses = u_mass
-00007f20: 6573 0a20 2020 2020 2020 2073 656c 662e  es.        self.
-00007f30: 5f70 686f 6e6f 6e5f 7072 696d 6974 6976  _phonon_primitiv
-00007f40: 652e 6d61 7373 6573 203d 2070 5f6d 6173  e.masses = p_mas
-00007f50: 7365 730a 2020 2020 2020 2020 7032 705f  ses.        p2p_
-00007f60: 6d61 7020 3d20 7365 6c66 2e5f 7068 6f6e  map = self._phon
-00007f70: 6f6e 5f70 7269 6d69 7469 7665 2e70 3270  on_primitive.p2p
-00007f80: 5f6d 6170 0a20 2020 2020 2020 2073 5f6d  _map.        s_m
-00007f90: 6173 7365 7320 3d20 705f 6d61 7373 6573  asses = p_masses
-00007fa0: 5b5b 7032 705f 6d61 705b 785d 2066 6f72  [[p2p_map[x] for
-00007fb0: 2078 2069 6e20 7365 6c66 2e5f 7068 6f6e   x in self._phon
-00007fc0: 6f6e 5f70 7269 6d69 7469 7665 2e73 3270  on_primitive.s2p
-00007fd0: 5f6d 6170 5d5d 0a20 2020 2020 2020 2073  _map]].        s
-00007fe0: 656c 662e 5f70 686f 6e6f 6e5f 7375 7065  elf._phonon_supe
-00007ff0: 7263 656c 6c2e 6d61 7373 6573 203d 2073  rcell.masses = s
-00008000: 5f6d 6173 7365 730a 0a20 2020 2040 7072  _masses..    @pr
-00008010: 6f70 6572 7479 0a20 2020 2064 6566 2073  operty.    def s
-00008020: 7570 6572 6365 6c6c 735f 7769 7468 5f64  upercells_with_d
-00008030: 6973 706c 6163 656d 656e 7473 2873 656c  isplacements(sel
-00008040: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00008050: 6574 7572 6e20 7375 7065 7263 656c 6c73  eturn supercells
-00008060: 2077 6974 6820 6469 7370 6c61 6365 6d65   with displaceme
-00008070: 6e74 732e 0a0a 2020 2020 2020 2020 6c69  nts...        li
-00008080: 7374 206f 6620 5068 6f6e 6f70 7941 746f  st of PhonopyAto
-00008090: 6d73 0a20 2020 2020 2020 2020 2020 2053  ms.            S
-000080a0: 7570 6572 6365 6c6c 7320 7769 7468 2064  upercells with d
-000080b0: 6973 706c 6163 656d 656e 7473 2067 656e  isplacements gen
-000080c0: 6572 6174 6564 2062 790a 2020 2020 2020  erated by.      
-000080d0: 2020 2020 2020 5068 6f6e 6f33 7079 2e67        Phono3py.g
-000080e0: 656e 6572 6174 655f 6469 7370 6c61 6365  enerate_displace
-000080f0: 6d65 6e74 732e 0a0a 2020 2020 2020 2020  ments...        
-00008100: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
-00008110: 656c 662e 5f73 7570 6572 6365 6c6c 735f  elf._supercells_
-00008120: 7769 7468 5f64 6973 706c 6163 656d 656e  with_displacemen
-00008130: 7473 2069 7320 4e6f 6e65 3a0a 2020 2020  ts is None:.    
-00008140: 2020 2020 2020 2020 7365 6c66 2e5f 6275          self._bu
-00008150: 696c 645f 7375 7065 7263 656c 6c73 5f77  ild_supercells_w
-00008160: 6974 685f 6469 7370 6c61 6365 6d65 6e74  ith_displacement
-00008170: 7328 290a 2020 2020 2020 2020 7265 7475  s().        retu
-00008180: 726e 2073 656c 662e 5f73 7570 6572 6365  rn self._superce
-00008190: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
-000081a0: 656d 656e 7473 0a0a 2020 2020 6465 6620  ements..    def 
-000081b0: 6765 745f 7375 7065 7263 656c 6c73 5f77  get_supercells_w
-000081c0: 6974 685f 6469 7370 6c61 6365 6d65 6e74  ith_displacement
-000081d0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-000081e0: 2022 2222 5265 7475 726e 2073 7570 6572   """Return super
-000081f0: 6365 6c6c 7320 7769 7468 2064 6973 706c  cells with displ
-00008200: 6163 656d 656e 7473 2e22 2222 0a20 2020  acements.""".   
-00008210: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00008220: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00008230: 2250 686f 6e6f 3370 792e 6765 745f 7375  "Phono3py.get_su
-00008240: 7065 7263 656c 6c73 5f77 6974 685f 6469  percells_with_di
-00008250: 7370 6c61 6365 6d65 6e74 7328 2920 6973  splacements() is
-00008260: 2064 6570 7265 6361 7465 642e 220a 2020   deprecated.".  
-00008270: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
-00008280: 686f 6e6f 3370 792e 7375 7065 7263 656c  hono3py.supercel
-00008290: 6c73 5f77 6974 685f 6469 7370 6c61 6365  ls_with_displace
-000082a0: 6d65 6e74 7320 6174 7472 6962 7574 6520  ments attribute 
-000082b0: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
-000082c0: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
-000082d0: 6f6e 5761 726e 696e 672c 0a20 2020 2020  onWarning,.     
-000082e0: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-000082f0: 7572 6e20 7365 6c66 2e73 7570 6572 6365  urn self.superce
-00008300: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
-00008310: 656d 656e 7473 0a0a 2020 2020 4070 726f  ements..    @pro
-00008320: 7065 7274 790a 2020 2020 6465 6620 7068  perty.    def ph
-00008330: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 735f  onon_supercells_
-00008340: 7769 7468 5f64 6973 706c 6163 656d 656e  with_displacemen
-00008350: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
-00008360: 2020 2222 2252 6574 7572 6e20 7375 7065    """Return supe
-00008370: 7263 656c 6c73 2077 6974 6820 6469 7370  rcells with disp
-00008380: 6c61 6365 6d65 6e74 7320 666f 7220 6663  lacements for fc
-00008390: 322e 0a0a 2020 2020 2020 2020 6c69 7374  2...        list
-000083a0: 206f 6620 5068 6f6e 6f70 7941 746f 6d73   of PhonopyAtoms
-000083b0: 0a20 2020 2020 2020 2020 2020 2053 7570  .            Sup
-000083c0: 6572 6365 6c6c 7320 7769 7468 2064 6973  ercells with dis
-000083d0: 706c 6163 656d 656e 7473 2067 656e 6572  placements gener
-000083e0: 6174 6564 2062 790a 2020 2020 2020 2020  ated by.        
-000083f0: 2020 2020 5068 6f6e 6f33 7079 2e67 656e      Phono3py.gen
-00008400: 6572 6174 655f 6469 7370 6c61 6365 6d65  erate_displaceme
-00008410: 6e74 732e 0a0a 2020 2020 2020 2020 2222  nts...        ""
-00008420: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-00008430: 662e 5f70 686f 6e6f 6e5f 7375 7065 7263  f._phonon_superc
-00008440: 656c 6c73 5f77 6974 685f 6469 7370 6c61  ells_with_displa
-00008450: 6365 6d65 6e74 7320 6973 204e 6f6e 653a  cements is None:
-00008460: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00008470: 7365 6c66 2e5f 7068 6f6e 6f6e 5f64 6174  self._phonon_dat
-00008480: 6173 6574 2069 7320 6e6f 7420 4e6f 6e65  aset is not None
-00008490: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000084a0: 2020 7365 6c66 2e5f 7068 6f6e 6f6e 5f73    self._phonon_s
-000084b0: 7570 6572 6365 6c6c 735f 7769 7468 5f64  upercells_with_d
-000084c0: 6973 706c 6163 656d 656e 7473 203d 2028  isplacements = (
-000084d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000084e0: 2020 2020 2073 656c 662e 5f62 7569 6c64       self._build
-000084f0: 5f70 686f 6e6f 6e5f 7375 7065 7263 656c  _phonon_supercel
-00008500: 6c73 5f77 6974 685f 6469 7370 6c61 6365  ls_with_displace
-00008510: 6d65 6e74 7328 0a20 2020 2020 2020 2020  ments(.         
-00008520: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00008530: 656c 662e 5f70 686f 6e6f 6e5f 7375 7065  elf._phonon_supe
-00008540: 7263 656c 6c2c 2073 656c 662e 5f70 686f  rcell, self._pho
-00008550: 6e6f 6e5f 6461 7461 7365 740a 2020 2020  non_dataset.    
-00008560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008570: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00008580: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00008590: 726e 2073 656c 662e 5f70 686f 6e6f 6e5f  rn self._phonon_
-000085a0: 7375 7065 7263 656c 6c73 5f77 6974 685f  supercells_with_
-000085b0: 6469 7370 6c61 6365 6d65 6e74 730a 0a20  displacements.. 
-000085c0: 2020 2064 6566 2067 6574 5f70 686f 6e6f     def get_phono
-000085d0: 6e5f 7375 7065 7263 656c 6c73 5f77 6974  n_supercells_wit
-000085e0: 685f 6469 7370 6c61 6365 6d65 6e74 7328  h_displacements(
-000085f0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00008600: 2222 5265 7475 726e 2073 7570 6572 6365  ""Return superce
-00008610: 6c6c 7320 7769 7468 2064 6973 706c 6163  lls with displac
-00008620: 656d 656e 7473 2066 6f72 2066 6332 2e22  ements for fc2."
-00008630: 2222 0a20 2020 2020 2020 2077 6172 6e69  "".        warni
-00008640: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-00008650: 2020 2020 2020 2250 686f 6e6f 3370 792e        "Phono3py.
-00008660: 6765 745f 7068 6f6e 6f6e 5f73 7570 6572  get_phonon_super
-00008670: 6365 6c6c 735f 7769 7468 5f64 6973 706c  cells_with_displ
-00008680: 6163 656d 656e 7473 2829 2022 0a20 2020  acements() ".   
-00008690: 2020 2020 2020 2020 2022 6973 2064 6570           "is dep
-000086a0: 7265 6361 7465 642e 2055 7365 2050 686f  recated. Use Pho
-000086b0: 6e6f 3370 792e 7068 6f6e 6f6e 5f73 7570  no3py.phonon_sup
-000086c0: 6572 6365 6c6c 735f 7769 7468 5f64 6973  ercells_with_dis
-000086d0: 706c 6163 656d 656e 7473 2022 0a20 2020  placements ".   
-000086e0: 2020 2020 2020 2020 2022 6174 7472 6962           "attrib
-000086f0: 7574 6520 696e 7374 6561 642e 222c 0a20  ute instead.",. 
-00008700: 2020 2020 2020 2020 2020 2044 6570 7265             Depre
-00008710: 6361 7469 6f6e 5761 726e 696e 672c 0a20  cationWarning,. 
-00008720: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00008730: 2072 6574 7572 6e20 7365 6c66 2e70 686f   return self.pho
-00008740: 6e6f 6e5f 7375 7065 7263 656c 6c73 5f77  non_supercells_w
-00008750: 6974 685f 6469 7370 6c61 6365 6d65 6e74  ith_displacement
-00008760: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
-00008770: 0a20 2020 2064 6566 206d 6573 685f 6e75  .    def mesh_nu
-00008780: 6d62 6572 7328 7365 6c66 293a 0a20 2020  mbers(self):.   
-00008790: 2020 2020 2022 2222 5365 7474 6572 2061       """Setter a
-000087a0: 6e64 2067 6574 7465 7220 6f66 2073 616d  nd getter of sam
-000087b0: 706c 696e 6720 6d65 7368 206e 756d 6265  pling mesh numbe
-000087c0: 7273 2069 6e20 7265 6369 7072 6f63 616c  rs in reciprocal
-000087d0: 2073 7061 6365 2e22 2222 0a20 2020 2020   space.""".     
-000087e0: 2020 2069 6620 7365 6c66 2e5f 627a 5f67     if self._bz_g
-000087f0: 7269 6420 6973 204e 6f6e 653a 0a20 2020  rid is None:.   
-00008800: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00008810: 4e6f 6e65 0a20 2020 2020 2020 2065 6c73  None.        els
-00008820: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00008830: 6574 7572 6e20 7365 6c66 2e5f 627a 5f67  eturn self._bz_g
-00008840: 7269 642e 445f 6469 6167 0a0a 2020 2020  rid.D_diag..    
-00008850: 406d 6573 685f 6e75 6d62 6572 732e 7365  @mesh_numbers.se
-00008860: 7474 6572 0a20 2020 2064 6566 206d 6573  tter.    def mes
-00008870: 685f 6e75 6d62 6572 7328 7365 6c66 2c20  h_numbers(self, 
-00008880: 6d65 7368 5f6e 756d 6265 7273 293a 0a20  mesh_numbers):. 
-00008890: 2020 2020 2020 2073 656c 662e 5f73 6574         self._set
-000088a0: 5f6d 6573 685f 6e75 6d62 6572 7328 6d65  _mesh_numbers(me
-000088b0: 7368 5f6e 756d 6265 7273 290a 0a20 2020  sh_numbers)..   
-000088c0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000088d0: 6566 2074 6865 726d 616c 5f63 6f6e 6475  ef thermal_condu
-000088e0: 6374 6976 6974 7928 7365 6c66 293a 0a20  ctivity(self):. 
-000088f0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00008900: 2074 6865 726d 616c 2063 6f6e 6475 6374   thermal conduct
-00008910: 6976 6974 7920 636c 6173 7320 696e 7374  ivity class inst
-00008920: 616e 6365 2e22 2222 0a20 2020 2020 2020  ance.""".       
-00008930: 2072 6574 7572 6e20 7365 6c66 2e5f 7468   return self._th
-00008940: 6572 6d61 6c5f 636f 6e64 7563 7469 7669  ermal_conductivi
-00008950: 7479 0a0a 2020 2020 6465 6620 6765 745f  ty..    def get_
-00008960: 7468 6572 6d61 6c5f 636f 6e64 7563 7469  thermal_conducti
-00008970: 7669 7479 2873 656c 6629 3a0a 2020 2020  vity(self):.    
-00008980: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
-00008990: 6572 6d61 6c20 636f 6e64 7563 7469 7669  ermal conductivi
-000089a0: 7479 2063 6c61 7373 2069 6e73 7461 6e63  ty class instanc
-000089b0: 652e 2222 220a 2020 2020 2020 2020 7761  e.""".        wa
-000089c0: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-000089d0: 2020 2020 2020 2020 2022 5068 6f6e 6f33           "Phono3
-000089e0: 7079 2e67 6574 5f74 6865 726d 616c 5f63  py.get_thermal_c
-000089f0: 6f6e 6475 6374 6976 6974 7928 2920 6973  onductivity() is
-00008a00: 2064 6570 7265 6361 7465 642e 220a 2020   deprecated.".  
-00008a10: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
-00008a20: 686f 6e6f 3370 792e 7468 6572 6d61 6c5f  hono3py.thermal_
-00008a30: 636f 6e64 7563 7469 7669 7479 2061 7474  conductivity att
-00008a40: 7269 6275 7465 2069 6e73 7465 6164 2e22  ribute instead."
-00008a50: 2c0a 2020 2020 2020 2020 2020 2020 4465  ,.            De
-00008a60: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
-00008a70: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00008a80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00008a90: 7468 6572 6d61 6c5f 636f 6e64 7563 7469  thermal_conducti
-00008aa0: 7669 7479 0a0a 2020 2020 4070 726f 7065  vity..    @prope
-00008ab0: 7274 790a 2020 2020 6465 6620 6469 7370  rty.    def disp
-00008ac0: 6c61 6365 6d65 6e74 7328 7365 6c66 293a  lacements(self):
-00008ad0: 0a20 2020 2020 2020 2022 2222 5365 7474  .        """Sett
-00008ae0: 6572 2061 6e64 2067 6574 7465 7220 6469  er and getter di
-00008af0: 7370 6c61 6365 6d65 6e74 7320 696e 2073  splacements in s
-00008b00: 7570 6572 6365 6c6c 732e 0a0a 2020 2020  upercells...    
-00008b10: 2020 2020 5468 6572 6520 6172 6520 7477      There are tw
-00008b20: 6f20 7479 7065 7320 6f66 2064 6973 706c  o types of displ
-00008b30: 6163 656d 656e 7420 6461 7461 7365 742e  acement dataset.
-00008b40: 2053 6565 2074 6865 2064 6f63 7374 7269   See the docstri
-00008b50: 6e67 0a20 2020 2020 2020 206f 6620 6461  ng.        of da
-00008b60: 7461 7365 7420 6162 6f75 7420 7479 7065  taset about type
-00008b70: 7320 3120 616e 6420 3220 666f 7220 7468  s 1 and 2 for th
-00008b80: 6520 6469 7370 6c61 6365 6d65 6e74 2064  e displacement d
-00008b90: 6174 6173 6574 2066 6f72 6d61 7473 2e0a  ataset formats..
-00008ba0: 2020 2020 2020 2020 4469 7370 6c61 6365          Displace
-00008bb0: 6d65 6e74 7320 7365 7420 7265 7475 726e  ments set return
-00008bc0: 6564 2064 6570 656e 6473 206f 6e20 6569  ed depends on ei
-00008bd0: 7468 6572 2074 7970 652d 3120 6f72 2074  ther type-1 or t
-00008be0: 7970 652d 3220 6173 0a20 2020 2020 2020  ype-2 as.       
-00008bf0: 2066 6f6c 6c6f 7773 3a0a 0a20 2020 2020   follows:..     
-00008c00: 2020 2054 7970 652d 312c 204c 6973 7420     Type-1, List 
-00008c10: 6f66 206c 6973 740a 2020 2020 2020 2020  of list.        
-00008c20: 2020 2020 5468 6520 696e 7465 726e 616c      The internal
-00008c30: 206c 6973 7420 6861 7320 3420 656c 656d   list has 4 elem
-00008c40: 656e 7473 2073 7563 6820 6173 205b 3332  ents such as [32
-00008c50: 2c20 302e 3031 2c20 302e 302c 2030 2e30  , 0.01, 0.0, 0.0
-00008c60: 5d5d 2e0a 2020 2020 2020 2020 2020 2020  ]]..            
-00008c70: 5468 6520 6669 7273 7420 656c 656d 656e  The first elemen
-00008c80: 7420 6973 2074 6865 2073 7570 6572 6365  t is the superce
-00008c90: 6c6c 2061 746f 6d20 696e 6465 7820 7374  ll atom index st
-00008ca0: 6172 7469 6e67 2077 6974 6820 302e 0a20  arting with 0.. 
-00008cb0: 2020 2020 2020 2020 2020 2054 6865 2072             The r
-00008cc0: 656d 6169 6e69 6e67 2074 6872 6565 2065  emaining three e
-00008cd0: 6c65 6d65 6e74 7320 6769 7665 2074 6865  lements give the
-00008ce0: 2064 6973 706c 6163 656d 656e 7420 696e   displacement in
-00008cf0: 2043 6172 7465 7369 616e 0a20 2020 2020   Cartesian.     
-00008d00: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
-00008d10: 6573 2e0a 2020 2020 2020 2020 5479 7065  es..        Type
-00008d20: 2d32 2c20 6172 7261 795f 6c69 6b65 0a20  -2, array_like. 
-00008d30: 2020 2020 2020 2020 2020 2044 6973 706c             Displ
-00008d40: 6163 656d 656e 7473 206f 6620 616c 6c20  acements of all 
-00008d50: 6174 6f6d 7320 6f66 2061 6c6c 2073 7570  atoms of all sup
-00008d60: 6572 6365 6c6c 7320 696e 2043 6172 7465  ercells in Carte
-00008d70: 7369 616e 0a20 2020 2020 2020 2020 2020  sian.           
-00008d80: 2063 6f6f 7264 696e 6174 6573 2e0a 2020   coordinates..  
-00008d90: 2020 2020 2020 2020 2020 7368 6170 653d            shape=
-00008da0: 2873 7570 6572 6365 6c6c 732c 206e 6174  (supercells, nat
-00008db0: 6f6d 2c20 3329 0a20 2020 2020 2020 2020  om, 3).         
-00008dc0: 2020 2064 7479 7065 3d27 646f 7562 6c65     dtype='double
-00008dd0: 270a 0a0a 2020 2020 2020 2020 466f 7220  '...        For 
-00008de0: 7365 7474 6572 2c20 6f6e 6c79 2074 7970  setter, only typ
-00008df0: 652d 3220 6461 7461 7365 7420 666f 726d  e-2 dataset form
-00008e00: 6174 2069 7320 616c 6c6f 7765 642e 0a0a  at is allowed...
-00008e10: 2020 2020 2020 2020 6469 7370 6c61 6365          displace
-00008e20: 6d65 6e74 7320 3a20 6172 7261 795f 6c69  ments : array_li
-00008e30: 6b65 0a20 2020 2020 2020 2020 2020 2041  ke.            A
-00008e40: 746f 6d69 6320 6469 7370 6c61 6365 6d65  tomic displaceme
-00008e50: 6e74 7320 6f66 2061 6c6c 2061 746f 6d73  nts of all atoms
-00008e60: 206f 6620 616c 6c20 7375 7065 7263 656c   of all supercel
-00008e70: 6c73 2e0a 2020 2020 2020 2020 2020 2020  ls..            
-00008e80: 4f6e 6c79 2061 6c6c 2064 6973 706c 6163  Only all displac
-00008e90: 656d 656e 7473 2069 6e20 6561 6368 2073  ements in each s
-00008ea0: 7570 6572 6365 6c6c 2063 6173 6520 2874  upercell case (t
-00008eb0: 7970 652d 3229 2069 730a 2020 2020 2020  ype-2) is.      
-00008ec0: 2020 2020 2020 7375 7070 6f72 7465 642e        supported.
-00008ed0: 0a20 2020 2020 2020 2020 2020 2073 6861  .            sha
-00008ee0: 7065 3d28 7375 7065 7263 656c 6c73 2c20  pe=(supercells, 
-00008ef0: 6e61 746f 6d2c 2033 292c 2064 7479 7065  natom, 3), dtype
-00008f00: 3d27 646f 7562 6c65 272c 206f 7264 6572  ='double', order
-00008f10: 3d27 4327 0a0a 2020 2020 2020 2020 2222  ='C'..        ""
-00008f20: 220a 2020 2020 2020 2020 6461 7461 7365  ".        datase
-00008f30: 7420 3d20 7365 6c66 2e5f 6461 7461 7365  t = self._datase
-00008f40: 740a 0a20 2020 2020 2020 2069 6620 2266  t..        if "f
-00008f50: 6972 7374 5f61 746f 6d73 2220 696e 2064  irst_atoms" in d
-00008f60: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-00008f70: 2020 2020 6e75 6d5f 7363 656c 6c73 203d      num_scells =
-00008f80: 206c 656e 2864 6174 6173 6574 5b22 6669   len(dataset["fi
-00008f90: 7273 745f 6174 6f6d 7322 5d29 0a20 2020  rst_atoms"]).   
-00008fa0: 2020 2020 2020 2020 2066 6f72 2064 6973           for dis
-00008fb0: 7031 2069 6e20 6461 7461 7365 745b 2266  p1 in dataset["f
-00008fc0: 6972 7374 5f61 746f 6d73 225d 3a0a 2020  irst_atoms"]:.  
-00008fd0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00008fe0: 6d5f 7363 656c 6c73 202b 3d20 6c65 6e28  m_scells += len(
-00008ff0: 6469 7370 315b 2273 6563 6f6e 645f 6174  disp1["second_at
-00009000: 6f6d 7322 5d29 0a20 2020 2020 2020 2020  oms"]).         
-00009010: 2020 2064 6973 706c 6163 656d 656e 7473     displacements
-00009020: 203d 206e 702e 7a65 726f 7328 0a20 2020   = np.zeros(.   
-00009030: 2020 2020 2020 2020 2020 2020 2028 6e75               (nu
-00009040: 6d5f 7363 656c 6c73 2c20 7365 6c66 2e5f  m_scells, self._
-00009050: 7375 7065 7263 656c 6c2e 6765 745f 6e75  supercell.get_nu
-00009060: 6d62 6572 5f6f 665f 6174 6f6d 7328 292c  mber_of_atoms(),
-00009070: 2033 292c 0a20 2020 2020 2020 2020 2020   3),.           
-00009080: 2020 2020 2064 7479 7065 3d22 646f 7562       dtype="doub
-00009090: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
-000090a0: 2020 2020 206f 7264 6572 3d22 4322 2c0a       order="C",.
-000090b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000090c0: 2020 2020 2020 2020 2020 6920 3d20 300a            i = 0.
-000090d0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000090e0: 6469 7370 3120 696e 2064 6174 6173 6574  disp1 in dataset
-000090f0: 5b22 6669 7273 745f 6174 6f6d 7322 5d3a  ["first_atoms"]:
-00009100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009110: 2064 6973 706c 6163 656d 656e 7473 5b69   displacements[i
-00009120: 2c20 6469 7370 315b 226e 756d 6265 7222  , disp1["number"
-00009130: 5d5d 203d 2064 6973 7031 5b22 6469 7370  ]] = disp1["disp
-00009140: 6c61 6365 6d65 6e74 225d 0a20 2020 2020  lacement"].     
-00009150: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
-00009160: 310a 2020 2020 2020 2020 2020 2020 666f  1.            fo
-00009170: 7220 6469 7370 3120 696e 2064 6174 6173  r disp1 in datas
-00009180: 6574 5b22 6669 7273 745f 6174 6f6d 7322  et["first_atoms"
-00009190: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-000091a0: 2020 2066 6f72 2064 6973 7032 2069 6e20     for disp2 in 
-000091b0: 6469 7370 315b 2273 6563 6f6e 645f 6174  disp1["second_at
-000091c0: 6f6d 7322 5d3a 0a20 2020 2020 2020 2020  oms"]:.         
-000091d0: 2020 2020 2020 2020 2020 2064 6973 706c             displ
-000091e0: 6163 656d 656e 7473 5b69 2c20 6469 7370  acements[i, disp
-000091f0: 325b 226e 756d 6265 7222 5d5d 203d 2064  2["number"]] = d
-00009200: 6973 7032 5b22 6469 7370 6c61 6365 6d65  isp2["displaceme
-00009210: 6e74 225d 0a20 2020 2020 2020 2020 2020  nt"].           
-00009220: 2020 2020 2020 2020 2069 202b 3d20 310a           i += 1.
-00009230: 2020 2020 2020 2020 656c 6966 2022 666f          elif "fo
-00009240: 7263 6573 2220 696e 2064 6174 6173 6574  rces" in dataset
-00009250: 206f 7220 2264 6973 706c 6163 656d 656e   or "displacemen
-00009260: 7473 2220 696e 2064 6174 6173 6574 3a0a  ts" in dataset:.
-00009270: 2020 2020 2020 2020 2020 2020 6469 7370              disp
-00009280: 6c61 6365 6d65 6e74 7320 3d20 6461 7461  lacements = data
-00009290: 7365 745b 2264 6973 706c 6163 656d 656e  set["displacemen
-000092a0: 7473 225d 0a20 2020 2020 2020 2065 6c73  ts"].        els
-000092b0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-000092c0: 6169 7365 2052 756e 7469 6d65 4572 726f  aise RuntimeErro
-000092d0: 7228 2264 6973 706c 6163 656d 656e 7420  r("displacement 
-000092e0: 6461 7461 7365 7420 6861 7320 7772 6f6e  dataset has wron
-000092f0: 6720 666f 726d 6174 2e22 290a 0a20 2020  g format.")..   
-00009300: 2020 2020 2072 6574 7572 6e20 6469 7370       return disp
-00009310: 6c61 6365 6d65 6e74 730a 0a20 2020 2040  lacements..    @
-00009320: 6469 7370 6c61 6365 6d65 6e74 732e 7365  displacements.se
-00009330: 7474 6572 0a20 2020 2064 6566 2064 6973  tter.    def dis
-00009340: 706c 6163 656d 656e 7473 2873 656c 662c  placements(self,
-00009350: 2064 6973 706c 6163 656d 656e 7473 293a   displacements):
-00009360: 0a20 2020 2020 2020 2064 6973 7073 203d  .        disps =
-00009370: 206e 702e 6172 7261 7928 6469 7370 6c61   np.array(displa
-00009380: 6365 6d65 6e74 732c 2064 7479 7065 3d22  cements, dtype="
-00009390: 646f 7562 6c65 222c 206f 7264 6572 3d22  double", order="
-000093a0: 4322 290a 2020 2020 2020 2020 6e61 746f  C").        nato
-000093b0: 6d20 3d20 6c65 6e28 7365 6c66 2e5f 7375  m = len(self._su
-000093c0: 7065 7263 656c 6c29 0a20 2020 2020 2020  percell).       
-000093d0: 2069 6620 6469 7370 732e 6e64 696d 2021   if disps.ndim !
-000093e0: 3d20 3320 6f72 2064 6973 7073 2e73 6861  = 3 or disps.sha
-000093f0: 7065 5b31 3a5d 2021 3d20 286e 6174 6f6d  pe[1:] != (natom
-00009400: 2c20 3329 3a0a 2020 2020 2020 2020 2020  , 3):.          
-00009410: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
-00009420: 7272 6f72 2822 4172 7261 7920 7368 6170  rror("Array shap
-00009430: 6520 6f66 2064 6973 706c 6163 656d 656e  e of displacemen
-00009440: 7473 2069 7320 696e 636f 7272 6563 742e  ts is incorrect.
-00009450: 2229 0a20 2020 2020 2020 2069 6620 2266  ").        if "f
-00009460: 6972 7374 5f61 746f 6d73 2220 696e 2073  irst_atoms" in s
-00009470: 656c 662e 5f64 6174 6173 6574 3a0a 2020  elf._dataset:.  
-00009480: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00009490: 5275 6e74 696d 6545 7272 6f72 2822 4469  RuntimeError("Di
-000094a0: 7370 6c61 6365 6d65 6e74 7320 6172 6520  splacements are 
-000094b0: 696e 636f 6d70 6174 6962 6c65 2077 6974  incompatible wit
-000094c0: 6820 6461 7461 7365 742e 2229 0a20 2020  h dataset.").   
-000094d0: 2020 2020 2073 656c 662e 5f64 6174 6173       self._datas
-000094e0: 6574 5b22 6469 7370 6c61 6365 6d65 6e74  et["displacement
-000094f0: 7322 5d20 3d20 6469 7370 730a 2020 2020  s"] = disps.    
-00009500: 2020 2020 7365 6c66 2e5f 7375 7065 7263      self._superc
-00009510: 656c 6c73 5f77 6974 685f 6469 7370 6c61  ells_with_displa
-00009520: 6365 6d65 6e74 7320 3d20 4e6f 6e65 0a0a  cements = None..
-00009530: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00009540: 2020 6465 6620 666f 7263 6573 2873 656c    def forces(sel
-00009550: 6629 3a0a 2020 2020 2020 2020 2222 2253  f):.        """S
-00009560: 6574 7465 7220 616e 6420 6765 7474 6572  etter and getter
-00009570: 206f 6620 666f 7263 6573 2069 6e20 6469   of forces in di
-00009580: 7370 6c61 6365 6d65 6e74 2064 6174 6173  splacement datas
-00009590: 6574 2e0a 0a20 2020 2020 2020 2041 2073  et...        A s
-000095a0: 6574 206f 6620 6174 6f6d 6963 2066 6f72  et of atomic for
-000095b0: 6365 7320 696e 2064 6973 706c 6163 6564  ces in displaced
-000095c0: 2073 7570 6572 6365 6c6c 732e 2054 6865   supercells. The
-000095d0: 206f 7264 6572 206f 660a 2020 2020 2020   order of.      
-000095e0: 2020 6469 7370 6c61 6365 6420 7375 7065    displaced supe
-000095f0: 7263 656c 6c73 2068 6173 2074 6f20 6d61  rcells has to ma
-00009600: 7463 6820 7769 7468 2074 6861 7420 696e  tch with that in
-00009610: 2064 6973 706c 6163 656d 656e 7420 6461   displacement da
-00009620: 7461 7365 742e 0a20 2020 2020 2020 2073  taset..        s
-00009630: 6861 7065 3d28 6469 7370 6c61 6365 6420  hape=(displaced 
-00009640: 7375 7065 7263 656c 6c73 2c20 6174 6f6d  supercells, atom
-00009650: 7320 696e 2073 7570 6572 6365 6c6c 2c20  s in supercell, 
-00009660: 3329 0a0a 2020 2020 2020 2020 6765 7474  3)..        gett
-00009670: 6572 203a 206e 6461 7272 6179 0a0a 2020  er : ndarray..  
-00009680: 2020 2020 2020 7365 7474 6572 203a 2061        setter : a
-00009690: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
-000096a0: 2020 2020 2020 5468 6520 6f72 6465 7220        The order 
-000096b0: 6f66 2073 7570 6572 6365 6c6c 7320 7573  of supercells us
-000096c0: 6564 2066 6f72 2063 616c 6375 6c61 7469  ed for calculati
-000096d0: 6e67 2066 6f72 6365 7320 6861 7320 746f  ng forces has to
-000096e0: 0a20 2020 2020 2020 2020 2020 2062 6520  .            be 
-000096f0: 7468 6520 7361 6d65 206f 7264 6572 206f  the same order o
-00009700: 6620 7375 7065 7263 656c 6c73 5f77 6974  f supercells_wit
-00009710: 685f 6469 7370 6c61 6365 6d65 6e74 732e  h_displacements.
-00009720: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00009730: 2020 2020 2020 6461 7461 7365 7420 3d20        dataset = 
-00009740: 7365 6c66 2e5f 6461 7461 7365 740a 2020  self._dataset.  
-00009750: 2020 2020 2020 6966 2022 666f 7263 6573        if "forces
-00009760: 2220 696e 2064 6174 6173 6574 3a0a 2020  " in dataset:.  
-00009770: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00009780: 2064 6174 6173 6574 5b22 666f 7263 6573   dataset["forces
-00009790: 225d 0a20 2020 2020 2020 2065 6c69 6620  "].        elif 
-000097a0: 2266 6972 7374 5f61 746f 6d73 2220 696e  "first_atoms" in
-000097b0: 2064 6174 6173 6574 3a0a 2020 2020 2020   dataset:.      
-000097c0: 2020 2020 2020 6e75 6d5f 7363 656c 6c73        num_scells
-000097d0: 203d 206c 656e 2864 6174 6173 6574 5b22   = len(dataset["
-000097e0: 6669 7273 745f 6174 6f6d 7322 5d29 0a20  first_atoms"]). 
-000097f0: 2020 2020 2020 2020 2020 2066 6f72 2064             for d
-00009800: 6973 7031 2069 6e20 6461 7461 7365 745b  isp1 in dataset[
-00009810: 2266 6972 7374 5f61 746f 6d73 225d 3a0a  "first_atoms"]:.
-00009820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009830: 6e75 6d5f 7363 656c 6c73 202b 3d20 6c65  num_scells += le
-00009840: 6e28 6469 7370 315b 2273 6563 6f6e 645f  n(disp1["second_
-00009850: 6174 6f6d 7322 5d29 0a20 2020 2020 2020  atoms"]).       
-00009860: 2020 2020 2066 6f72 6365 7320 3d20 6e70       forces = np
-00009870: 2e7a 6572 6f73 280a 2020 2020 2020 2020  .zeros(.        
-00009880: 2020 2020 2020 2020 286e 756d 5f73 6365          (num_sce
-00009890: 6c6c 732c 2073 656c 662e 5f73 7570 6572  lls, self._super
-000098a0: 6365 6c6c 2e67 6574 5f6e 756d 6265 725f  cell.get_number_
-000098b0: 6f66 5f61 746f 6d73 2829 2c20 3329 2c0a  of_atoms(), 3),.
-000098c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098d0: 6474 7970 653d 2264 6f75 626c 6522 2c0a  dtype="double",.
-000098e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098f0: 6f72 6465 723d 2243 222c 0a20 2020 2020  order="C",.     
-00009900: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00009910: 2020 2020 2069 203d 2030 0a20 2020 2020       i = 0.     
-00009920: 2020 2020 2020 2066 6f72 2064 6973 7031         for disp1
-00009930: 2069 6e20 6461 7461 7365 745b 2266 6972   in dataset["fir
-00009940: 7374 5f61 746f 6d73 225d 3a0a 2020 2020  st_atoms"]:.    
-00009950: 2020 2020 2020 2020 2020 2020 666f 7263              forc
-00009960: 6573 5b69 5d20 3d20 6469 7370 315b 2266  es[i] = disp1["f
-00009970: 6f72 6365 7322 5d0a 2020 2020 2020 2020  orces"].        
-00009980: 2020 2020 2020 2020 6920 2b3d 2031 0a20          i += 1. 
-00009990: 2020 2020 2020 2020 2020 2066 6f72 2064             for d
-000099a0: 6973 7031 2069 6e20 6461 7461 7365 745b  isp1 in dataset[
-000099b0: 2266 6972 7374 5f61 746f 6d73 225d 3a0a  "first_atoms"]:.
-000099c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000099d0: 666f 7220 6469 7370 3220 696e 2064 6973  for disp2 in dis
-000099e0: 7031 5b22 7365 636f 6e64 5f61 746f 6d73  p1["second_atoms
-000099f0: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
-00009a00: 2020 2020 2020 2020 666f 7263 6573 5b69          forces[i
-00009a10: 5d20 3d20 6469 7370 325b 2266 6f72 6365  ] = disp2["force
-00009a20: 7322 5d0a 2020 2020 2020 2020 2020 2020  s"].            
-00009a30: 2020 2020 2020 2020 6920 2b3d 2031 0a20          i += 1. 
-00009a40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00009a50: 6e20 666f 7263 6573 0a20 2020 2020 2020  n forces.       
-00009a60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00009a70: 2020 2072 6169 7365 2052 756e 7469 6d65     raise Runtime
-00009a80: 4572 726f 7228 2264 6973 706c 6163 656d  Error("displacem
-00009a90: 656e 7420 6461 7461 7365 7420 6861 7320  ent dataset has 
-00009aa0: 7772 6f6e 6720 666f 726d 6174 2e22 290a  wrong format.").
-00009ab0: 0a20 2020 2040 666f 7263 6573 2e73 6574  .    @forces.set
-00009ac0: 7465 720a 2020 2020 6465 6620 666f 7263  ter.    def forc
-00009ad0: 6573 2873 656c 662c 2066 6f72 6365 735f  es(self, forces_
-00009ae0: 6663 3329 3a0a 2020 2020 2020 2020 666f  fc3):.        fo
-00009af0: 7263 6573 203d 206e 702e 6172 7261 7928  rces = np.array(
-00009b00: 666f 7263 6573 5f66 6333 2c20 6474 7970  forces_fc3, dtyp
-00009b10: 653d 2264 6f75 626c 6522 2c20 6f72 6465  e="double", orde
-00009b20: 723d 2243 2229 0a20 2020 2020 2020 2064  r="C").        d
-00009b30: 6174 6173 6574 203d 2073 656c 662e 5f64  ataset = self._d
-00009b40: 6174 6173 6574 0a20 2020 2020 2020 2069  ataset.        i
-00009b50: 6620 2266 6972 7374 5f61 746f 6d73 2220  f "first_atoms" 
-00009b60: 696e 2064 6174 6173 6574 3a0a 2020 2020  in dataset:.    
-00009b70: 2020 2020 2020 2020 6920 3d20 300a 2020          i = 0.  
-00009b80: 2020 2020 2020 2020 2020 666f 7220 6469            for di
-00009b90: 7370 3120 696e 2064 6174 6173 6574 5b22  sp1 in dataset["
-00009ba0: 6669 7273 745f 6174 6f6d 7322 5d3a 0a20  first_atoms"]:. 
-00009bb0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00009bc0: 6973 7031 5b22 666f 7263 6573 225d 203d  isp1["forces"] =
-00009bd0: 2066 6f72 6365 735b 695d 0a20 2020 2020   forces[i].     
-00009be0: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
-00009bf0: 310a 2020 2020 2020 2020 2020 2020 666f  1.            fo
-00009c00: 7220 6469 7370 3120 696e 2064 6174 6173  r disp1 in datas
-00009c10: 6574 5b22 6669 7273 745f 6174 6f6d 7322  et["first_atoms"
-00009c20: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00009c30: 2020 2066 6f72 2064 6973 7032 2069 6e20     for disp2 in 
-00009c40: 6469 7370 315b 2273 6563 6f6e 645f 6174  disp1["second_at
-00009c50: 6f6d 7322 5d3a 0a20 2020 2020 2020 2020  oms"]:.         
-00009c60: 2020 2020 2020 2020 2020 2064 6973 7032             disp2
-00009c70: 5b22 666f 7263 6573 225d 203d 2066 6f72  ["forces"] = for
-00009c80: 6365 735b 695d 0a20 2020 2020 2020 2020  ces[i].         
-00009c90: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
-00009ca0: 310a 2020 2020 2020 2020 656c 6966 2022  1.        elif "
-00009cb0: 6469 7370 6c61 6365 6d65 6e74 7322 2069  displacements" i
-00009cc0: 6e20 6461 7461 7365 7420 6f72 2022 666f  n dataset or "fo
-00009cd0: 7263 6573 2220 696e 2064 6174 6173 6574  rces" in dataset
-00009ce0: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
-00009cf0: 7461 7365 745b 2266 6f72 6365 7322 5d20  taset["forces"] 
-00009d00: 3d20 666f 7263 6573 0a0a 2020 2020 4070  = forces..    @p
-00009d10: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00009d20: 7068 6f6e 6f6e 5f64 6973 706c 6163 656d  phonon_displacem
-00009d30: 656e 7473 2873 656c 6629 3a0a 2020 2020  ents(self):.    
-00009d40: 2020 2020 2222 2253 6574 7465 7220 616e      """Setter an
-00009d50: 6420 6765 7474 6572 206f 6620 6469 7370  d getter of disp
-00009d60: 6c61 6365 6d65 6e74 7320 696e 2073 7570  lacements in sup
-00009d70: 6572 6365 6c6c 7320 666f 7220 6663 322e  ercells for fc2.
-00009d80: 0a0a 2020 2020 2020 2020 5468 6572 6520  ..        There 
-00009d90: 6172 6520 7477 6f20 7479 7065 7320 6f66  are two types of
-00009da0: 2064 6973 706c 6163 656d 656e 7420 6461   displacement da
-00009db0: 7461 7365 742e 2053 6565 2074 6865 2064  taset. See the d
-00009dc0: 6f63 7374 7269 6e67 0a20 2020 2020 2020  ocstring.       
-00009dd0: 206f 6620 6461 7461 7365 7420 6162 6f75   of dataset abou
-00009de0: 7420 7479 7065 7320 3120 616e 6420 3220  t types 1 and 2 
-00009df0: 666f 7220 7468 6520 6469 7370 6c61 6365  for the displace
-00009e00: 6d65 6e74 2064 6174 6173 6574 2066 6f72  ment dataset for
-00009e10: 6d61 7473 2e0a 2020 2020 2020 2020 4469  mats..        Di
-00009e20: 7370 6c61 6365 6d65 6e74 7320 7365 7420  splacements set 
-00009e30: 7265 7475 726e 6564 2064 6570 656e 6473  returned depends
-00009e40: 206f 6e20 6569 7468 6572 2074 7970 652d   on either type-
-00009e50: 3120 6f72 2074 7970 652d 3220 6173 0a20  1 or type-2 as. 
-00009e60: 2020 2020 2020 2066 6f6c 6c6f 7773 3a0a         follows:.
-00009e70: 0a20 2020 2020 2020 2054 7970 652d 312c  .        Type-1,
-00009e80: 204c 6973 7420 6f66 206c 6973 740a 2020   List of list.  
-00009e90: 2020 2020 2020 2020 2020 5468 6520 696e            The in
-00009ea0: 7465 726e 616c 206c 6973 7420 6861 7320  ternal list has 
-00009eb0: 3420 656c 656d 656e 7473 2073 7563 6820  4 elements such 
-00009ec0: 6173 205b 3332 2c20 302e 3031 2c20 302e  as [32, 0.01, 0.
-00009ed0: 302c 2030 2e30 5d5d 2e0a 2020 2020 2020  0, 0.0]]..      
-00009ee0: 2020 2020 2020 5468 6520 6669 7273 7420        The first 
-00009ef0: 656c 656d 656e 7420 6973 2074 6865 2073  element is the s
-00009f00: 7570 6572 6365 6c6c 2061 746f 6d20 696e  upercell atom in
-00009f10: 6465 7820 7374 6172 7469 6e67 2077 6974  dex starting wit
-00009f20: 6820 302e 0a20 2020 2020 2020 2020 2020  h 0..           
-00009f30: 2054 6865 2072 656d 6169 6e69 6e67 2074   The remaining t
-00009f40: 6872 6565 2065 6c65 6d65 6e74 7320 6769  hree elements gi
-00009f50: 7665 2074 6865 2064 6973 706c 6163 656d  ve the displacem
-00009f60: 656e 7420 696e 2043 6172 7465 7369 616e  ent in Cartesian
-00009f70: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
-00009f80: 7264 696e 6174 6573 2e0a 2020 2020 2020  rdinates..      
-00009f90: 2020 5479 7065 2d32 2c20 6172 7261 795f    Type-2, array_
-00009fa0: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
-00009fb0: 2044 6973 706c 6163 656d 656e 7473 206f   Displacements o
-00009fc0: 6620 616c 6c20 6174 6f6d 7320 6f66 2061  f all atoms of a
-00009fd0: 6c6c 2073 7570 6572 6365 6c6c 7320 696e  ll supercells in
-00009fe0: 2043 6172 7465 7369 616e 0a20 2020 2020   Cartesian.     
-00009ff0: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
-0000a000: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
-0000a010: 7368 6170 653d 2873 7570 6572 6365 6c6c  shape=(supercell
-0000a020: 732c 206e 6174 6f6d 2c20 3329 0a20 2020  s, natom, 3).   
-0000a030: 2020 2020 2020 2020 2064 7479 7065 3d27           dtype='
-0000a040: 646f 7562 6c65 270a 0a0a 2020 2020 2020  double'...      
-0000a050: 2020 466f 7220 7365 7474 6572 2c20 6f6e    For setter, on
-0000a060: 6c79 2074 7970 652d 3220 6461 7461 7365  ly type-2 datase
-0000a070: 7420 666f 726d 6174 2069 7320 616c 6c6f  t format is allo
-0000a080: 7765 642e 0a0a 2020 2020 2020 2020 6469  wed...        di
-0000a090: 7370 6c61 6365 6d65 6e74 7320 3a20 6172  splacements : ar
-0000a0a0: 7261 795f 6c69 6b65 0a20 2020 2020 2020  ray_like.       
-0000a0b0: 2020 2020 2041 746f 6d69 6320 6469 7370       Atomic disp
-0000a0c0: 6c61 6365 6d65 6e74 7320 6f66 2061 6c6c  lacements of all
-0000a0d0: 2061 746f 6d73 206f 6620 616c 6c20 7375   atoms of all su
-0000a0e0: 7065 7263 656c 6c73 2e0a 2020 2020 2020  percells..      
-0000a0f0: 2020 2020 2020 4f6e 6c79 2061 6c6c 2064        Only all d
-0000a100: 6973 706c 6163 656d 656e 7473 2069 6e20  isplacements in 
-0000a110: 6561 6368 2073 7570 6572 6365 6c6c 2063  each supercell c
-0000a120: 6173 6520 2874 7970 652d 3229 2069 730a  ase (type-2) is.
-0000a130: 2020 2020 2020 2020 2020 2020 7375 7070              supp
-0000a140: 6f72 7465 642e 0a20 2020 2020 2020 2020  orted..         
-0000a150: 2020 2073 6861 7065 3d28 7375 7065 7263     shape=(superc
-0000a160: 656c 6c73 2c20 6e61 746f 6d2c 2033 292c  ells, natom, 3),
-0000a170: 2064 7479 7065 3d27 646f 7562 6c65 272c   dtype='double',
-0000a180: 206f 7264 6572 3d27 4327 0a0a 2020 2020   order='C'..    
-0000a190: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000a1a0: 6966 2073 656c 662e 5f70 686f 6e6f 6e5f  if self._phonon_
-0000a1b0: 6461 7461 7365 7420 6973 204e 6f6e 653a  dataset is None:
-0000a1c0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000a1d0: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
-0000a1e0: 2270 686f 6e6f 6e5f 6469 7370 6c61 6365  "phonon_displace
-0000a1f0: 6d65 6e74 5f64 6174 6173 6574 2064 6f65  ment_dataset doe
-0000a200: 7320 6e6f 7420 6578 6973 742e 2229 0a0a  s not exist.")..
-0000a210: 2020 2020 2020 2020 6461 7461 7365 7420          dataset 
-0000a220: 3d20 7365 6c66 2e5f 7068 6f6e 6f6e 5f64  = self._phonon_d
-0000a230: 6174 6173 6574 0a20 2020 2020 2020 2069  ataset.        i
-0000a240: 6620 2266 6972 7374 5f61 746f 6d73 2220  f "first_atoms" 
-0000a250: 696e 2064 6174 6173 6574 3a0a 2020 2020  in dataset:.    
-0000a260: 2020 2020 2020 2020 6e75 6d5f 7363 656c          num_scel
-0000a270: 6c73 203d 206c 656e 2864 6174 6173 6574  ls = len(dataset
-0000a280: 5b22 6669 7273 745f 6174 6f6d 7322 5d29  ["first_atoms"])
-0000a290: 0a20 2020 2020 2020 2020 2020 206e 6174  .            nat
-0000a2a0: 6f6d 203d 206c 656e 2873 656c 662e 5f70  om = len(self._p
-0000a2b0: 686f 6e6f 6e5f 7375 7065 7263 656c 6c29  honon_supercell)
-0000a2c0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-0000a2d0: 706c 6163 656d 656e 7473 203d 206e 702e  placements = np.
-0000a2e0: 7a65 726f 7328 286e 756d 5f73 6365 6c6c  zeros((num_scell
-0000a2f0: 732c 206e 6174 6f6d 2c20 3329 2c20 6474  s, natom, 3), dt
-0000a300: 7970 653d 2264 6f75 626c 6522 2c20 6f72  ype="double", or
-0000a310: 6465 723d 2243 2229 0a20 2020 2020 2020  der="C").       
-0000a320: 2020 2020 2066 6f72 2069 2c20 6469 7370       for i, disp
-0000a330: 3120 696e 2065 6e75 6d65 7261 7465 2864  1 in enumerate(d
-0000a340: 6174 6173 6574 5b22 6669 7273 745f 6174  ataset["first_at
-0000a350: 6f6d 7322 5d29 3a0a 2020 2020 2020 2020  oms"]):.        
-0000a360: 2020 2020 2020 2020 6469 7370 6c61 6365          displace
-0000a370: 6d65 6e74 735b 692c 2064 6973 7031 5b22  ments[i, disp1["
-0000a380: 6e75 6d62 6572 225d 5d20 3d20 6469 7370  number"]] = disp
-0000a390: 315b 2264 6973 706c 6163 656d 656e 7422  1["displacement"
-0000a3a0: 5d0a 2020 2020 2020 2020 656c 6966 2022  ].        elif "
-0000a3b0: 666f 7263 6573 2220 696e 2064 6174 6173  forces" in datas
-0000a3c0: 6574 206f 7220 2264 6973 706c 6163 656d  et or "displacem
-0000a3d0: 656e 7473 2220 696e 2064 6174 6173 6574  ents" in dataset
-0000a3e0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-0000a3f0: 7370 6c61 6365 6d65 6e74 7320 3d20 6461  splacements = da
-0000a400: 7461 7365 745b 2264 6973 706c 6163 656d  taset["displacem
-0000a410: 656e 7473 225d 0a20 2020 2020 2020 2065  ents"].        e
-0000a420: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000a430: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
-0000a440: 726f 7228 2264 6973 706c 6163 656d 656e  ror("displacemen
-0000a450: 7420 6461 7461 7365 7420 6861 7320 7772  t dataset has wr
-0000a460: 6f6e 6720 666f 726d 6174 2e22 290a 0a20  ong format.").. 
-0000a470: 2020 2020 2020 2072 6574 7572 6e20 6469         return di
-0000a480: 7370 6c61 6365 6d65 6e74 730a 0a20 2020  splacements..   
-0000a490: 2040 7068 6f6e 6f6e 5f64 6973 706c 6163   @phonon_displac
-0000a4a0: 656d 656e 7473 2e73 6574 7465 720a 2020  ements.setter.  
-0000a4b0: 2020 6465 6620 7068 6f6e 6f6e 5f64 6973    def phonon_dis
-0000a4c0: 706c 6163 656d 656e 7473 2873 656c 662c  placements(self,
-0000a4d0: 2064 6973 706c 6163 656d 656e 7473 293a   displacements):
-0000a4e0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0000a4f0: 2e5f 7068 6f6e 6f6e 5f64 6174 6173 6574  ._phonon_dataset
-0000a500: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000a510: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
-0000a520: 696d 6545 7272 6f72 2822 7068 6f6e 6f6e  imeError("phonon
-0000a530: 5f64 6973 706c 6163 656d 656e 745f 6461  _displacement_da
-0000a540: 7461 7365 7420 646f 6573 206e 6f74 2065  taset does not e
-0000a550: 7869 7374 2e22 290a 0a20 2020 2020 2020  xist.")..       
-0000a560: 2064 6973 7073 203d 206e 702e 6172 7261   disps = np.arra
-0000a570: 7928 6469 7370 6c61 6365 6d65 6e74 732c  y(displacements,
-0000a580: 2064 7479 7065 3d22 646f 7562 6c65 222c   dtype="double",
-0000a590: 206f 7264 6572 3d22 4322 290a 2020 2020   order="C").    
-0000a5a0: 2020 2020 6e61 746f 6d20 3d20 6c65 6e28      natom = len(
-0000a5b0: 7365 6c66 2e5f 7068 6f6e 6f6e 5f73 7570  self._phonon_sup
-0000a5c0: 6572 6365 6c6c 290a 2020 2020 2020 2020  ercell).        
-0000a5d0: 6966 2064 6973 7073 2e6e 6469 6d20 213d  if disps.ndim !=
-0000a5e0: 2033 206f 7220 6469 7370 732e 7368 6170   3 or disps.shap
-0000a5f0: 655b 313a 5d20 213d 2028 6e61 746f 6d2c  e[1:] != (natom,
-0000a600: 2033 293a 0a20 2020 2020 2020 2020 2020   3):.           
-0000a610: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
-0000a620: 726f 7228 2241 7272 6179 2073 6861 7065  ror("Array shape
-0000a630: 206f 6620 6469 7370 6c61 6365 6d65 6e74   of displacement
-0000a640: 7320 6973 2069 6e63 6f72 7265 6374 2e22  s is incorrect."
-0000a650: 290a 2020 2020 2020 2020 6966 2022 6669  ).        if "fi
-0000a660: 7273 745f 6174 6f6d 7322 2069 6e20 7365  rst_atoms" in se
-0000a670: 6c66 2e5f 7068 6f6e 6f6e 5f64 6174 6173  lf._phonon_datas
-0000a680: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
-0000a690: 7261 6973 6520 5275 6e74 696d 6545 7272  raise RuntimeErr
-0000a6a0: 6f72 2822 4469 7370 6c61 6365 6d65 6e74  or("Displacement
-0000a6b0: 7320 6172 6520 696e 636f 6d70 6174 6962  s are incompatib
-0000a6c0: 6c65 2077 6974 6820 6461 7461 7365 742e  le with dataset.
-0000a6d0: 2229 0a0a 2020 2020 2020 2020 7365 6c66  ")..        self
-0000a6e0: 2e5f 7068 6f6e 6f6e 5f64 6174 6173 6574  ._phonon_dataset
-0000a6f0: 5b22 6469 7370 6c61 6365 6d65 6e74 7322  ["displacements"
-0000a700: 5d20 3d20 6469 7370 730a 2020 2020 2020  ] = disps.      
-0000a710: 2020 7365 6c66 2e5f 7068 6f6e 6f6e 5f73    self._phonon_s
-0000a720: 7570 6572 6365 6c6c 735f 7769 7468 5f64  upercells_with_d
-0000a730: 6973 706c 6163 656d 656e 7473 203d 204e  isplacements = N
-0000a740: 6f6e 650a 0a20 2020 2040 7072 6f70 6572  one..    @proper
-0000a750: 7479 0a20 2020 2064 6566 2070 686f 6e6f  ty.    def phono
-0000a760: 6e5f 666f 7263 6573 2873 656c 6629 3a0a  n_forces(self):.
-0000a770: 2020 2020 2020 2020 2222 2253 6574 7465          """Sette
-0000a780: 7220 616e 6420 6765 7474 6572 206f 6620  r and getter of 
-0000a790: 666f 7263 6573 2069 6e20 6469 7370 6c61  forces in displa
-0000a7a0: 6365 6d65 6e74 2064 6174 6173 6574 2066  cement dataset f
-0000a7b0: 6f72 2066 6332 2e0a 0a20 2020 2020 2020  or fc2...       
-0000a7c0: 2041 2073 6574 206f 6620 6174 6f6d 6963   A set of atomic
-0000a7d0: 2066 6f72 6365 7320 696e 2064 6973 706c   forces in displ
-0000a7e0: 6163 6564 2073 7570 6572 6365 6c6c 732e  aced supercells.
-0000a7f0: 2054 6865 206f 7264 6572 206f 660a 2020   The order of.  
-0000a800: 2020 2020 2020 6469 7370 6c61 6365 6420        displaced 
-0000a810: 7375 7065 7263 656c 6c73 2068 6173 2074  supercells has t
-0000a820: 6f20 6d61 7463 6820 7769 7468 2074 6861  o match with tha
-0000a830: 7420 696e 2070 686f 6e6f 6e20 6469 7370  t in phonon disp
-0000a840: 6c61 6365 6d65 6e74 0a20 2020 2020 2020  lacement.       
-0000a850: 2064 6174 6173 6574 2e0a 2020 2020 2020   dataset..      
-0000a860: 2020 7368 6170 653d 2864 6973 706c 6163    shape=(displac
-0000a870: 6564 2073 7570 6572 6365 6c6c 732c 2061  ed supercells, a
-0000a880: 746f 6d73 2069 6e20 7375 7065 7263 656c  toms in supercel
-0000a890: 6c2c 2033 290a 0a20 2020 2020 2020 2067  l, 3)..        g
-0000a8a0: 6574 7465 7220 3a20 6e64 6172 7261 790a  etter : ndarray.
-0000a8b0: 0a20 2020 2020 2020 2073 6574 7465 7220  .        setter 
-0000a8c0: 3a20 6172 7261 795f 6c69 6b65 0a20 2020  : array_like.   
-0000a8d0: 2020 2020 2020 2020 2054 6865 206f 7264           The ord
-0000a8e0: 6572 206f 6620 7375 7065 7263 656c 6c73  er of supercells
-0000a8f0: 2075 7365 6420 666f 7220 6361 6c63 756c   used for calcul
-0000a900: 6174 696e 6720 666f 7263 6573 2068 6173  ating forces has
-0000a910: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
-0000a920: 6265 2074 6865 2073 616d 6520 6f72 6465  be the same orde
-0000a930: 7220 6f66 2070 686f 6e6f 6e5f 7375 7065  r of phonon_supe
-0000a940: 7263 656c 6c73 5f77 6974 685f 6469 7370  rcells_with_disp
-0000a950: 6c61 6365 6d65 6e74 732e 0a0a 2020 2020  lacements...    
-0000a960: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000a970: 6966 2073 656c 662e 5f70 686f 6e6f 6e5f  if self._phonon_
-0000a980: 6461 7461 7365 7420 6973 204e 6f6e 653a  dataset is None:
-0000a990: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000a9a0: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
-0000a9b0: 2270 686f 6e6f 6e5f 6469 7370 6c61 6365  "phonon_displace
-0000a9c0: 6d65 6e74 5f64 6174 6173 6574 2064 6f65  ment_dataset doe
-0000a9d0: 7320 6e6f 7420 6578 6973 742e 2229 0a0a  s not exist.")..
-0000a9e0: 2020 2020 2020 2020 6461 7461 7365 7420          dataset 
-0000a9f0: 3d20 7365 6c66 2e5f 7068 6f6e 6f6e 5f64  = self._phonon_d
-0000aa00: 6174 6173 6574 0a20 2020 2020 2020 2069  ataset.        i
-0000aa10: 6620 2266 6f72 6365 7322 2069 6e20 6461  f "forces" in da
-0000aa20: 7461 7365 743a 0a20 2020 2020 2020 2020  taset:.         
-0000aa30: 2020 2072 6574 7572 6e20 6461 7461 7365     return datase
-0000aa40: 745b 2266 6f72 6365 7322 5d0a 2020 2020  t["forces"].    
-0000aa50: 2020 2020 656c 6966 2022 6669 7273 745f      elif "first_
-0000aa60: 6174 6f6d 7322 2069 6e20 6461 7461 7365  atoms" in datase
-0000aa70: 743a 0a20 2020 2020 2020 2020 2020 206e  t:.            n
-0000aa80: 756d 5f73 6365 6c6c 7320 3d20 6c65 6e28  um_scells = len(
-0000aa90: 6461 7461 7365 745b 2266 6972 7374 5f61  dataset["first_a
-0000aaa0: 746f 6d73 225d 290a 2020 2020 2020 2020  toms"]).        
-0000aab0: 2020 2020 666f 7263 6573 203d 206e 702e      forces = np.
-0000aac0: 7a65 726f 7328 0a20 2020 2020 2020 2020  zeros(.         
-0000aad0: 2020 2020 2020 2028 6e75 6d5f 7363 656c         (num_scel
-0000aae0: 6c73 2c20 7365 6c66 2e5f 7068 6f6e 6f6e  ls, self._phonon
-0000aaf0: 5f73 7570 6572 6365 6c6c 2e67 6574 5f6e  _supercell.get_n
-0000ab00: 756d 6265 725f 6f66 5f61 746f 6d73 2829  umber_of_atoms()
-0000ab10: 2c20 3329 2c0a 2020 2020 2020 2020 2020  , 3),.          
-0000ab20: 2020 2020 2020 6474 7970 653d 2264 6f75        dtype="dou
-0000ab30: 626c 6522 2c0a 2020 2020 2020 2020 2020  ble",.          
-0000ab40: 2020 2020 2020 6f72 6465 723d 2243 222c        order="C",
-0000ab50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000ab60: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0000ab70: 2c20 6469 7370 3120 696e 2065 6e75 6d65  , disp1 in enume
-0000ab80: 7261 7465 2864 6174 6173 6574 5b22 6669  rate(dataset["fi
-0000ab90: 7273 745f 6174 6f6d 7322 5d29 3a0a 2020  rst_atoms"]):.  
-0000aba0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000abb0: 7263 6573 5b69 5d20 3d20 6469 7370 315b  rces[i] = disp1[
-0000abc0: 2266 6f72 6365 7322 5d0a 2020 2020 2020  "forces"].      
-0000abd0: 2020 2020 2020 7265 7475 726e 2066 6f72        return for
-0000abe0: 6365 730a 2020 2020 2020 2020 656c 7365  ces.        else
-0000abf0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000ac00: 6973 6520 5275 6e74 696d 6545 7272 6f72  ise RuntimeError
-0000ac10: 2822 6469 7370 6c61 6365 6d65 6e74 2064  ("displacement d
-0000ac20: 6174 6173 6574 2068 6173 2077 726f 6e67  ataset has wrong
-0000ac30: 2066 6f72 6d61 742e 2229 0a0a 2020 2020   format.")..    
-0000ac40: 4070 686f 6e6f 6e5f 666f 7263 6573 2e73  @phonon_forces.s
-0000ac50: 6574 7465 720a 2020 2020 6465 6620 7068  etter.    def ph
-0000ac60: 6f6e 6f6e 5f66 6f72 6365 7328 7365 6c66  onon_forces(self
-0000ac70: 2c20 666f 7263 6573 5f66 6332 293a 0a20  , forces_fc2):. 
-0000ac80: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000ac90: 7068 6f6e 6f6e 5f64 6174 6173 6574 2069  phonon_dataset i
-0000aca0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0000acb0: 2020 2020 7261 6973 6520 5275 6e74 696d      raise Runtim
-0000acc0: 6545 7272 6f72 2822 7068 6f6e 6f6e 5f64  eError("phonon_d
-0000acd0: 6973 706c 6163 656d 656e 745f 6461 7461  isplacement_data
-0000ace0: 7365 7420 646f 6573 206e 6f74 2065 7869  set does not exi
-0000acf0: 7374 2e22 290a 0a20 2020 2020 2020 2066  st.")..        f
-0000ad00: 6f72 6365 7320 3d20 6e70 2e61 7272 6179  orces = np.array
-0000ad10: 2866 6f72 6365 735f 6663 322c 2064 7479  (forces_fc2, dty
-0000ad20: 7065 3d22 646f 7562 6c65 222c 206f 7264  pe="double", ord
-0000ad30: 6572 3d22 4322 290a 2020 2020 2020 2020  er="C").        
-0000ad40: 6461 7461 7365 7420 3d20 7365 6c66 2e5f  dataset = self._
-0000ad50: 7068 6f6e 6f6e 5f64 6174 6173 6574 0a20  phonon_dataset. 
-0000ad60: 2020 2020 2020 2069 6620 2266 6972 7374         if "first
-0000ad70: 5f61 746f 6d73 2220 696e 2064 6174 6173  _atoms" in datas
-0000ad80: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
-0000ad90: 6920 3d20 300a 2020 2020 2020 2020 2020  i = 0.          
-0000ada0: 2020 666f 7220 692c 2064 6973 7031 2069    for i, disp1 i
-0000adb0: 6e20 656e 756d 6572 6174 6528 6461 7461  n enumerate(data
-0000adc0: 7365 745b 2266 6972 7374 5f61 746f 6d73  set["first_atoms
-0000add0: 225d 293a 0a20 2020 2020 2020 2020 2020  "]):.           
-0000ade0: 2020 2020 2064 6973 7031 5b22 666f 7263       disp1["forc
-0000adf0: 6573 225d 203d 2066 6f72 6365 735b 695d  es"] = forces[i]
-0000ae00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ae10: 2069 202b 3d20 310a 2020 2020 2020 2020   i += 1.        
-0000ae20: 656c 6966 2022 6469 7370 6c61 6365 6d65  elif "displaceme
-0000ae30: 6e74 7322 2069 6e20 6461 7461 7365 7420  nts" in dataset 
-0000ae40: 6f72 2022 666f 7263 6573 2220 696e 2064  or "forces" in d
-0000ae50: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-0000ae60: 2020 2020 6461 7461 7365 745b 2266 6f72      dataset["for
-0000ae70: 6365 7322 5d20 3d20 666f 7263 6573 0a0a  ces"] = forces..
-0000ae80: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000ae90: 2020 6465 6620 7068 7068 5f69 6e74 6572    def phph_inter
-0000aea0: 6163 7469 6f6e 2873 656c 6629 3a0a 2020  action(self):.  
-0000aeb0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-0000aec0: 496e 7465 7261 6374 696f 6e20 696e 7374  Interaction inst
-0000aed0: 616e 6365 2e22 2222 0a20 2020 2020 2020  ance.""".       
-0000aee0: 2072 6574 7572 6e20 7365 6c66 2e5f 696e   return self._in
-0000aef0: 7465 7261 6374 696f 6e0a 0a20 2020 2064  teraction..    d
-0000af00: 6566 2067 6574 5f70 6870 685f 696e 7465  ef get_phph_inte
-0000af10: 7261 6374 696f 6e28 7365 6c66 293a 0a20  raction(self):. 
-0000af20: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000af30: 2049 6e74 6572 6163 7469 6f6e 2069 6e73   Interaction ins
-0000af40: 7461 6e63 652e 2222 220a 2020 2020 2020  tance.""".      
-0000af50: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0000af60: 0a20 2020 2020 2020 2020 2020 2022 5068  .            "Ph
-0000af70: 6f6e 6f33 7079 2e67 6574 5f70 6870 685f  ono3py.get_phph_
-0000af80: 696e 7465 7261 6374 696f 6e28 2920 6973  interaction() is
-0000af90: 2064 6570 7265 6361 7465 642e 220a 2020   deprecated.".  
-0000afa0: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
-0000afb0: 686f 6e6f 3370 792e 7068 7068 5f69 6e74  hono3py.phph_int
-0000afc0: 6572 6163 7469 6f6e 2061 7474 7269 6275  eraction attribu
-0000afd0: 7465 2069 6e73 7465 6164 2e22 2c0a 2020  te instead.",.  
-0000afe0: 2020 2020 2020 2020 2020 4465 7072 6563            Deprec
-0000aff0: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
-0000b000: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000b010: 7265 7475 726e 2073 656c 662e 7068 7068  return self.phph
-0000b020: 5f69 6e74 6572 6163 7469 6f6e 0a0a 2020  _interaction..  
-0000b030: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000b040: 6465 6620 6465 7461 696c 6564 5f67 616d  def detailed_gam
-0000b050: 6d61 7328 7365 6c66 293a 0a20 2020 2020  mas(self):.     
-0000b060: 2020 2022 2222 5265 7475 726e 2064 6574     """Return det
-0000b070: 6169 6c65 6420 6761 6d6d 612e 2222 220a  ailed gamma.""".
-0000b080: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000b090: 656c 662e 5f64 6574 6169 6c65 645f 6761  elf._detailed_ga
-0000b0a0: 6d6d 6173 0a0a 2020 2020 4070 726f 7065  mmas..    @prope
-0000b0b0: 7274 790a 2020 2020 6465 6620 6772 6964  rty.    def grid
-0000b0c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000b0d0: 2222 2252 6574 7572 6e20 4272 696c 6c6f  """Return Brillo
-0000b0e0: 7569 6e20 7a6f 6e65 2067 7269 6420 696e  uin zone grid in
-0000b0f0: 666f 726d 6174 696f 6e2e 0a0a 2020 2020  formation...    
-0000b100: 2020 2020 425a 4772 6964 0a20 2020 2020      BZGrid.     
-0000b110: 2020 2020 2020 2041 6e20 696e 7374 616e         An instan
-0000b120: 6365 206f 6620 425a 4772 6964 2075 7365  ce of BZGrid use
-0000b130: 6420 666f 7220 656e 7469 7265 2070 686f  d for entire pho
-0000b140: 6e6f 3370 7920 6361 6c63 756c 6174 696f  no3py calculatio
-0000b150: 6e2e 0a0a 2020 2020 2020 2020 2222 220a  n...        """.
-0000b160: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000b170: 656c 662e 5f62 7a5f 6772 6964 0a0a 2020  elf._bz_grid..  
-0000b180: 2020 6465 6620 696e 6974 5f70 6870 685f    def init_phph_
-0000b190: 696e 7465 7261 6374 696f 6e28 0a20 2020  interaction(.   
-0000b1a0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000b1b0: 2020 206e 6163 5f71 5f64 6972 6563 7469     nac_q_directi
-0000b1c0: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
-0000b1d0: 2063 6f6e 7374 616e 745f 6176 6572 6167   constant_averag
-0000b1e0: 6564 5f69 6e74 6572 6163 7469 6f6e 3d4e  ed_interaction=N
-0000b1f0: 6f6e 652c 0a20 2020 2020 2020 2066 7265  one,.        fre
-0000b200: 7175 656e 6379 5f73 6361 6c65 5f66 6163  quency_scale_fac
-0000b210: 746f 723d 4e6f 6e65 2c0a 2020 2020 2020  tor=None,.      
-0000b220: 2020 7379 6d6d 6574 7269 7a65 5f66 6333    symmetrize_fc3
-0000b230: 713d 4661 6c73 652c 0a20 2020 2020 2020  q=False,.       
-0000b240: 206d 616b 655f 7230 5f61 7665 7261 6765   make_r0_average
-0000b250: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0000b260: 6c61 7061 636b 5f7a 6865 6576 5f75 706c  lapack_zheev_upl
-0000b270: 6f3d 224c 222c 0a20 2020 2020 2020 206f  o="L",.        o
-0000b280: 7065 6e6d 705f 7065 725f 7472 6970 6c65  penmp_per_triple
-0000b290: 7473 3d4e 6f6e 652c 0a20 2020 2029 3a0a  ts=None,.    ):.
-0000b2a0: 2020 2020 2020 2020 2222 2249 6e69 7469          """Initi
-0000b2b0: 616c 697a 6520 7068 2d70 6820 696e 7465  alize ph-ph inte
-0000b2c0: 7261 6374 696f 6e20 6361 6c63 756c 6174  raction calculat
-0000b2d0: 696f 6e2e 0a0a 2020 2020 2020 2020 5468  ion...        Th
-0000b2e0: 6973 206d 6574 686f 6420 6372 6561 7465  is method create
-0000b2f0: 7320 616e 2069 6e73 7461 6e63 6520 6f66  s an instance of
-0000b300: 2049 6e74 6572 6163 7469 6f6e 2063 6c61   Interaction cla
-0000b310: 7373 2c20 7768 6963 680a 2020 2020 2020  ss, which.      
-0000b320: 2020 6973 206e 6563 6573 7361 7279 2074    is necessary t
-0000b330: 6f20 7275 6e20 7068 2d70 6820 696e 7465  o run ph-ph inte
-0000b340: 7261 6374 696f 6e20 6361 6c63 756c 6174  raction calculat
-0000b350: 696f 6e2e 0a20 2020 2020 2020 2054 6865  ion..        The
-0000b360: 2069 6e70 7574 2064 6174 6120 7375 6368   input data such
-0000b370: 2061 7320 6772 6964 732c 2066 6f72 6365   as grids, force
-0000b380: 2063 6f6e 7374 616e 7473 2c20 6574 632c   constants, etc,
-0000b390: 2061 7265 0a20 2020 2020 2020 2073 746f   are.        sto
-0000b3a0: 7265 6420 746f 2062 6520 7265 6164 7920  red to be ready 
-0000b3b0: 666f 7220 7468 6520 6361 6c63 756c 6174  for the calculat
-0000b3c0: 696f 6e2e 0a0a 2020 2020 2020 2020 4e6f  ion...        No
-0000b3d0: 7465 0a20 2020 2020 2020 202d 2d2d 2d0a  te.        ----.
-0000b3e0: 2020 2020 2020 2020 6663 3320 616e 6420          fc3 and 
-0000b3f0: 6663 322c 2061 6e64 206f 7074 696f 6e61  fc2, and optiona
-0000b400: 6c6c 7920 6e61 635f 7061 7261 6d73 2068  lly nac_params h
-0000b410: 6176 6520 746f 2062 6520 7365 7420 6265  ave to be set be
-0000b420: 666f 7265 2063 616c 6c69 6e67 0a20 2020  fore calling.   
-0000b430: 2020 2020 2074 6869 7320 6d65 7468 6f64       this method
-0000b440: 2e20 6663 3320 616e 6420 6663 3220 6361  . fc3 and fc2 ca
-0000b450: 6e20 6265 206d 6164 6520 6569 7468 6572  n be made either
-0000b460: 2066 726f 6d20 7365 7473 206f 6620 666f   from sets of fo
-0000b470: 7263 6573 0a20 2020 2020 2020 2061 6e64  rces.        and
-0000b480: 2064 6973 706c 6163 656d 656e 7473 206f   displacements o
-0000b490: 6620 7375 7065 7263 656c 6c73 206f 7220  f supercells or 
-0000b4a0: 6265 2073 6574 2073 696d 706c 7920 7669  be set simply vi
-0000b4b0: 6120 6174 7472 6962 7574 6573 2e0a 0a20  a attributes... 
-0000b4c0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000b4d0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0000b4e0: 2d2d 2d2d 0a20 2020 2020 2020 206e 6163  ----.        nac
-0000b4f0: 5f71 5f64 6972 6563 7469 6f6e 203a 2061  _q_direction : a
-0000b500: 7272 6179 5f6c 696b 652c 206f 7074 696f  rray_like, optio
-0000b510: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0000b520: 4469 7265 6374 696f 6e20 6f66 2071 2d76  Direction of q-v
-0000b530: 6563 746f 7220 7761 7463 6869 6e67 2066  ector watching f
-0000b540: 726f 6d20 4761 6d6d 6120 706f 696e 7420  rom Gamma point 
-0000b550: 7573 6564 2066 6f72 0a20 2020 2020 2020  used for.       
-0000b560: 2020 2020 206e 6f6e 2d61 6e61 6c79 7469       non-analyti
-0000b570: 6361 6c20 7465 726d 2063 6f72 7265 6374  cal term correct
-0000b580: 696f 6e2e 2054 6869 7320 6973 2065 6666  ion. This is eff
-0000b590: 6563 7469 7665 206f 6e6c 7920 6174 2071  ective only at q
-0000b5a0: 3d30 0a20 2020 2020 2020 2020 2020 2028  =0.            (
-0000b5b0: 7068 7973 6963 616c 6c79 2071 2d3e 3029  physically q->0)
-0000b5c0: 2e20 5468 6520 6469 7265 6374 696f 6e20  . The direction 
-0000b5d0: 6973 2067 6976 656e 2069 6e20 6372 7973  is given in crys
-0000b5e0: 7461 6c6c 6f67 7261 7068 6963 0a20 2020  tallographic.   
-0000b5f0: 2020 2020 2020 2020 2028 6672 6163 7469           (fracti
-0000b600: 6f6e 616c 2920 636f 6f72 6469 6e61 7465  onal) coordinate
-0000b610: 732e 0a20 2020 2020 2020 2020 2020 2073  s..            s
-0000b620: 6861 7065 3d28 332c 292c 2064 7479 7065  hape=(3,), dtype
-0000b630: 3d27 646f 7562 6c65 272e 0a20 2020 2020  ='double'..     
-0000b640: 2020 2020 2020 2044 6566 6175 6c74 2076         Default v
-0000b650: 616c 7565 2069 7320 4e6f 6e65 2c20 7768  alue is None, wh
-0000b660: 6963 6820 6d65 616e 7320 7468 6973 2066  ich means this f
-0000b670: 6561 7475 7265 2069 7320 6e6f 7420 7573  eature is not us
-0000b680: 6564 2e0a 2020 2020 2020 2020 636f 6e73  ed..        cons
-0000b690: 7461 6e74 5f61 7665 7261 6765 645f 696e  tant_averaged_in
-0000b6a0: 7465 7261 6374 696f 6e20 3a20 666c 6f61  teraction : floa
-0000b6b0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-0000b6c0: 2020 2020 2020 2020 5068 2d70 6820 696e          Ph-ph in
-0000b6d0: 7465 7261 6374 696f 6e20 7374 7265 6e67  teraction streng
-0000b6e0: 7468 2061 7272 6179 2069 7320 7265 706c  th array is repl
-0000b6f0: 6163 6564 2062 7920 6120 7363 616c 6172  aced by a scalar
-0000b700: 2076 616c 7565 2e0a 2020 2020 2020 2020   value..        
-0000b710: 2020 2020 4465 6661 756c 7420 6973 204e      Default is N
-0000b720: 6f6e 652c 2077 6869 6368 206d 6561 6e73  one, which means
-0000b730: 2074 6869 7320 6665 6174 7572 6520 6973   this feature is
-0000b740: 206e 6f74 2075 7365 642e 0a20 2020 2020   not used..     
-0000b750: 2020 2066 7265 7175 656e 6379 5f73 6361     frequency_sca
-0000b760: 6c65 5f66 6163 746f 7220 3a20 666c 6f61  le_factor : floa
-0000b770: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-0000b780: 2020 2020 2020 2020 416c 6c20 7068 6f6e          All phon
-0000b790: 6f6e 2066 7265 7175 656e 6365 7320 6172  on frequences ar
-0000b7a0: 6520 7363 616c 6564 2062 7920 7468 6973  e scaled by this
-0000b7b0: 2076 616c 7565 2e20 4465 6661 756c 7420   value. Default 
-0000b7c0: 6973 204e 6f6e 652c 0a20 2020 2020 2020  is None,.       
-0000b7d0: 2020 2020 2077 6869 6368 206d 6561 6e73       which means
-0000b7e0: 2070 686f 6e6f 6e20 6672 6571 7565 6e63   phonon frequenc
-0000b7f0: 6965 7320 6172 6520 6e6f 7420 7363 616c  ies are not scal
-0000b800: 6564 2e0a 2020 2020 2020 2020 7379 6d6d  ed..        symm
-0000b810: 6574 7269 7a65 5f66 6333 7120 3a20 626f  etrize_fc3q : bo
-0000b820: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
-0000b830: 2020 2020 2020 2020 2066 6333 2069 6e20           fc3 in 
-0000b840: 7068 6f6e 6f6e 2073 7061 6365 2069 7320  phonon space is 
-0000b850: 7379 6d6d 6574 7269 7a65 6420 6279 2070  symmetrized by p
-0000b860: 6572 6d75 7461 7469 6f6e 2073 796d 6d65  ermutation symme
-0000b870: 7472 792e 0a20 2020 2020 2020 2020 2020  try..           
-0000b880: 2044 6566 6175 6c74 2069 7320 4661 6c73   Default is Fals
-0000b890: 652e 0a20 2020 2020 2020 206d 616b 655f  e..        make_
-0000b8a0: 7230 5f61 7665 7261 6765 203a 2062 6f6f  r0_average : boo
-0000b8b0: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-0000b8c0: 2020 2020 2020 2020 6663 3320 7472 616e          fc3 tran
-0000b8d0: 7366 6f72 6d61 7469 6f6e 2066 726f 6d20  sformation from 
-0000b8e0: 7265 616c 2074 6f20 7265 6369 7072 6f63  real to reciproc
-0000b8f0: 616c 2073 7061 6365 2069 7320 646f 6e65  al space is done
-0000b900: 0a20 2020 2020 2020 2020 2020 2061 726f  .            aro
-0000b910: 756e 6420 7468 7265 6520 6174 6f6d 7320  und three atoms 
-0000b920: 616e 6420 6176 6572 6167 6564 2077 6865  and averaged whe
-0000b930: 6e20 5472 7565 2e20 4465 6661 756c 7420  n True. Default 
-0000b940: 6973 2046 616c 7365 2c20 692e 652e 2c0a  is False, i.e.,.
-0000b950: 2020 2020 2020 2020 2020 2020 6f6e 6c79              only
-0000b960: 2061 726f 756e 6420 7468 6520 6669 7273   around the firs
-0000b970: 7420 6174 6f6d 2e0a 2020 2020 2020 2020  t atom..        
-0000b980: 6c61 7061 636b 5f7a 6865 6576 5f75 706c  lapack_zheev_upl
-0000b990: 6f20 3a20 7374 722c 206f 7074 696f 6e61  o : str, optiona
-0000b9a0: 6c0a 2020 2020 2020 2020 2020 2020 274c  l.            'L
-0000b9b0: 2720 6f72 2027 5527 2e20 4465 6661 756c  ' or 'U'. Defaul
-0000b9c0: 7420 6973 2027 4c27 2e20 5468 6973 2069  t is 'L'. This i
-0000b9d0: 7320 7061 7373 6564 2074 6f20 4c41 5041  s passed to LAPA
-0000b9e0: 434b 207a 6865 6576 0a20 2020 2020 2020  CK zheev.       
-0000b9f0: 2020 2020 2075 7365 6420 666f 7220 7068       used for ph
-0000ba00: 6f6e 6f6e 2073 6f6c 7665 722e 0a20 2020  onon solver..   
-0000ba10: 2020 2020 206f 7065 6e6d 705f 7065 725f       openmp_per_
-0000ba20: 7472 6970 6c65 7473 203a 2062 6f6f 6c20  triplets : bool 
-0000ba30: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
-0000ba40: 6c2c 2064 6566 6175 6c74 2069 7320 4e6f  l, default is No
-0000ba50: 6e65 0a20 2020 2020 2020 2020 2020 204e  ne.            N
-0000ba60: 6f72 6d61 6c6c 7920 7468 6973 2070 6172  ormally this par
-0000ba70: 616d 6574 6572 2073 686f 756c 6420 6e6f  ameter should no
-0000ba80: 7420 6265 2074 6f75 6368 6564 2e0a 2020  t be touched..  
-0000ba90: 2020 2020 2020 2020 2020 5768 656e 2060            When `
-0000baa0: 5472 7565 602c 2070 682d 7068 2069 6e74  True`, ph-ph int
-0000bab0: 6572 6163 7469 6f6e 2073 7472 656e 6774  eraction strengt
-0000bac0: 6820 6361 6c63 756c 6174 696f 6e20 7275  h calculation ru
-0000bad0: 6e73 2077 6974 680a 2020 2020 2020 2020  ns with.        
-0000bae0: 2020 2020 4f70 656e 4d50 2064 6973 7472      OpenMP distr
-0000baf0: 6962 7574 696f 6e20 6f76 6572 2074 7269  ibution over tri
-0000bb00: 706c 6574 732c 2061 6e64 206f 7665 7220  plets, and over 
-0000bb10: 6261 6e64 7320 7768 656e 2060 4661 6c73  bands when `Fals
-0000bb20: 6560 2e0a 2020 2020 2020 2020 2020 2020  e`..            
-0000bb30: 604e 6f6e 6560 2077 696c 6c20 6368 6f6f  `None` will choo
-0000bb40: 7365 206f 6e65 206f 6620 7468 656d 2061  se one of them a
-0000bb50: 7574 6f6d 6174 6963 616c 6c79 2e0a 0a20  utomatically... 
-0000bb60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000bb70: 2020 2069 6620 7365 6c66 2e6d 6573 685f     if self.mesh_
-0000bb80: 6e75 6d62 6572 7320 6973 204e 6f6e 653a  numbers is None:
-0000bb90: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-0000bba0: 203d 2022 5068 6f6e 6f33 7079 2e6d 6573   = "Phono3py.mes
-0000bbb0: 685f 6e75 6d62 6572 7320 6f66 2069 6e73  h_numbers of ins
-0000bbc0: 7461 6e63 6520 6861 7320 746f 2062 6520  tance has to be 
-0000bbd0: 7365 742e 220a 2020 2020 2020 2020 2020  set.".          
-0000bbe0: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
-0000bbf0: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
-0000bc00: 2020 2069 6620 7365 6c66 2e5f 6663 3220     if self._fc2 
-0000bc10: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000bc20: 2020 2020 206d 7367 203d 2022 5068 6f6e       msg = "Phon
-0000bc30: 6f33 7079 2e66 6332 206f 6620 696e 7374  o3py.fc2 of inst
-0000bc40: 616e 6365 2069 7320 6e6f 7420 666f 756e  ance is not foun
-0000bc50: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
-0000bc60: 7261 6973 6520 5275 6e74 696d 6545 7272  raise RuntimeErr
-0000bc70: 6f72 286d 7367 290a 0a20 2020 2020 2020  or(msg)..       
-0000bc80: 2069 6620 7365 6c66 2e5f 7379 6d6d 6574   if self._symmet
-0000bc90: 7269 7a65 5f66 6333 7120 6973 204e 6f6e  rize_fc3q is Non
-0000bca0: 653a 0a20 2020 2020 2020 2020 2020 205f  e:.            _
-0000bcb0: 7379 6d6d 6574 7269 7a65 5f66 6333 7120  symmetrize_fc3q 
-0000bcc0: 3d20 7379 6d6d 6574 7269 7a65 5f66 6333  = symmetrize_fc3
-0000bcd0: 710a 2020 2020 2020 2020 656c 7365 3a0a  q.        else:.
-0000bce0: 2020 2020 2020 2020 2020 2020 5f73 796d              _sym
-0000bcf0: 6d65 7472 697a 655f 6663 3371 203d 2073  metrize_fc3q = s
-0000bd00: 656c 662e 5f73 796d 6d65 7472 697a 655f  elf._symmetrize_
-0000bd10: 6663 3371 0a0a 2020 2020 2020 2020 6966  fc3q..        if
-0000bd20: 2073 656c 662e 5f6c 6170 6163 6b5f 7a68   self._lapack_zh
-0000bd30: 6565 765f 7570 6c6f 2069 7320 4e6f 6e65  eev_uplo is None
-0000bd40: 3a0a 2020 2020 2020 2020 2020 2020 5f6c  :.            _l
-0000bd50: 6170 6163 6b5f 7a68 6565 765f 7570 6c6f  apack_zheev_uplo
-0000bd60: 203d 206c 6170 6163 6b5f 7a68 6565 765f   = lapack_zheev_
-0000bd70: 7570 6c6f 0a20 2020 2020 2020 2065 6c73  uplo.        els
-0000bd80: 653a 0a20 2020 2020 2020 2020 2020 205f  e:.            _
-0000bd90: 6c61 7061 636b 5f7a 6865 6576 5f75 706c  lapack_zheev_upl
-0000bda0: 6f20 3d20 7365 6c66 2e5f 6c61 7061 636b  o = self._lapack
-0000bdb0: 5f7a 6865 6576 5f75 706c 6f0a 0a20 2020  _zheev_uplo..   
-0000bdc0: 2020 2020 2073 656c 662e 5f69 6e74 6572       self._inter
-0000bdd0: 6163 7469 6f6e 203d 2049 6e74 6572 6163  action = Interac
-0000bde0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-0000bdf0: 2020 7365 6c66 2e5f 7072 696d 6974 6976    self._primitiv
-0000be00: 652c 0a20 2020 2020 2020 2020 2020 2073  e,.            s
-0000be10: 656c 662e 5f62 7a5f 6772 6964 2c0a 2020  elf._bz_grid,.  
-0000be20: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000be30: 7072 696d 6974 6976 655f 7379 6d6d 6574  primitive_symmet
-0000be40: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-0000be50: 6663 333d 7365 6c66 2e5f 6663 332c 0a20  fc3=self._fc3,. 
-0000be60: 2020 2020 2020 2020 2020 2062 616e 645f             band_
-0000be70: 696e 6469 6365 733d 7365 6c66 2e5f 6261  indices=self._ba
-0000be80: 6e64 5f69 6e64 6963 6573 5f66 6c61 7474  nd_indices_flatt
-0000be90: 656e 2c0a 2020 2020 2020 2020 2020 2020  en,.            
-0000bea0: 636f 6e73 7461 6e74 5f61 7665 7261 6765  constant_average
-0000beb0: 645f 696e 7465 7261 6374 696f 6e3d 636f  d_interaction=co
-0000bec0: 6e73 7461 6e74 5f61 7665 7261 6765 645f  nstant_averaged_
-0000bed0: 696e 7465 7261 6374 696f 6e2c 0a20 2020  interaction,.   
-0000bee0: 2020 2020 2020 2020 2066 7265 7175 656e           frequen
-0000bef0: 6379 5f66 6163 746f 725f 746f 5f54 487a  cy_factor_to_THz
-0000bf00: 3d73 656c 662e 5f66 7265 7175 656e 6379  =self._frequency
-0000bf10: 5f66 6163 746f 725f 746f 5f54 487a 2c0a  _factor_to_THz,.
-0000bf20: 2020 2020 2020 2020 2020 2020 6672 6571              freq
-0000bf30: 7565 6e63 795f 7363 616c 655f 6661 6374  uency_scale_fact
-0000bf40: 6f72 3d66 7265 7175 656e 6379 5f73 6361  or=frequency_sca
-0000bf50: 6c65 5f66 6163 746f 722c 0a20 2020 2020  le_factor,.     
-0000bf60: 2020 2020 2020 2063 7574 6f66 665f 6672         cutoff_fr
-0000bf70: 6571 7565 6e63 793d 7365 6c66 2e5f 6375  equency=self._cu
-0000bf80: 746f 6666 5f66 7265 7175 656e 6379 2c0a  toff_frequency,.
-0000bf90: 2020 2020 2020 2020 2020 2020 6973 5f6d              is_m
-0000bfa0: 6573 685f 7379 6d6d 6574 7279 3d73 656c  esh_symmetry=sel
-0000bfb0: 662e 5f69 735f 6d65 7368 5f73 796d 6d65  f._is_mesh_symme
-0000bfc0: 7472 792c 0a20 2020 2020 2020 2020 2020  try,.           
-0000bfd0: 2073 796d 6d65 7472 697a 655f 6663 3371   symmetrize_fc3q
-0000bfe0: 3d5f 7379 6d6d 6574 7269 7a65 5f66 6333  =_symmetrize_fc3
-0000bff0: 712c 0a20 2020 2020 2020 2020 2020 206d  q,.            m
-0000c000: 616b 655f 7230 5f61 7665 7261 6765 3d6d  ake_r0_average=m
-0000c010: 616b 655f 7230 5f61 7665 7261 6765 2c0a  ake_r0_average,.
-0000c020: 2020 2020 2020 2020 2020 2020 6c61 7061              lapa
-0000c030: 636b 5f7a 6865 6576 5f75 706c 6f3d 5f6c  ck_zheev_uplo=_l
-0000c040: 6170 6163 6b5f 7a68 6565 765f 7570 6c6f  apack_zheev_uplo
-0000c050: 2c0a 2020 2020 2020 2020 2020 2020 6f70  ,.            op
-0000c060: 656e 6d70 5f70 6572 5f74 7269 706c 6574  enmp_per_triplet
-0000c070: 733d 6f70 656e 6d70 5f70 6572 5f74 7269  s=openmp_per_tri
-0000c080: 706c 6574 732c 0a20 2020 2020 2020 2029  plets,.        )
-0000c090: 0a20 2020 2020 2020 2073 656c 662e 5f69  .        self._i
-0000c0a0: 6e74 6572 6163 7469 6f6e 2e6e 6163 5f71  nteraction.nac_q
-0000c0b0: 5f64 6972 6563 7469 6f6e 203d 206e 6163  _direction = nac
-0000c0c0: 5f71 5f64 6972 6563 7469 6f6e 0a20 2020  _q_direction.   
-0000c0d0: 2020 2020 2073 656c 662e 5f69 6e69 745f       self._init_
-0000c0e0: 6479 6e61 6d69 6361 6c5f 6d61 7472 6978  dynamical_matrix
-0000c0f0: 2829 0a0a 2020 2020 6465 6620 7365 745f  ()..    def set_
-0000c100: 7068 6f6e 6f6e 5f64 6174 6128 7365 6c66  phonon_data(self
-0000c110: 2c20 6672 6571 7565 6e63 6965 732c 2065  , frequencies, e
-0000c120: 6967 656e 7665 6374 6f72 732c 2067 7269  igenvectors, gri
-0000c130: 645f 6164 6472 6573 7329 3a0a 2020 2020  d_address):.    
-0000c140: 2020 2020 2222 2253 6574 2070 686f 6e6f      """Set phono
-0000c150: 6e20 6672 6571 7565 6e63 6965 7320 616e  n frequencies an
-0000c160: 6420 6569 6765 6e76 6563 746f 7273 2069  d eigenvectors i
-0000c170: 6e20 496e 7465 7261 6374 696f 6e20 696e  n Interaction in
-0000c180: 7374 616e 6365 2e0a 0a20 2020 2020 2020  stance...       
-0000c190: 2048 6172 6d6f 6e69 6320 7068 6f6e 6f6e   Harmonic phonon
-0000c1a0: 2069 6e66 6f72 6d61 7469 6f6e 2069 7320   information is 
-0000c1b0: 7374 6f72 6564 2069 6e20 496e 7465 7261  stored in Intera
-0000c1c0: 6374 696f 6e20 696e 7374 616e 6365 2e20  ction instance. 
-0000c1d0: 466f 720a 2020 2020 2020 2020 6578 616d  For.        exam
-0000c1e0: 706c 652c 2074 6869 7320 696e 666f 726d  ple, this inform
-0000c1f0: 6174 696f 6e20 7374 6f72 6520 696e 2061  ation store in a
-0000c200: 2066 696c 6520 6973 2072 6561 6420 616e   file is read an
-0000c210: 6420 7061 7373 6564 2074 6f0a 2020 2020  d passed to.    
-0000c220: 2020 2020 5068 6f6e 6f33 7079 2069 6e73      Phono3py ins
-0000c230: 7461 6e63 6520 6279 2075 7369 6e67 2074  tance by using t
-0000c240: 6869 7320 6d65 7468 6f64 2e20 5468 6520  his method. The 
-0000c250: 6772 6964 5f61 6464 7265 7373 2069 7320  grid_address is 
-0000c260: 7573 6564 0a20 2020 2020 2020 2066 6f72  used.        for
-0000c270: 2074 6865 2063 6f6e 7369 7374 656e 6379   the consistency
-0000c280: 2063 6865 636b 2e0a 0a20 2020 2020 2020   check...       
-0000c290: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000c2a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0000c2b0: 2020 2020 2020 2066 7265 7175 656e 6369         frequenci
-0000c2c0: 6573 203a 2061 7272 6179 5f6c 696b 650a  es : array_like.
-0000c2d0: 2020 2020 2020 2020 2020 2020 5068 6f6e              Phon
-0000c2e0: 6f6e 2066 7265 7175 656e 6369 6573 2e0a  on frequencies..
-0000c2f0: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-0000c300: 653d 286e 756d 5f67 7269 645f 706f 696e  e=(num_grid_poin
-0000c310: 7473 2c20 6e75 6d5f 6261 6e64 292c 2064  ts, num_band), d
-0000c320: 7479 7065 3d27 646f 7562 6c65 272c 206f  type='double', o
-0000c330: 7264 6572 3d27 4327 0a20 2020 2020 2020  rder='C'.       
-0000c340: 2065 6967 656e 7665 6374 6f72 7320 3a20   eigenvectors : 
-0000c350: 6172 7261 795f 6c69 6b65 0a20 2020 2020  array_like.     
-0000c360: 2020 2020 2020 2050 686f 6e6f 6e20 6569         Phonon ei
-0000c370: 6765 6e76 6563 746f 7273 0a20 2020 2020  genvectors.     
-0000c380: 2020 2020 2020 2073 6861 7065 3d28 6e75         shape=(nu
-0000c390: 6d5f 6772 6964 5f70 6f69 6e74 732c 206e  m_grid_points, n
-0000c3a0: 756d 5f62 616e 642c 206e 756d 5f62 616e  um_band, num_ban
-0000c3b0: 6429 0a20 2020 2020 2020 2020 2020 2064  d).            d
-0000c3c0: 7479 7065 3d27 636f 6d70 6c65 7831 3238  type='complex128
-0000c3d0: 272c 206f 7264 6572 3d27 4327 0a20 2020  ', order='C'.   
-0000c3e0: 2020 2020 2067 7269 645f 6164 6472 6573       grid_addres
-0000c3f0: 7320 3a20 6172 7261 795f 6c69 6b65 0a20  s : array_like. 
-0000c400: 2020 2020 2020 2020 2020 2047 7269 6420             Grid 
-0000c410: 706f 696e 7420 6164 6472 6573 7365 7320  point addresses 
-0000c420: 6279 2069 6e74 6567 6572 732e 2054 6865  by integers. The
-0000c430: 2066 6972 7374 2064 696d 656e 7369 6f6e   first dimension
-0000c440: 206d 6179 206e 6f74 2062 650a 2020 2020   may not be.    
-0000c450: 2020 2020 2020 2020 7072 6f64 286d 6573          prod(mes
-0000c460: 6829 2062 6563 6175 7365 2069 7420 696e  h) because it in
-0000c470: 636c 7564 6573 2042 7269 6c6c 6f75 696e  cludes Brillouin
-0000c480: 207a 6f6e 6520 626f 756e 6461 7279 2e20   zone boundary. 
-0000c490: 5468 6520 6465 7461 696c 0a20 2020 2020  The detail.     
-0000c4a0: 2020 2020 2020 2069 7320 666f 756e 6420         is found 
-0000c4b0: 696e 2074 6865 2064 6f63 7374 7269 6e67  in the docstring
-0000c4c0: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
-0000c4d0: 7068 6f6e 6f33 7079 2e70 686f 6e6f 6e33  phono3py.phonon3
-0000c4e0: 2e74 7269 706c 6574 732e 6765 745f 7472  .triplets.get_tr
-0000c4f0: 6970 6c65 7473 5f61 745f 712e 0a20 2020  iplets_at_q..   
-0000c500: 2020 2020 2020 2020 2073 6861 7065 3d28           shape=(
-0000c510: 6e75 6d5f 6772 6964 5f70 6f69 6e74 732c  num_grid_points,
-0000c520: 2033 292c 2064 7479 7065 3d69 6e74 0a0a   3), dtype=int..
-0000c530: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000c540: 2020 2020 6966 2073 656c 662e 5f69 6e74      if self._int
-0000c550: 6572 6163 7469 6f6e 2069 7320 6e6f 7420  eraction is not 
-0000c560: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000c570: 2020 7365 6c66 2e5f 696e 7465 7261 6374    self._interact
-0000c580: 696f 6e2e 7365 745f 7068 6f6e 6f6e 5f64  ion.set_phonon_d
-0000c590: 6174 6128 6672 6571 7565 6e63 6965 732c  ata(frequencies,
-0000c5a0: 2065 6967 656e 7665 6374 6f72 732c 2067   eigenvectors, g
-0000c5b0: 7269 645f 6164 6472 6573 7329 0a0a 2020  rid_address)..  
-0000c5c0: 2020 6465 6620 6765 745f 7068 6f6e 6f6e    def get_phonon
-0000c5d0: 5f64 6174 6128 7365 6c66 293a 0a20 2020  _data(self):.   
-0000c5e0: 2020 2020 2022 2222 4765 7420 7068 6f6e       """Get phon
-0000c5f0: 6f6e 2066 7265 7175 656e 6369 6573 2061  on frequencies a
-0000c600: 6e64 2065 6967 656e 7665 6374 6f72 7320  nd eigenvectors 
-0000c610: 696e 2049 6e74 6572 6163 7469 6f6e 2069  in Interaction i
-0000c620: 6e73 7461 6e63 652e 0a0a 2020 2020 2020  nstance...      
-0000c630: 2020 4861 726d 6f6e 6963 2070 686f 6e6f    Harmonic phono
-0000c640: 6e20 696e 666f 726d 6174 696f 6e20 6973  n information is
-0000c650: 2073 746f 7265 6420 696e 2049 6e74 6572   stored in Inter
-0000c660: 6163 7469 6f6e 2069 6e73 7461 6e63 652e  action instance.
-0000c670: 2054 6869 730a 2020 2020 2020 2020 696e   This.        in
-0000c680: 666f 726d 6174 696f 6e20 6361 6e20 6265  formation can be
-0000c690: 206f 6274 6169 6e65 642e 2054 6865 2067   obtained. The g
-0000c6a0: 7269 645f 6164 6472 6573 7320 7265 7475  rid_address retu
-0000c6b0: 726e 6564 2067 6976 6520 7468 650a 2020  rned give the.  
-0000c6c0: 2020 2020 2020 712d 706f 696e 7473 206c        q-points l
-0000c6d0: 6f63 6174 696f 6e73 2077 6974 6820 7265  ocations with re
-0000c6e0: 7370 6563 7420 746f 2072 6563 6970 726f  spect to recipro
-0000c6f0: 6361 6c20 6261 7369 7320 7665 6374 6f72  cal basis vector
-0000c700: 7320 6279 0a20 2020 2020 2020 2069 6e74  s by.        int
-0000c710: 6567 6572 7320 696e 2074 6865 2077 6179  egers in the way
-0000c720: 2074 6861 740a 2020 2020 2020 2020 2020   that.          
-0000c730: 2020 715f 706f 696e 7473 203d 2067 7269    q_points = gri
-0000c740: 645f 6164 6472 6573 7320 2f20 6e70 2e61  d_address / np.a
-0000c750: 7272 6179 286d 6573 682c 2064 7479 7065  rray(mesh, dtype
-0000c760: 3d27 646f 7562 6c65 2729 2e0a 0a20 2020  ='double')...   
-0000c770: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-0000c780: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-0000c790: 2020 2020 2074 7570 6c65 0a20 2020 2020       tuple.     
-0000c7a0: 2020 2020 2020 2028 6672 6571 7565 6e63         (frequenc
-0000c7b0: 6965 732c 2065 6967 656e 7665 6374 6f72  ies, eigenvector
-0000c7c0: 732c 2067 7269 645f 6164 6472 6573 7329  s, grid_address)
-0000c7d0: 0a20 2020 2020 2020 2020 2020 2053 6565  .            See
-0000c7e0: 206d 6f72 6520 6465 7461 696c 7320 6174   more details at
-0000c7f0: 2074 6865 2064 6f63 7374 7269 6e67 206f   the docstring o
-0000c800: 6620 7365 745f 7068 6f6e 6f6e 5f64 6174  f set_phonon_dat
-0000c810: 612e 0a0a 2020 2020 2020 2020 2222 220a  a...        """.
-0000c820: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000c830: 5f69 6e74 6572 6163 7469 6f6e 2069 7320  _interaction is 
-0000c840: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000c850: 2020 2020 2020 6672 6571 732c 2065 6967        freqs, eig
-0000c860: 7665 6373 2c20 5f20 3d20 7365 6c66 2e5f  vecs, _ = self._
-0000c870: 696e 7465 7261 6374 696f 6e2e 6765 745f  interaction.get_
-0000c880: 7068 6f6e 6f6e 7328 290a 2020 2020 2020  phonons().      
-0000c890: 2020 2020 2020 7265 7475 726e 2066 7265        return fre
-0000c8a0: 7173 2c20 6569 6776 6563 732c 2073 656c  qs, eigvecs, sel
-0000c8b0: 662e 5f69 6e74 6572 6163 7469 6f6e 2e62  f._interaction.b
-0000c8c0: 7a5f 6772 6964 2e61 6464 7265 7373 6573  z_grid.addresses
-0000c8d0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000c8e0: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
-0000c8f0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0000c900: 2020 2022 5068 6f6e 6f33 7079 2e69 6e69     "Phono3py.ini
-0000c910: 745f 7068 7068 5f69 6e74 6572 6163 7469  t_phph_interacti
-0000c920: 6f6e 2068 6173 2074 6f20 6265 2063 616c  on has to be cal
-0000c930: 6c65 6420 220a 2020 2020 2020 2020 2020  led ".          
-0000c940: 2020 2020 2020 2262 6566 6f72 6520 7275        "before ru
-0000c950: 6e6e 696e 6720 7468 6973 206d 6574 686f  nning this metho
-0000c960: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
-0000c970: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
-0000c980: 6973 6520 5275 6e74 696d 6545 7272 6f72  ise RuntimeError
-0000c990: 286d 7367 290a 0a20 2020 2064 6566 2072  (msg)..    def r
-0000c9a0: 756e 5f70 686f 6e6f 6e5f 736f 6c76 6572  un_phonon_solver
-0000c9b0: 2873 656c 662c 2067 7269 645f 706f 696e  (self, grid_poin
-0000c9c0: 7473 3d4e 6f6e 6529 3a0a 2020 2020 2020  ts=None):.      
-0000c9d0: 2020 2222 2252 756e 2068 6172 6d6f 6e69    """Run harmoni
-0000c9e0: 6320 7068 6f6e 6f6e 2063 616c 6375 6c61  c phonon calcula
-0000c9f0: 7469 6f6e 206f 6e20 6772 6964 2070 6f69  tion on grid poi
-0000ca00: 6e74 732e 0a0a 2020 2020 2020 2020 5061  nts...        Pa
-0000ca10: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0000ca20: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0000ca30: 2020 2020 6772 6964 5f70 6f69 6e74 7320      grid_points 
-0000ca40: 3a20 6172 7261 795f 6c69 6b65 206f 7220  : array_like or 
-0000ca50: 4e6f 6e65 2c20 6f70 7469 6f6e 616c 0a20  None, optional. 
-0000ca60: 2020 2020 2020 2020 2020 2041 206c 6973             A lis
-0000ca70: 7420 6f66 2067 7269 6420 706f 696e 7420  t of grid point 
-0000ca80: 696e 6469 6365 7320 6f66 2050 686f 6e6f  indices of Phono
-0000ca90: 3370 792e 6772 6964 2e61 6464 7265 7373  3py.grid.address
-0000caa0: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
-0000cab0: 5370 6563 6966 7969 6e67 204e 6f6e 6520  Specifying None 
-0000cac0: 7275 6e73 2061 6c6c 2070 686f 6e6f 6e73  runs all phonons
-0000cad0: 206f 6e20 7468 6520 6772 6964 2070 6f69   on the grid poi
-0000cae0: 6e74 7320 756e 6c65 7373 0a20 2020 2020  nts unless.     
-0000caf0: 2020 2020 2020 2074 686f 7365 2070 686f         those pho
-0000cb00: 6e6f 6e73 2077 6572 6520 616c 7265 6164  nons were alread
-0000cb10: 7920 6361 6c63 756c 6174 6564 2e20 4e6f  y calculated. No
-0000cb20: 726d 616c 6c79 2070 686f 6e6f 6e73 2061  rmally phonons a
-0000cb30: 740a 2020 2020 2020 2020 2020 2020 5b30  t.            [0
-0000cb40: 2c20 302c 2030 5d20 706f 696e 7420 6973  , 0, 0] point is
-0000cb50: 2061 6c72 6561 6479 2063 616c 6375 6c61   already calcula
-0000cb60: 7465 6420 6265 666f 7265 2063 616c 6c69  ted before calli
-0000cb70: 6e67 2074 6869 7320 6d65 7468 6f64 2e0a  ng this method..
-0000cb80: 2020 2020 2020 2020 2020 2020 5068 6f6e              Phon
-0000cb90: 6f6e 2063 616c 6375 6c61 7469 6f6e 7320  on calculations 
-0000cba0: 6172 6520 7065 7266 6f72 6d65 6420 6175  are performed au
-0000cbb0: 746f 6d61 7469 6361 6c6c 7920 7768 656e  tomatically when
-0000cbc0: 206e 6565 6465 640a 2020 2020 2020 2020   needed.        
-0000cbd0: 2020 2020 696e 7465 726e 616c 6c79 2066      internally f
-0000cbe0: 6f72 2070 682d 7068 2063 616c 6375 6c61  or ph-ph calcula
-0000cbf0: 7469 6f6e 2e20 5468 6572 6566 6f72 6520  tion. Therefore 
-0000cc00: 6361 6c6c 696e 6720 7468 6973 206d 6574  calling this met
-0000cc10: 686f 640a 2020 2020 2020 2020 2020 2020  hod.            
-0000cc20: 6973 206e 6f74 206e 6563 6573 7361 7279  is not necessary
-0000cc30: 2069 6e20 6d6f 7374 2063 6173 6573 2e0a   in most cases..
-0000cc40: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0000cc50: 7068 6f6e 6f6e 2072 6573 756c 7473 2061  phonon results a
-0000cc60: 7265 206f 6274 6169 6e65 6420 6279 2050  re obtained by P
-0000cc70: 686f 6e6f 3370 792e 6765 745f 7068 6f6e  hono3py.get_phon
-0000cc80: 6f6e 5f64 6174 6128 292e 0a0a 2020 2020  on_data()...    
-0000cc90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000cca0: 6966 2073 656c 662e 5f69 6e74 6572 6163  if self._interac
-0000ccb0: 7469 6f6e 2069 7320 6e6f 7420 4e6f 6e65  tion is not None
-0000ccc0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000ccd0: 6c66 2e5f 696e 7465 7261 6374 696f 6e2e  lf._interaction.
-0000cce0: 7275 6e5f 7068 6f6e 6f6e 5f73 6f6c 7665  run_phonon_solve
-0000ccf0: 7228 6772 6964 5f70 6f69 6e74 733d 6772  r(grid_points=gr
-0000cd00: 6964 5f70 6f69 6e74 7329 0a20 2020 2020  id_points).     
-0000cd10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000cd20: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
-0000cd30: 2020 2020 2020 2020 2020 2020 2022 5068               "Ph
-0000cd40: 6f6e 6f33 7079 2e69 6e69 745f 7068 7068  ono3py.init_phph
-0000cd50: 5f69 6e74 6572 6163 7469 6f6e 2068 6173  _interaction has
-0000cd60: 2074 6f20 6265 2063 616c 6c65 6420 220a   to be called ".
-0000cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd80: 2262 6566 6f72 6520 7275 6e6e 696e 6720  "before running 
-0000cd90: 7468 6973 206d 6574 686f 642e 220a 2020  this method.".  
-0000cda0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000cdb0: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
-0000cdc0: 6e74 696d 6545 7272 6f72 286d 7367 290a  ntimeError(msg).
-0000cdd0: 0a20 2020 2064 6566 2067 656e 6572 6174  .    def generat
-0000cde0: 655f 6469 7370 6c61 6365 6d65 6e74 7328  e_displacements(
-0000cdf0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000ce00: 2020 2020 2020 2064 6973 7461 6e63 653d         distance=
-0000ce10: 302e 3033 2c0a 2020 2020 2020 2020 6375  0.03,.        cu
-0000ce20: 746f 6666 5f70 6169 725f 6469 7374 616e  toff_pair_distan
-0000ce30: 6365 3d4e 6f6e 652c 0a20 2020 2020 2020  ce=None,.       
-0000ce40: 2069 735f 706c 7573 6d69 6e75 733d 2261   is_plusminus="a
-0000ce50: 7574 6f22 2c0a 2020 2020 2020 2020 6973  uto",.        is
-0000ce60: 5f64 6961 676f 6e61 6c3d 5472 7565 2c0a  _diagonal=True,.
-0000ce70: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-0000ce80: 2222 4765 6e65 7261 7465 2064 6973 706c  ""Generate displ
-0000ce90: 6163 656d 656e 7420 6461 7461 7365 7420  acement dataset 
-0000cea0: 696e 2073 7570 6572 6365 6c6c 2066 6f72  in supercell for
-0000ceb0: 2066 6333 2e0a 0a20 2020 2020 2020 2054   fc3...        T
-0000cec0: 6869 7320 7379 7374 656d 6174 6963 616c  his systematical
-0000ced0: 6c79 2067 656e 6572 6174 6573 2073 696e  ly generates sin
-0000cee0: 676c 6520 616e 6420 7061 6972 2061 746f  gle and pair ato
-0000cef0: 6d69 6320 6469 7370 6c61 6365 6d65 6e74  mic displacement
-0000cf00: 730a 2020 2020 2020 2020 696e 2073 7570  s.        in sup
-0000cf10: 6572 6365 6c6c 7320 746f 2063 616c 6375  ercells to calcu
-0000cf20: 6c61 7465 2066 6333 2063 6f6e 7369 6465  late fc3 conside
-0000cf30: 7269 6e67 2063 7279 7374 616c 2073 796d  ring crystal sym
-0000cf40: 6d65 7472 792e 0a20 2020 2020 2020 2057  metry..        W
-0000cf50: 6865 6e20 7468 6973 206d 6574 686f 6420  hen this method 
-0000cf60: 6973 2063 616c 6c65 642c 2065 7869 7374  is called, exist
-0000cf70: 696e 6720 6361 6368 6520 6f66 2073 7570  ing cache of sup
-0000cf80: 6572 6365 6c6c 7320 7769 7468 0a20 2020  ercells with.   
-0000cf90: 2020 2020 2064 6973 706c 6163 656d 656e       displacemen
-0000cfa0: 7473 2066 6f72 2066 6333 2061 7265 2072  ts for fc3 are r
-0000cfb0: 656d 6f76 6564 2e0a 0a20 2020 2020 2020  emoved...       
-0000cfc0: 2046 6f72 2066 6333 2c20 7477 6f20 6174   For fc3, two at
-0000cfd0: 6f6d 7320 6172 6520 6469 7370 6c61 6365  oms are displace
-0000cfe0: 6420 666f 7220 6561 6368 2063 6f6e 6669  d for each confi
-0000cff0: 6775 7261 7469 6f6e 0a20 2020 2020 2020  guration.       
-0000d000: 2063 6f6e 7369 6465 7269 6e67 2063 7279   considering cry
-0000d010: 7374 616c 2073 796d 6d65 7472 792e 2054  stal symmetry. T
-0000d020: 6865 2066 6972 7374 2064 6973 706c 6163  he first displac
-0000d030: 656d 656e 7420 6973 2063 686f 7365 6e0a  ement is chosen.
-0000d040: 2020 2020 2020 2020 696e 2074 6865 2070          in the p
-0000d050: 6572 6665 6374 2073 7570 6572 6365 6c6c  erfect supercell
-0000d060: 2c20 616e 6420 7468 6520 7365 636f 6e64  , and the second
-0000d070: 2064 6973 706c 6163 656d 656e 7420 696e   displacement in
-0000d080: 2074 6865 0a20 2020 2020 2020 2064 6973   the.        dis
-0000d090: 706c 6163 6564 2073 7570 6572 6365 6c6c  placed supercell
-0000d0a0: 2e20 5468 6520 6669 7273 7420 6469 7370  . The first disp
-0000d0b0: 6c61 6365 6d65 6e74 7320 6172 6520 7461  lacements are ta
-0000d0c0: 6b65 6e20 616c 6f6e 670a 2020 2020 2020  ken along.      
-0000d0d0: 2020 7468 6520 6261 7369 7320 7665 6374    the basis vect
-0000d0e0: 6f72 7320 6f66 2074 6865 2073 7570 6572  ors of the super
-0000d0f0: 6365 6c6c 2e20 5468 6973 2069 7320 6265  cell. This is be
-0000d100: 6361 7573 6520 7468 650a 2020 2020 2020  cause the.      
-0000d110: 2020 7379 6d6d 6574 7279 2069 7320 6578    symmetry is ex
-0000d120: 7065 6374 6564 2074 6f20 6265 206c 6573  pected to be les
-0000d130: 7320 6272 6f6b 656e 2062 7920 7468 6520  s broken by the 
-0000d140: 696e 7472 6f64 7563 6564 2066 6972 7374  introduced first
-0000d150: 0a20 2020 2020 2020 2064 6973 706c 6163  .        displac
-0000d160: 656d 656e 742c 2061 6e64 2061 7320 7468  ement, and as th
-0000d170: 6520 7265 7375 6c74 2c20 7468 6520 6e75  e result, the nu
-0000d180: 6d62 6572 206f 6620 7365 636f 6e64 0a20  mber of second. 
-0000d190: 2020 2020 2020 2064 6973 706c 6163 656d         displacem
-0000d1a0: 656e 7473 206d 6179 2062 6563 6f6d 6520  ents may become 
-0000d1b0: 736d 616c 6c65 7220 7468 616e 2074 6865  smaller than the
-0000d1c0: 2063 6173 6520 7468 6174 2074 6865 2066   case that the f
-0000d1d0: 6972 7374 0a20 2020 2020 2020 2061 746f  irst.        ato
-0000d1e0: 6d20 6973 2064 6973 706c 6163 6564 206e  m is displaced n
-0000d1f0: 6f74 2061 6c6f 6e67 2074 6865 2062 6173  ot along the bas
-0000d200: 6973 2076 6563 746f 7273 2e0a 0a20 2020  is vectors...   
-0000d210: 2020 2020 204e 6f74 650a 2020 2020 2020       Note.      
-0000d220: 2020 2d2d 2d2d 0a20 2020 2020 2020 2057    ----.        W
-0000d230: 6865 6e20 7068 6f6e 6f6e 5f73 7570 6572  hen phonon_super
-0000d240: 6365 6c6c 5f6d 6174 7269 7820 6973 206e  cell_matrix is n
-0000d250: 6f74 2067 6976 656e 2c20 6663 3220 6973  ot given, fc2 is
-0000d260: 2061 6c73 6f0a 2020 2020 2020 2020 636f   also.        co
-0000d270: 6d70 7574 6564 2066 726f 6d20 7468 6520  mputed from the 
-0000d280: 7361 6d65 2073 6574 206f 6620 7468 6520  same set of the 
-0000d290: 6469 7370 6c61 6365 6d65 6e74 7320 666f  displacements fo
-0000d2a0: 7220 6663 3320 616e 640a 2020 2020 2020  r fc3 and.      
-0000d2b0: 2020 7265 7370 6563 7469 7665 2073 7570    respective sup
-0000d2c0: 6572 6365 6c6c 2066 6f72 6365 732e 2057  ercell forces. W
-0000d2d0: 6865 6e20 7068 6f6e 6f6e 5f73 7570 6572  hen phonon_super
-0000d2e0: 6365 6c6c 5f6d 6174 7269 7820 6973 0a20  cell_matrix is. 
-0000d2f0: 2020 2020 2020 2073 6574 2c20 7468 6520         set, the 
-0000d300: 6469 7370 6c61 6365 6d65 6e74 7320 696e  displacements in
-0000d310: 2070 686f 6e6f 6e5f 7375 7065 7263 656c   phonon_supercel
-0000d320: 6c20 6172 6520 6765 6e65 7261 7465 6420  l are generated 
-0000d330: 756e 6c65 7373 0a20 2020 2020 2020 2074  unless.        t
-0000d340: 686f 7365 2061 6c72 6561 6479 2065 7869  hose already exi
-0000d350: 7374 2e0a 0a20 2020 2020 2020 2050 6172  st...        Par
-0000d360: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0000d370: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000d380: 2020 2064 6973 7461 6e63 6520 3a20 666c     distance : fl
-0000d390: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
-0000d3a0: 2020 2020 2020 2020 2020 436f 6e73 7461            Consta
-0000d3b0: 6e74 2064 6973 706c 6163 656d 656e 7420  nt displacement 
-0000d3c0: 4575 636c 6964 6561 6e20 6469 7374 616e  Euclidean distan
-0000d3d0: 6365 2e20 4465 6661 756c 7420 6973 2030  ce. Default is 0
-0000d3e0: 2e30 332e 0a20 2020 2020 2020 2063 7574  .03..        cut
-0000d3f0: 6f66 665f 7061 6972 5f64 6973 7461 6e63  off_pair_distanc
-0000d400: 6520 3a20 666c 6f61 742c 206f 7074 696f  e : float, optio
-0000d410: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0000d420: 5468 6973 2069 7320 7573 6564 2061 7320  This is used as 
-0000d430: 6120 6375 746f 6666 2045 7563 6c69 6465  a cutoff Euclide
-0000d440: 616e 2064 6973 7461 6e63 6520 746f 2064  an distance to d
-0000d450: 6574 6572 6d69 6e65 2069 660a 2020 2020  etermine if.    
-0000d460: 2020 2020 2020 2020 6561 6368 2070 6169          each pai
-0000d470: 7220 6f66 2064 6973 706c 6163 656d 656e  r of displacemen
-0000d480: 7473 2069 7320 636f 6e73 6964 6572 6564  ts is considered
-0000d490: 2074 6f20 6361 6c63 756c 6174 6520 6663   to calculate fc
-0000d4a0: 3320 6f72 206e 6f74 2e0a 2020 2020 2020  3 or not..      
-0000d4b0: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
-0000d4c0: 204e 6f6e 652c 2077 6869 6368 206d 6561   None, which mea
-0000d4d0: 6e73 2063 7574 6f66 6620 6973 206e 6f74  ns cutoff is not
-0000d4e0: 2075 7365 642e 0a20 2020 2020 2020 2069   used..        i
-0000d4f0: 735f 706c 7573 6d69 6e75 7320 3a20 5472  s_plusminus : Tr
-0000d500: 7565 2c20 4661 6c73 652c 206f 7220 2761  ue, False, or 'a
-0000d510: 7574 6f27 2c20 6f70 7469 6f6e 616c 0a20  uto', optional. 
-0000d520: 2020 2020 2020 2020 2020 2057 6974 6820             With 
-0000d530: 5472 7565 2c20 6174 6f6d 6973 2061 7265  True, atomis are
-0000d540: 2064 6973 706c 6163 6564 2069 6e20 626f   displaced in bo
-0000d550: 7468 2070 6f73 6974 6976 6520 616e 6420  th positive and 
-0000d560: 6e65 6761 7469 7665 0a20 2020 2020 2020  negative.       
-0000d570: 2020 2020 2064 6972 6563 7469 6f6e 732e       directions.
-0000d580: 2057 6974 6820 4661 6c73 652c 206f 6e6c   With False, onl
-0000d590: 7920 6f6e 6520 6469 7265 6374 696f 6e2e  y one direction.
-0000d5a0: 2057 6974 6820 2761 7574 6f27 2c0a 2020   With 'auto',.  
-0000d5b0: 2020 2020 2020 2020 2020 6d6f 7374 6c79            mostly
-0000d5c0: 2065 7175 6976 616c 656e 7420 746f 2069   equivalent to i
-0000d5d0: 735f 706c 7573 6d69 6e75 733d 5472 7565  s_plusminus=True
-0000d5e0: 2c20 6275 7420 6f6e 6c79 206f 6e65 2064  , but only one d
-0000d5f0: 6972 6563 7469 6f6e 0a20 2020 2020 2020  irection.       
-0000d600: 2020 2020 2069 7320 6368 6f73 656e 2077       is chosen w
-0000d610: 6865 6e20 7468 6520 6469 7370 6c61 6365  hen the displace
-0000d620: 6d65 6e74 7320 696e 2062 6f74 6820 6469  ments in both di
-0000d630: 7265 6374 696f 6e73 2061 7265 0a20 2020  rections are.   
-0000d640: 2020 2020 2020 2020 2073 796d 6d65 7472           symmetr
-0000d650: 6963 616c 6c79 2065 7175 6976 616c 656e  ically equivalen
-0000d660: 742e 2044 6566 6175 6c74 2069 7320 2761  t. Default is 'a
-0000d670: 7574 6f27 2e0a 2020 2020 2020 2020 6973  uto'..        is
-0000d680: 5f64 6961 676f 6e61 6c20 3a20 426f 6f6c  _diagonal : Bool
-0000d690: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0000d6a0: 2020 2020 2020 2057 6974 6820 4661 6c73         With Fals
-0000d6b0: 652c 2074 6865 2073 6563 6f6e 6420 6469  e, the second di
-0000d6c0: 7370 6c61 6365 6d65 6e74 7320 6172 6520  splacements are 
-0000d6d0: 6d61 6465 2061 6c6f 6e67 2074 6865 2062  made along the b
-0000d6e0: 6173 6973 0a20 2020 2020 2020 2020 2020  asis.           
-0000d6f0: 2076 6563 746f 7273 206f 6620 7468 6520   vectors of the 
-0000d700: 7375 7065 7263 656c 6c2e 2057 6974 6820  supercell. With 
-0000d710: 5472 7565 2c20 6469 7265 6374 696f 6e20  True, direction 
-0000d720: 6e6f 7420 616c 6f6e 6720 7468 6520 6261  not along the ba
-0000d730: 7369 730a 2020 2020 2020 2020 2020 2020  sis.            
-0000d740: 7665 6374 6f72 7320 6361 6e20 6265 2063  vectors can be c
-0000d750: 686f 7365 6e20 7768 656e 2074 6865 206e  hosen when the n
-0000d760: 756d 6265 7220 6f66 2074 6865 2064 6973  umber of the dis
-0000d770: 706c 6163 656d 656e 7473 0a20 2020 2020  placements.     
-0000d780: 2020 2020 2020 206d 6179 2062 6520 7265         may be re
-0000d790: 6475 6365 642e 0a0a 2020 2020 2020 2020  duced...        
-0000d7a0: 2222 220a 2020 2020 2020 2020 6469 7265  """.        dire
-0000d7b0: 6374 696f 6e5f 6461 7461 7365 7420 3d20  ction_dataset = 
-0000d7c0: 6765 745f 7468 6972 645f 6f72 6465 725f  get_third_order_
-0000d7d0: 6469 7370 6c61 6365 6d65 6e74 7328 0a20  displacements(. 
-0000d7e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d7f0: 5f73 7570 6572 6365 6c6c 2c0a 2020 2020  _supercell,.    
-0000d800: 2020 2020 2020 2020 7365 6c66 2e5f 7379          self._sy
-0000d810: 6d6d 6574 7279 2c0a 2020 2020 2020 2020  mmetry,.        
-0000d820: 2020 2020 6973 5f70 6c75 736d 696e 7573      is_plusminus
-0000d830: 3d69 735f 706c 7573 6d69 6e75 732c 0a20  =is_plusminus,. 
-0000d840: 2020 2020 2020 2020 2020 2069 735f 6469             is_di
-0000d850: 6167 6f6e 616c 3d69 735f 6469 6167 6f6e  agonal=is_diagon
-0000d860: 616c 2c0a 2020 2020 2020 2020 290a 2020  al,.        ).  
-0000d870: 2020 2020 2020 7365 6c66 2e5f 6461 7461        self._data
-0000d880: 7365 7420 3d20 6469 7265 6374 696f 6e5f  set = direction_
-0000d890: 746f 5f64 6973 706c 6163 656d 656e 7428  to_displacement(
-0000d8a0: 0a20 2020 2020 2020 2020 2020 2064 6972  .            dir
-0000d8b0: 6563 7469 6f6e 5f64 6174 6173 6574 2c0a  ection_dataset,.
-0000d8c0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-0000d8d0: 616e 6365 2c0a 2020 2020 2020 2020 2020  ance,.          
-0000d8e0: 2020 7365 6c66 2e5f 7375 7065 7263 656c    self._supercel
-0000d8f0: 6c2c 0a20 2020 2020 2020 2020 2020 2063  l,.            c
-0000d900: 7574 6f66 665f 6469 7374 616e 6365 3d63  utoff_distance=c
-0000d910: 7574 6f66 665f 7061 6972 5f64 6973 7461  utoff_pair_dista
-0000d920: 6e63 652c 0a20 2020 2020 2020 2029 0a20  nce,.        ). 
-0000d930: 2020 2020 2020 2073 656c 662e 5f73 7570         self._sup
-0000d940: 6572 6365 6c6c 735f 7769 7468 5f64 6973  ercells_with_dis
-0000d950: 706c 6163 656d 656e 7473 203d 204e 6f6e  placements = Non
-0000d960: 650a 0a20 2020 2020 2020 2069 6620 7365  e..        if se
-0000d970: 6c66 2e5f 7068 6f6e 6f6e 5f73 7570 6572  lf._phonon_super
-0000d980: 6365 6c6c 5f6d 6174 7269 7820 6973 206e  cell_matrix is n
-0000d990: 6f74 204e 6f6e 6520 616e 6420 7365 6c66  ot None and self
-0000d9a0: 2e5f 7068 6f6e 6f6e 5f64 6174 6173 6574  ._phonon_dataset
-0000d9b0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000d9c0: 2020 2020 2020 7365 6c66 2e67 656e 6572        self.gener
-0000d9d0: 6174 655f 6663 325f 6469 7370 6c61 6365  ate_fc2_displace
-0000d9e0: 6d65 6e74 7328 0a20 2020 2020 2020 2020  ments(.         
-0000d9f0: 2020 2020 2020 2064 6973 7461 6e63 653d         distance=
-0000da00: 6469 7374 616e 6365 2c20 6973 5f70 6c75  distance, is_plu
-0000da10: 736d 696e 7573 3d69 735f 706c 7573 6d69  sminus=is_plusmi
-0000da20: 6e75 732c 2069 735f 6469 6167 6f6e 616c  nus, is_diagonal
-0000da30: 3d46 616c 7365 0a20 2020 2020 2020 2020  =False.         
-0000da40: 2020 2029 0a0a 2020 2020 6465 6620 6765     )..    def ge
-0000da50: 6e65 7261 7465 5f66 6332 5f64 6973 706c  nerate_fc2_displ
-0000da60: 6163 656d 656e 7473 280a 2020 2020 2020  acements(.      
-0000da70: 2020 7365 6c66 2c20 6469 7374 616e 6365    self, distance
-0000da80: 3d30 2e30 332c 2069 735f 706c 7573 6d69  =0.03, is_plusmi
-0000da90: 6e75 733d 2261 7574 6f22 2c20 6973 5f64  nus="auto", is_d
-0000daa0: 6961 676f 6e61 6c3d 4661 6c73 650a 2020  iagonal=False.  
-0000dab0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-0000dac0: 4765 6e65 7261 7465 2064 6973 706c 6163  Generate displac
-0000dad0: 656d 656e 7420 6461 7461 7365 7420 696e  ement dataset in
-0000dae0: 2070 686f 6e6f 6e20 7375 7065 7263 656c   phonon supercel
-0000daf0: 6c20 666f 7220 6663 322e 0a0a 2020 2020  l for fc2...    
-0000db00: 2020 2020 5468 6973 2073 7973 7465 6d61      This systema
-0000db10: 7469 6361 6c6c 7920 6765 6e65 7261 7465  tically generate
-0000db20: 7320 7369 6e67 6c65 2061 746f 6d69 6320  s single atomic 
-0000db30: 6469 7370 6c61 6365 6d65 6e74 730a 2020  displacements.  
-0000db40: 2020 2020 2020 696e 2073 7570 6572 6365        in superce
-0000db50: 6c6c 7320 746f 2063 616c 6375 6c61 7465  lls to calculate
-0000db60: 2070 686f 6e6f 6e5f 6663 3220 636f 6e73   phonon_fc2 cons
-0000db70: 6964 6572 696e 6720 6372 7973 7461 6c20  idering crystal 
-0000db80: 7379 6d6d 6574 7279 2e0a 2020 2020 2020  symmetry..      
-0000db90: 2020 5768 656e 2074 6869 7320 6d65 7468    When this meth
-0000dba0: 6f64 2069 7320 6361 6c6c 6564 2c20 6578  od is called, ex
-0000dbb0: 6973 7469 6e67 2063 6163 6865 206f 6620  isting cache of 
-0000dbc0: 7375 7065 7263 656c 6c73 2077 6974 680a  supercells with.
-0000dbd0: 2020 2020 2020 2020 6469 7370 6c61 6365          displace
-0000dbe0: 6d65 6e74 7320 666f 7220 6663 3220 6172  ments for fc2 ar
-0000dbf0: 6520 7265 6d6f 7665 642e 0a0a 2020 2020  e removed...    
-0000dc00: 2020 2020 4e6f 7465 0a20 2020 2020 2020      Note.       
-0000dc10: 202d 2d2d 2d0a 2020 2020 2020 2020 6973   ----.        is
-0000dc20: 5f64 6961 676f 6e61 6c3d 4661 6c73 6520  _diagonal=False 
-0000dc30: 6973 2063 686f 7365 6e20 6173 2074 6865  is chosen as the
-0000dc40: 2064 6566 6175 6c74 2073 6574 7469 6e67   default setting
-0000dc50: 2069 6e74 656e 7469 6f6e 616c 6c79 0a20   intentionally. 
-0000dc60: 2020 2020 2020 2074 6f20 6265 2063 6f6e         to be con
-0000dc70: 7369 7374 656e 7420 746f 2074 6865 2066  sistent to the f
-0000dc80: 6972 7374 2064 6973 706c 6163 656d 656e  irst displacemen
-0000dc90: 7473 206f 6620 7468 6520 6663 3320 7061  ts of the fc3 pa
-0000dca0: 6972 0a20 2020 2020 2020 2064 6973 706c  ir.        displ
-0000dcb0: 6163 656d 6574 7320 696e 2073 7570 6572  acemets in super
-0000dcc0: 6365 6c6c 2e0a 0a20 2020 2020 2020 2050  cell...        P
-0000dcd0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0000dce0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000dcf0: 2020 2020 2064 6973 7461 6e63 6520 3a20       distance : 
-0000dd00: 666c 6f61 742c 206f 7074 696f 6e61 6c0a  float, optional.
-0000dd10: 2020 2020 2020 2020 2020 2020 436f 6e73              Cons
-0000dd20: 7461 6e74 2064 6973 706c 6163 656d 656e  tant displacemen
-0000dd30: 7420 4575 636c 6964 6561 6e20 6469 7374  t Euclidean dist
-0000dd40: 616e 6365 2e20 4465 6661 756c 7420 6973  ance. Default is
-0000dd50: 2030 2e30 332e 0a20 2020 2020 2020 2069   0.03..        i
-0000dd60: 735f 706c 7573 6d69 6e75 7320 3a20 5472  s_plusminus : Tr
-0000dd70: 7565 2c20 4661 6c73 652c 206f 7220 2761  ue, False, or 'a
-0000dd80: 7574 6f27 2c20 6f70 7469 6f6e 616c 0a20  uto', optional. 
-0000dd90: 2020 2020 2020 2020 2020 2057 6974 6820             With 
-0000dda0: 5472 7565 2c20 6174 6f6d 6973 2061 7265  True, atomis are
-0000ddb0: 2064 6973 706c 6163 6564 2069 6e20 626f   displaced in bo
-0000ddc0: 7468 2070 6f73 6974 6976 6520 616e 6420  th positive and 
-0000ddd0: 6e65 6761 7469 7665 0a20 2020 2020 2020  negative.       
-0000dde0: 2020 2020 2064 6972 6563 7469 6f6e 732e       directions.
-0000ddf0: 2057 6974 6820 4661 6c73 652c 206f 6e6c   With False, onl
-0000de00: 7920 6f6e 6520 6469 7265 6374 696f 6e2e  y one direction.
-0000de10: 2057 6974 6820 2761 7574 6f27 2c0a 2020   With 'auto',.  
-0000de20: 2020 2020 2020 2020 2020 6d6f 7374 6c79            mostly
-0000de30: 2065 7175 6976 616c 656e 7420 746f 2069   equivalent to i
-0000de40: 735f 706c 7573 6d69 6e75 733d 5472 7565  s_plusminus=True
-0000de50: 2c20 6275 7420 6f6e 6c79 206f 6e65 2064  , but only one d
-0000de60: 6972 6563 7469 6f6e 0a20 2020 2020 2020  irection.       
-0000de70: 2020 2020 2069 7320 6368 6f73 656e 2077       is chosen w
-0000de80: 6865 6e20 7468 6520 6469 7370 6c61 6365  hen the displace
-0000de90: 6d65 6e74 7320 696e 2062 6f74 6820 6469  ments in both di
-0000dea0: 7265 6374 696f 6e73 2061 7265 0a20 2020  rections are.   
-0000deb0: 2020 2020 2020 2020 2073 796d 6d65 7472           symmetr
-0000dec0: 6963 616c 6c79 2065 7175 6976 616c 656e  ically equivalen
-0000ded0: 742e 2044 6566 6175 6c74 2069 7320 2761  t. Default is 'a
-0000dee0: 7574 6f27 2e0a 2020 2020 2020 2020 6973  uto'..        is
-0000def0: 5f64 6961 676f 6e61 6c20 3a20 426f 6f6c  _diagonal : Bool
-0000df00: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0000df10: 2020 2020 2020 2057 6974 6820 4661 6c73         With Fals
-0000df20: 652c 2074 6865 2064 6973 706c 6163 656d  e, the displacem
-0000df30: 656e 7473 2061 7265 206d 6164 6520 616c  ents are made al
-0000df40: 6f6e 6720 7468 6520 6261 7369 730a 2020  ong the basis.  
-0000df50: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
-0000df60: 7320 6f66 2074 6865 2073 7570 6572 6365  s of the superce
-0000df70: 6c6c 2e20 5769 7468 2054 7275 652c 2064  ll. With True, d
-0000df80: 6972 6563 7469 6f6e 206e 6f74 2061 6c6f  irection not alo
-0000df90: 6e67 2074 6865 2062 6173 6973 0a20 2020  ng the basis.   
-0000dfa0: 2020 2020 2020 2020 2076 6563 746f 7273           vectors
-0000dfb0: 2063 616e 2062 6520 6368 6f73 656e 2077   can be chosen w
-0000dfc0: 6865 6e20 7468 6520 6e75 6d62 6572 206f  hen the number o
-0000dfd0: 6620 7468 6520 6469 7370 6c61 6365 6d65  f the displaceme
-0000dfe0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-0000dff0: 6d61 7920 6265 2072 6564 7563 6564 2e20  may be reduced. 
-0000e000: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
-0000e010: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-0000e020: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000e030: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
-0000e040: 5f6d 6174 7269 7820 6973 204e 6f6e 653a  _matrix is None:
-0000e050: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-0000e060: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0000e070: 2020 2020 2022 7068 6f6e 6f6e 5f73 7570       "phonon_sup
-0000e080: 6572 6365 6c6c 5f6d 6174 7269 7820 6973  ercell_matrix is
-0000e090: 206e 6f74 2073 6574 2e20 220a 2020 2020   not set. ".    
-0000e0a0: 2020 2020 2020 2020 2020 2020 2254 6869              "Thi
-0000e0b0: 7320 6d65 7468 6f64 2069 7320 7573 6564  s method is used
-0000e0c0: 2074 6f20 6765 6e65 7261 7465 2064 6973   to generate dis
-0000e0d0: 706c 6163 656d 656e 7473 2074 6f20 220a  placements to ".
-0000e0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0f0: 2263 616c 6375 6c61 7465 2070 686f 6e6f  "calculate phono
-0000e100: 6e5f 6663 322e 220a 2020 2020 2020 2020  n_fc2.".        
-0000e110: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000e120: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
-0000e130: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
-0000e140: 2020 2070 686f 6e6f 6e5f 6469 7370 6c61     phonon_displa
-0000e150: 6365 6d65 6e74 5f64 6972 6563 7469 6f6e  cement_direction
-0000e160: 7320 3d20 6765 745f 6c65 6173 745f 6469  s = get_least_di
-0000e170: 7370 6c61 6365 6d65 6e74 7328 0a20 2020  splacements(.   
-0000e180: 2020 2020 2020 2020 2073 656c 662e 5f70           self._p
-0000e190: 686f 6e6f 6e5f 7375 7065 7263 656c 6c5f  honon_supercell_
-0000e1a0: 7379 6d6d 6574 7279 2c0a 2020 2020 2020  symmetry,.      
-0000e1b0: 2020 2020 2020 6973 5f70 6c75 736d 696e        is_plusmin
-0000e1c0: 7573 3d69 735f 706c 7573 6d69 6e75 732c  us=is_plusminus,
-0000e1d0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
-0000e1e0: 6469 6167 6f6e 616c 3d69 735f 6469 6167  diagonal=is_diag
-0000e1f0: 6f6e 616c 2c0a 2020 2020 2020 2020 290a  onal,.        ).
-0000e200: 2020 2020 2020 2020 7365 6c66 2e5f 7068          self._ph
-0000e210: 6f6e 6f6e 5f64 6174 6173 6574 203d 2064  onon_dataset = d
-0000e220: 6972 6563 7469 6f6e 735f 746f 5f64 6973  irections_to_dis
-0000e230: 706c 6163 656d 656e 745f 6461 7461 7365  placement_datase
-0000e240: 7428 0a20 2020 2020 2020 2020 2020 2070  t(.            p
-0000e250: 686f 6e6f 6e5f 6469 7370 6c61 6365 6d65  honon_displaceme
-0000e260: 6e74 5f64 6972 6563 7469 6f6e 732c 2064  nt_directions, d
-0000e270: 6973 7461 6e63 652c 2073 656c 662e 5f70  istance, self._p
-0000e280: 686f 6e6f 6e5f 7375 7065 7263 656c 6c0a  honon_supercell.
-0000e290: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000e2a0: 2020 7365 6c66 2e5f 7068 6f6e 6f6e 5f73    self._phonon_s
-0000e2b0: 7570 6572 6365 6c6c 735f 7769 7468 5f64  upercells_with_d
-0000e2c0: 6973 706c 6163 656d 656e 7473 203d 204e  isplacements = N
-0000e2d0: 6f6e 650a 0a20 2020 2064 6566 2070 726f  one..    def pro
-0000e2e0: 6475 6365 5f66 6333 280a 2020 2020 2020  duce_fc3(.      
-0000e2f0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000e300: 7379 6d6d 6574 7269 7a65 5f66 6333 723d  symmetrize_fc3r=
-0000e310: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
-0000e320: 735f 636f 6d70 6163 745f 6663 3d46 616c  s_compact_fc=Fal
-0000e330: 7365 2c0a 2020 2020 2020 2020 6663 5f63  se,.        fc_c
-0000e340: 616c 6375 6c61 746f 723d 4e6f 6e65 2c0a  alculator=None,.
-0000e350: 2020 2020 2020 2020 6663 5f63 616c 6375          fc_calcu
-0000e360: 6c61 746f 725f 6f70 7469 6f6e 733d 4e6f  lator_options=No
-0000e370: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-0000e380: 2020 2022 2222 4361 6c63 756c 6174 6520     """Calculate 
-0000e390: 6663 3320 6672 6f6d 2064 6973 706c 6163  fc3 from displac
-0000e3a0: 656d 656e 7473 2061 6e64 2066 6f72 6365  ements and force
-0000e3b0: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
-0000e3c0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0000e3d0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000e3e0: 2020 7379 6d6d 6574 7269 7a65 5f66 6333    symmetrize_fc3
-0000e3f0: 7220 3a20 626f 6f6c 0a20 2020 2020 2020  r : bool.       
-0000e400: 2020 2020 204f 6e6c 7920 666f 7220 7479       Only for ty
-0000e410: 7065 2031 2064 6973 706c 6163 656d 656e  pe 1 displacemen
-0000e420: 745f 6461 7461 7365 742c 2074 7261 6e73  t_dataset, trans
-0000e430: 6c61 7469 6f6e 616c 2061 6e64 0a20 2020  lational and.   
-0000e440: 2020 2020 2020 2020 2070 6572 6d75 7461           permuta
-0000e450: 7469 6f6e 2073 796d 6d65 7472 6965 7320  tion symmetries 
-0000e460: 6172 6520 6170 706c 6965 6420 6166 7465  are applied afte
-0000e470: 7220 6372 6561 7469 6e67 2066 6333 2e20  r creating fc3. 
-0000e480: 5468 6973 0a20 2020 2020 2020 2020 2020  This.           
-0000e490: 2073 796d 6d65 7472 697a 6174 696f 6e20   symmetrization 
-0000e4a0: 6973 206e 6f74 2076 6572 7920 736f 7068  is not very soph
-0000e4b0: 6973 7469 6361 7465 6420 616e 6420 6361  isticated and ca
-0000e4c0: 6e20 6272 6561 6b20 7370 6163 650a 2020  n break space.  
-0000e4d0: 2020 2020 2020 2020 2020 6772 6f75 7020            group 
-0000e4e0: 7379 6d6d 6574 7279 2c20 6275 7420 6f66  symmetry, but of
-0000e4f0: 7465 6e20 7573 6566 756c 2e20 4966 2062  ten useful. If b
-0000e500: 6574 7465 7220 7379 6d6d 6574 7269 7a61  etter symmetriza
-0000e510: 7469 6f6e 2069 730a 2020 2020 2020 2020  tion is.        
-0000e520: 2020 2020 6578 7065 6374 6564 2c20 6974      expected, it
-0000e530: 2069 7320 7265 636f 6d6d 656e 6465 6420   is recommended 
-0000e540: 746f 2075 7365 2065 7874 6572 6e61 6c20  to use external 
-0000e550: 666f 7263 6520 636f 6e73 7461 6e74 730a  force constants.
-0000e560: 2020 2020 2020 2020 2020 2020 6361 6c63              calc
-0000e570: 756c 6174 6f72 2073 7563 6820 6173 2041  ulator such as A
-0000e580: 4c4d 2e20 4465 6661 756c 7420 6973 2046  LM. Default is F
-0000e590: 616c 7365 2e0a 2020 2020 2020 2020 6973  alse..        is
-0000e5a0: 5f63 6f6d 7061 6374 5f66 6320 3a20 626f  _compact_fc : bo
-0000e5b0: 6f6c 0a20 2020 2020 2020 2020 2020 2066  ol.            f
-0000e5c0: 6333 2073 6861 7065 2069 730a 2020 2020  c3 shape is.    
-0000e5d0: 2020 2020 2020 2020 2020 2020 4661 6c73              Fals
-0000e5e0: 653a 2028 7375 7065 7263 656c 6c2c 2073  e: (supercell, s
-0000e5f0: 7570 6572 6365 6c6c 2c20 7375 7065 6365  upercell, supece
-0000e600: 6c6c 2c20 332c 2033 2c20 3329 0a20 2020  ll, 3, 3, 3).   
-0000e610: 2020 2020 2020 2020 2020 2020 2054 7275               Tru
-0000e620: 653a 2028 7072 696d 6974 6976 652c 2073  e: (primitive, s
-0000e630: 7570 6572 6365 6c6c 2c20 7375 7065 6365  upercell, supece
-0000e640: 6c6c 2c20 332c 2033 2c20 3329 0a20 2020  ll, 3, 3, 3).   
-0000e650: 2020 2020 2020 2020 2077 6865 7265 2027           where '
-0000e660: 7375 7065 7263 656c 6c27 2061 6e64 2027  supercell' and '
-0000e670: 7072 696d 6974 6976 6527 2069 6e64 6963  primitive' indic
-0000e680: 6174 6520 6e75 6d62 6572 206f 6620 6174  ate number of at
-0000e690: 6f6d 7320 696e 2074 6865 7365 0a20 2020  oms in these.   
-0000e6a0: 2020 2020 2020 2020 2063 656c 6c73 2e20           cells. 
-0000e6b0: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
-0000e6c0: 2e0a 2020 2020 2020 2020 6663 5f63 616c  ..        fc_cal
-0000e6d0: 6375 6c61 746f 7220 3a20 7374 7220 6f72  culator : str or
-0000e6e0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-0000e6f0: 2020 466f 7263 6520 636f 6e73 7461 6e74    Force constant
-0000e700: 7320 6361 6c63 756c 6174 6f72 2067 6976  s calculator giv
-0000e710: 656e 2062 7920 7374 722e 0a20 2020 2020  en by str..     
-0000e720: 2020 2066 635f 6361 6c63 756c 6174 6f72     fc_calculator
-0000e730: 5f6f 7074 696f 6e73 203a 2064 6963 740a  _options : dict.
-0000e740: 2020 2020 2020 2020 2020 2020 4f70 7469              Opti
-0000e750: 6f6e 7320 666f 7220 6578 7465 726e 616c  ons for external
-0000e760: 2066 6f72 6365 2063 6f6e 7374 616e 7473   force constants
-0000e770: 2063 616c 6375 6c61 746f 722e 0a0a 2020   calculator...  
-0000e780: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000e790: 2020 6469 7370 5f64 6174 6173 6574 203d    disp_dataset =
-0000e7a0: 2073 656c 662e 5f64 6174 6173 6574 0a0a   self._dataset..
-0000e7b0: 2020 2020 2020 2020 6663 335f 6361 6c63          fc3_calc
-0000e7c0: 756c 6174 6f72 2c20 6663 335f 6361 6c63  ulator, fc3_calc
-0000e7d0: 756c 6174 6f72 5f6f 7074 696f 6e73 203d  ulator_options =
-0000e7e0: 2073 656c 662e 5f65 7874 7261 6374 5f66   self._extract_f
-0000e7f0: 6332 5f66 6333 5f63 616c 6375 6c61 746f  c2_fc3_calculato
-0000e800: 7273 280a 2020 2020 2020 2020 2020 2020  rs(.            
-0000e810: 6663 5f63 616c 6375 6c61 746f 722c 2066  fc_calculator, f
-0000e820: 635f 6361 6c63 756c 6174 6f72 5f6f 7074  c_calculator_opt
-0000e830: 696f 6e73 2c20 330a 2020 2020 2020 2020  ions, 3.        
-0000e840: 290a 0a20 2020 2020 2020 2069 6620 6663  )..        if fc
-0000e850: 335f 6361 6c63 756c 6174 6f72 2069 7320  3_calculator is 
-0000e860: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000e870: 2020 2020 2020 6469 7370 732c 2066 6f72        disps, for
-0000e880: 6365 7320 3d20 6765 745f 6469 7370 6c61  ces = get_displa
-0000e890: 6365 6d65 6e74 735f 616e 645f 666f 7263  cements_and_forc
-0000e8a0: 6573 5f66 6333 2864 6973 705f 6461 7461  es_fc3(disp_data
-0000e8b0: 7365 7429 0a20 2020 2020 2020 2020 2020  set).           
-0000e8c0: 2066 6332 2c20 6663 3320 3d20 6765 745f   fc2, fc3 = get_
-0000e8d0: 6663 3328 0a20 2020 2020 2020 2020 2020  fc3(.           
-0000e8e0: 2020 2020 2073 656c 662e 5f73 7570 6572       self._super
-0000e8f0: 6365 6c6c 2c0a 2020 2020 2020 2020 2020  cell,.          
-0000e900: 2020 2020 2020 7365 6c66 2e5f 7072 696d        self._prim
-0000e910: 6974 6976 652c 0a20 2020 2020 2020 2020  itive,.         
-0000e920: 2020 2020 2020 2064 6973 7073 2c0a 2020         disps,.  
-0000e930: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000e940: 7263 6573 2c0a 2020 2020 2020 2020 2020  rces,.          
-0000e950: 2020 2020 2020 6663 5f63 616c 6375 6c61        fc_calcula
-0000e960: 746f 723d 6663 335f 6361 6c63 756c 6174  tor=fc3_calculat
-0000e970: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
-0000e980: 2020 2020 6663 5f63 616c 6375 6c61 746f      fc_calculato
-0000e990: 725f 6f70 7469 6f6e 733d 6663 335f 6361  r_options=fc3_ca
-0000e9a0: 6c63 756c 6174 6f72 5f6f 7074 696f 6e73  lculator_options
-0000e9b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e9c0: 2020 6973 5f63 6f6d 7061 6374 5f66 633d    is_compact_fc=
-0000e9d0: 6973 5f63 6f6d 7061 6374 5f66 632c 0a20  is_compact_fc,. 
-0000e9e0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0000e9f0: 6f67 5f6c 6576 656c 3d73 656c 662e 5f6c  og_level=self._l
-0000ea00: 6f67 5f6c 6576 656c 2c0a 2020 2020 2020  og_level,.      
-0000ea10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000ea20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000ea30: 2020 6966 2022 6469 7370 6c61 6365 6d65    if "displaceme
-0000ea40: 6e74 7322 2069 6e20 6469 7370 5f64 6174  nts" in disp_dat
-0000ea50: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
-0000ea60: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
-0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea80: 2020 2266 635f 6361 6c63 756c 6174 6f72    "fc_calculator
-0000ea90: 2068 6173 2074 6f20 6265 2073 6574 2074   has to be set t
-0000eaa0: 6f20 7072 6f64 7563 6520 666f 7263 6520  o produce force 
-0000eab0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000eac0: 2020 2020 2020 2263 6f6e 7374 616e 7320        "constans 
-0000ead0: 6672 6f6d 2074 6869 7320 6461 7461 7365  from this datase
-0000eae0: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
-0000eaf0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000eb00: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
-0000eb10: 696d 6545 7272 6f72 286d 7367 290a 2020  imeError(msg).  
-0000eb20: 2020 2020 2020 2020 2020 6663 322c 2066            fc2, f
-0000eb30: 6333 203d 2067 6574 5f70 686f 6e6f 3370  c3 = get_phono3p
-0000eb40: 795f 6663 3328 0a20 2020 2020 2020 2020  y_fc3(.         
-0000eb50: 2020 2020 2020 2073 656c 662e 5f73 7570         self._sup
-0000eb60: 6572 6365 6c6c 2c0a 2020 2020 2020 2020  ercell,.        
-0000eb70: 2020 2020 2020 2020 7365 6c66 2e5f 7072          self._pr
-0000eb80: 696d 6974 6976 652c 0a20 2020 2020 2020  imitive,.       
-0000eb90: 2020 2020 2020 2020 2064 6973 705f 6461           disp_da
-0000eba0: 7461 7365 742c 0a20 2020 2020 2020 2020  taset,.         
-0000ebb0: 2020 2020 2020 2073 656c 662e 5f73 796d         self._sym
-0000ebc0: 6d65 7472 792c 0a20 2020 2020 2020 2020  metry,.         
-0000ebd0: 2020 2020 2020 2069 735f 636f 6d70 6163         is_compac
-0000ebe0: 745f 6663 3d69 735f 636f 6d70 6163 745f  t_fc=is_compact_
-0000ebf0: 6663 2c0a 2020 2020 2020 2020 2020 2020  fc,.            
-0000ec00: 2020 2020 7665 7262 6f73 653d 7365 6c66      verbose=self
-0000ec10: 2e5f 6c6f 675f 6c65 7665 6c2c 0a20 2020  ._log_level,.   
-0000ec20: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000ec30: 2020 2020 2020 2069 6620 7379 6d6d 6574         if symmet
-0000ec40: 7269 7a65 5f66 6333 723a 0a20 2020 2020  rize_fc3r:.     
-0000ec50: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0000ec60: 5f63 6f6d 7061 6374 5f66 633a 0a20 2020  _compact_fc:.   
-0000ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec80: 2073 6574 5f74 7261 6e73 6c61 7469 6f6e   set_translation
-0000ec90: 616c 5f69 6e76 6172 6961 6e63 655f 636f  al_invariance_co
-0000eca0: 6d70 6163 745f 6663 3328 6663 332c 2073  mpact_fc3(fc3, s
-0000ecb0: 656c 662e 5f70 7269 6d69 7469 7665 290a  elf._primitive).
-0000ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ecd0: 2020 2020 7365 745f 7065 726d 7574 6174      set_permutat
-0000ece0: 696f 6e5f 7379 6d6d 6574 7279 5f63 6f6d  ion_symmetry_com
-0000ecf0: 7061 6374 5f66 6333 2866 6333 2c20 7365  pact_fc3(fc3, se
-0000ed00: 6c66 2e5f 7072 696d 6974 6976 6529 0a20  lf._primitive). 
-0000ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed20: 2020 2069 6620 7365 6c66 2e5f 6663 3220     if self._fc2 
-0000ed30: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed50: 2073 796d 6d65 7472 697a 655f 636f 6d70   symmetrize_comp
-0000ed60: 6163 745f 666f 7263 655f 636f 6e73 7461  act_force_consta
-0000ed70: 6e74 7328 6663 322c 2073 656c 662e 5f70  nts(fc2, self._p
-0000ed80: 7269 6d69 7469 7665 290a 2020 2020 2020  rimitive).      
-0000ed90: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00000670: 6f6d 2070 686f 6e6f 7079 2e65 7863 6570  om phonopy.excep
+00000680: 7469 6f6e 2069 6d70 6f72 7420 466f 7263  tion import Forc
+00000690: 6543 616c 6375 6c61 746f 7252 6571 7569  eCalculatorRequi
+000006a0: 7265 6445 7272 6f72 0a66 726f 6d20 7068  redError.from ph
+000006b0: 6f6e 6f70 792e 6861 726d 6f6e 6963 2e64  onopy.harmonic.d
+000006c0: 6973 706c 6163 656d 656e 7420 696d 706f  isplacement impo
+000006d0: 7274 2028 0a20 2020 2064 6972 6563 7469  rt (.    directi
+000006e0: 6f6e 735f 746f 5f64 6973 706c 6163 656d  ons_to_displacem
+000006f0: 656e 745f 6461 7461 7365 742c 0a20 2020  ent_dataset,.   
+00000700: 2067 6574 5f6c 6561 7374 5f64 6973 706c   get_least_displ
+00000710: 6163 656d 656e 7473 2c0a 290a 6672 6f6d  acements,.).from
+00000720: 2070 686f 6e6f 7079 2e68 6172 6d6f 6e69   phonopy.harmoni
+00000730: 632e 666f 7263 655f 636f 6e73 7461 6e74  c.force_constant
+00000740: 7320 696d 706f 7274 2067 6574 5f66 6332  s import get_fc2
+00000750: 2061 7320 6765 745f 7068 6f6e 6f70 795f   as get_phonopy_
+00000760: 6663 320a 6672 6f6d 2070 686f 6e6f 7079  fc2.from phonopy
+00000770: 2e68 6172 6d6f 6e69 632e 666f 7263 655f  .harmonic.force_
+00000780: 636f 6e73 7461 6e74 7320 696d 706f 7274  constants import
+00000790: 2028 0a20 2020 2073 6574 5f70 6572 6d75   (.    set_permu
+000007a0: 7461 7469 6f6e 5f73 796d 6d65 7472 792c  tation_symmetry,
+000007b0: 0a20 2020 2073 6574 5f74 7261 6e73 6c61  .    set_transla
+000007c0: 7469 6f6e 616c 5f69 6e76 6172 6961 6e63  tional_invarianc
+000007d0: 652c 0a20 2020 2073 796d 6d65 7472 697a  e,.    symmetriz
+000007e0: 655f 636f 6d70 6163 745f 666f 7263 655f  e_compact_force_
+000007f0: 636f 6e73 7461 6e74 732c 0a20 2020 2073  constants,.    s
+00000800: 796d 6d65 7472 697a 655f 666f 7263 655f  ymmetrize_force_
+00000810: 636f 6e73 7461 6e74 732c 0a29 0a66 726f  constants,.).fro
+00000820: 6d20 7068 6f6e 6f70 792e 696e 7465 7266  m phonopy.interf
+00000830: 6163 652e 6663 5f63 616c 6375 6c61 746f  ace.fc_calculato
+00000840: 7220 696d 706f 7274 2067 6574 5f66 6332  r import get_fc2
+00000850: 0a66 726f 6d20 7068 6f6e 6f70 792e 7374  .from phonopy.st
+00000860: 7275 6374 7572 652e 6174 6f6d 7320 696d  ructure.atoms im
+00000870: 706f 7274 2050 686f 6e6f 7079 4174 6f6d  port PhonopyAtom
+00000880: 730a 6672 6f6d 2070 686f 6e6f 7079 2e73  s.from phonopy.s
+00000890: 7472 7563 7475 7265 2e63 656c 6c73 2069  tructure.cells i
+000008a0: 6d70 6f72 7420 280a 2020 2020 5072 696d  mport (.    Prim
+000008b0: 6974 6976 652c 0a20 2020 2053 7570 6572  itive,.    Super
+000008c0: 6365 6c6c 2c0a 2020 2020 6765 745f 7072  cell,.    get_pr
+000008d0: 696d 6974 6976 652c 0a20 2020 2067 6574  imitive,.    get
+000008e0: 5f70 7269 6d69 7469 7665 5f6d 6174 7269  _primitive_matri
+000008f0: 782c 0a20 2020 2067 6574 5f73 7570 6572  x,.    get_super
+00000900: 6365 6c6c 2c0a 2020 2020 6775 6573 735f  cell,.    guess_
+00000910: 7072 696d 6974 6976 655f 6d61 7472 6978  primitive_matrix
+00000920: 2c0a 2020 2020 7368 6170 655f 7375 7065  ,.    shape_supe
+00000930: 7263 656c 6c5f 6d61 7472 6978 2c0a 290a  rcell_matrix,.).
+00000940: 6672 6f6d 2070 686f 6e6f 7079 2e73 7472  from phonopy.str
+00000950: 7563 7475 7265 2e64 6174 6173 6574 2069  ucture.dataset i
+00000960: 6d70 6f72 7420 6765 745f 6469 7370 6c61  mport get_displa
+00000970: 6365 6d65 6e74 735f 616e 645f 666f 7263  cements_and_forc
+00000980: 6573 0a66 726f 6d20 7068 6f6e 6f70 792e  es.from phonopy.
+00000990: 7374 7275 6374 7572 652e 7379 6d6d 6574  structure.symmet
+000009a0: 7279 2069 6d70 6f72 7420 5379 6d6d 6574  ry import Symmet
+000009b0: 7279 0a66 726f 6d20 7068 6f6e 6f70 792e  ry.from phonopy.
+000009c0: 756e 6974 7320 696d 706f 7274 2056 6173  units import Vas
+000009d0: 7054 6f54 487a 0a0a 6672 6f6d 2070 686f  pToTHz..from pho
+000009e0: 6e6f 3370 792e 636f 6e64 7563 7469 7669  no3py.conductivi
+000009f0: 7479 2e64 6972 6563 745f 736f 6c75 7469  ty.direct_soluti
+00000a00: 6f6e 2069 6d70 6f72 7420 6765 745f 7468  on import get_th
+00000a10: 6572 6d61 6c5f 636f 6e64 7563 7469 7669  ermal_conductivi
+00000a20: 7479 5f4c 4254 450a 6672 6f6d 2070 686f  ty_LBTE.from pho
+00000a30: 6e6f 3370 792e 636f 6e64 7563 7469 7669  no3py.conductivi
+00000a40: 7479 2e72 7461 2069 6d70 6f72 7420 6765  ty.rta import ge
+00000a50: 745f 7468 6572 6d61 6c5f 636f 6e64 7563  t_thermal_conduc
+00000a60: 7469 7669 7479 5f52 5441 0a66 726f 6d20  tivity_RTA.from 
+00000a70: 7068 6f6e 6f33 7079 2e69 6e74 6572 6661  phono3py.interfa
+00000a80: 6365 2e66 635f 6361 6c63 756c 6174 6f72  ce.fc_calculator
+00000a90: 2069 6d70 6f72 7420 6765 745f 6663 330a   import get_fc3.
+00000aa0: 6672 6f6d 2070 686f 6e6f 3370 792e 696e  from phono3py.in
+00000ab0: 7465 7266 6163 652e 7068 6f6e 6f33 7079  terface.phono3py
+00000ac0: 5f79 616d 6c20 696d 706f 7274 2050 686f  _yaml import Pho
+00000ad0: 6e6f 3370 7959 616d 6c0a 6672 6f6d 2070  no3pyYaml.from p
+00000ae0: 686f 6e6f 3370 792e 7068 6f6e 6f6e 332e  hono3py.phonon3.
+00000af0: 6461 7461 7365 7420 696d 706f 7274 2067  dataset import g
+00000b00: 6574 5f64 6973 706c 6163 656d 656e 7473  et_displacements
+00000b10: 5f61 6e64 5f66 6f72 6365 735f 6663 330a  _and_forces_fc3.
+00000b20: 6672 6f6d 2070 686f 6e6f 3370 792e 7068  from phono3py.ph
+00000b30: 6f6e 6f6e 332e 6469 7370 6c61 6365 6d65  onon3.displaceme
+00000b40: 6e74 5f66 6333 2069 6d70 6f72 7420 280a  nt_fc3 import (.
+00000b50: 2020 2020 6469 7265 6374 696f 6e5f 746f      direction_to
+00000b60: 5f64 6973 706c 6163 656d 656e 742c 0a20  _displacement,. 
+00000b70: 2020 2067 6574 5f74 6869 7264 5f6f 7264     get_third_ord
+00000b80: 6572 5f64 6973 706c 6163 656d 656e 7473  er_displacements
+00000b90: 2c0a 290a 6672 6f6d 2070 686f 6e6f 3370  ,.).from phono3p
+00000ba0: 792e 7068 6f6e 6f6e 332e 6663 3320 696d  y.phonon3.fc3 im
+00000bb0: 706f 7274 2063 7574 6f66 665f 6663 335f  port cutoff_fc3_
+00000bc0: 6279 5f7a 6572 6f0a 6672 6f6d 2070 686f  by_zero.from pho
+00000bd0: 6e6f 3370 792e 7068 6f6e 6f6e 332e 6663  no3py.phonon3.fc
+00000be0: 3320 696d 706f 7274 2067 6574 5f66 6333  3 import get_fc3
+00000bf0: 2061 7320 6765 745f 7068 6f6e 6f33 7079   as get_phono3py
+00000c00: 5f66 6333 0a66 726f 6d20 7068 6f6e 6f33  _fc3.from phono3
+00000c10: 7079 2e70 686f 6e6f 6e33 2e66 6333 2069  py.phonon3.fc3 i
+00000c20: 6d70 6f72 7420 280a 2020 2020 7365 745f  mport (.    set_
+00000c30: 7065 726d 7574 6174 696f 6e5f 7379 6d6d  permutation_symm
+00000c40: 6574 7279 5f63 6f6d 7061 6374 5f66 6333  etry_compact_fc3
+00000c50: 2c0a 2020 2020 7365 745f 7065 726d 7574  ,.    set_permut
+00000c60: 6174 696f 6e5f 7379 6d6d 6574 7279 5f66  ation_symmetry_f
+00000c70: 6333 2c0a 2020 2020 7365 745f 7472 616e  c3,.    set_tran
+00000c80: 736c 6174 696f 6e61 6c5f 696e 7661 7269  slational_invari
+00000c90: 616e 6365 5f63 6f6d 7061 6374 5f66 6333  ance_compact_fc3
+00000ca0: 2c0a 2020 2020 7365 745f 7472 616e 736c  ,.    set_transl
+00000cb0: 6174 696f 6e61 6c5f 696e 7661 7269 616e  ational_invarian
+00000cc0: 6365 5f66 6333 2c0a 290a 6672 6f6d 2070  ce_fc3,.).from p
+00000cd0: 686f 6e6f 3370 792e 7068 6f6e 6f6e 332e  hono3py.phonon3.
+00000ce0: 696d 6167 5f73 656c 665f 656e 6572 6779  imag_self_energy
+00000cf0: 2069 6d70 6f72 7420 280a 2020 2020 6765   import (.    ge
+00000d00: 745f 696d 6167 5f73 656c 665f 656e 6572  t_imag_self_ener
+00000d10: 6779 2c0a 2020 2020 7772 6974 655f 696d  gy,.    write_im
+00000d20: 6167 5f73 656c 665f 656e 6572 6779 2c0a  ag_self_energy,.
+00000d30: 290a 6672 6f6d 2070 686f 6e6f 3370 792e  ).from phono3py.
+00000d40: 7068 6f6e 6f6e 332e 696e 7465 7261 6374  phonon3.interact
+00000d50: 696f 6e20 696d 706f 7274 2049 6e74 6572  ion import Inter
+00000d60: 6163 7469 6f6e 0a66 726f 6d20 7068 6f6e  action.from phon
+00000d70: 6f33 7079 2e70 686f 6e6f 6e33 2e72 6561  o3py.phonon3.rea
+00000d80: 6c5f 7365 6c66 5f65 6e65 7267 7920 696d  l_self_energy im
+00000d90: 706f 7274 2028 0a20 2020 2067 6574 5f72  port (.    get_r
+00000da0: 6561 6c5f 7365 6c66 5f65 6e65 7267 792c  eal_self_energy,
+00000db0: 0a20 2020 2077 7269 7465 5f72 6561 6c5f  .    write_real_
+00000dc0: 7365 6c66 5f65 6e65 7267 792c 0a29 0a66  self_energy,.).f
+00000dd0: 726f 6d20 7068 6f6e 6f33 7079 2e70 686f  rom phono3py.pho
+00000de0: 6e6f 6e33 2e73 7065 6374 7261 6c5f 6675  non3.spectral_fu
+00000df0: 6e63 7469 6f6e 2069 6d70 6f72 7420 7275  nction import ru
+00000e00: 6e5f 7370 6563 7472 616c 5f66 756e 6374  n_spectral_funct
+00000e10: 696f 6e0a 6672 6f6d 2070 686f 6e6f 3370  ion.from phono3p
+00000e20: 792e 7068 6f6e 6f6e 2e67 7269 6420 696d  y.phonon.grid im
+00000e30: 706f 7274 2042 5a47 7269 640a 6672 6f6d  port BZGrid.from
+00000e40: 2070 686f 6e6f 3370 792e 7665 7273 696f   phono3py.versio
+00000e50: 6e20 696d 706f 7274 205f 5f76 6572 7369  n import __versi
+00000e60: 6f6e 5f5f 0a0a 0a63 6c61 7373 2050 686f  on__...class Pho
+00000e70: 6e6f 3370 793a 0a20 2020 2022 2222 5068  no3py:.    """Ph
+00000e80: 6f6e 6f33 7079 206d 6169 6e20 636c 6173  ono3py main clas
+00000e90: 732e 0a0a 2020 2020 4174 7472 6962 7574  s...    Attribut
+00000ea0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  es.    ---------
+00000eb0: 2d0a 2020 2020 7665 7273 696f 6e0a 2020  -.    version.  
+00000ec0: 2020 6361 6c63 756c 6174 6f72 0a20 2020    calculator.   
+00000ed0: 2066 6333 203a 2067 6574 7465 7220 616e   fc3 : getter an
+00000ee0: 6420 7365 7474 6572 0a20 2020 2066 6332  d setter.    fc2
+00000ef0: 203a 2067 6574 7465 7220 616e 6420 7365   : getter and se
+00000f00: 7474 6572 0a20 2020 2066 6f72 6365 5f63  tter.    force_c
+00000f10: 6f6e 7374 616e 7473 0a20 2020 2073 6967  onstants.    sig
+00000f20: 6d61 203a 2067 6574 7465 7220 616e 6420  ma : getter and 
+00000f30: 7365 7474 6572 0a20 2020 2073 6967 6d61  setter.    sigma
+00000f40: 5f63 7574 6f66 6620 3a20 6765 7474 6572  _cutoff : getter
+00000f50: 2061 6e64 2073 6574 7465 720a 2020 2020   and setter.    
+00000f60: 6e61 635f 7061 7261 6d73 203a 2067 6574  nac_params : get
+00000f70: 7465 7220 616e 6420 7365 7474 6572 0a20  ter and setter. 
+00000f80: 2020 2064 796e 616d 6963 616c 5f6d 6174     dynamical_mat
+00000f90: 7269 780a 2020 2020 7072 696d 6974 6976  rix.    primitiv
+00000fa0: 650a 2020 2020 756e 6974 6365 6c6c 0a20  e.    unitcell. 
+00000fb0: 2020 2073 7570 6572 6365 6c6c 0a20 2020     supercell.   
+00000fc0: 2070 686f 6e6f 6e5f 7375 7065 7263 656c   phonon_supercel
+00000fd0: 6c0a 2020 2020 7068 6f6e 6f6e 5f70 7269  l.    phonon_pri
+00000fe0: 6d69 7469 7665 0a20 2020 2073 796d 6d65  mitive.    symme
+00000ff0: 7472 790a 2020 2020 7072 696d 6974 6976  try.    primitiv
+00001000: 655f 7379 6d6d 6574 7279 0a20 2020 2070  e_symmetry.    p
+00001010: 686f 6e6f 6e5f 7375 7065 7263 656c 6c5f  honon_supercell_
+00001020: 7379 6d6d 6574 7279 0a20 2020 2073 7570  symmetry.    sup
+00001030: 6572 6365 6c6c 5f6d 6174 7269 780a 2020  ercell_matrix.  
+00001040: 2020 7068 6f6e 6f6e 5f73 7570 6572 6365    phonon_superce
+00001050: 6c6c 5f6d 6174 7269 780a 2020 2020 7072  ll_matrix.    pr
+00001060: 696d 6974 6976 655f 6d61 7472 6978 0a20  imitive_matrix. 
+00001070: 2020 2075 6e69 745f 636f 6e76 6572 7369     unit_conversi
+00001080: 6f6e 5f66 6163 746f 720a 2020 2020 6461  on_factor.    da
+00001090: 7461 7365 7420 3a20 6765 7474 6572 2061  taset : getter a
+000010a0: 6e64 2073 6574 7465 720a 2020 2020 7068  nd setter.    ph
+000010b0: 6f6e 6f6e 5f64 6174 6173 6574 203a 2067  onon_dataset : g
+000010c0: 6574 7465 7220 616e 6420 7365 7474 6572  etter and setter
+000010d0: 0a20 2020 2062 616e 645f 696e 6469 6365  .    band_indice
+000010e0: 7320 3a20 6765 7474 6572 2061 6e64 2073  s : getter and s
+000010f0: 6574 7465 720a 2020 2020 7068 6f6e 6f6e  etter.    phonon
+00001100: 5f73 7570 6572 6365 6c6c 735f 7769 7468  _supercells_with
+00001110: 5f64 6973 706c 6163 656d 656e 7473 0a20  _displacements. 
+00001120: 2020 2073 7570 6572 6365 6c6c 735f 7769     supercells_wi
+00001130: 7468 5f64 6973 706c 6163 656d 656e 7473  th_displacements
+00001140: 0a20 2020 206d 6573 685f 6e75 6d62 6572  .    mesh_number
+00001150: 7320 3a20 6765 7474 6572 2061 6e64 2073  s : getter and s
+00001160: 6574 7465 720a 2020 2020 7468 6572 6d61  etter.    therma
+00001170: 6c5f 636f 6e64 7563 7469 7669 7479 0a20  l_conductivity. 
+00001180: 2020 2064 6973 706c 6163 656d 656e 7473     displacements
+00001190: 203a 2067 6574 7465 7220 616e 6420 7365   : getter and se
+000011a0: 7474 6572 0a20 2020 2066 6f72 6365 7320  tter.    forces 
+000011b0: 3a20 6765 7474 6572 2061 6e64 2073 6574  : getter and set
+000011c0: 7465 720a 2020 2020 7068 6f6e 6f6e 5f64  ter.    phonon_d
+000011d0: 6973 706c 6163 656d 656e 7473 203a 2067  isplacements : g
+000011e0: 6574 7465 7220 616e 6420 7365 7474 6572  etter and setter
+000011f0: 0a20 2020 2070 686f 6e6f 6e5f 666f 7263  .    phonon_forc
+00001200: 6573 203a 2067 6574 7465 7220 616e 6420  es : getter and 
+00001210: 7365 7474 6572 0a20 2020 2070 6870 685f  setter.    phph_
+00001220: 696e 7465 7261 6374 696f 6e0a 0a20 2020  interaction..   
+00001230: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
+00001240: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
+00001250: 7365 6c66 2c0a 2020 2020 2020 2020 756e  self,.        un
+00001260: 6974 6365 6c6c 3a20 5068 6f6e 6f70 7941  itcell: PhonopyA
+00001270: 746f 6d73 2c0a 2020 2020 2020 2020 7375  toms,.        su
+00001280: 7065 7263 656c 6c5f 6d61 7472 6978 3d4e  percell_matrix=N
+00001290: 6f6e 652c 0a20 2020 2020 2020 2070 7269  one,.        pri
+000012a0: 6d69 7469 7665 5f6d 6174 7269 783d 4e6f  mitive_matrix=No
+000012b0: 6e65 2c0a 2020 2020 2020 2020 7068 6f6e  ne,.        phon
+000012c0: 6f6e 5f73 7570 6572 6365 6c6c 5f6d 6174  on_supercell_mat
+000012d0: 7269 783d 4e6f 6e65 2c0a 2020 2020 2020  rix=None,.      
+000012e0: 2020 6d61 7373 6573 3d4e 6f6e 652c 0a20    masses=None,. 
+000012f0: 2020 2020 2020 2062 616e 645f 696e 6469         band_indi
+00001300: 6365 733d 4e6f 6e65 2c0a 2020 2020 2020  ces=None,.      
+00001310: 2020 7369 676d 6173 3d4e 6f6e 652c 0a20    sigmas=None,. 
+00001320: 2020 2020 2020 2073 6967 6d61 5f63 7574         sigma_cut
+00001330: 6f66 663d 4e6f 6e65 2c0a 2020 2020 2020  off=None,.      
+00001340: 2020 6375 746f 6666 5f66 7265 7175 656e    cutoff_frequen
+00001350: 6379 3d31 652d 342c 0a20 2020 2020 2020  cy=1e-4,.       
+00001360: 2066 7265 7175 656e 6379 5f66 6163 746f   frequency_facto
+00001370: 725f 746f 5f54 487a 3d56 6173 7054 6f54  r_to_THz=VaspToT
+00001380: 487a 2c0a 2020 2020 2020 2020 6973 5f73  Hz,.        is_s
+00001390: 796d 6d65 7472 793d 5472 7565 2c0a 2020  ymmetry=True,.  
+000013a0: 2020 2020 2020 6973 5f6d 6573 685f 7379        is_mesh_sy
+000013b0: 6d6d 6574 7279 3d54 7275 652c 0a20 2020  mmetry=True,.   
+000013c0: 2020 2020 2075 7365 5f67 7267 3d46 616c       use_grg=Fal
+000013d0: 7365 2c0a 2020 2020 2020 2020 534e 465f  se,.        SNF_
+000013e0: 636f 6f72 6469 6e61 7465 733d 2272 6563  coordinates="rec
+000013f0: 6970 726f 6361 6c22 2c0a 2020 2020 2020  iprocal",.      
+00001400: 2020 7379 6d6d 6574 7269 7a65 5f66 6333    symmetrize_fc3
+00001410: 713d 4e6f 6e65 2c0a 2020 2020 2020 2020  q=None,.        
+00001420: 7374 6f72 655f 6465 6e73 655f 6770 5f6d  store_dense_gp_m
+00001430: 6170 3d54 7275 652c 0a20 2020 2020 2020  ap=True,.       
+00001440: 2073 746f 7265 5f64 656e 7365 5f73 7665   store_dense_sve
+00001450: 6373 3d54 7275 652c 0a20 2020 2020 2020  cs=True,.       
+00001460: 2073 796d 7072 6563 3d31 652d 352c 0a20   symprec=1e-5,. 
+00001470: 2020 2020 2020 2063 616c 6375 6c61 746f         calculato
+00001480: 723d 4e6f 6e65 2c0a 2020 2020 2020 2020  r=None,.        
+00001490: 6c6f 675f 6c65 7665 6c3d 302c 0a20 2020  log_level=0,.   
+000014a0: 2020 2020 206c 6170 6163 6b5f 7a68 6565       lapack_zhee
+000014b0: 765f 7570 6c6f 3d4e 6f6e 652c 0a20 2020  v_uplo=None,.   
+000014c0: 2029 3a0a 2020 2020 2020 2020 2222 2249   ):.        """I
+000014d0: 6e69 7420 6d65 7468 6f64 2e0a 0a20 2020  nit method...   
+000014e0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+000014f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00001500: 2d2d 0a20 2020 2020 2020 2075 6e69 7463  --.        unitc
+00001510: 656c 6c20 3a20 5068 6f6e 6f70 7941 746f  ell : PhonopyAto
+00001520: 6d73 2c20 6f70 7469 6f6e 616c 0a20 2020  ms, optional.   
+00001530: 2020 2020 2020 2020 2049 6e70 7574 2075           Input u
+00001540: 6e69 7420 6365 6c6c 2e0a 2020 2020 2020  nit cell..      
+00001550: 2020 7375 7065 7263 656c 6c5f 6d61 7472    supercell_matr
+00001560: 6978 203a 2061 7272 6179 5f6c 696b 652c  ix : array_like,
+00001570: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00001580: 2020 2020 2020 5375 7065 7263 656c 6c20        Supercell 
+00001590: 6d61 7472 6978 206d 756c 7469 706c 6965  matrix multiplie
+000015a0: 6420 746f 2069 6e70 7574 2063 656c 6c20  d to input cell 
+000015b0: 6261 7369 7320 7665 6374 6f72 732e 2073  basis vectors. s
+000015c0: 6861 7065 3d28 332c 2029 0a20 2020 2020  hape=(3, ).     
+000015d0: 2020 2020 2020 206f 7220 2833 2c20 3329         or (3, 3)
+000015e0: 2c20 7768 6572 6520 7468 6520 666f 726d  , where the form
+000015f0: 6572 2069 7320 636f 6e73 6964 6572 6564  er is considered
+00001600: 2061 2064 6961 676f 6e61 6c20 6d61 7472   a diagonal matr
+00001610: 6978 2e20 5468 650a 2020 2020 2020 2020  ix. The.        
+00001620: 2020 2020 656c 656d 656e 7473 2068 6176      elements hav
+00001630: 6520 746f 2062 6520 6769 7665 6e20 6279  e to be given by
+00001640: 2069 6e74 6567 6572 732e 2041 6c74 686f   integers. Altho
+00001650: 7567 6820 7468 6520 6465 6661 756c 7420  ugh the default 
+00001660: 6973 204e 6f6e 652c 0a20 2020 2020 2020  is None,.       
+00001670: 2020 2020 2077 6869 6368 2072 6573 756c       which resul
+00001680: 7473 2069 6e20 6964 656e 7469 7479 206d  ts in identity m
+00001690: 6174 7269 782c 2069 7420 6973 2072 6563  atrix, it is rec
+000016a0: 6f6d 6d65 6e64 6564 2074 6f20 6769 7665  ommended to give
+000016b0: 0a20 2020 2020 2020 2020 2020 2060 7375  .            `su
+000016c0: 7065 7263 656c 6c5f 6d61 7472 6978 6020  percell_matrix` 
+000016d0: 6578 706c 6963 6974 6c79 2e0a 2020 2020  explicitly..    
+000016e0: 2020 2020 7072 696d 6974 6976 655f 6d61      primitive_ma
+000016f0: 7472 6978 203a 2061 7272 6179 5f6c 696b  trix : array_lik
+00001700: 6520 6f72 2073 7472 2c20 6f70 7469 6f6e  e or str, option
+00001710: 616c 0a20 2020 2020 2020 2020 2020 2050  al.            P
+00001720: 7269 6d69 7469 7665 206d 6174 7269 7820  rimitive matrix 
+00001730: 6d75 6c74 6970 6c69 6564 2074 6f20 696e  multiplied to in
+00001740: 7075 7420 6365 6c6c 2062 6173 6973 2076  put cell basis v
+00001750: 6563 746f 7273 2e20 4465 6661 756c 7420  ectors. Default 
+00001760: 6973 0a20 2020 2020 2020 2020 2020 2074  is.            t
+00001770: 6865 2069 6465 6e74 6974 7920 6d61 7472  he identity matr
+00001780: 6978 2e20 5768 656e 2067 6976 656e 2061  ix. When given a
+00001790: 7320 6172 7261 795f 6c69 6b65 2c20 7368  s array_like, sh
+000017a0: 6170 653d 2833 2c20 3329 2c0a 2020 2020  ape=(3, 3),.    
+000017b0: 2020 2020 2020 2020 6474 7970 653d 666c          dtype=fl
+000017c0: 6f61 742e 2057 6865 6e20 2746 272c 2027  oat. When 'F', '
+000017d0: 4927 2c20 2741 272c 2027 4327 2c20 6f72  I', 'A', 'C', or
+000017e0: 2027 5227 2069 7320 6769 7665 6e20 696e   'R' is given in
+000017f0: 7374 6561 6420 6f66 2061 0a20 2020 2020  stead of a.     
+00001800: 2020 2020 2020 2033 7833 206d 6174 7269         3x3 matri
+00001810: 782c 2074 6865 2070 7269 6d69 7469 7665  x, the primitive
+00001820: 206d 6174 7269 7820 6465 6669 6e65 6420   matrix defined 
+00001830: 6174 0a20 2020 2020 2020 2020 2020 2068  at.            h
+00001840: 7474 7073 3a2f 2f73 7067 6c69 622e 6769  ttps://spglib.gi
+00001850: 7468 7562 2e69 6f2f 7370 676c 6962 2f64  thub.io/spglib/d
+00001860: 6566 696e 6974 696f 6e2e 6874 6d6c 2069  efinition.html i
+00001870: 7320 7573 6564 2e20 5768 656e 2027 6175  s used. When 'au
+00001880: 746f 270a 2020 2020 2020 2020 2020 2020  to'.            
+00001890: 6973 2067 6976 656e 2c20 7468 6520 6365  is given, the ce
+000018a0: 6e74 7269 6e67 2074 7970 6520 2827 4627  ntring type ('F'
+000018b0: 2c20 2749 272c 2027 4127 2c20 2743 272c  , 'I', 'A', 'C',
+000018c0: 2027 5227 2c20 6f72 2070 7269 6d69 7469   'R', or primiti
+000018d0: 7665 0a20 2020 2020 2020 2020 2020 2027  ve.            '
+000018e0: 5027 2920 6973 2061 7574 6f6d 6174 6963  P') is automatic
+000018f0: 616c 6c79 2063 686f 7365 6e2e 0a20 2020  ally chosen..   
+00001900: 2020 2020 2070 686f 6e6f 6e5f 7375 7065       phonon_supe
+00001910: 7263 656c 6c5f 6d61 7472 6978 203a 2061  rcell_matrix : a
+00001920: 7272 6179 5f6c 696b 652c 206f 7074 696f  rray_like, optio
+00001930: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00001940: 5375 7065 7263 656c 6c20 6d61 7472 6978  Supercell matrix
+00001950: 2075 7365 6420 666f 7220 6663 322e 2049   used for fc2. I
+00001960: 6e20 7068 6f6e 6f33 7079 2c20 7375 7065  n phono3py, supe
+00001970: 7263 656c 6c20 6d61 7472 6978 2066 6f72  rcell matrix for
+00001980: 2066 6333 0a20 2020 2020 2020 2020 2020   fc3.           
+00001990: 2061 6e64 2066 6332 2063 616e 2062 6520   and fc2 can be 
+000019a0: 6469 6666 6572 656e 7420 746f 2073 7570  different to sup
+000019b0: 706f 7274 206c 6f6e 6765 7220 7261 6e67  port longer rang
+000019c0: 6520 696e 7465 7261 6374 696f 6e20 6f66  e interaction of
+000019d0: 2066 6332 0a20 2020 2020 2020 2020 2020   fc2.           
+000019e0: 2074 6861 6e20 7468 6174 206f 6620 6663   than that of fc
+000019f0: 332e 2055 6e6c 6573 7320 7365 7474 696e  3. Unless settin
+00001a00: 6720 7468 6973 2c20 7375 7065 7263 656c  g this, supercel
+00001a10: 6c5f 6d61 7472 6978 2069 7320 7573 6564  l_matrix is used
+00001a20: 2e0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00001a30: 6973 2069 7320 6f6e 6c79 2076 616c 6964  is is only valid
+00001a40: 6520 7768 656e 2075 6e69 7463 656c 6c20  e when unitcell 
+00001a50: 6f72 2075 6e69 7463 656c 6c5f 6669 6c65  or unitcell_file
+00001a60: 6e61 6d65 2069 7320 6769 7665 6e2e 0a20  name is given.. 
+00001a70: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+00001a80: 6c74 2069 7320 4e6f 6e65 2e0a 2020 2020  lt is None..    
+00001a90: 2020 2020 6d61 7373 6573 203a 2044 6570      masses : Dep
+00001aa0: 7265 6361 7465 642e 0a20 2020 2020 2020  recated..       
+00001ab0: 2020 2020 2055 7365 2050 686f 6e6f 3370       Use Phono3p
+00001ac0: 792e 6d61 7373 6573 2061 7474 7269 6275  y.masses attribu
+00001ad0: 7465 2061 6674 6572 2069 6e73 7461 6e63  te after instanc
+00001ae0: 6961 7469 6f6e 2e0a 2020 2020 2020 2020  iation..        
+00001af0: 6261 6e64 5f69 6e64 6963 6573 203a 2044  band_indices : D
+00001b00: 6570 7265 6361 7465 642e 0a20 2020 2020  eprecated..     
+00001b10: 2020 2020 2020 2055 7365 2050 686f 6e6f         Use Phono
+00001b20: 3370 792e 6261 6e64 5f69 6e64 6963 6573  3py.band_indices
+00001b30: 2061 7474 7269 6275 7465 2061 6674 6572   attribute after
+00001b40: 2069 6e73 7461 6e63 6961 7469 6f6e 2e0a   instanciation..
+00001b50: 2020 2020 2020 2020 7369 676d 6173 203a          sigmas :
+00001b60: 2044 6570 7265 6361 7465 642e 0a20 2020   Deprecated..   
+00001b70: 2020 2020 2020 2020 2055 7365 2050 686f           Use Pho
+00001b80: 6e6f 3370 792e 7369 676d 6173 2061 7474  no3py.sigmas att
+00001b90: 7269 6275 7465 2061 6674 6572 2069 6e73  ribute after ins
+00001ba0: 7461 6e63 6961 7469 6f6e 2e0a 2020 2020  tanciation..    
+00001bb0: 2020 2020 7369 676d 615f 6375 746f 6666      sigma_cutoff
+00001bc0: 203a 2044 6570 7265 6361 7465 642e 0a20   : Deprecated.. 
+00001bd0: 2020 2020 2020 2020 2020 2055 7365 2050             Use P
+00001be0: 686f 6e6f 3370 792e 7369 676d 615f 6375  hono3py.sigma_cu
+00001bf0: 746f 6666 2061 7474 7269 6275 7465 2061  toff attribute a
+00001c00: 6674 6572 2069 6e73 7461 6e63 6961 7469  fter instanciati
+00001c10: 6f6e 2e0a 2020 2020 2020 2020 6375 746f  on..        cuto
+00001c20: 6666 5f66 7265 7175 656e 6379 203a 2066  ff_frequency : f
+00001c30: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
+00001c40: 2020 2020 2020 2020 2020 2050 686f 6e6f             Phono
+00001c50: 6e20 6672 6571 7565 6e63 7920 6265 6c6f  n frequency belo
+00001c60: 7720 7468 6973 2076 616c 7565 2069 7320  w this value is 
+00001c70: 6967 6e6f 7265 6420 7768 656e 2074 6865  ignored when the
+00001c80: 2063 7574 6f66 6620 6973 0a20 2020 2020   cutoff is.     
+00001c90: 2020 2020 2020 206e 6565 6465 6420 666f         needed fo
+00001ca0: 7220 7468 6520 636f 6d70 7574 6174 696f  r the computatio
+00001cb0: 6e2e 2044 6566 6175 6c74 2069 7320 3165  n. Default is 1e
+00001cc0: 2d34 2e0a 2020 2020 2020 2020 6672 6571  -4..        freq
+00001cd0: 7565 6e63 795f 6661 6374 6f72 5f74 6f5f  uency_factor_to_
+00001ce0: 5448 7a20 3a20 666c 6f61 742c 206f 7074  THz : float, opt
+00001cf0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00001d00: 2020 5068 6f6e 6f6e 2066 7265 7175 656e    Phonon frequen
+00001d10: 6379 2075 6e69 7420 636f 6e76 6572 7369  cy unit conversi
+00001d20: 6f6e 2066 6163 746f 722e 2055 6e6c 6573  on factor. Unles
+00001d30: 7320 7370 6563 6966 6965 642c 2064 6566  s specified, def
+00001d40: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
+00001d50: 2075 6e69 7420 636f 6e76 6572 7369 6f6e   unit conversion
+00001d60: 2066 6163 746f 7220 666f 7220 6561 6368   factor for each
+00001d70: 2063 616c 6375 6c61 746f 7220 6973 2075   calculator is u
+00001d80: 7365 642e 0a20 2020 2020 2020 2069 735f  sed..        is_
+00001d90: 7379 6d6d 6574 7279 203a 2062 6f6f 6c2c  symmetry : bool,
+00001da0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00001db0: 2020 2020 2020 5573 6520 6372 7973 7461        Use crysta
+00001dc0: 6c20 7379 6d6d 6574 7279 2069 6e20 6d6f  l symmetry in mo
+00001dd0: 7374 2063 616c 6375 6c61 7469 6f6e 7320  st calculations 
+00001de0: 7768 656e 2054 7275 652e 2044 6566 6175  when True. Defau
+00001df0: 6c74 2069 730a 2020 2020 2020 2020 2020  lt is.          
+00001e00: 2020 5472 7565 2e0a 2020 2020 2020 2020    True..        
+00001e10: 6973 5f6d 6573 685f 7379 6d6d 6574 7279  is_mesh_symmetry
+00001e20: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+00001e30: 6c0a 2020 2020 2020 2020 2020 2020 5573  l.            Us
+00001e40: 6520 6372 7973 7461 6c20 7379 6d6d 6574  e crystal symmet
+00001e50: 7279 2069 6e20 7265 6369 7072 6f63 616c  ry in reciprocal
+00001e60: 2073 7061 6365 2067 7269 6420 6861 6e64   space grid hand
+00001e70: 6c69 6e67 2077 6865 6e20 5472 7565 2e0a  ling when True..
+00001e80: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+00001e90: 756c 7420 6973 2054 7275 652e 0a20 2020  ult is True..   
+00001ea0: 2020 2020 2075 7365 5f67 7267 203a 2062       use_grg : b
+00001eb0: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
+00001ec0: 2020 2020 2020 2020 2020 5573 6520 6765            Use ge
+00001ed0: 6e65 7261 6c69 7a65 6420 7265 6775 6c61  neralized regula
+00001ee0: 7220 6772 6964 2077 6865 6e20 5472 7565  r grid when True
+00001ef0: 2e20 4465 6661 756c 7420 6973 2046 616c  . Default is Fal
+00001f00: 7365 2e0a 2020 2020 2020 2020 534e 465f  se..        SNF_
+00001f10: 636f 6f72 6469 6e61 7465 7320 3a20 7374  coordinates : st
+00001f20: 722c 206f 7074 696f 6e61 6c0a 2020 2020  r, optional.    
+00001f30: 2020 2020 2020 2020 6072 6563 6970 726f          `recipro
+00001f40: 6361 6c60 206f 7220 6064 6972 6563 7460  cal` or `direct`
+00001f50: 2e20 5370 6163 6520 6f66 2063 6f6f 7264  . Space of coord
+00001f60: 696e 6174 6573 2074 6f20 6765 6e65 7261  inates to genera
+00001f70: 7465 2067 7269 640a 2020 2020 2020 2020  te grid.        
+00001f80: 2020 2020 6765 6e65 7261 7469 6e67 206d      generating m
+00001f90: 6174 7269 7820 6569 7468 6572 2069 6e20  atrix either in 
+00001fa0: 6469 7265 6374 206f 7220 7265 6369 7072  direct or recipr
+00001fb0: 6f63 616c 2073 7061 6365 2e20 5468 6520  ocal space. The 
+00001fc0: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
+00001fd0: 2020 2020 6973 2060 7265 6369 7072 6f63      is `reciproc
+00001fe0: 616c 602e 0a20 2020 2020 2020 2073 796d  al`..        sym
+00001ff0: 6d65 7472 697a 655f 6663 3371 203a 2044  metrize_fc3q : D
+00002000: 6570 7265 6361 7465 642e 0a20 2020 2020  eprecated..     
+00002010: 2020 2020 2020 2053 6565 2050 686f 6e6f         See Phono
+00002020: 3370 792e 696e 6974 5f70 6870 685f 696e  3py.init_phph_in
+00002030: 7465 7261 6374 696f 6e28 292e 0a20 2020  teraction()..   
+00002040: 2020 2020 2073 746f 7265 5f64 656e 7365       store_dense
+00002050: 5f67 705f 6d61 7020 3a20 626f 6f6c 2c20  _gp_map : bool, 
+00002060: 6f70 7469 6f6e 616c 2c20 4465 7072 6563  optional, Deprec
+00002070: 6174 6564 2e0a 2020 2020 2020 2020 2020  ated..          
+00002080: 2020 5573 6520 6465 6e73 6520 666f 726d    Use dense form
+00002090: 6174 206f 6620 425a 2067 7269 6420 7379  at of BZ grid sy
+000020a0: 7374 656d 2e20 4465 6661 756c 7420 6973  stem. Default is
+000020b0: 2054 7275 652e 0a20 2020 2020 2020 2073   True..        s
+000020c0: 746f 7265 5f64 656e 7365 5f73 7665 6373  tore_dense_svecs
+000020d0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+000020e0: 6c2c 2044 6570 7265 6361 7465 642e 0a20  l, Deprecated.. 
+000020f0: 2020 2020 2020 2020 2020 2053 686f 7274             Short
+00002100: 6573 7420 7665 6374 6f72 7320 6172 6520  est vectors are 
+00002110: 7374 6f72 6564 2069 6e20 7468 6520 6465  stored in the de
+00002120: 6e73 6520 6172 7261 7920 666f 726d 6174  nse array format
+00002130: 2e20 5468 6973 2069 730a 2020 2020 2020  . This is.      
+00002140: 2020 2020 2020 6578 7065 6374 6564 2074        expected t
+00002150: 6f20 6265 2061 6c77 6179 7320 5472 7565  o be always True
+00002160: 2e20 5365 7474 696e 6720 4661 6c73 6520  . Setting False 
+00002170: 6973 2066 6f72 2072 6f75 6768 2063 6f6d  is for rough com
+00002180: 7061 7469 6269 6c69 7479 0a20 2020 2020  patibility.     
+00002190: 2020 2020 2020 2077 6974 6820 7631 2e78         with v1.x
+000021a0: 2e20 4465 6661 756c 7420 6973 2054 7275  . Default is Tru
+000021b0: 652e 0a20 2020 2020 2020 2073 796d 7072  e..        sympr
+000021c0: 6563 203a 2066 6c6f 6174 2c20 6f70 7469  ec : float, opti
+000021d0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+000021e0: 2054 6f6c 6572 616e 6365 2075 7365 6420   Tolerance used 
+000021f0: 746f 2066 696e 6420 6372 7973 7461 6c20  to find crystal 
+00002200: 7379 6d6d 6574 7279 2e20 4465 6661 756c  symmetry. Defaul
+00002210: 7420 6973 2031 652d 352e 0a20 2020 2020  t is 1e-5..     
+00002220: 2020 2063 616c 6375 6c61 746f 7220 3a20     calculator : 
+00002230: 7374 722c 206f 7074 696f 6e61 6c2e 0a20  str, optional.. 
+00002240: 2020 2020 2020 2020 2020 2043 616c 6375             Calcu
+00002250: 6c61 746f 7220 7573 6564 2066 6f72 2063  lator used for c
+00002260: 6f6d 7075 7469 6e67 2066 6f72 6365 732e  omputing forces.
+00002270: 2054 6869 7320 6973 2075 7365 6420 746f   This is used to
+00002280: 2073 7769 7463 6820 7468 6520 7365 740a   switch the set.
+00002290: 2020 2020 2020 2020 2020 2020 6f66 2070              of p
+000022a0: 6879 7369 6361 6c20 756e 6974 732e 2044  hysical units. D
+000022b0: 6566 6175 6c74 2069 7320 4e6f 6e65 2c20  efault is None, 
+000022c0: 7768 6963 6820 6973 2065 7175 6976 616c  which is equival
+000022d0: 656e 7420 746f 2022 7661 7370 222e 0a20  ent to "vasp".. 
+000022e0: 2020 2020 2020 206c 6f67 5f6c 6576 656c         log_level
+000022f0: 203a 2069 6e74 2c20 6f70 7469 6f6e 616c   : int, optional
+00002300: 0a20 2020 2020 2020 2020 2020 2056 6572  .            Ver
+00002310: 626f 7369 7479 2063 6f6e 7472 6f6c 2e20  bosity control. 
+00002320: 4465 6661 756c 7420 6973 2030 2e20 5468  Default is 0. Th
+00002330: 6973 2063 616e 2062 6520 302c 2031 2c20  is can be 0, 1, 
+00002340: 6f72 2032 2e0a 2020 2020 2020 2020 6c61  or 2..        la
+00002350: 7061 636b 5f7a 6865 6576 5f75 706c 6f20  pack_zheev_uplo 
+00002360: 3a20 4465 7072 6563 6174 6564 2e0a 2020  : Deprecated..  
+00002370: 2020 2020 2020 2020 2020 5365 6520 5068            See Ph
+00002380: 6f6e 6f33 7079 2e69 6e69 745f 7068 7068  ono3py.init_phph
+00002390: 5f69 6e74 6572 6163 7469 6f6e 2829 2e0a  _interaction()..
+000023a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000023b0: 2020 2020 2073 656c 662e 5f73 796d 7072       self._sympr
+000023c0: 6563 203d 2073 796d 7072 6563 0a20 2020  ec = symprec.   
+000023d0: 2020 2020 2073 656c 662e 5f66 7265 7175       self._frequ
+000023e0: 656e 6379 5f66 6163 746f 725f 746f 5f54  ency_factor_to_T
+000023f0: 487a 203d 2066 7265 7175 656e 6379 5f66  Hz = frequency_f
+00002400: 6163 746f 725f 746f 5f54 487a 0a20 2020  actor_to_THz.   
+00002410: 2020 2020 2073 656c 662e 5f69 735f 7379       self._is_sy
+00002420: 6d6d 6574 7279 203d 2069 735f 7379 6d6d  mmetry = is_symm
+00002430: 6574 7279 0a20 2020 2020 2020 2073 656c  etry.        sel
+00002440: 662e 5f69 735f 6d65 7368 5f73 796d 6d65  f._is_mesh_symme
+00002450: 7472 7920 3d20 6973 5f6d 6573 685f 7379  try = is_mesh_sy
+00002460: 6d6d 6574 7279 0a20 2020 2020 2020 2073  mmetry.        s
+00002470: 656c 662e 5f75 7365 5f67 7267 203d 2075  elf._use_grg = u
+00002480: 7365 5f67 7267 0a20 2020 2020 2020 2073  se_grg.        s
+00002490: 656c 662e 5f53 4e46 5f63 6f6f 7264 696e  elf._SNF_coordin
+000024a0: 6174 6573 203d 2053 4e46 5f63 6f6f 7264  ates = SNF_coord
+000024b0: 696e 6174 6573 0a0a 2020 2020 2020 2020  inates..        
+000024c0: 6966 206e 6f74 2073 746f 7265 5f64 656e  if not store_den
+000024d0: 7365 5f67 705f 6d61 703a 0a20 2020 2020  se_gp_map:.     
+000024e0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000024f0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+00002500: 2020 2020 2020 2250 686f 6e6f 3370 7920        "Phono3py 
+00002510: 696e 6974 2070 6172 616d 6574 6572 206f  init parameter o
+00002520: 6620 7374 6f72 655f 6465 6e73 655f 6770  f store_dense_gp
+00002530: 5f6d 6170 2069 7320 6465 7072 6563 6174  _map is deprecat
+00002540: 6564 2e20 220a 2020 2020 2020 2020 2020  ed. ".          
+00002550: 2020 2020 2020 2254 6869 7320 7769 6c6c        "This will
+00002560: 2062 6520 7365 7420 616c 7761 7973 2054   be set always T
+00002570: 7275 652e 222c 0a20 2020 2020 2020 2020  rue.",.         
+00002580: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
+00002590: 6f6e 5761 726e 696e 672c 0a20 2020 2020  onWarning,.     
+000025a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000025b0: 2073 656c 662e 5f73 746f 7265 5f64 656e   self._store_den
+000025c0: 7365 5f67 705f 6d61 7020 3d20 7374 6f72  se_gp_map = stor
+000025d0: 655f 6465 6e73 655f 6770 5f6d 6170 0a0a  e_dense_gp_map..
+000025e0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+000025f0: 746f 7265 5f64 656e 7365 5f73 7665 6373  tore_dense_svecs
+00002600: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
+00002610: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+00002620: 2020 2020 2020 2020 2020 2020 2022 5068               "Ph
+00002630: 6f6e 6f33 7079 2069 6e69 7420 7061 7261  ono3py init para
+00002640: 6d65 7465 7220 6f66 2073 746f 7265 5f64  meter of store_d
+00002650: 656e 7365 5f73 7665 6373 2069 7320 6465  ense_svecs is de
+00002660: 7072 6563 6174 6564 2e20 220a 2020 2020  precated. ".    
+00002670: 2020 2020 2020 2020 2020 2020 2254 6869              "Thi
+00002680: 7320 7769 6c6c 2062 6520 7365 7420 616c  s will be set al
+00002690: 7761 7973 2054 7275 652e 222c 0a20 2020  ways True.",.   
+000026a0: 2020 2020 2020 2020 2020 2020 2044 6570               Dep
+000026b0: 7265 6361 7469 6f6e 5761 726e 696e 672c  recationWarning,
+000026c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000026d0: 2020 2020 2020 2073 656c 662e 5f73 746f         self._sto
+000026e0: 7265 5f64 656e 7365 5f73 7665 6373 203d  re_dense_svecs =
+000026f0: 2073 746f 7265 5f64 656e 7365 5f73 7665   store_dense_sve
+00002700: 6373 0a0a 2020 2020 2020 2020 7365 6c66  cs..        self
+00002710: 2e5f 6375 746f 6666 5f66 7265 7175 656e  ._cutoff_frequen
+00002720: 6379 203d 2063 7574 6f66 665f 6672 6571  cy = cutoff_freq
+00002730: 7565 6e63 790a 2020 2020 2020 2020 7365  uency.        se
+00002740: 6c66 2e5f 6361 6c63 756c 6174 6f72 203d  lf._calculator =
+00002750: 2063 616c 6375 6c61 746f 720a 2020 2020   calculator.    
+00002760: 2020 2020 7365 6c66 2e5f 6c6f 675f 6c65      self._log_le
+00002770: 7665 6c20 3d20 6c6f 675f 6c65 7665 6c0a  vel = log_level.
+00002780: 0a20 2020 2020 2020 2023 2043 7265 6174  .        # Creat
+00002790: 6520 7375 7065 7263 656c 6c20 616e 6420  e supercell and 
+000027a0: 7072 696d 6974 6976 6520 6365 6c6c 0a20  primitive cell. 
+000027b0: 2020 2020 2020 2073 656c 662e 5f75 6e69         self._uni
+000027c0: 7463 656c 6c20 3d20 756e 6974 6365 6c6c  tcell = unitcell
+000027d0: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
+000027e0: 7570 6572 6365 6c6c 5f6d 6174 7269 7820  upercell_matrix 
+000027f0: 3d20 6e70 2e61 7272 6179 280a 2020 2020  = np.array(.    
+00002800: 2020 2020 2020 2020 7368 6170 655f 7375          shape_su
+00002810: 7065 7263 656c 6c5f 6d61 7472 6978 2873  percell_matrix(s
+00002820: 7570 6572 6365 6c6c 5f6d 6174 7269 7829  upercell_matrix)
+00002830: 2c20 6474 7970 653d 2269 6e74 5f22 2c20  , dtype="int_", 
+00002840: 6f72 6465 723d 2243 220a 2020 2020 2020  order="C".      
+00002850: 2020 290a 2020 2020 2020 2020 706d 6174    ).        pmat
+00002860: 203d 2073 656c 662e 5f64 6574 6572 6d69   = self._determi
+00002870: 6e65 5f70 7269 6d69 7469 7665 5f6d 6174  ne_primitive_mat
+00002880: 7269 7828 7072 696d 6974 6976 655f 6d61  rix(primitive_ma
+00002890: 7472 6978 290a 2020 2020 2020 2020 7365  trix).        se
+000028a0: 6c66 2e5f 7072 696d 6974 6976 655f 6d61  lf._primitive_ma
+000028b0: 7472 6978 203d 2070 6d61 740a 2020 2020  trix = pmat.    
+000028c0: 2020 2020 7365 6c66 2e5f 6e61 635f 7061      self._nac_pa
+000028d0: 7261 6d73 203d 204e 6f6e 650a 2020 2020  rams = None.    
+000028e0: 2020 2020 6966 2070 686f 6e6f 6e5f 7375      if phonon_su
+000028f0: 7065 7263 656c 6c5f 6d61 7472 6978 2069  percell_matrix i
+00002900: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00002910: 2020 2020 2020 2020 7365 6c66 2e5f 7068          self._ph
+00002920: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
+00002930: 6174 7269 7820 3d20 6e70 2e61 7272 6179  atrix = np.array
+00002940: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00002950: 2020 7368 6170 655f 7375 7065 7263 656c    shape_supercel
+00002960: 6c5f 6d61 7472 6978 2870 686f 6e6f 6e5f  l_matrix(phonon_
+00002970: 7375 7065 7263 656c 6c5f 6d61 7472 6978  supercell_matrix
+00002980: 292c 2064 7479 7065 3d22 696e 745f 222c  ), dtype="int_",
+00002990: 206f 7264 6572 3d22 4322 0a20 2020 2020   order="C".     
+000029a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000029b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000029c0: 2020 2073 656c 662e 5f70 686f 6e6f 6e5f     self._phonon_
+000029d0: 7375 7065 7263 656c 6c5f 6d61 7472 6978  supercell_matrix
+000029e0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+000029f0: 7365 6c66 2e5f 7375 7065 7263 656c 6c20  self._supercell 
+00002a00: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00002a10: 656c 662e 5f70 7269 6d69 7469 7665 203d  elf._primitive =
+00002a20: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+00002a30: 6c66 2e5f 7068 6f6e 6f6e 5f73 7570 6572  lf._phonon_super
+00002a40: 6365 6c6c 203d 204e 6f6e 650a 2020 2020  cell = None.    
+00002a50: 2020 2020 7365 6c66 2e5f 7068 6f6e 6f6e      self._phonon
+00002a60: 5f70 7269 6d69 7469 7665 203d 204e 6f6e  _primitive = Non
+00002a70: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00002a80: 6275 696c 645f 7375 7065 7263 656c 6c28  build_supercell(
+00002a90: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00002aa0: 6275 696c 645f 7072 696d 6974 6976 655f  build_primitive_
+00002ab0: 6365 6c6c 2829 0a20 2020 2020 2020 2073  cell().        s
+00002ac0: 656c 662e 5f62 7569 6c64 5f70 686f 6e6f  elf._build_phono
+00002ad0: 6e5f 7375 7065 7263 656c 6c28 290a 2020  n_supercell().  
+00002ae0: 2020 2020 2020 7365 6c66 2e5f 6275 696c        self._buil
+00002af0: 645f 7068 6f6e 6f6e 5f70 7269 6d69 7469  d_phonon_primiti
+00002b00: 7665 5f63 656c 6c28 290a 0a20 2020 2020  ve_cell()..     
+00002b10: 2020 2073 656c 662e 5f73 6967 6d61 7320     self._sigmas 
+00002b20: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+00002b30: 4e6f 6e65 2c0a 2020 2020 2020 2020 5d0a  None,.        ].
+00002b40: 2020 2020 2020 2020 7365 6c66 2e5f 7369          self._si
+00002b50: 676d 615f 6375 746f 6666 203d 204e 6f6e  gma_cutoff = Non
+00002b60: 650a 0a20 2020 2020 2020 2023 2047 7269  e..        # Gri
+00002b70: 640a 2020 2020 2020 2020 7365 6c66 2e5f  d.        self._
+00002b80: 627a 5f67 7269 6420 3d20 4e6f 6e65 0a0a  bz_grid = None..
+00002b90: 2020 2020 2020 2020 2320 5365 7420 7375          # Set su
+00002ba0: 7065 7263 656c 6c2c 2070 7269 6d69 7469  percell, primiti
+00002bb0: 7665 2c20 616e 6420 7068 6f6e 6f6e 2073  ve, and phonon s
+00002bc0: 7570 6572 6365 6c6c 2073 796d 6d65 7472  upercell symmetr
+00002bd0: 6965 730a 2020 2020 2020 2020 7365 6c66  ies.        self
+00002be0: 2e5f 7379 6d6d 6574 7279 203d 204e 6f6e  ._symmetry = Non
+00002bf0: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00002c00: 7072 696d 6974 6976 655f 7379 6d6d 6574  primitive_symmet
+00002c10: 7279 203d 204e 6f6e 650a 2020 2020 2020  ry = None.      
+00002c20: 2020 7365 6c66 2e5f 7068 6f6e 6f6e 5f73    self._phonon_s
+00002c30: 7570 6572 6365 6c6c 5f73 796d 6d65 7472  upercell_symmetr
+00002c40: 7920 3d20 4e6f 6e65 0a20 2020 2020 2020  y = None.       
+00002c50: 2073 656c 662e 5f73 6561 7263 685f 7379   self._search_sy
+00002c60: 6d6d 6574 7279 2829 0a20 2020 2020 2020  mmetry().       
+00002c70: 2073 656c 662e 5f73 6561 7263 685f 7072   self._search_pr
+00002c80: 696d 6974 6976 655f 7379 6d6d 6574 7279  imitive_symmetry
+00002c90: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00002ca0: 5f73 6561 7263 685f 7068 6f6e 6f6e 5f73  _search_phonon_s
+00002cb0: 7570 6572 6365 6c6c 5f73 796d 6d65 7472  upercell_symmetr
+00002cc0: 7928 290a 0a20 2020 2020 2020 2023 2044  y()..        # D
+00002cd0: 6973 706c 6163 656d 656e 7473 2061 6e64  isplacements and
+00002ce0: 2073 7570 6572 6365 6c6c 730a 2020 2020   supercells.    
+00002cf0: 2020 2020 7365 6c66 2e5f 7375 7065 7263      self._superc
+00002d00: 656c 6c73 5f77 6974 685f 6469 7370 6c61  ells_with_displa
+00002d10: 6365 6d65 6e74 7320 3d20 4e6f 6e65 0a20  cements = None. 
+00002d20: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
+00002d30: 6173 6574 203d 204e 6f6e 650a 2020 2020  aset = None.    
+00002d40: 2020 2020 7365 6c66 2e5f 7068 6f6e 6f6e      self._phonon
+00002d50: 5f64 6174 6173 6574 203d 204e 6f6e 650a  _dataset = None.
+00002d60: 2020 2020 2020 2020 7365 6c66 2e5f 7068          self._ph
+00002d70: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 735f  onon_supercells_
+00002d80: 7769 7468 5f64 6973 706c 6163 656d 656e  with_displacemen
+00002d90: 7473 203d 204e 6f6e 650a 0a20 2020 2020  ts = None..     
+00002da0: 2020 2023 2054 6865 726d 616c 2063 6f6e     # Thermal con
+00002db0: 6475 6374 6976 6974 790a 2020 2020 2020  ductivity.      
+00002dc0: 2020 2320 636f 6e64 7563 7469 7669 7479    # conductivity
+00002dd0: 5f52 5441 206f 7220 636f 6e64 7563 7469  _RTA or conducti
+00002de0: 7669 7479 5f4c 4254 4520 636c 6173 7320  vity_LBTE class 
+00002df0: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+00002e00: 2073 656c 662e 5f74 6865 726d 616c 5f63   self._thermal_c
+00002e10: 6f6e 6475 6374 6976 6974 7920 3d20 4e6f  onductivity = No
+00002e20: 6e65 0a0a 2020 2020 2020 2020 2320 496d  ne..        # Im
+00002e30: 6167 696e 6172 7920 7061 7274 206f 6620  aginary part of 
+00002e40: 7365 6c66 2065 6e65 7267 7920 6174 2066  self energy at f
+00002e50: 7265 7175 656e 6379 2070 6f69 6e74 730a  requency points.
+00002e60: 2020 2020 2020 2020 7365 6c66 2e5f 6761          self._ga
+00002e70: 6d6d 6173 203d 204e 6f6e 650a 2020 2020  mmas = None.    
+00002e80: 2020 2020 7365 6c66 2e5f 7363 6174 7465      self._scatte
+00002e90: 7269 6e67 5f65 7665 6e74 5f63 6c61 7373  ring_event_class
+00002ea0: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+00002eb0: 2023 2046 7265 7175 656e 6379 2073 6869   # Frequency shi
+00002ec0: 6674 2028 7265 616c 2070 6172 7420 6f66  ft (real part of
+00002ed0: 2062 7562 626c 6520 6469 6167 7261 6d29   bubble diagram)
+00002ee0: 0a20 2020 2020 2020 2073 656c 662e 5f72  .        self._r
+00002ef0: 6561 6c5f 7365 6c66 5f65 6e65 7267 7920  eal_self_energy 
+00002f00: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
+00002f10: 7365 6c66 2e5f 6772 6964 5f70 6f69 6e74  self._grid_point
+00002f20: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
+00002f30: 2073 656c 662e 5f66 7265 7175 656e 6379   self._frequency
+00002f40: 5f70 6f69 6e74 7320 3d20 4e6f 6e65 0a20  _points = None. 
+00002f50: 2020 2020 2020 2073 656c 662e 5f74 656d         self._tem
+00002f60: 7065 7261 7475 7265 7320 3d20 4e6f 6e65  peratures = None
+00002f70: 0a0a 2020 2020 2020 2020 2320 4f74 6865  ..        # Othe
+00002f80: 7220 7661 7269 6162 6c65 730a 2020 2020  r variables.    
+00002f90: 2020 2020 7365 6c66 2e5f 6663 3220 3d20      self._fc2 = 
+00002fa0: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
+00002fb0: 662e 5f66 6333 203d 204e 6f6e 650a 0a20  f._fc3 = None.. 
+00002fc0: 2020 2020 2020 2023 2053 6574 7570 2069         # Setup i
+00002fd0: 6e74 6572 6163 7469 6f6e 0a20 2020 2020  nteraction.     
+00002fe0: 2020 2073 656c 662e 5f69 6e74 6572 6163     self._interac
+00002ff0: 7469 6f6e 203d 204e 6f6e 650a 2020 2020  tion = None.    
+00003000: 2020 2020 7365 6c66 2e5f 6261 6e64 5f69      self._band_i
+00003010: 6e64 6963 6573 203d 204e 6f6e 650a 2020  ndices = None.  
+00003020: 2020 2020 2020 7365 6c66 2e5f 6261 6e64        self._band
+00003030: 5f69 6e64 6963 6573 5f66 6c61 7474 656e  _indices_flatten
+00003040: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00003050: 7365 6c66 2e5f 7365 745f 6261 6e64 5f69  self._set_band_i
+00003060: 6e64 6963 6573 2829 0a0a 2020 2020 2020  ndices()..      
+00003070: 2020 6966 206d 6173 7365 7320 6973 206e    if masses is n
+00003080: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00003090: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000030a0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+000030b0: 2020 2020 2250 686f 6e6f 3370 7920 696e      "Phono3py in
+000030c0: 6974 2070 6172 616d 6574 6572 206f 6620  it parameter of 
+000030d0: 6d61 7373 6573 2069 7320 6465 7072 6563  masses is deprec
+000030e0: 6174 6564 2e20 220a 2020 2020 2020 2020  ated. ".        
+000030f0: 2020 2020 2020 2020 2255 7365 2050 686f          "Use Pho
+00003100: 6e6f 3370 792e 6d61 7373 6573 2061 7474  no3py.masses att
+00003110: 7269 6275 7465 2069 6e73 7465 6164 2e22  ribute instead."
+00003120: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003130: 2020 4465 7072 6563 6174 696f 6e57 6172    DeprecationWar
+00003140: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+00003150: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00003160: 7365 6c66 2e6d 6173 7365 7320 3d20 6d61  self.masses = ma
+00003170: 7373 6573 0a0a 2020 2020 2020 2020 6966  sses..        if
+00003180: 2062 616e 645f 696e 6469 6365 7320 6973   band_indices is
+00003190: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000031a0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000031b0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+000031c0: 2020 2020 2020 2250 686f 6e6f 3370 7920        "Phono3py 
+000031d0: 696e 6974 2070 6172 616d 6574 6572 206f  init parameter o
+000031e0: 6620 6261 6e64 5f69 6e64 6963 6573 2069  f band_indices i
+000031f0: 7320 6465 7072 6563 6174 6564 2e20 220a  s deprecated. ".
+00003200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003210: 2255 7365 2050 686f 6e6f 3370 792e 6261  "Use Phono3py.ba
+00003220: 6e64 5f69 6e64 6963 6573 2061 7474 7269  nd_indices attri
+00003230: 6275 7465 2069 6e73 7465 6164 2e22 2c0a  bute instead.",.
+00003240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003250: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
+00003260: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+00003270: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00003280: 6c66 2e62 616e 645f 696e 6469 6365 7320  lf.band_indices 
+00003290: 3d20 6261 6e64 5f69 6e64 6963 6573 0a0a  = band_indices..
+000032a0: 2020 2020 2020 2020 6966 2073 6967 6d61          if sigma
+000032b0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+000032c0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+000032d0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+000032e0: 2020 2020 2020 2020 2020 2250 686f 6e6f            "Phono
+000032f0: 3370 7920 696e 6974 2070 6172 616d 6574  3py init paramet
+00003300: 6572 206f 6620 7369 676d 6173 2069 7320  er of sigmas is 
+00003310: 6465 7072 6563 6174 6564 2e20 220a 2020  deprecated. ".  
+00003320: 2020 2020 2020 2020 2020 2020 2020 2255                "U
+00003330: 7365 2050 686f 6e6f 3370 792e 7369 676d  se Phono3py.sigm
+00003340: 6173 2061 7474 7269 6275 7465 2069 6e73  as attribute ins
+00003350: 7465 6164 2e22 2c0a 2020 2020 2020 2020  tead.",.        
+00003360: 2020 2020 2020 2020 4465 7072 6563 6174          Deprecat
+00003370: 696f 6e57 6172 6e69 6e67 2c0a 2020 2020  ionWarning,.    
+00003380: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003390: 2020 2020 2020 7365 6c66 2e73 6967 6d61        self.sigma
+000033a0: 7320 3d20 7369 676d 6173 0a0a 2020 2020  s = sigmas..    
+000033b0: 2020 2020 6966 2073 6967 6d61 5f63 7574      if sigma_cut
+000033c0: 6f66 6620 6973 206e 6f74 204e 6f6e 653a  off is not None:
+000033d0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+000033e0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+000033f0: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
+00003400: 6e6f 3370 7920 696e 6974 2070 6172 616d  no3py init param
+00003410: 6574 6572 206f 6620 7369 676d 615f 6375  eter of sigma_cu
+00003420: 746f 6666 2069 7320 6465 7072 6563 6174  toff is deprecat
+00003430: 6564 2e20 220a 2020 2020 2020 2020 2020  ed. ".          
+00003440: 2020 2020 2020 2255 7365 2050 686f 6e6f        "Use Phono
+00003450: 3370 792e 7369 676d 615f 6375 746f 6666  3py.sigma_cutoff
+00003460: 2061 7474 7269 6275 7465 2069 6e73 7465   attribute inste
+00003470: 6164 2e22 2c0a 2020 2020 2020 2020 2020  ad.",.          
+00003480: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
+00003490: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
+000034a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000034b0: 2020 2020 7365 6c66 2e73 6967 6d61 5f63      self.sigma_c
+000034c0: 7574 6f66 6620 3d20 7369 676d 615f 6375  utoff = sigma_cu
+000034d0: 746f 6666 0a0a 2020 2020 2020 2020 6966  toff..        if
+000034e0: 2073 796d 6d65 7472 697a 655f 6663 3371   symmetrize_fc3q
+000034f0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00003500: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00003510: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00003520: 2020 2020 2020 2020 2022 5068 6f6e 6f33           "Phono3
+00003530: 7079 2069 6e69 7420 7061 7261 6d65 7465  py init paramete
+00003540: 7220 6f66 2073 796d 6d65 7472 697a 655f  r of symmetrize_
+00003550: 6663 3371 2069 7320 6465 7072 6563 6174  fc3q is deprecat
+00003560: 6564 2e20 220a 2020 2020 2020 2020 2020  ed. ".          
+00003570: 2020 2020 2020 2253 6574 2074 6869 7320        "Set this 
+00003580: 6174 2050 686f 6e6f 3370 792e 696e 6974  at Phono3py.init
+00003590: 5f70 6870 685f 696e 7465 7261 6374 696f  _phph_interactio
+000035a0: 6e28 292e 222c 0a20 2020 2020 2020 2020  n().",.         
+000035b0: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
+000035c0: 6f6e 5761 726e 696e 672c 0a20 2020 2020  onWarning,.     
+000035d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000035e0: 2020 2020 2073 656c 662e 5f73 796d 6d65       self._symme
+000035f0: 7472 697a 655f 6663 3371 203d 2073 796d  trize_fc3q = sym
+00003600: 6d65 7472 697a 655f 6663 3371 0a20 2020  metrize_fc3q.   
+00003610: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00003620: 2020 2020 2020 2073 656c 662e 5f73 796d         self._sym
+00003630: 6d65 7472 697a 655f 6663 3371 203d 204e  metrize_fc3q = N
+00003640: 6f6e 650a 0a20 2020 2020 2020 2069 6620  one..        if 
+00003650: 6c61 7061 636b 5f7a 6865 6576 5f75 706c  lapack_zheev_upl
+00003660: 6f20 6973 206e 6f74 204e 6f6e 653a 0a20  o is not None:. 
+00003670: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+00003680: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+00003690: 2020 2020 2020 2020 2020 2250 686f 6e6f            "Phono
+000036a0: 3370 7920 696e 6974 2070 6172 616d 6574  3py init paramet
+000036b0: 6572 206f 6620 6c61 7061 636b 5f7a 6865  er of lapack_zhe
+000036c0: 6576 5f75 706c 6f20 6973 2064 6570 7265  ev_uplo is depre
+000036d0: 6361 7465 642e 2022 0a20 2020 2020 2020  cated. ".       
+000036e0: 2020 2020 2020 2020 2022 5365 7420 7468           "Set th
+000036f0: 6973 2061 7420 5068 6f6e 6f33 7079 2e69  is at Phono3py.i
+00003700: 6e69 745f 7068 7068 5f69 6e74 6572 6163  nit_phph_interac
+00003710: 7469 6f6e 2829 2e22 2c0a 2020 2020 2020  tion().",.      
+00003720: 2020 2020 2020 2020 2020 4465 7072 6563            Deprec
+00003730: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
+00003740: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00003750: 2020 2020 2020 2020 7365 6c66 2e5f 6c61          self._la
+00003760: 7061 636b 5f7a 6865 6576 5f75 706c 6f20  pack_zheev_uplo 
+00003770: 3d20 6c61 7061 636b 5f7a 6865 6576 5f75  = lapack_zheev_u
+00003780: 706c 6f0a 2020 2020 2020 2020 656c 7365  plo.        else
+00003790: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000037a0: 6c66 2e5f 6c61 7061 636b 5f7a 6865 6576  lf._lapack_zheev
+000037b0: 5f75 706c 6f20 3d20 4e6f 6e65 0a0a 2020  _uplo = None..  
+000037c0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000037d0: 6465 6620 7665 7273 696f 6e28 7365 6c66  def version(self
+000037e0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+000037f0: 7475 726e 2070 686f 6e6f 3370 7920 7265  turn phono3py re
+00003800: 6c65 6173 6520 7665 7273 696f 6e20 6e75  lease version nu
+00003810: 6d62 6572 2e0a 0a20 2020 2020 2020 2073  mber...        s
+00003820: 7472 0a20 2020 2020 2020 2020 2020 2050  tr.            P
+00003830: 686f 6e6f 3370 7920 7265 6c65 6173 6520  hono3py release 
+00003840: 7665 7273 696f 6e20 6e75 6d62 6572 0a0a  version number..
+00003850: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00003860: 2020 2020 7265 7475 726e 205f 5f76 6572      return __ver
+00003870: 7369 6f6e 5f5f 0a0a 2020 2020 6465 6620  sion__..    def 
+00003880: 6765 745f 7665 7273 696f 6e28 7365 6c66  get_version(self
+00003890: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+000038a0: 7475 726e 2070 686f 6e6f 3370 7920 7265  turn phono3py re
+000038b0: 6c65 6173 6520 7665 7273 696f 6e20 6e75  lease version nu
+000038c0: 6d62 6572 2e22 2222 0a20 2020 2020 2020  mber.""".       
+000038d0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+000038e0: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
+000038f0: 6e6f 3370 792e 6765 745f 7665 7273 696f  no3py.get_versio
+00003900: 6e28 2920 6973 2064 6570 7265 6361 7465  n() is deprecate
+00003910: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
+00003920: 2255 7365 2050 686f 6e6f 3370 792e 7665  "Use Phono3py.ve
+00003930: 7273 696f 6e20 6174 7472 6962 7574 6520  rsion attribute 
+00003940: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+00003950: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
+00003960: 6f6e 5761 726e 696e 672c 0a20 2020 2020  onWarning,.     
+00003970: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00003980: 7572 6e20 7365 6c66 2e76 6572 7369 6f6e  urn self.version
+00003990: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+000039a0: 2020 2020 6465 6620 6361 6c63 756c 6174      def calculat
+000039b0: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
+000039c0: 2020 2222 2252 6574 7572 6e20 6361 6c63    """Return calc
+000039d0: 756c 6174 6f72 2069 6e74 6572 6661 6365  ulator interface
+000039e0: 206e 616d 652e 0a0a 2020 2020 2020 2020   name...        
+000039f0: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
+00003a00: 4361 6c63 756c 6174 6f72 206e 616d 6520  Calculator name 
+00003a10: 7375 6368 2061 7320 2776 6173 7027 2c20  such as 'vasp', 
+00003a20: 2771 6527 2c20 6574 632e 0a0a 2020 2020  'qe', etc...    
+00003a30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00003a40: 7265 7475 726e 2073 656c 662e 5f63 616c  return self._cal
+00003a50: 6375 6c61 746f 720a 0a20 2020 2040 7072  culator..    @pr
+00003a60: 6f70 6572 7479 0a20 2020 2064 6566 2066  operty.    def f
+00003a70: 6333 2873 656c 6629 3a0a 2020 2020 2020  c3(self):.      
+00003a80: 2020 2222 2253 6574 7465 7220 616e 6420    """Setter and 
+00003a90: 6765 7474 6572 206f 6620 7468 6972 6420  getter of third 
+00003aa0: 6f72 6465 7220 666f 7263 6520 636f 6e73  order force cons
+00003ab0: 7461 6e74 7320 2866 6333 292e 0a0a 2020  tants (fc3)...  
+00003ac0: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
+00003ad0: 2020 2020 2020 2020 2020 6663 3320 7368            fc3 sh
+00003ae0: 6170 6520 6973 2065 6974 6865 7220 2873  ape is either (s
+00003af0: 7570 6572 6365 6c6c 2c20 7375 7065 6365  upercell, supece
+00003b00: 6c6c 2c20 7375 7065 7263 656c 6c2c 2033  ll, supercell, 3
+00003b10: 2c20 332c 2033 2920 6f72 0a20 2020 2020  , 3, 3) or.     
+00003b20: 2020 2020 2020 2028 7072 696d 6974 6976         (primitiv
+00003b30: 652c 2073 7570 6572 6365 6c6c 2c20 7375  e, supercell, su
+00003b40: 7065 6365 6c6c 2c20 332c 2033 2c20 3329  pecell, 3, 3, 3)
+00003b50: 2c0a 2020 2020 2020 2020 2020 2020 7768  ,.            wh
+00003b60: 6572 6520 2773 7570 6572 6365 6c6c 2720  ere 'supercell' 
+00003b70: 616e 6420 2770 7269 6d69 7469 7665 2720  and 'primitive' 
+00003b80: 696e 6469 6361 7465 206e 756d 6265 7220  indicate number 
+00003b90: 6f66 2061 746f 6d73 2069 6e0a 2020 2020  of atoms in.    
+00003ba0: 2020 2020 2020 2020 7468 6573 6520 6365          these ce
+00003bb0: 6c6c 732e 0a0a 2020 2020 2020 2020 2222  lls...        ""
+00003bc0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00003bd0: 2073 656c 662e 5f66 6333 0a0a 2020 2020   self._fc3..    
+00003be0: 4066 6333 2e73 6574 7465 720a 2020 2020  @fc3.setter.    
+00003bf0: 6465 6620 6663 3328 7365 6c66 2c20 6663  def fc3(self, fc
+00003c00: 3329 3a0a 2020 2020 2020 2020 7365 6c66  3):.        self
+00003c10: 2e5f 6663 3320 3d20 6663 330a 0a20 2020  ._fc3 = fc3..   
+00003c20: 2064 6566 2067 6574 5f66 6333 2873 656c   def get_fc3(sel
+00003c30: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+00003c40: 6574 7572 6e20 7468 6972 6420 6f72 6465  eturn third orde
+00003c50: 7220 666f 7263 6520 636f 6e73 7461 6e74  r force constant
+00003c60: 7320 2866 6333 292e 2222 220a 2020 2020  s (fc3).""".    
+00003c70: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00003c80: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+00003c90: 5068 6f6e 6f33 7079 2e67 6574 5f66 6333  Phono3py.get_fc3
+00003ca0: 2829 2069 7320 6465 7072 6563 6174 6564  () is deprecated
+00003cb0: 2e22 2022 5573 6520 5068 6f6e 6f33 7079  ." "Use Phono3py
+00003cc0: 2e66 6333 2061 7474 7269 6275 7465 2069  .fc3 attribute i
+00003cd0: 6e73 7465 6164 2e22 2c0a 2020 2020 2020  nstead.",.      
+00003ce0: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
+00003cf0: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
+00003d00: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00003d10: 726e 2073 656c 662e 6663 330a 0a20 2020  rn self.fc3..   
+00003d20: 2064 6566 2073 6574 5f66 6333 2873 656c   def set_fc3(sel
+00003d30: 662c 2066 6333 293a 0a20 2020 2020 2020  f, fc3):.       
+00003d40: 2022 2222 5365 7420 6663 332e 2222 220a   """Set fc3.""".
+00003d50: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00003d60: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+00003d70: 2020 2022 5068 6f6e 6f33 7079 2e73 6574     "Phono3py.set
+00003d80: 5f66 6333 2829 2069 7320 6465 7072 6563  _fc3() is deprec
+00003d90: 6174 6564 2e22 2022 5573 6520 5068 6f6e  ated." "Use Phon
+00003da0: 6f33 7079 2e66 6333 2061 7474 7269 6275  o3py.fc3 attribu
+00003db0: 7465 2069 6e73 7465 6164 2e22 2c0a 2020  te instead.",.  
+00003dc0: 2020 2020 2020 2020 2020 4465 7072 6563            Deprec
+00003dd0: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
+00003de0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00003df0: 7365 6c66 2e66 6333 203d 2066 6333 0a0a  self.fc3 = fc3..
+00003e00: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00003e10: 2020 6465 6620 6663 3228 7365 6c66 293a    def fc2(self):
+00003e20: 0a20 2020 2020 2020 2022 2222 5365 7474  .        """Sett
+00003e30: 6572 2061 6e64 2067 6574 7465 7220 6f66  er and getter of
+00003e40: 2073 6563 6f6e 6420 6f72 6465 7220 666f   second order fo
+00003e50: 7263 6520 636f 6e73 7461 6e74 7320 2866  rce constants (f
+00003e60: 6332 292e 0a0a 2020 2020 2020 2020 6e64  c2)...        nd
+00003e70: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00003e80: 2020 6663 3220 7368 6170 6520 6973 2065    fc2 shape is e
+00003e90: 6974 6865 7220 2873 7570 6572 6365 6c6c  ither (supercell
+00003ea0: 2c20 7375 7065 6365 6c6c 2c20 332c 2033  , supecell, 3, 3
+00003eb0: 2920 6f72 0a20 2020 2020 2020 2020 2020  ) or.           
+00003ec0: 2028 7072 696d 6974 6976 652c 2073 7570   (primitive, sup
+00003ed0: 6563 656c 6c2c 2033 2c20 3329 2c0a 2020  ecell, 3, 3),.  
+00003ee0: 2020 2020 2020 2020 2020 7768 6572 6520            where 
+00003ef0: 2773 7570 6572 6365 6c6c 2720 616e 6420  'supercell' and 
+00003f00: 2770 7269 6d69 7469 7665 2720 696e 6469  'primitive' indi
+00003f10: 6361 7465 206e 756d 6265 7220 6f66 2061  cate number of a
+00003f20: 746f 6d73 2069 6e0a 2020 2020 2020 2020  toms in.        
+00003f30: 2020 2020 7468 6573 6520 6365 6c6c 732e      these cells.
+00003f40: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00003f50: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00003f60: 662e 5f66 6332 0a0a 2020 2020 4066 6332  f._fc2..    @fc2
+00003f70: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+00003f80: 6663 3228 7365 6c66 2c20 6663 3229 3a0a  fc2(self, fc2):.
+00003f90: 2020 2020 2020 2020 7365 6c66 2e5f 6663          self._fc
+00003fa0: 3220 3d20 6663 320a 0a20 2020 2064 6566  2 = fc2..    def
+00003fb0: 2067 6574 5f66 6332 2873 656c 6629 3a0a   get_fc2(self):.
+00003fc0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00003fd0: 6e20 7365 636f 6e64 206f 7264 6572 2066  n second order f
+00003fe0: 6f72 6365 2063 6f6e 7374 616e 7473 2028  orce constants (
+00003ff0: 6663 3229 2e22 2222 0a20 2020 2020 2020  fc2).""".       
+00004000: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+00004010: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
+00004020: 6e6f 3370 792e 6765 745f 6663 3228 2920  no3py.get_fc2() 
+00004030: 6973 2064 6570 7265 6361 7465 642e 2220  is deprecated." 
+00004040: 2255 7365 2050 686f 6e6f 3370 792e 6663  "Use Phono3py.fc
+00004050: 3220 6174 7472 6962 7574 6520 696e 7374  2 attribute inst
+00004060: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
+00004070: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
+00004080: 726e 696e 672c 0a20 2020 2020 2020 2029  rning,.        )
+00004090: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000040a0: 7365 6c66 2e66 6332 0a0a 2020 2020 6465  self.fc2..    de
+000040b0: 6620 7365 745f 6663 3228 7365 6c66 2c20  f set_fc2(self, 
+000040c0: 6663 3229 3a0a 2020 2020 2020 2020 2222  fc2):.        ""
+000040d0: 2253 6574 2066 6332 2e22 2222 0a20 2020  "Set fc2.""".   
+000040e0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000040f0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00004100: 2250 686f 6e6f 3370 792e 7365 745f 6663  "Phono3py.set_fc
+00004110: 3228 2920 6973 2064 6570 7265 6361 7465  2() is deprecate
+00004120: 642e 2220 2255 7365 2050 686f 6e6f 3370  d." "Use Phono3p
+00004130: 792e 6663 3220 6174 7472 6962 7574 6520  y.fc2 attribute 
+00004140: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+00004150: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
+00004160: 6f6e 5761 726e 696e 672c 0a20 2020 2020  onWarning,.     
+00004170: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00004180: 662e 6663 3220 3d20 6663 320a 0a20 2020  f.fc2 = fc2..   
+00004190: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000041a0: 6566 2066 6f72 6365 5f63 6f6e 7374 616e  ef force_constan
+000041b0: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
+000041c0: 2020 2222 2252 6574 7572 6e20 6663 322e    """Return fc2.
+000041d0: 2054 6869 7320 6973 2073 616d 6520 6173   This is same as
+000041e0: 2074 6865 2067 6574 7465 7220 6174 7472   the getter attr
+000041f0: 6962 7574 6520 6066 6332 602e 2222 220a  ibute `fc2`.""".
+00004200: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00004210: 656c 662e 6663 320a 0a20 2020 2040 7072  elf.fc2..    @pr
+00004220: 6f70 6572 7479 0a20 2020 2064 6566 2073  operty.    def s
+00004230: 6967 6d61 7328 7365 6c66 293a 0a20 2020  igmas(self):.   
+00004240: 2020 2020 2022 2222 5365 7474 6572 2061       """Setter a
+00004250: 6e64 2067 6574 7465 7220 6f66 2073 6d65  nd getter of sme
+00004260: 6172 696e 6720 7769 6474 6873 2e0a 0a20  aring widths... 
+00004270: 2020 2020 2020 206c 6973 740a 2020 2020         list.    
+00004280: 2020 2020 2020 2020 5468 6520 666c 6f61          The floa
+00004290: 7420 7661 6c75 6573 2061 7265 2067 6976  t values are giv
+000042a0: 656e 2061 7320 7468 6520 7374 616e 6461  en as the standa
+000042b0: 7264 2064 6576 6961 7469 6f6e 7320 6f66  rd deviations of
+000042c0: 2047 6175 7373 6961 6e0a 2020 2020 2020   Gaussian.      
+000042d0: 2020 2020 2020 6675 6e63 7469 6f6e 2e20        function. 
+000042e0: 4966 204e 6f6e 6520 6973 2067 6976 656e  If None is given
+000042f0: 2061 7320 616e 2065 6c65 6d65 6e74 206f   as an element o
+00004300: 6620 7468 6973 206c 6973 742c 206c 696e  f this list, lin
+00004310: 6561 720a 2020 2020 2020 2020 2020 2020  ear.            
+00004320: 7465 7472 6168 6564 726f 6e20 6d65 7468  tetrahedron meth
+00004330: 6f64 2069 7320 7573 6564 2069 6e73 7465  od is used inste
+00004340: 6164 206f 6620 736d 6561 7269 6e67 206d  ad of smearing m
+00004350: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+00004360: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00004370: 726e 2073 656c 662e 5f73 6967 6d61 730a  rn self._sigmas.
+00004380: 0a20 2020 2040 7369 676d 6173 2e73 6574  .    @sigmas.set
+00004390: 7465 720a 2020 2020 6465 6620 7369 676d  ter.    def sigm
+000043a0: 6173 2873 656c 662c 2073 6967 6d61 7329  as(self, sigmas)
+000043b0: 3a0a 2020 2020 2020 2020 6966 2073 6967  :.        if sig
+000043c0: 6d61 7320 6973 204e 6f6e 653a 0a20 2020  mas is None:.   
+000043d0: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
+000043e0: 6967 6d61 7320 3d20 5b0a 2020 2020 2020  igmas = [.      
+000043f0: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
+00004400: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00004410: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00004420: 7461 6e63 6528 7369 676d 6173 2c20 666c  tance(sigmas, fl
+00004430: 6f61 7429 206f 7220 6973 696e 7374 616e  oat) or isinstan
+00004440: 6365 2873 6967 6d61 732c 2069 6e74 293a  ce(sigmas, int):
+00004450: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00004460: 662e 5f73 6967 6d61 7320 3d20 5b0a 2020  f._sigmas = [.  
+00004470: 2020 2020 2020 2020 2020 2020 2020 666c                fl
+00004480: 6f61 7428 7369 676d 6173 292c 0a20 2020  oat(sigmas),.   
+00004490: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+000044a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000044b0: 2020 2020 2073 656c 662e 5f73 6967 6d61       self._sigma
+000044c0: 7320 3d20 5b5d 0a20 2020 2020 2020 2020  s = [].         
+000044d0: 2020 2066 6f72 2073 2069 6e20 7369 676d     for s in sigm
+000044e0: 6173 3a0a 2020 2020 2020 2020 2020 2020  as:.            
+000044f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00004500: 6528 732c 2066 6c6f 6174 2920 6f72 2069  e(s, float) or i
+00004510: 7369 6e73 7461 6e63 6528 732c 2069 6e74  sinstance(s, int
+00004520: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00004530: 2020 2020 2020 2073 656c 662e 5f73 6967         self._sig
+00004540: 6d61 732e 6170 7065 6e64 2866 6c6f 6174  mas.append(float
+00004550: 2873 2929 0a20 2020 2020 2020 2020 2020  (s)).           
+00004560: 2020 2020 2065 6c69 6620 7320 6973 204e       elif s is N
+00004570: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00004580: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
+00004590: 6967 6d61 732e 6170 7065 6e64 284e 6f6e  igmas.append(Non
+000045a0: 6529 0a0a 2020 2020 4070 726f 7065 7274  e)..    @propert
+000045b0: 790a 2020 2020 6465 6620 7369 676d 615f  y.    def sigma_
+000045c0: 6375 746f 6666 2873 656c 6629 3a0a 2020  cutoff(self):.  
+000045d0: 2020 2020 2020 2222 2253 6574 7465 7220        """Setter 
+000045e0: 616e 6420 6765 7474 6572 206f 6620 536d  and getter of Sm
+000045f0: 6561 7269 6e67 2063 7574 6f66 6620 7769  earing cutoff wi
+00004600: 6474 682e 0a0a 2020 2020 2020 2020 5468  dth...        Th
+00004610: 6973 2069 7320 6769 7665 6e20 6173 2061  is is given as a
+00004620: 206d 756c 7469 706c 6520 6f66 2074 6865   multiple of the
+00004630: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+00004640: 696f 6e2e 0a0a 2020 2020 2020 2020 666c  ion...        fl
+00004650: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+00004660: 466f 7220 6578 616d 706c 652c 2069 6620  For example, if 
+00004670: 7468 6973 2076 616c 7565 2069 7320 352c  this value is 5,
+00004680: 2074 6865 2074 6169 6c20 6f66 2074 6865   the tail of the
+00004690: 2047 6175 7373 6961 6e20 6675 6e63 7469   Gaussian functi
+000046a0: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
+000046b0: 7320 6375 7420 6174 2035 2073 6967 6d61  s cut at 5 sigma
+000046c0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+000046d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000046e0: 6c66 2e5f 7369 676d 615f 6375 746f 6666  lf._sigma_cutoff
+000046f0: 0a0a 2020 2020 4073 6967 6d61 5f63 7574  ..    @sigma_cut
+00004700: 6f66 662e 7365 7474 6572 0a20 2020 2064  off.setter.    d
+00004710: 6566 2073 6967 6d61 5f63 7574 6f66 6628  ef sigma_cutoff(
+00004720: 7365 6c66 2c20 7369 676d 615f 6375 746f  self, sigma_cuto
+00004730: 6666 293a 0a20 2020 2020 2020 2073 656c  ff):.        sel
+00004740: 662e 5f73 6967 6d61 5f63 7574 6f66 6620  f._sigma_cutoff 
+00004750: 3d20 7369 676d 615f 6375 746f 6666 0a0a  = sigma_cutoff..
+00004760: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00004770: 2020 6465 6620 6e61 635f 7061 7261 6d73    def nac_params
+00004780: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00004790: 2222 2253 6574 7465 7220 616e 6420 6765  """Setter and ge
+000047a0: 7474 6572 206f 6620 7061 7261 6d65 7465  tter of paramete
+000047b0: 7273 2066 6f72 206e 6f6e 2d61 6e61 6c79  rs for non-analy
+000047c0: 7469 6361 6c20 7465 726d 2063 6f72 7265  tical term corre
+000047d0: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
+000047e0: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+000047f0: 2050 6172 616d 6574 6572 7320 7573 6564   Parameters used
+00004800: 2066 6f72 206e 6f6e 2d61 6e61 6c79 7469   for non-analyti
+00004810: 6361 6c20 7465 726d 2063 6f72 7265 6374  cal term correct
+00004820: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00004830: 2762 6f72 6e27 3a20 6e64 6172 7261 790a  'born': ndarray.
+00004840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004850: 426f 726e 2065 6666 6563 7469 7665 2063  Born effective c
+00004860: 6861 7267 6573 0a20 2020 2020 2020 2020  harges.         
+00004870: 2020 2020 2020 2073 6861 7065 3d28 7072         shape=(pr
+00004880: 696d 6974 6976 6520 6365 6c6c 2061 746f  imitive cell ato
+00004890: 6d73 2c20 332c 2033 292c 2064 7479 7065  ms, 3, 3), dtype
+000048a0: 3d27 646f 7562 6c65 272c 206f 7264 6572  ='double', order
+000048b0: 3d27 4327 0a20 2020 2020 2020 2020 2020  ='C'.           
+000048c0: 2027 6661 6374 6f72 273a 2066 6c6f 6174   'factor': float
+000048d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000048e0: 2055 6e69 7420 636f 6e76 6572 7369 6f6e   Unit conversion
+000048f0: 2066 6163 746f 720a 2020 2020 2020 2020   factor.        
+00004900: 2020 2020 2764 6965 6c65 6374 7269 6327      'dielectric'
+00004910: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
+00004920: 2020 2020 2020 2020 2020 4469 656c 6563            Dielec
+00004930: 7472 6963 2063 6f6e 7374 616e 7420 7465  tric constant te
+00004940: 6e73 6f72 0a20 2020 2020 2020 2020 2020  nsor.           
+00004950: 2020 2020 2073 6861 7065 3d28 332c 2033       shape=(3, 3
+00004960: 292c 2064 7479 7065 3d27 646f 7562 6c65  ), dtype='double
+00004970: 272c 206f 7264 6572 3d27 4327 0a0a 2020  ', order='C'..  
+00004980: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00004990: 2020 7265 7475 726e 2073 656c 662e 5f6e    return self._n
+000049a0: 6163 5f70 6172 616d 730a 0a20 2020 2040  ac_params..    @
+000049b0: 6e61 635f 7061 7261 6d73 2e73 6574 7465  nac_params.sette
+000049c0: 720a 2020 2020 6465 6620 6e61 635f 7061  r.    def nac_pa
+000049d0: 7261 6d73 2873 656c 662c 206e 6163 5f70  rams(self, nac_p
+000049e0: 6172 616d 7329 3a0a 2020 2020 2020 2020  arams):.        
+000049f0: 7365 6c66 2e5f 6e61 635f 7061 7261 6d73  self._nac_params
+00004a00: 203d 206e 6163 5f70 6172 616d 730a 2020   = nac_params.  
+00004a10: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
+00004a20: 6e74 6572 6163 7469 6f6e 2069 7320 6e6f  nteraction is no
+00004a30: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00004a40: 2020 2020 7365 6c66 2e5f 696e 6974 5f64      self._init_d
+00004a50: 796e 616d 6963 616c 5f6d 6174 7269 7828  ynamical_matrix(
+00004a60: 290a 0a20 2020 2064 6566 2067 6574 5f6e  )..    def get_n
+00004a70: 6163 5f70 6172 616d 7328 7365 6c66 293a  ac_params(self):
+00004a80: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00004a90: 726e 204e 4143 2070 6172 616d 6574 6572  rn NAC parameter
+00004aa0: 732e 2222 220a 2020 2020 2020 2020 7761  s.""".        wa
+00004ab0: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+00004ac0: 2020 2020 2020 2020 2022 5068 6f6e 6f33           "Phono3
+00004ad0: 7079 2e67 6574 5f6e 6163 5f70 6172 616d  py.get_nac_param
+00004ae0: 7328 2920 6973 2064 6570 7265 6361 7465  s() is deprecate
+00004af0: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
+00004b00: 2255 7365 2050 686f 6e6f 3370 792e 6e61  "Use Phono3py.na
+00004b10: 635f 7061 7261 6d73 2061 7474 7269 6275  c_params attribu
+00004b20: 7465 2069 6e73 7465 6164 2e22 2c0a 2020  te instead.",.  
+00004b30: 2020 2020 2020 2020 2020 4465 7072 6563            Deprec
+00004b40: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
+00004b50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00004b60: 7265 7475 726e 2073 656c 662e 6e61 635f  return self.nac_
+00004b70: 7061 7261 6d73 0a0a 2020 2020 6465 6620  params..    def 
+00004b80: 7365 745f 6e61 635f 7061 7261 6d73 2873  set_nac_params(s
+00004b90: 656c 662c 206e 6163 5f70 6172 616d 7329  elf, nac_params)
+00004ba0: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
+00004bb0: 204e 4143 2070 6172 616d 6574 6572 732e   NAC parameters.
+00004bc0: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
+00004bd0: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+00004be0: 2020 2020 2020 2022 5068 6f6e 6f33 7079         "Phono3py
+00004bf0: 2e73 6574 5f6e 6163 5f70 6172 616d 7328  .set_nac_params(
+00004c00: 2920 6973 2064 6570 7265 6361 7465 642e  ) is deprecated.
+00004c10: 220a 2020 2020 2020 2020 2020 2020 2255  ".            "U
+00004c20: 7365 2050 686f 6e6f 3370 792e 6e61 635f  se Phono3py.nac_
+00004c30: 7061 7261 6d73 2061 7474 7269 6275 7465  params attribute
+00004c40: 2069 6e73 7465 6164 2e22 2c0a 2020 2020   instead.",.    
+00004c50: 2020 2020 2020 2020 4465 7072 6563 6174          Deprecat
+00004c60: 696f 6e57 6172 6e69 6e67 2c0a 2020 2020  ionWarning,.    
+00004c70: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00004c80: 6c66 2e6e 6163 5f70 6172 616d 7320 3d20  lf.nac_params = 
+00004c90: 6e61 635f 7061 7261 6d73 0a0a 2020 2020  nac_params..    
+00004ca0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00004cb0: 6620 6479 6e61 6d69 6361 6c5f 6d61 7472  f dynamical_matr
+00004cc0: 6978 2873 656c 6629 3a0a 2020 2020 2020  ix(self):.      
+00004cd0: 2020 2222 2252 6574 7572 6e20 4479 6e61    """Return Dyna
+00004ce0: 6d69 6361 6c4d 6174 7269 7820 696e 7374  micalMatrix inst
+00004cf0: 616e 6365 2e0a 0a20 2020 2020 2020 2054  ance...        T
+00004d00: 6869 7320 6973 206e 6f74 2064 796e 616d  his is not dynam
+00004d10: 6963 616c 206d 6174 7269 6365 7320 6275  ical matrices bu
+00004d20: 7420 7468 6520 696e 7374 616e 6365 206f  t the instance o
+00004d30: 6620 4479 6e61 6d69 6361 6c4d 6174 7269  f DynamicalMatri
+00004d40: 780a 2020 2020 2020 2020 636c 6173 732e  x.        class.
+00004d50: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00004d60: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
+00004d70: 6e74 6572 6163 7469 6f6e 2069 7320 4e6f  nteraction is No
+00004d80: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00004d90: 7265 7475 726e 204e 6f6e 650a 2020 2020  return None.    
+00004da0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00004db0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00004dc0: 662e 5f69 6e74 6572 6163 7469 6f6e 2e64  f._interaction.d
+00004dd0: 796e 616d 6963 616c 5f6d 6174 7269 780a  ynamical_matrix.
+00004de0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00004df0: 2020 2064 6566 2070 7269 6d69 7469 7665     def primitive
+00004e00: 2873 656c 6629 202d 3e20 5072 696d 6974  (self) -> Primit
+00004e10: 6976 653a 0a20 2020 2020 2020 2022 2222  ive:.        """
+00004e20: 5265 7475 726e 2070 7269 6d69 7469 7665  Return primitive
+00004e30: 2063 656c 6c2e 0a0a 2020 2020 2020 2020   cell...        
+00004e40: 5072 696d 6974 6976 650a 2020 2020 2020  Primitive.      
+00004e50: 2020 2020 2020 5072 696d 6974 6976 6520        Primitive 
+00004e60: 6365 6c6c 2e0a 0a20 2020 2020 2020 2022  cell...        "
+00004e70: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00004e80: 6e20 7365 6c66 2e5f 7072 696d 6974 6976  n self._primitiv
+00004e90: 650a 0a20 2020 2064 6566 2067 6574 5f70  e..    def get_p
+00004ea0: 7269 6d69 7469 7665 2873 656c 6629 3a0a  rimitive(self):.
+00004eb0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00004ec0: 6e20 7072 696d 6974 6976 6520 6365 6c6c  n primitive cell
+00004ed0: 2e22 2222 0a20 2020 2020 2020 2077 6172  .""".        war
+00004ee0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+00004ef0: 2020 2020 2020 2020 2250 686f 6e6f 3370          "Phono3p
+00004f00: 792e 6765 745f 7072 696d 6974 6976 6528  y.get_primitive(
+00004f10: 2920 6973 2064 6570 7265 6361 7465 642e  ) is deprecated.
+00004f20: 220a 2020 2020 2020 2020 2020 2020 2255  ".            "U
+00004f30: 7365 2050 686f 6e6f 3370 792e 7072 696d  se Phono3py.prim
+00004f40: 6974 6976 6520 6174 7472 6962 7574 6520  itive attribute 
+00004f50: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+00004f60: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
+00004f70: 6f6e 5761 726e 696e 672c 0a20 2020 2020  onWarning,.     
+00004f80: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00004f90: 7572 6e20 7365 6c66 2e70 7269 6d69 7469  urn self.primiti
+00004fa0: 7665 0a0a 2020 2020 4070 726f 7065 7274  ve..    @propert
+00004fb0: 790a 2020 2020 6465 6620 756e 6974 6365  y.    def unitce
+00004fc0: 6c6c 2873 656c 6629 202d 3e20 5068 6f6e  ll(self) -> Phon
+00004fd0: 6f70 7941 746f 6d73 3a0a 2020 2020 2020  opyAtoms:.      
+00004fe0: 2020 2222 2252 6574 7572 6e20 556e 6974    """Return Unit
+00004ff0: 2063 656c 6c2e 0a0a 2020 2020 2020 2020   cell...        
+00005000: 5068 6f6e 6f70 7941 746f 6d73 0a20 2020  PhonopyAtoms.   
+00005010: 2020 2020 2020 2020 2055 6e69 7420 6365           Unit ce
+00005020: 6c6c 2e0a 0a20 2020 2020 2020 2022 2222  ll...        """
+00005030: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00005040: 7365 6c66 2e5f 756e 6974 6365 6c6c 0a0a  self._unitcell..
+00005050: 2020 2020 6465 6620 6765 745f 756e 6974      def get_unit
+00005060: 6365 6c6c 2873 656c 6629 3a0a 2020 2020  cell(self):.    
+00005070: 2020 2020 2222 2252 6574 7572 6e20 556e      """Return Un
+00005080: 6974 2063 656c 6c2e 2222 220a 2020 2020  it cell.""".    
+00005090: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+000050a0: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+000050b0: 5068 6f6e 6f33 7079 2e67 6574 5f75 6e69  Phono3py.get_uni
+000050c0: 7463 656c 6c28 2920 6973 2064 6570 7265  tcell() is depre
+000050d0: 6361 7465 642e 220a 2020 2020 2020 2020  cated.".        
+000050e0: 2020 2020 2255 7365 2050 686f 6e6f 3370      "Use Phono3p
+000050f0: 792e 756e 6974 6365 6c6c 2061 7474 7269  y.unitcell attri
+00005100: 6275 7465 2069 6e73 7465 6164 2e22 2c0a  bute instead.",.
+00005110: 2020 2020 2020 2020 2020 2020 4465 7072              Depr
+00005120: 6563 6174 696f 6e57 6172 6e69 6e67 2c0a  ecationWarning,.
+00005130: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00005140: 2020 7265 7475 726e 2073 656c 662e 756e    return self.un
+00005150: 6974 6365 6c6c 0a0a 2020 2020 4070 726f  itcell..    @pro
+00005160: 7065 7274 790a 2020 2020 6465 6620 7375  perty.    def su
+00005170: 7065 7263 656c 6c28 7365 6c66 2920 2d3e  percell(self) ->
+00005180: 2053 7570 6572 6365 6c6c 3a0a 2020 2020   Supercell:.    
+00005190: 2020 2020 2222 2252 6574 7572 6e20 7375      """Return su
+000051a0: 7065 7263 656c 6c2e 0a0a 2020 2020 2020  percell...      
+000051b0: 2020 5375 7065 7263 656c 6c0a 2020 2020    Supercell.    
+000051c0: 2020 2020 2020 2020 5375 7065 7263 656c          Supercel
+000051d0: 6c2e 0a0a 2020 2020 2020 2020 2222 220a  l...        """.
+000051e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000051f0: 656c 662e 5f73 7570 6572 6365 6c6c 0a0a  elf._supercell..
+00005200: 2020 2020 6465 6620 6765 745f 7375 7065      def get_supe
+00005210: 7263 656c 6c28 7365 6c66 293a 0a20 2020  rcell(self):.   
+00005220: 2020 2020 2022 2222 5265 7475 726e 2073       """Return s
+00005230: 7570 6572 6365 6c6c 2e22 2222 0a20 2020  upercell.""".   
+00005240: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00005250: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00005260: 2250 686f 6e6f 3370 792e 6765 745f 7375  "Phono3py.get_su
+00005270: 7065 7263 656c 6c28 2920 6973 2064 6570  percell() is dep
+00005280: 7265 6361 7465 642e 220a 2020 2020 2020  recated.".      
+00005290: 2020 2020 2020 2255 7365 2050 686f 6e6f        "Use Phono
+000052a0: 3370 792e 7375 7065 7263 656c 6c20 6174  3py.supercell at
+000052b0: 7472 6962 7574 6520 696e 7374 6561 642e  tribute instead.
+000052c0: 222c 0a20 2020 2020 2020 2020 2020 2044  ",.            D
+000052d0: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
+000052e0: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
+000052f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00005300: 2e73 7570 6572 6365 6c6c 0a0a 2020 2020  .supercell..    
+00005310: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00005320: 6620 7068 6f6e 6f6e 5f73 7570 6572 6365  f phonon_superce
+00005330: 6c6c 2873 656c 6629 202d 3e20 5375 7065  ll(self) -> Supe
+00005340: 7263 656c 6c3a 0a20 2020 2020 2020 2022  rcell:.        "
+00005350: 2222 5265 7475 726e 2073 7570 6572 6365  ""Return superce
+00005360: 6c6c 2066 6f72 2066 6332 2e0a 0a20 2020  ll for fc2...   
+00005370: 2020 2020 2053 7570 6572 6365 6c6c 0a20       Supercell. 
+00005380: 2020 2020 2020 2020 2020 2053 7570 6572             Super
+00005390: 6365 6c6c 2066 6f72 2066 6332 2e0a 0a20  cell for fc2... 
+000053a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000053b0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000053c0: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
+000053d0: 0a0a 2020 2020 6465 6620 6765 745f 7068  ..    def get_ph
+000053e0: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 2873  onon_supercell(s
+000053f0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00005400: 2252 6574 7572 6e20 7375 7065 7263 656c  "Return supercel
+00005410: 6c20 666f 7220 6663 322e 2222 220a 2020  l for fc2.""".  
+00005420: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00005430: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+00005440: 2022 5068 6f6e 6f33 7079 2e67 6574 5f70   "Phono3py.get_p
+00005450: 686f 6e6f 6e5f 7375 7065 7263 656c 6c28  honon_supercell(
+00005460: 2920 6973 2064 6570 7265 6361 7465 642e  ) is deprecated.
+00005470: 220a 2020 2020 2020 2020 2020 2020 2255  ".            "U
+00005480: 7365 2050 686f 6e6f 3370 792e 7068 6f6e  se Phono3py.phon
+00005490: 6f6e 5f73 7570 6572 6365 6c6c 2061 7474  on_supercell att
+000054a0: 7269 6275 7465 2069 6e73 7465 6164 2e22  ribute instead."
+000054b0: 2c0a 2020 2020 2020 2020 2020 2020 4465  ,.            De
+000054c0: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
+000054d0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000054e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000054f0: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
+00005500: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00005510: 2020 2020 6465 6620 7068 6f6e 6f6e 5f70      def phonon_p
+00005520: 7269 6d69 7469 7665 2873 656c 6629 202d  rimitive(self) -
+00005530: 3e20 5072 696d 6974 6976 653a 0a20 2020  > Primitive:.   
+00005540: 2020 2020 2022 2222 5265 7475 726e 2070       """Return p
+00005550: 7269 6d69 7469 7665 2063 656c 6c20 666f  rimitive cell fo
+00005560: 7220 6663 322e 0a0a 2020 2020 2020 2020  r fc2...        
+00005570: 5072 696d 6974 6976 650a 2020 2020 2020  Primitive.      
+00005580: 2020 2020 2020 5072 696d 6974 6976 6520        Primitive 
+00005590: 6365 6c6c 2066 6f72 2066 6332 2e20 5468  cell for fc2. Th
+000055a0: 6973 2073 686f 756c 6420 6265 2074 6865  is should be the
+000055b0: 2073 616d 6520 6173 2074 6865 2070 7269   same as the pri
+000055c0: 6d69 7469 7665 0a20 2020 2020 2020 2020  mitive.         
+000055d0: 2020 2063 656c 6c20 666f 7220 6663 332c     cell for fc3,
+000055e0: 2062 7574 2074 6869 7320 6973 2063 7265   but this is cre
+000055f0: 6174 6564 2066 726f 6d20 7375 7065 7263  ated from superc
+00005600: 656c 6c20 666f 7220 6663 3220 616e 640a  ell for fc2 and.
+00005610: 2020 2020 2020 2020 2020 2020 6361 6e20              can 
+00005620: 6265 206e 6f74 206e 756d 6572 6963 616c  be not numerical
+00005630: 6c79 2070 6572 6665 6374 6c79 2069 6465  ly perfectly ide
+00005640: 6e74 6963 616c 2e0a 0a20 2020 2020 2020  ntical...       
+00005650: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00005660: 7572 6e20 7365 6c66 2e5f 7068 6f6e 6f6e  urn self._phonon
+00005670: 5f70 7269 6d69 7469 7665 0a0a 2020 2020  _primitive..    
+00005680: 6465 6620 6765 745f 7068 6f6e 6f6e 5f70  def get_phonon_p
+00005690: 7269 6d69 7469 7665 2873 656c 6629 3a0a  rimitive(self):.
+000056a0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000056b0: 6e20 7072 696d 6974 6976 6520 6365 6c6c  n primitive cell
+000056c0: 2066 6f72 2066 6332 2e22 2222 0a20 2020   for fc2.""".   
+000056d0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000056e0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+000056f0: 2250 686f 6e6f 3370 792e 6765 745f 7068  "Phono3py.get_ph
+00005700: 6f6e 6f6e 5f70 7269 6d69 7469 7665 2829  onon_primitive()
+00005710: 2069 7320 6465 7072 6563 6174 6564 2e22   is deprecated."
+00005720: 0a20 2020 2020 2020 2020 2020 2022 5573  .            "Us
+00005730: 6520 5068 6f6e 6f33 7079 2e70 686f 6e6f  e Phono3py.phono
+00005740: 6e5f 7072 696d 6974 6976 6520 6174 7472  n_primitive attr
+00005750: 6962 7574 6520 696e 7374 6561 642e 222c  ibute instead.",
+00005760: 0a20 2020 2020 2020 2020 2020 2044 6570  .            Dep
+00005770: 7265 6361 7469 6f6e 5761 726e 696e 672c  recationWarning,
+00005780: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00005790: 2020 2072 6574 7572 6e20 7365 6c66 2e70     return self.p
+000057a0: 686f 6e6f 6e5f 7072 696d 6974 6976 650a  honon_primitive.
+000057b0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+000057c0: 2020 2064 6566 2073 796d 6d65 7472 7928     def symmetry(
+000057d0: 7365 6c66 2920 2d3e 2053 796d 6d65 7472  self) -> Symmetr
+000057e0: 793a 0a20 2020 2020 2020 2022 2222 5265  y:.        """Re
+000057f0: 7475 726e 2073 796d 6d65 7472 7920 6f66  turn symmetry of
+00005800: 2073 7570 6572 6365 6c6c 2e0a 0a20 2020   supercell...   
+00005810: 2020 2020 2053 796d 6d65 7472 790a 2020       Symmetry.  
+00005820: 2020 2020 2020 2020 2020 5379 6d6d 6574            Symmet
+00005830: 7279 206f 6620 7375 7065 7263 656c 6c0a  ry of supercell.
+00005840: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00005850: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00005860: 2e5f 7379 6d6d 6574 7279 0a0a 2020 2020  ._symmetry..    
+00005870: 6465 6620 6765 745f 7379 6d6d 6574 7279  def get_symmetry
+00005880: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00005890: 2222 2252 6574 7572 6e20 7379 6d6d 6574  """Return symmet
+000058a0: 7279 206f 6620 7375 7065 7263 656c 6c2e  ry of supercell.
+000058b0: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
+000058c0: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+000058d0: 2020 2020 2020 2022 5068 6f6e 6f33 7079         "Phono3py
+000058e0: 2e67 6574 5f73 796d 6d65 7472 7928 2920  .get_symmetry() 
+000058f0: 6973 2064 6570 7265 6361 7465 642e 220a  is deprecated.".
+00005900: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
+00005910: 2050 686f 6e6f 3370 792e 7379 6d6d 6574   Phono3py.symmet
+00005920: 7279 2061 7474 7269 6275 7465 2069 6e73  ry attribute ins
+00005930: 7465 6164 2e22 2c0a 2020 2020 2020 2020  tead.",.        
+00005940: 2020 2020 4465 7072 6563 6174 696f 6e57      DeprecationW
+00005950: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+00005960: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00005970: 2073 656c 662e 7379 6d6d 6574 7279 0a0a   self.symmetry..
+00005980: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00005990: 2020 6465 6620 7072 696d 6974 6976 655f    def primitive_
+000059a0: 7379 6d6d 6574 7279 2873 656c 6629 202d  symmetry(self) -
+000059b0: 3e20 5379 6d6d 6574 7279 3a0a 2020 2020  > Symmetry:.    
+000059c0: 2020 2020 2222 2252 6574 7572 6e20 7379      """Return sy
+000059d0: 6d6d 6574 7279 206f 6620 7072 696d 6974  mmetry of primit
+000059e0: 6976 6520 6365 6c6c 2e0a 0a20 2020 2020  ive cell...     
+000059f0: 2020 2053 796d 6d65 7472 790a 2020 2020     Symmetry.    
+00005a00: 2020 2020 2020 2020 5379 6d6d 6574 7279          Symmetry
+00005a10: 206f 6620 7072 696d 6974 6976 6520 6365   of primitive ce
+00005a20: 6c6c 2e0a 0a20 2020 2020 2020 2022 2222  ll...        """
+00005a30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00005a40: 7365 6c66 2e5f 7072 696d 6974 6976 655f  self._primitive_
+00005a50: 7379 6d6d 6574 7279 0a0a 2020 2020 6465  symmetry..    de
+00005a60: 6620 6765 745f 7072 696d 6974 6976 655f  f get_primitive_
+00005a70: 7379 6d6d 6574 7279 2873 656c 6629 3a0a  symmetry(self):.
+00005a80: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00005a90: 6e20 7379 6d6d 6574 7279 206f 6620 7072  n symmetry of pr
+00005aa0: 696d 6974 6976 6520 6365 6c6c 2e22 2222  imitive cell."""
+00005ab0: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00005ac0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00005ad0: 2020 2020 2250 686f 6e6f 3370 792e 6765      "Phono3py.ge
+00005ae0: 745f 7072 696d 6974 6976 655f 7379 6d6d  t_primitive_symm
+00005af0: 6574 7279 2829 2069 7320 6465 7072 6563  etry() is deprec
+00005b00: 6174 6564 2e22 0a20 2020 2020 2020 2020  ated.".         
+00005b10: 2020 2022 5573 6520 5068 6f6e 6f33 7079     "Use Phono3py
+00005b20: 2e70 7269 6d69 7469 7665 5f73 796d 6d65  .primitive_symme
+00005b30: 7472 7920 6174 7472 6962 7574 6520 696e  try attribute in
+00005b40: 7374 6561 642e 222c 0a20 2020 2020 2020  stead.",.       
+00005b50: 2020 2020 2044 6570 7265 6361 7469 6f6e       Deprecation
+00005b60: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
+00005b70: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+00005b80: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
+00005b90: 5f73 796d 6d65 7472 790a 0a20 2020 2040  _symmetry..    @
+00005ba0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00005bb0: 2070 686f 6e6f 6e5f 7375 7065 7263 656c   phonon_supercel
+00005bc0: 6c5f 7379 6d6d 6574 7279 2873 656c 6629  l_symmetry(self)
+00005bd0: 202d 3e20 5379 6d6d 6574 7279 3a0a 2020   -> Symmetry:.  
+00005be0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00005bf0: 7379 6d6d 6574 7279 206f 6620 7375 7065  symmetry of supe
+00005c00: 7263 656c 6c20 666f 7220 6663 322e 0a0a  rcell for fc2...
+00005c10: 2020 2020 2020 2020 5379 6d6d 6574 7279          Symmetry
+00005c20: 0a20 2020 2020 2020 2020 2020 2053 796d  .            Sym
+00005c30: 6d65 7472 7920 6f66 2073 7570 6572 6365  metry of superce
+00005c40: 6c6c 2066 6f72 2066 6332 2028 7068 6f6e  ll for fc2 (phon
+00005c50: 6f6e 5f73 7570 6572 6365 6c6c 292e 0a0a  on_supercell)...
+00005c60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00005c70: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00005c80: 5f70 686f 6e6f 6e5f 7375 7065 7263 656c  _phonon_supercel
+00005c90: 6c5f 7379 6d6d 6574 7279 0a0a 2020 2020  l_symmetry..    
+00005ca0: 6465 6620 6765 745f 7068 6f6e 6f6e 5f73  def get_phonon_s
+00005cb0: 7570 6572 6365 6c6c 5f73 796d 6d65 7472  upercell_symmetr
+00005cc0: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+00005cd0: 2022 2222 5265 7475 726e 2073 796d 6d65   """Return symme
+00005ce0: 7472 7920 6f66 2073 7570 6572 6365 6c6c  try of supercell
+00005cf0: 2066 6f72 2066 6332 2e22 2222 0a20 2020   for fc2.""".   
+00005d00: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00005d10: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00005d20: 2250 686f 6e6f 3370 792e 6765 745f 7068  "Phono3py.get_ph
+00005d30: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f73  onon_supercell_s
+00005d40: 796d 6d65 7472 7928 2920 6973 2064 6570  ymmetry() is dep
+00005d50: 7265 6361 7465 642e 220a 2020 2020 2020  recated.".      
+00005d60: 2020 2020 2020 2255 7365 2050 686f 6e6f        "Use Phono
+00005d70: 3370 792e 7068 6f6e 6f6e 5f73 7570 6572  3py.phonon_super
+00005d80: 6365 6c6c 5f73 796d 6d65 7472 7920 6174  cell_symmetry at
+00005d90: 7472 6962 7574 6520 696e 7374 6561 642e  tribute instead.
+00005da0: 222c 0a20 2020 2020 2020 2020 2020 2044  ",.            D
+00005db0: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
+00005dc0: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
+00005dd0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00005de0: 2e70 686f 6e6f 6e5f 7375 7065 7263 656c  .phonon_supercel
+00005df0: 6c5f 7379 6d6d 6574 7279 0a0a 2020 2020  l_symmetry..    
+00005e00: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00005e10: 6620 7375 7065 7263 656c 6c5f 6d61 7472  f supercell_matr
+00005e20: 6978 2873 656c 6629 3a0a 2020 2020 2020  ix(self):.      
+00005e30: 2020 2222 2252 6574 7572 6e20 7472 616e    """Return tran
+00005e40: 7366 6f72 6d61 7469 6f6e 206d 6174 7269  sformation matri
+00005e50: 7820 746f 2073 7570 6572 6365 6c6c 2063  x to supercell c
+00005e60: 656c 6c20 6672 6f6d 2075 6e69 7420 6365  ell from unit ce
+00005e70: 6c6c 2e0a 0a20 2020 2020 2020 206e 6461  ll...        nda
+00005e80: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00005e90: 2053 7570 6572 6365 6c6c 206d 6174 7269   Supercell matri
+00005ea0: 7820 7769 7468 2072 6573 7065 6374 2074  x with respect t
+00005eb0: 6f20 756e 6974 2063 656c 6c2e 0a20 2020  o unit cell..   
+00005ec0: 2020 2020 2020 2020 2073 6861 7065 3d28           shape=(
+00005ed0: 332c 2033 292c 2064 7479 7065 3d27 696e  3, 3), dtype='in
+00005ee0: 745f 272c 206f 7264 6572 3d27 4327 0a0a  t_', order='C'..
+00005ef0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00005f00: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00005f10: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
+00005f20: 780a 0a20 2020 2064 6566 2067 6574 5f73  x..    def get_s
+00005f30: 7570 6572 6365 6c6c 5f6d 6174 7269 7828  upercell_matrix(
+00005f40: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00005f50: 2222 5265 7475 726e 2074 7261 6e73 666f  ""Return transfo
+00005f60: 726d 6174 696f 6e20 6d61 7472 6978 2074  rmation matrix t
+00005f70: 6f20 7375 7065 7263 656c 6c20 6365 6c6c  o supercell cell
+00005f80: 2066 726f 6d20 756e 6974 2063 656c 6c2e   from unit cell.
+00005f90: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
+00005fa0: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+00005fb0: 2020 2020 2020 2022 5068 6f6e 6f33 7079         "Phono3py
+00005fc0: 2e67 6574 5f73 7570 6572 6365 6c6c 5f6d  .get_supercell_m
+00005fd0: 6174 7269 7828 2920 6973 2064 6570 7265  atrix() is depre
+00005fe0: 6361 7465 642e 220a 2020 2020 2020 2020  cated.".        
+00005ff0: 2020 2020 2255 7365 2050 686f 6e6f 3370      "Use Phono3p
+00006000: 792e 7375 7065 7263 656c 6c5f 6d61 7472  y.supercell_matr
+00006010: 6978 2061 7474 7269 6275 7465 2069 6e73  ix attribute ins
+00006020: 7465 6164 2e22 2c0a 2020 2020 2020 2020  tead.",.        
+00006030: 2020 2020 4465 7072 6563 6174 696f 6e57      DeprecationW
+00006040: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+00006050: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00006060: 2073 656c 662e 7375 7065 7263 656c 6c5f   self.supercell_
+00006070: 6d61 7472 6978 0a0a 2020 2020 4070 726f  matrix..    @pro
+00006080: 7065 7274 790a 2020 2020 6465 6620 7068  perty.    def ph
+00006090: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
+000060a0: 6174 7269 7828 7365 6c66 293a 0a20 2020  atrix(self):.   
+000060b0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+000060c0: 7261 6e73 666f 726d 6174 696f 6e20 6d61  ransformation ma
+000060d0: 7472 6978 2074 6f20 7068 6f6e 6f6e 2073  trix to phonon s
+000060e0: 7570 6572 6365 6c6c 2066 726f 6d20 756e  upercell from un
+000060f0: 6974 2063 656c 6c2e 0a0a 2020 2020 2020  it cell...      
+00006100: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
+00006110: 2020 2020 2020 5375 7065 7263 656c 6c20        Supercell 
+00006120: 6d61 7472 6978 2077 6974 6820 7265 7370  matrix with resp
+00006130: 6563 7420 746f 2075 6e69 7420 6365 6c6c  ect to unit cell
+00006140: 2e0a 2020 2020 2020 2020 2020 2020 7368  ..            sh
+00006150: 6170 653d 2833 2c20 3329 2c20 6474 7970  ape=(3, 3), dtyp
+00006160: 653d 2769 6e74 5f27 2c20 6f72 6465 723d  e='int_', order=
+00006170: 2743 270a 0a20 2020 2020 2020 2022 2222  'C'..        """
+00006180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006190: 7365 6c66 2e5f 7068 6f6e 6f6e 5f73 7570  self._phonon_sup
+000061a0: 6572 6365 6c6c 5f6d 6174 7269 780a 0a20  ercell_matrix.. 
+000061b0: 2020 2064 6566 2067 6574 5f70 686f 6e6f     def get_phono
+000061c0: 6e5f 7375 7065 7263 656c 6c5f 6d61 7472  n_supercell_matr
+000061d0: 6978 2873 656c 6629 3a0a 2020 2020 2020  ix(self):.      
+000061e0: 2020 2222 2252 6574 7572 6e20 7472 616e    """Return tran
+000061f0: 7366 6f72 6d61 7469 6f6e 206d 6174 7269  sformation matri
+00006200: 7820 746f 2070 686f 6e6f 6e20 7375 7065  x to phonon supe
+00006210: 7263 656c 6c20 6672 6f6d 2075 6e69 7420  rcell from unit 
+00006220: 6365 6c6c 2e22 2222 0a20 2020 2020 2020  cell.""".       
+00006230: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+00006240: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
+00006250: 6e6f 3370 792e 6765 745f 7068 6f6e 6f6e  no3py.get_phonon
+00006260: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
+00006270: 7828 2920 6973 2064 6570 7265 6361 7465  x() is deprecate
+00006280: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
+00006290: 2255 7365 2050 686f 6e6f 3370 792e 7068  "Use Phono3py.ph
+000062a0: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
+000062b0: 6174 7269 7820 6174 7472 6962 7574 6520  atrix attribute 
+000062c0: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+000062d0: 2020 2020 2020 2044 6570 7265 6361 7469         Deprecati
+000062e0: 6f6e 5761 726e 696e 672c 0a20 2020 2020  onWarning,.     
+000062f0: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00006300: 7572 6e20 7365 6c66 2e70 686f 6e6f 6e5f  urn self.phonon_
+00006310: 7375 7065 7263 656c 6c5f 6d61 7472 6978  supercell_matrix
+00006320: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00006330: 2020 2020 6465 6620 7072 696d 6974 6976      def primitiv
+00006340: 655f 6d61 7472 6978 2873 656c 6629 3a0a  e_matrix(self):.
+00006350: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00006360: 6e20 7472 616e 7366 6f72 6d61 7469 6f6e  n transformation
+00006370: 206d 6174 7269 7820 746f 2070 7269 6d69   matrix to primi
+00006380: 7469 7665 2063 656c 6c20 6672 6f6d 2075  tive cell from u
+00006390: 6e69 7420 6365 6c6c 2e0a 0a20 2020 2020  nit cell...     
+000063a0: 2020 206e 6461 7272 6179 0a20 2020 2020     ndarray.     
+000063b0: 2020 2020 2020 2050 7269 6d69 7469 7665         Primitive
+000063c0: 206d 6174 7269 7820 7769 7468 2072 6573   matrix with res
+000063d0: 7065 6374 2074 6f20 756e 6974 2063 656c  pect to unit cel
+000063e0: 6c2e 0a20 2020 2020 2020 2020 2020 2073  l..            s
+000063f0: 6861 7065 3d28 332c 2033 292c 2064 7479  hape=(3, 3), dty
+00006400: 7065 3d27 646f 7562 6c65 272c 206f 7264  pe='double', ord
+00006410: 6572 3d27 4327 0a0a 2020 2020 2020 2020  er='C'..        
+00006420: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00006430: 726e 2073 656c 662e 5f70 7269 6d69 7469  rn self._primiti
+00006440: 7665 5f6d 6174 7269 780a 0a20 2020 2064  ve_matrix..    d
+00006450: 6566 2067 6574 5f70 7269 6d69 7469 7665  ef get_primitive
+00006460: 5f6d 6174 7269 7828 7365 6c66 293a 0a20  _matrix(self):. 
+00006470: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00006480: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
+00006490: 6d61 7472 6978 2074 6f20 7072 696d 6974  matrix to primit
+000064a0: 6976 6520 6365 6c6c 2066 726f 6d20 756e  ive cell from un
+000064b0: 6974 2063 656c 6c2e 2222 220a 2020 2020  it cell.""".    
+000064c0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+000064d0: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+000064e0: 5068 6f6e 6f33 7079 2e67 6574 5f70 7269  Phono3py.get_pri
+000064f0: 6d69 7469 7665 5f6d 6174 7269 7828 2920  mitive_matrix() 
+00006500: 6973 2064 6570 7265 6361 7465 642e 220a  is deprecated.".
+00006510: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
+00006520: 2050 686f 6e6f 3370 792e 7072 696d 6974   Phono3py.primit
+00006530: 6976 655f 6d61 7472 6978 2061 7474 7269  ive_matrix attri
+00006540: 6275 7465 2069 6e73 7465 6164 2e22 2c0a  bute instead.",.
+00006550: 2020 2020 2020 2020 2020 2020 4465 7072              Depr
+00006560: 6563 6174 696f 6e57 6172 6e69 6e67 2c0a  ecationWarning,.
+00006570: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00006580: 2020 7265 7475 726e 2073 656c 662e 7072    return self.pr
+00006590: 696d 6974 6976 655f 6d61 7472 6978 0a0a  imitive_matrix..
+000065a0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+000065b0: 2020 6465 6620 756e 6974 5f63 6f6e 7665    def unit_conve
+000065c0: 7273 696f 6e5f 6661 6374 6f72 2873 656c  rsion_factor(sel
+000065d0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+000065e0: 6574 7572 6e20 7068 6f6e 6f6e 2066 7265  eturn phonon fre
+000065f0: 7175 656e 6379 2075 6e69 7420 636f 6e76  quency unit conv
+00006600: 6572 7369 6f6e 2066 6163 746f 722e 0a0a  ersion factor...
+00006610: 2020 2020 2020 2020 666c 6f61 740a 2020          float.  
+00006620: 2020 2020 2020 2020 2020 5068 6f6e 6f6e            Phonon
+00006630: 2066 7265 7175 656e 6379 2075 6e69 7420   frequency unit 
+00006640: 636f 6e76 6572 7369 6f6e 2066 6163 746f  conversion facto
+00006650: 722e 2054 6869 7320 6661 6374 6f72 0a20  r. This factor. 
+00006660: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
+00006670: 7274 7320 7371 7274 283c 666f 7263 653e  rts sqrt(<force>
+00006680: 2f3c 6469 7374 616e 6365 3e2f 3c41 4d55  /<distance>/<AMU
+00006690: 3e29 2f32 7069 2f31 6531 3220 746f 2054  >)/2pi/1e12 to T
+000066a0: 487a 0a20 2020 2020 2020 2020 2020 2028  Hz.            (
+000066b0: 6f72 6469 6e61 7279 2066 7265 7175 656e  ordinary frequen
+000066c0: 6379 292e 0a0a 2020 2020 2020 2020 2222  cy)...        ""
+000066d0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+000066e0: 2073 656c 662e 5f66 7265 7175 656e 6379   self._frequency
+000066f0: 5f66 6163 746f 725f 746f 5f54 487a 0a0a  _factor_to_THz..
+00006700: 2020 2020 6465 6620 7365 745f 6469 7370      def set_disp
+00006710: 6c61 6365 6d65 6e74 5f64 6174 6173 6574  lacement_dataset
+00006720: 2873 656c 662c 2064 6174 6173 6574 293a  (self, dataset):
+00006730: 0a20 2020 2020 2020 2022 2222 5365 7420  .        """Set 
+00006740: 6469 7370 6c61 6365 6d65 6e74 2d66 6f72  displacement-for
+00006750: 6365 2064 6174 6173 6574 2e22 2222 0a20  ce dataset.""". 
+00006760: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00006770: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+00006780: 2020 2250 686f 6e6f 3370 792e 7365 745f    "Phono3py.set_
+00006790: 6469 7370 6c61 6365 6d65 6e74 5f64 6174  displacement_dat
+000067a0: 6173 6574 2829 2069 7320 6465 7072 6563  aset() is deprec
+000067b0: 6174 6564 2e22 0a20 2020 2020 2020 2020  ated.".         
+000067c0: 2020 2022 5573 6520 5068 6f6e 6f33 7079     "Use Phono3py
+000067d0: 2e64 6174 6173 6574 2061 7474 7269 6275  .dataset attribu
+000067e0: 7465 2069 6e73 7465 6164 2e22 2c0a 2020  te instead.",.  
+000067f0: 2020 2020 2020 2020 2020 4465 7072 6563            Deprec
+00006800: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
+00006810: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00006820: 7365 6c66 2e5f 6461 7461 7365 7420 3d20  self._dataset = 
+00006830: 6461 7461 7365 740a 0a20 2020 2040 7072  dataset..    @pr
+00006840: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
+00006850: 6174 6173 6574 2873 656c 6629 3a0a 2020  ataset(self):.  
+00006860: 2020 2020 2020 2222 2253 6574 7465 7220        """Setter 
+00006870: 616e 6420 6765 7474 6572 206f 6620 6469  and getter of di
+00006880: 7370 6c61 6365 6d65 6e74 2d66 6f72 6365  splacement-force
+00006890: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
+000068a0: 2020 2064 6963 740a 2020 2020 2020 2020     dict.        
+000068b0: 2020 2020 4469 7370 6c61 6365 6d65 6e74      Displacement
+000068c0: 7320 696e 2073 7570 6572 6365 6c6c 732e  s in supercells.
+000068d0: 2054 6865 7265 2061 7265 2074 776f 2074   There are two t
+000068e0: 7970 6573 206f 6620 666f 726d 6174 732e  ypes of formats.
+000068f0: 0a20 2020 2020 2020 2020 2020 2054 7970  .            Typ
+00006900: 6520 312e 2054 776f 2061 746f 6d69 6320  e 1. Two atomic 
+00006910: 6469 7370 6c61 6365 6d65 6e74 2069 6e20  displacement in 
+00006920: 6561 6368 2073 7570 6572 6365 6c6c 3a0a  each supercell:.
+00006930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006940: 7b27 6e61 746f 6d27 3a20 6e75 6d62 6572  {'natom': number
+00006950: 206f 6620 6174 6f6d 7320 696e 2073 7570   of atoms in sup
+00006960: 6572 6365 6c6c 2c0a 2020 2020 2020 2020  ercell,.        
+00006970: 2020 2020 2020 2020 2027 6669 7273 745f           'first_
+00006980: 6174 6f6d 7327 3a20 5b0a 2020 2020 2020  atoms': [.      
+00006990: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
+000069a0: 756d 6265 7227 3a20 6174 6f6d 2069 6e64  umber': atom ind
+000069b0: 6578 206f 6620 6669 7273 7420 6469 7370  ex of first disp
+000069c0: 6c61 6365 6420 6174 6f6d 2c0a 2020 2020  laced atom,.    
+000069d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000069e0: 2764 6973 706c 6163 656d 656e 7427 3a20  'displacement': 
+000069f0: 6469 7370 6c61 6365 6d65 6e74 2069 6e20  displacement in 
+00006a00: 4361 7274 6573 6961 6e20 636f 6f72 6469  Cartesian coordi
+00006a10: 6e61 7465 732c 0a20 2020 2020 2020 2020  nates,.         
+00006a20: 2020 2020 2020 2020 2020 2027 666f 7263             'forc
+00006a30: 6573 273a 2066 6f72 6365 7320 6f6e 2061  es': forces on a
+00006a40: 746f 6d73 2069 6e20 7375 7065 7263 656c  toms in supercel
+00006a50: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
+00006a60: 2020 2020 2020 2027 6964 273a 2064 6973         'id': dis
+00006a70: 706c 6163 656d 656e 7420 6964 2028 312c  placement id (1,
+00006a80: 2032 2c2e 2e2e 2c6e 5f66 6972 7374 5f61   2,...,n_first_a
+00006a90: 746f 6d73 290a 2020 2020 2020 2020 2020  toms).          
+00006aa0: 2020 2020 2020 2020 2020 2773 6563 6f6e            'secon
+00006ab0: 645f 6174 6f6d 7327 3a20 5b0a 2020 2020  d_atoms': [.    
+00006ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ad0: 2020 7b27 6e75 6d62 6572 273a 2061 746f    {'number': ato
+00006ae0: 6d20 696e 6465 7820 6f66 2073 6563 6f6e  m index of secon
+00006af0: 6420 6469 7370 6c61 6365 6420 6174 6f6d  d displaced atom
+00006b00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006b10: 2020 2020 2020 2020 2027 6469 7370 6c61           'displa
+00006b20: 6365 6d65 6e74 273a 2064 6973 706c 6163  cement': displac
+00006b30: 656d 656e 7420 696e 2043 6172 7465 7369  ement in Cartesi
+00006b40: 616e 2063 6f6f 7264 696e 6174 6573 7d2c  an coordinates},
+00006b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006b60: 2020 2020 2020 2020 2766 6f72 6365 7327          'forces'
+00006b70: 3a20 666f 7263 6573 206f 6e20 6174 6f6d  : forces on atom
+00006b80: 7320 696e 2073 7570 6572 6365 6c6c 2c0a  s in supercell,.
+00006b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ba0: 2020 2020 2020 2027 7061 6972 5f64 6973         'pair_dis
+00006bb0: 7461 6e63 6527 3a20 6469 7374 616e 6365  tance': distance
+00006bc0: 2062 6574 7765 656e 2070 6169 7265 6420   between paired 
+00006bd0: 6174 6f6d 732c 0a20 2020 2020 2020 2020  atoms,.         
+00006be0: 2020 2020 2020 2020 2020 2020 2020 2769                'i
+00006bf0: 6e63 6c75 6465 6427 3a20 7769 7468 2063  ncluded': with c
+00006c00: 7574 6f66 6620 7061 6972 2064 6973 7461  utoff pair dista
+00006c10: 6e63 6520 696e 2064 6973 706c 6163 656d  nce in displacem
+00006c20: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
+00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c40: 2020 2020 2020 2070 6169 7220 6765 6e65         pair gene
+00006c50: 7261 7469 6f6e 2c20 7468 6973 2069 6e64  ration, this ind
+00006c60: 6963 6174 6573 2069 6620 7468 6973 0a20  icates if this. 
+00006c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c90: 2020 7061 6972 2064 6973 706c 6163 656d    pair displacem
+00006ca0: 656e 7473 2069 7320 696e 636c 7564 6564  ents is included
+00006cb0: 2074 6f20 636f 6d70 7574 650a 2020 2020   to compute.    
+00006cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cd0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00006ce0: 6333 206f 7220 6e6f 742c 0a20 2020 2020  c3 or not,.     
+00006cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006d00: 2020 2769 6427 3a20 6469 7370 6c61 6365    'id': displace
+00006d10: 6d65 6e74 2069 642e 2028 6e5f 6669 7273  ment id. (n_firs
+00006d20: 745f 6174 6f6d 7320 2b20 312c 202e 2e2e  t_atoms + 1, ...
+00006d30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006d40: 2020 2020 2020 2020 2e2e 2e20 5d20 7d2c          ... ] },
+00006d50: 202e 2e2e 205d 207d 0a20 2020 2020 2020   ... ] }.       
+00006d60: 2020 2020 2054 7970 6520 322e 2041 6c6c       Type 2. All
+00006d70: 2061 746f 6d69 6320 6469 7370 6c61 6365   atomic displace
+00006d80: 6d65 6e74 7320 696e 2065 6163 6820 7375  ments in each su
+00006d90: 7065 7263 656c 6c3a 0a20 2020 2020 2020  percell:.       
+00006da0: 2020 2020 2020 2020 207b 2764 6973 706c           {'displ
+00006db0: 6163 656d 656e 7473 273a 206e 6461 7272  acements': ndarr
+00006dc0: 6179 2c20 6474 7970 653d 2764 6f75 626c  ay, dtype='doubl
+00006dd0: 6527 2c20 6f72 6465 723d 2743 272c 0a20  e', order='C',. 
+00006de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e00: 2073 6861 7065 3d28 7375 7065 7263 656c   shape=(supercel
+00006e10: 6c73 2c20 6174 6f6d 7320 696e 2073 7570  ls, atoms in sup
+00006e20: 6572 6365 6c6c 2c20 3329 0a20 2020 2020  ercell, 3).     
+00006e30: 2020 2020 2020 2020 2020 2020 2766 6f72              'for
+00006e40: 6365 7327 3a20 6e64 6172 7261 792c 2064  ces': ndarray, d
+00006e50: 7479 7065 3d27 646f 7562 6c65 272c 2c20  type='double',, 
+00006e60: 6f72 6465 723d 2743 272c 0a20 2020 2020  order='C',.     
+00006e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e80: 2020 2020 2020 2020 2020 2020 2073 6861               sha
+00006e90: 7065 3d28 7375 7065 7263 656c 6c73 2c20  pe=(supercells, 
+00006ea0: 6174 6f6d 7320 696e 2073 7570 6572 6365  atoms in superce
+00006eb0: 6c6c 2c20 3329 7d0a 2020 2020 2020 2020  ll, 3)}.        
+00006ec0: 2020 2020 496e 2074 7970 6520 322c 2064      In type 2, d
+00006ed0: 6973 706c 6163 656d 656e 7473 2061 6e64  isplacements and
+00006ee0: 2066 6f72 6365 7320 6361 6e20 6265 2067   forces can be g
+00006ef0: 6976 656e 2062 7920 6e75 6d70 7920 6172  iven by numpy ar
+00006f00: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+00006f10: 7769 7468 2064 6966 6665 7265 6e74 2073  with different s
+00006f20: 6861 7065 2062 7574 2074 6861 7420 6361  hape but that ca
+00006f30: 6e20 6265 2072 6573 6861 7065 6420 746f  n be reshaped to
+00006f40: 0a20 2020 2020 2020 2020 2020 2028 7375  .            (su
+00006f50: 7065 7263 656c 6c73 2c20 6e61 746f 6d2c  percells, natom,
+00006f60: 2033 292e 0a0a 2020 2020 2020 2020 2020   3)...          
+00006f70: 2020 496e 2061 6464 6974 696f 6e2c 2027    In addition, '
+00006f80: 6475 706c 6963 6174 6573 2720 616e 6420  duplicates' and 
+00006f90: 2763 7574 6f66 665f 6469 7374 616e 6365  'cutoff_distance
+00006fa0: 2720 6361 6e20 6578 6973 7420 696e 2074  ' can exist in t
+00006fb0: 6869 730a 2020 2020 2020 2020 2020 2020  his.            
+00006fc0: 6461 7461 7365 7420 696e 2064 6973 706c  dataset in displ
+00006fd0: 6163 656d 656e 7420 7061 6972 2067 656e  acement pair gen
+00006fe0: 6572 6174 696f 6e2e 2027 6475 706c 6963  eration. 'duplic
+00006ff0: 6174 6573 2720 6769 7665 730a 2020 2020  ates' gives.    
+00007000: 2020 2020 2020 2020 6475 706c 6963 6174          duplicat
+00007010: 6564 2073 7570 6572 6365 6c6c 2069 6473  ed supercell ids
+00007020: 2061 7320 7061 6972 732e 0a0a 2020 2020   as pairs...    
+00007030: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00007040: 7265 7475 726e 2073 656c 662e 5f64 6174  return self._dat
+00007050: 6173 6574 0a0a 2020 2020 4064 6174 6173  aset..    @datas
+00007060: 6574 2e73 6574 7465 720a 2020 2020 6465  et.setter.    de
+00007070: 6620 6461 7461 7365 7428 7365 6c66 2c20  f dataset(self, 
+00007080: 6461 7461 7365 7429 3a0a 2020 2020 2020  dataset):.      
+00007090: 2020 7365 6c66 2e5f 6461 7461 7365 7420    self._dataset 
+000070a0: 3d20 6461 7461 7365 740a 2020 2020 2020  = dataset.      
+000070b0: 2020 7365 6c66 2e5f 7375 7065 7263 656c    self._supercel
+000070c0: 6c73 5f77 6974 685f 6469 7370 6c61 6365  ls_with_displace
+000070d0: 6d65 6e74 7320 3d20 4e6f 6e65 0a20 2020  ments = None.   
+000070e0: 2020 2020 2073 656c 662e 5f70 686f 6e6f       self._phono
+000070f0: 6e5f 7375 7065 7263 656c 6c73 5f77 6974  n_supercells_wit
+00007100: 685f 6469 7370 6c61 6365 6d65 6e74 7320  h_displacements 
+00007110: 3d20 4e6f 6e65 0a0a 2020 2020 4070 726f  = None..    @pro
+00007120: 7065 7274 790a 2020 2020 6465 6620 6469  perty.    def di
+00007130: 7370 6c61 6365 6d65 6e74 5f64 6174 6173  splacement_datas
+00007140: 6574 2873 656c 6629 3a0a 2020 2020 2020  et(self):.      
+00007150: 2020 2222 2252 6574 7572 6e20 6469 7370    """Return disp
+00007160: 6c61 6365 6d65 6e74 2d66 6f72 6365 2064  lacement-force d
+00007170: 6174 6173 6574 2e22 2222 0a20 2020 2020  ataset.""".     
+00007180: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00007190: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
+000071a0: 686f 6e6f 3370 792e 6469 7370 6c61 6365  hono3py.displace
+000071b0: 6d65 6e74 5f64 6174 6173 6574 2069 7320  ment_dataset is 
+000071c0: 6465 7072 6563 6174 6564 2e22 2022 5573  deprecated." "Us
+000071d0: 6520 5068 6f6e 6f33 7079 2e64 6174 6173  e Phono3py.datas
+000071e0: 6574 2e22 2c0a 2020 2020 2020 2020 2020  et.",.          
+000071f0: 2020 4465 7072 6563 6174 696f 6e57 6172    DeprecationWar
+00007200: 6e69 6e67 2c0a 2020 2020 2020 2020 290a  ning,.        ).
+00007210: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00007220: 656c 662e 6461 7461 7365 740a 0a20 2020  elf.dataset..   
+00007230: 2064 6566 2067 6574 5f64 6973 706c 6163   def get_displac
+00007240: 656d 656e 745f 6461 7461 7365 7428 7365  ement_dataset(se
+00007250: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00007260: 5265 7475 726e 2064 6973 706c 6163 656d  Return displacem
+00007270: 656e 742d 666f 7263 6520 6461 7461 7365  ent-force datase
+00007280: 742e 2222 220a 2020 2020 2020 2020 7761  t.""".        wa
+00007290: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+000072a0: 2020 2020 2020 2020 2022 5068 6f6e 6f33           "Phono3
+000072b0: 7079 2e67 6574 5f64 6973 706c 6163 656d  py.get_displacem
+000072c0: 656e 745f 6461 7461 7365 7428 2920 6973  ent_dataset() is
+000072d0: 2064 6570 7265 6361 7465 642e 220a 2020   deprecated.".  
+000072e0: 2020 2020 2020 2020 2020 2255 7365 2050            "Use P
+000072f0: 686f 6e6f 3370 792e 6461 7461 7365 742e  hono3py.dataset.
+00007300: 222c 0a20 2020 2020 2020 2020 2020 2044  ",.            D
+00007310: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
+00007320: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
+00007330: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00007340: 2e64 6973 706c 6163 656d 656e 745f 6461  .displacement_da
+00007350: 7461 7365 740a 0a20 2020 2040 7072 6f70  taset..    @prop
+00007360: 6572 7479 0a20 2020 2064 6566 2070 686f  erty.    def pho
+00007370: 6e6f 6e5f 6461 7461 7365 7428 7365 6c66  non_dataset(self
+00007380: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
+00007390: 7474 6572 2061 6e64 2067 6574 7465 7220  tter and getter 
+000073a0: 6f66 2064 6973 706c 6163 656d 656e 742d  of displacement-
+000073b0: 666f 7263 6520 6461 7461 7365 7420 666f  force dataset fo
+000073c0: 7220 6663 322e 0a0a 2020 2020 2020 2020  r fc2...        
+000073d0: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+000073e0: 2044 6973 706c 6163 656d 656e 7473 2069   Displacements i
+000073f0: 6e20 7375 7065 7263 656c 6c73 2e20 5468  n supercells. Th
+00007400: 6572 6520 6172 6520 7477 6f20 7479 7065  ere are two type
+00007410: 7320 6f66 2066 6f72 6d61 7473 2e0a 2020  s of formats..  
+00007420: 2020 2020 2020 2020 2020 5479 7065 2031            Type 1
+00007430: 2e20 5477 6f20 6174 6f6d 6963 2064 6973  . Two atomic dis
+00007440: 706c 6163 656d 656e 7420 696e 2065 6163  placement in eac
+00007450: 6820 7375 7065 7263 656c 6c3a 0a20 2020  h supercell:.   
+00007460: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
+00007470: 6174 6f6d 273a 206e 756d 6265 7220 6f66  atom': number of
+00007480: 2061 746f 6d73 2069 6e20 7375 7065 7263   atoms in superc
+00007490: 656c 6c2c 0a20 2020 2020 2020 2020 2020  ell,.           
+000074a0: 2020 2020 2020 2766 6972 7374 5f61 746f        'first_ato
+000074b0: 6d73 273a 205b 0a20 2020 2020 2020 2020  ms': [.         
+000074c0: 2020 2020 2020 2020 2020 7b27 6e75 6d62            {'numb
+000074d0: 6572 273a 2061 746f 6d20 696e 6465 7820  er': atom index 
+000074e0: 6f66 2066 6972 7374 2064 6973 706c 6163  of first displac
+000074f0: 6564 2061 746f 6d2c 0a20 2020 2020 2020  ed atom,.       
+00007500: 2020 2020 2020 2020 2020 2020 2027 6469               'di
+00007510: 7370 6c61 6365 6d65 6e74 273a 2064 6973  splacement': dis
+00007520: 706c 6163 656d 656e 7420 696e 2043 6172  placement in Car
+00007530: 7465 7369 616e 2063 6f6f 7264 696e 6174  tesian coordinat
+00007540: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00007550: 2020 2020 2020 2020 2766 6f72 6365 7327          'forces'
+00007560: 3a20 666f 7263 6573 206f 6e20 6174 6f6d  : forces on atom
+00007570: 7320 696e 2073 7570 6572 6365 6c6c 7d20  s in supercell} 
+00007580: 2e2e 2e20 5d7d 0a20 2020 2020 2020 2020  ... ]}.         
+00007590: 2020 2054 7970 6520 322e 2041 6c6c 2061     Type 2. All a
+000075a0: 746f 6d69 6320 6469 7370 6c61 6365 6d65  tomic displaceme
+000075b0: 6e74 7320 696e 2065 6163 6820 7375 7065  nts in each supe
+000075c0: 7263 656c 6c3a 0a20 2020 2020 2020 2020  rcell:.         
+000075d0: 2020 2020 2020 207b 2764 6973 706c 6163         {'displac
+000075e0: 656d 656e 7473 273a 206e 6461 7272 6179  ements': ndarray
+000075f0: 2c20 6474 7970 653d 2764 6f75 626c 6527  , dtype='double'
+00007600: 2c20 6f72 6465 723d 2743 272c 0a20 2020  , order='C',.   
+00007610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007620: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00007630: 6861 7065 3d28 7375 7065 7263 656c 6c73  hape=(supercells
+00007640: 2c20 6174 6f6d 7320 696e 2073 7570 6572  , atoms in super
+00007650: 6365 6c6c 2c20 3329 0a20 2020 2020 2020  cell, 3).       
+00007660: 2020 2020 2020 2020 2020 2766 6f72 6365            'force
+00007670: 7327 3a20 6e64 6172 7261 792c 2064 7479  s': ndarray, dty
+00007680: 7065 3d27 646f 7562 6c65 272c 2c20 6f72  pe='double',, or
+00007690: 6465 723d 2743 272c 0a20 2020 2020 2020  der='C',.       
+000076a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000076b0: 2020 2020 2020 2020 2020 2073 6861 7065             shape
+000076c0: 3d28 7375 7065 7263 656c 6c73 2c20 6174  =(supercells, at
+000076d0: 6f6d 7320 696e 2073 7570 6572 6365 6c6c  oms in supercell
+000076e0: 2c20 3329 7d0a 2020 2020 2020 2020 2020  , 3)}.          
+000076f0: 2020 496e 2074 7970 6520 322c 2064 6973    In type 2, dis
+00007700: 706c 6163 656d 656e 7473 2061 6e64 2066  placements and f
+00007710: 6f72 6365 7320 6361 6e20 6265 2067 6976  orces can be giv
+00007720: 656e 2062 7920 6e75 6d70 7920 6172 7261  en by numpy arra
+00007730: 790a 2020 2020 2020 2020 2020 2020 7769  y.            wi
+00007740: 7468 2064 6966 6665 7265 6e74 2073 6861  th different sha
+00007750: 7065 2062 7574 2074 6861 7420 6361 6e20  pe but that can 
+00007760: 6265 2072 6573 6861 7065 6420 746f 0a20  be reshaped to. 
+00007770: 2020 2020 2020 2020 2020 2028 7375 7065             (supe
+00007780: 7263 656c 6c73 2c20 6e61 746f 6d2c 2033  rcells, natom, 3
+00007790: 292e 0a0a 2020 2020 2020 2020 2222 220a  )...        """.
+000077a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000077b0: 656c 662e 5f70 686f 6e6f 6e5f 6461 7461  elf._phonon_data
+000077c0: 7365 740a 0a20 2020 2040 7068 6f6e 6f6e  set..    @phonon
+000077d0: 5f64 6174 6173 6574 2e73 6574 7465 720a  _dataset.setter.
+000077e0: 2020 2020 6465 6620 7068 6f6e 6f6e 5f64      def phonon_d
+000077f0: 6174 6173 6574 2873 656c 662c 2064 6174  ataset(self, dat
+00007800: 6173 6574 293a 0a20 2020 2020 2020 2073  aset):.        s
+00007810: 656c 662e 5f70 686f 6e6f 6e5f 6461 7461  elf._phonon_data
+00007820: 7365 7420 3d20 6461 7461 7365 740a 0a20  set = dataset.. 
+00007830: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00007840: 2064 6566 2070 686f 6e6f 6e5f 6469 7370   def phonon_disp
+00007850: 6c61 6365 6d65 6e74 5f64 6174 6173 6574  lacement_dataset
+00007860: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00007870: 2222 2252 6574 7572 6e20 7068 6f6e 6f6e  """Return phonon
+00007880: 2064 6973 7061 6c63 656d 656e 742d 666f   dispalcement-fo
+00007890: 7263 6520 6461 7461 7365 742e 2222 220a  rce dataset.""".
+000078a0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+000078b0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+000078c0: 2020 2022 5068 6f6e 6f33 7079 2e70 686f     "Phono3py.pho
+000078d0: 6e6f 6e5f 6469 7370 6c61 6365 6d65 6e74  non_displacement
+000078e0: 5f64 6174 6173 6574 2069 7320 6465 7072  _dataset is depr
+000078f0: 6563 6174 6564 2e22 0a20 2020 2020 2020  ecated.".       
+00007900: 2020 2020 2022 5573 6520 5068 6f6e 6f33       "Use Phono3
+00007910: 7079 2e70 686f 6e6f 6e5f 6461 7461 7365  py.phonon_datase
+00007920: 742e 222c 0a20 2020 2020 2020 2020 2020  t.",.           
+00007930: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
+00007940: 696e 672c 0a20 2020 2020 2020 2029 0a20  ing,.        ). 
+00007950: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00007960: 6c66 2e5f 7068 6f6e 6f6e 5f64 6174 6173  lf._phonon_datas
+00007970: 6574 0a0a 2020 2020 6465 6620 6765 745f  et..    def get_
+00007980: 7068 6f6e 6f6e 5f64 6973 706c 6163 656d  phonon_displacem
+00007990: 656e 745f 6461 7461 7365 7428 7365 6c66  ent_dataset(self
+000079a0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+000079b0: 7475 726e 2070 686f 6e6f 6e20 6469 7370  turn phonon disp
+000079c0: 616c 6365 6d65 6e74 2d66 6f72 6365 2064  alcement-force d
+000079d0: 6174 6173 6574 2e22 2222 0a20 2020 2020  ataset.""".     
+000079e0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+000079f0: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
+00007a00: 686f 6e6f 3370 792e 6765 745f 7068 6f6e  hono3py.get_phon
+00007a10: 6f6e 5f64 6973 706c 6163 656d 656e 745f  on_displacement_
+00007a20: 6461 7461 7365 7428 2920 6973 2064 6570  dataset() is dep
+00007a30: 7265 6361 7465 642e 220a 2020 2020 2020  recated.".      
+00007a40: 2020 2020 2020 2255 7365 2050 686f 6e6f        "Use Phono
+00007a50: 3370 792e 7068 6f6e 6f6e 5f64 6174 6173  3py.phonon_datas
+00007a60: 6574 2e22 2c0a 2020 2020 2020 2020 2020  et.",.          
+00007a70: 2020 4465 7072 6563 6174 696f 6e57 6172    DeprecationWar
+00007a80: 6e69 6e67 2c0a 2020 2020 2020 2020 290a  ning,.        ).
+00007a90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00007aa0: 656c 662e 7068 6f6e 6f6e 5f64 6973 706c  elf.phonon_displ
+00007ab0: 6163 656d 656e 745f 6461 7461 7365 740a  acement_dataset.
+00007ac0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00007ad0: 2020 2064 6566 2062 616e 645f 696e 6469     def band_indi
+00007ae0: 6365 7328 7365 6c66 293a 0a20 2020 2020  ces(self):.     
+00007af0: 2020 2022 2222 5365 7474 6572 2061 6e64     """Setter and
+00007b00: 2067 6574 7465 7220 6f66 2062 616e 6420   getter of band 
+00007b10: 696e 6469 6365 732e 0a0a 2020 2020 2020  indices...      
+00007b20: 2020 6172 7261 795f 6c69 6b65 0a20 2020    array_like.   
+00007b30: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
+00007b40: 2062 616e 6420 696e 6469 6365 7320 7370   band indices sp
+00007b50: 6563 6966 6965 6420 746f 2073 656c 6563  ecified to selec
+00007b60: 7420 7370 6563 6966 6963 2062 616e 6473  t specific bands
+00007b70: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+00007b80: 636f 6d70 7574 6572 2070 682d 7068 2069  computer ph-ph i
+00007b90: 6e74 6572 6163 7469 6f6e 2072 656c 6174  nteraction relat
+00007ba0: 6564 2070 726f 7065 7274 6965 732e 0a0a  ed properties...
+00007bb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00007bc0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00007bd0: 5f62 616e 645f 696e 6469 6365 730a 0a20  _band_indices.. 
+00007be0: 2020 2040 6261 6e64 5f69 6e64 6963 6573     @band_indices
+00007bf0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+00007c00: 6261 6e64 5f69 6e64 6963 6573 2873 656c  band_indices(sel
+00007c10: 662c 2062 616e 645f 696e 6469 6365 7329  f, band_indices)
+00007c20: 3a0a 2020 2020 2020 2020 7365 6c66 2e5f  :.        self._
+00007c30: 7365 745f 6261 6e64 5f69 6e64 6963 6573  set_band_indices
+00007c40: 2862 616e 645f 696e 6469 6365 733d 6261  (band_indices=ba
+00007c50: 6e64 5f69 6e64 6963 6573 290a 0a20 2020  nd_indices)..   
+00007c60: 2064 6566 2073 6574 5f62 616e 645f 696e   def set_band_in
+00007c70: 6469 6365 7328 7365 6c66 2c20 6261 6e64  dices(self, band
+00007c80: 5f69 6e64 6963 6573 293a 0a20 2020 2020  _indices):.     
+00007c90: 2020 2022 2222 5365 7420 6261 6e64 2069     """Set band i
+00007ca0: 6e64 6963 6573 2e22 2222 0a20 2020 2020  ndices.""".     
+00007cb0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00007cc0: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
+00007cd0: 686f 6e6f 3370 792e 7365 745f 6261 6e64  hono3py.set_band
+00007ce0: 5f69 6e64 6963 6573 2829 2069 7320 6465  _indices() is de
+00007cf0: 7072 6563 6174 6564 2e22 0a20 2020 2020  precated.".     
+00007d00: 2020 2020 2020 2022 5573 6520 5068 6f6e         "Use Phon
+00007d10: 6f33 7079 2e62 616e 645f 696e 6469 6365  o3py.band_indice
+00007d20: 7320 6174 7472 6962 7574 6520 696e 7374  s attribute inst
+00007d30: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
+00007d40: 2020 2044 6570 7265 6361 7469 6f6e 5761     DeprecationWa
+00007d50: 726e 696e 672c 0a20 2020 2020 2020 2029  rning,.        )
+00007d60: 0a20 2020 2020 2020 2073 656c 662e 6261  .        self.ba
+00007d70: 6e64 5f69 6e64 6963 6573 203d 2062 616e  nd_indices = ban
+00007d80: 645f 696e 6469 6365 730a 0a20 2020 2064  d_indices..    d
+00007d90: 6566 205f 7365 745f 6261 6e64 5f69 6e64  ef _set_band_ind
+00007da0: 6963 6573 2873 656c 662c 2062 616e 645f  ices(self, band_
+00007db0: 696e 6469 6365 733d 4e6f 6e65 293a 0a20  indices=None):. 
+00007dc0: 2020 2020 2020 2069 6620 6261 6e64 5f69         if band_i
+00007dd0: 6e64 6963 6573 2069 7320 4e6f 6e65 3a0a  ndices is None:.
+00007de0: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
+00007df0: 6261 6e64 203d 206c 656e 2873 656c 662e  band = len(self.
+00007e00: 5f70 7269 6d69 7469 7665 2920 2a20 330a  _primitive) * 3.
+00007e10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00007e20: 2e5f 6261 6e64 5f69 6e64 6963 6573 203d  ._band_indices =
+00007e30: 205b 6e70 2e61 7261 6e67 6528 6e75 6d5f   [np.arange(num_
+00007e40: 6261 6e64 2c20 6474 7970 653d 2269 6e74  band, dtype="int
+00007e50: 5f22 295d 0a20 2020 2020 2020 2065 6c73  _")].        els
+00007e60: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00007e70: 656c 662e 5f62 616e 645f 696e 6469 6365  elf._band_indice
+00007e80: 7320 3d20 6261 6e64 5f69 6e64 6963 6573  s = band_indices
+00007e90: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+00007ea0: 616e 645f 696e 6469 6365 735f 666c 6174  and_indices_flat
+00007eb0: 7465 6e20 3d20 6e70 2e68 7374 6163 6b28  ten = np.hstack(
+00007ec0: 7365 6c66 2e5f 6261 6e64 5f69 6e64 6963  self._band_indic
+00007ed0: 6573 292e 6173 7479 7065 2822 696e 745f  es).astype("int_
+00007ee0: 2229 0a0a 2020 2020 4070 726f 7065 7274  ")..    @propert
+00007ef0: 790a 2020 2020 6465 6620 6d61 7373 6573  y.    def masses
+00007f00: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00007f10: 2222 2253 6574 7465 7220 616e 6420 6765  """Setter and ge
+00007f20: 7474 6572 206f 6620 6174 6f6d 6963 206d  tter of atomic m
+00007f30: 6173 7365 7320 6f66 2070 7269 6d69 7469  asses of primiti
+00007f40: 7665 2063 656c 6c2e 2222 220a 2020 2020  ve cell.""".    
+00007f50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00007f60: 5f70 7269 6d69 7469 7665 2e6d 6173 7365  _primitive.masse
+00007f70: 730a 0a20 2020 2040 6d61 7373 6573 2e73  s..    @masses.s
+00007f80: 6574 7465 720a 2020 2020 6465 6620 6d61  etter.    def ma
+00007f90: 7373 6573 2873 656c 662c 206d 6173 7365  sses(self, masse
+00007fa0: 7329 3a0a 2020 2020 2020 2020 6966 206d  s):.        if m
+00007fb0: 6173 7365 7320 6973 204e 6f6e 653a 0a20  asses is None:. 
+00007fc0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00007fd0: 6e0a 2020 2020 2020 2020 705f 6d61 7373  n.        p_mass
+00007fe0: 6573 203d 206e 702e 6172 7261 7928 6d61  es = np.array(ma
+00007ff0: 7373 6573 290a 2020 2020 2020 2020 7365  sses).        se
+00008000: 6c66 2e5f 7072 696d 6974 6976 652e 6d61  lf._primitive.ma
+00008010: 7373 6573 203d 2070 5f6d 6173 7365 730a  sses = p_masses.
+00008020: 2020 2020 2020 2020 7032 705f 6d61 7020          p2p_map 
+00008030: 3d20 7365 6c66 2e5f 7072 696d 6974 6976  = self._primitiv
+00008040: 652e 7032 705f 6d61 700a 2020 2020 2020  e.p2p_map.      
+00008050: 2020 735f 6d61 7373 6573 203d 2070 5f6d    s_masses = p_m
+00008060: 6173 7365 735b 5b70 3270 5f6d 6170 5b78  asses[[p2p_map[x
+00008070: 5d20 666f 7220 7820 696e 2073 656c 662e  ] for x in self.
+00008080: 5f70 7269 6d69 7469 7665 2e73 3270 5f6d  _primitive.s2p_m
+00008090: 6170 5d5d 0a20 2020 2020 2020 2073 656c  ap]].        sel
+000080a0: 662e 5f73 7570 6572 6365 6c6c 2e6d 6173  f._supercell.mas
+000080b0: 7365 7320 3d20 735f 6d61 7373 6573 0a20  ses = s_masses. 
+000080c0: 2020 2020 2020 2075 3273 5f6d 6170 203d         u2s_map =
+000080d0: 2073 656c 662e 5f73 7570 6572 6365 6c6c   self._supercell
+000080e0: 2e75 3273 5f6d 6170 0a20 2020 2020 2020  .u2s_map.       
+000080f0: 2075 5f6d 6173 7365 7320 3d20 735f 6d61   u_masses = s_ma
+00008100: 7373 6573 5b75 3273 5f6d 6170 5d0a 2020  sses[u2s_map].  
+00008110: 2020 2020 2020 7365 6c66 2e5f 756e 6974        self._unit
+00008120: 6365 6c6c 2e6d 6173 7365 7320 3d20 755f  cell.masses = u_
+00008130: 6d61 7373 6573 0a20 2020 2020 2020 2073  masses.        s
+00008140: 656c 662e 5f70 686f 6e6f 6e5f 7072 696d  elf._phonon_prim
+00008150: 6974 6976 652e 6d61 7373 6573 203d 2070  itive.masses = p
+00008160: 5f6d 6173 7365 730a 2020 2020 2020 2020  _masses.        
+00008170: 7032 705f 6d61 7020 3d20 7365 6c66 2e5f  p2p_map = self._
+00008180: 7068 6f6e 6f6e 5f70 7269 6d69 7469 7665  phonon_primitive
+00008190: 2e70 3270 5f6d 6170 0a20 2020 2020 2020  .p2p_map.       
+000081a0: 2073 5f6d 6173 7365 7320 3d20 705f 6d61   s_masses = p_ma
+000081b0: 7373 6573 5b5b 7032 705f 6d61 705b 785d  sses[[p2p_map[x]
+000081c0: 2066 6f72 2078 2069 6e20 7365 6c66 2e5f   for x in self._
+000081d0: 7068 6f6e 6f6e 5f70 7269 6d69 7469 7665  phonon_primitive
+000081e0: 2e73 3270 5f6d 6170 5d5d 0a20 2020 2020  .s2p_map]].     
+000081f0: 2020 2073 656c 662e 5f70 686f 6e6f 6e5f     self._phonon_
+00008200: 7375 7065 7263 656c 6c2e 6d61 7373 6573  supercell.masses
+00008210: 203d 2073 5f6d 6173 7365 730a 0a20 2020   = s_masses..   
+00008220: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00008230: 6566 2073 7570 6572 6365 6c6c 735f 7769  ef supercells_wi
+00008240: 7468 5f64 6973 706c 6163 656d 656e 7473  th_displacements
+00008250: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00008260: 2222 2252 6574 7572 6e20 7375 7065 7263  """Return superc
+00008270: 656c 6c73 2077 6974 6820 6469 7370 6c61  ells with displa
+00008280: 6365 6d65 6e74 732e 0a0a 2020 2020 2020  cements...      
+00008290: 2020 6c69 7374 206f 6620 5068 6f6e 6f70    list of Phonop
+000082a0: 7941 746f 6d73 0a20 2020 2020 2020 2020  yAtoms.         
+000082b0: 2020 2053 7570 6572 6365 6c6c 7320 7769     Supercells wi
+000082c0: 7468 2064 6973 706c 6163 656d 656e 7473  th displacements
+000082d0: 2067 656e 6572 6174 6564 2062 790a 2020   generated by.  
+000082e0: 2020 2020 2020 2020 2020 5068 6f6e 6f33            Phono3
+000082f0: 7079 2e67 656e 6572 6174 655f 6469 7370  py.generate_disp
+00008300: 6c61 6365 6d65 6e74 732e 0a0a 2020 2020  lacements...    
+00008310: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00008320: 6966 2073 656c 662e 5f73 7570 6572 6365  if self._superce
+00008330: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
+00008340: 656d 656e 7473 2069 7320 4e6f 6e65 3a0a  ements is None:.
+00008350: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00008360: 2e5f 6275 696c 645f 7375 7065 7263 656c  ._build_supercel
+00008370: 6c73 5f77 6974 685f 6469 7370 6c61 6365  ls_with_displace
+00008380: 6d65 6e74 7328 290a 2020 2020 2020 2020  ments().        
+00008390: 7265 7475 726e 2073 656c 662e 5f73 7570  return self._sup
+000083a0: 6572 6365 6c6c 735f 7769 7468 5f64 6973  ercells_with_dis
+000083b0: 706c 6163 656d 656e 7473 0a0a 2020 2020  placements..    
+000083c0: 6465 6620 6765 745f 7375 7065 7263 656c  def get_supercel
+000083d0: 6c73 5f77 6974 685f 6469 7370 6c61 6365  ls_with_displace
+000083e0: 6d65 6e74 7328 7365 6c66 293a 0a20 2020  ments(self):.   
+000083f0: 2020 2020 2022 2222 5265 7475 726e 2073       """Return s
+00008400: 7570 6572 6365 6c6c 7320 7769 7468 2064  upercells with d
+00008410: 6973 706c 6163 656d 656e 7473 2e22 2222  isplacements."""
+00008420: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00008430: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00008440: 2020 2020 2250 686f 6e6f 3370 792e 6765      "Phono3py.ge
+00008450: 745f 7375 7065 7263 656c 6c73 5f77 6974  t_supercells_wit
+00008460: 685f 6469 7370 6c61 6365 6d65 6e74 7328  h_displacements(
+00008470: 2920 6973 2064 6570 7265 6361 7465 642e  ) is deprecated.
+00008480: 220a 2020 2020 2020 2020 2020 2020 2255  ".            "U
+00008490: 7365 2050 686f 6e6f 3370 792e 7375 7065  se Phono3py.supe
+000084a0: 7263 656c 6c73 5f77 6974 685f 6469 7370  rcells_with_disp
+000084b0: 6c61 6365 6d65 6e74 7320 6174 7472 6962  lacements attrib
+000084c0: 7574 6520 696e 7374 6561 642e 222c 0a20  ute instead.",. 
+000084d0: 2020 2020 2020 2020 2020 2044 6570 7265             Depre
+000084e0: 6361 7469 6f6e 5761 726e 696e 672c 0a20  cationWarning,. 
+000084f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00008500: 2072 6574 7572 6e20 7365 6c66 2e73 7570   return self.sup
+00008510: 6572 6365 6c6c 735f 7769 7468 5f64 6973  ercells_with_dis
+00008520: 706c 6163 656d 656e 7473 0a0a 2020 2020  placements..    
+00008530: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00008540: 6620 7068 6f6e 6f6e 5f73 7570 6572 6365  f phonon_superce
+00008550: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
+00008560: 656d 656e 7473 2873 656c 6629 3a0a 2020  ements(self):.  
+00008570: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00008580: 7375 7065 7263 656c 6c73 2077 6974 6820  supercells with 
+00008590: 6469 7370 6c61 6365 6d65 6e74 7320 666f  displacements fo
+000085a0: 7220 6663 322e 0a0a 2020 2020 2020 2020  r fc2...        
+000085b0: 6c69 7374 206f 6620 5068 6f6e 6f70 7941  list of PhonopyA
+000085c0: 746f 6d73 0a20 2020 2020 2020 2020 2020  toms.           
+000085d0: 2053 7570 6572 6365 6c6c 7320 7769 7468   Supercells with
+000085e0: 2064 6973 706c 6163 656d 656e 7473 2067   displacements g
+000085f0: 656e 6572 6174 6564 2062 790a 2020 2020  enerated by.    
+00008600: 2020 2020 2020 2020 5068 6f6e 6f33 7079          Phono3py
+00008610: 2e67 656e 6572 6174 655f 6469 7370 6c61  .generate_displa
+00008620: 6365 6d65 6e74 732e 0a0a 2020 2020 2020  cements...      
+00008630: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00008640: 2073 656c 662e 5f70 686f 6e6f 6e5f 7375   self._phonon_su
+00008650: 7065 7263 656c 6c73 5f77 6974 685f 6469  percells_with_di
+00008660: 7370 6c61 6365 6d65 6e74 7320 6973 204e  splacements is N
+00008670: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00008680: 2069 6620 7365 6c66 2e5f 7068 6f6e 6f6e   if self._phonon
+00008690: 5f64 6174 6173 6574 2069 7320 6e6f 7420  _dataset is not 
+000086a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000086b0: 2020 2020 2020 7365 6c66 2e5f 7068 6f6e        self._phon
+000086c0: 6f6e 5f73 7570 6572 6365 6c6c 735f 7769  on_supercells_wi
+000086d0: 7468 5f64 6973 706c 6163 656d 656e 7473  th_displacements
+000086e0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+000086f0: 2020 2020 2020 2020 2073 656c 662e 5f62           self._b
+00008700: 7569 6c64 5f70 686f 6e6f 6e5f 7375 7065  uild_phonon_supe
+00008710: 7263 656c 6c73 5f77 6974 685f 6469 7370  rcells_with_disp
+00008720: 6c61 6365 6d65 6e74 7328 0a20 2020 2020  lacements(.     
+00008730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008740: 2020 2073 656c 662e 5f70 686f 6e6f 6e5f     self._phonon_
+00008750: 7375 7065 7263 656c 6c2c 2073 656c 662e  supercell, self.
+00008760: 5f70 686f 6e6f 6e5f 6461 7461 7365 740a  _phonon_dataset.
+00008770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008780: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00008790: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000087a0: 7265 7475 726e 2073 656c 662e 5f70 686f  return self._pho
+000087b0: 6e6f 6e5f 7375 7065 7263 656c 6c73 5f77  non_supercells_w
+000087c0: 6974 685f 6469 7370 6c61 6365 6d65 6e74  ith_displacement
+000087d0: 730a 0a20 2020 2064 6566 2067 6574 5f70  s..    def get_p
+000087e0: 686f 6e6f 6e5f 7375 7065 7263 656c 6c73  honon_supercells
+000087f0: 5f77 6974 685f 6469 7370 6c61 6365 6d65  _with_displaceme
+00008800: 6e74 7328 7365 6c66 293a 0a20 2020 2020  nts(self):.     
+00008810: 2020 2022 2222 5265 7475 726e 2073 7570     """Return sup
+00008820: 6572 6365 6c6c 7320 7769 7468 2064 6973  ercells with dis
+00008830: 706c 6163 656d 656e 7473 2066 6f72 2066  placements for f
+00008840: 6332 2e22 2222 0a20 2020 2020 2020 2077  c2.""".        w
+00008850: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00008860: 2020 2020 2020 2020 2020 2250 686f 6e6f            "Phono
+00008870: 3370 792e 6765 745f 7068 6f6e 6f6e 5f73  3py.get_phonon_s
+00008880: 7570 6572 6365 6c6c 735f 7769 7468 5f64  upercells_with_d
+00008890: 6973 706c 6163 656d 656e 7473 2829 2022  isplacements() "
+000088a0: 0a20 2020 2020 2020 2020 2020 2022 6973  .            "is
+000088b0: 2064 6570 7265 6361 7465 642e 2055 7365   deprecated. Use
+000088c0: 2050 686f 6e6f 3370 792e 7068 6f6e 6f6e   Phono3py.phonon
+000088d0: 5f73 7570 6572 6365 6c6c 735f 7769 7468  _supercells_with
+000088e0: 5f64 6973 706c 6163 656d 656e 7473 2022  _displacements "
+000088f0: 0a20 2020 2020 2020 2020 2020 2022 6174  .            "at
+00008900: 7472 6962 7574 6520 696e 7374 6561 642e  tribute instead.
+00008910: 222c 0a20 2020 2020 2020 2020 2020 2044  ",.            D
+00008920: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
+00008930: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
+00008940: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00008950: 2e70 686f 6e6f 6e5f 7375 7065 7263 656c  .phonon_supercel
+00008960: 6c73 5f77 6974 685f 6469 7370 6c61 6365  ls_with_displace
+00008970: 6d65 6e74 730a 0a20 2020 2040 7072 6f70  ments..    @prop
+00008980: 6572 7479 0a20 2020 2064 6566 206d 6573  erty.    def mes
+00008990: 685f 6e75 6d62 6572 7328 7365 6c66 293a  h_numbers(self):
+000089a0: 0a20 2020 2020 2020 2022 2222 5365 7474  .        """Sett
+000089b0: 6572 2061 6e64 2067 6574 7465 7220 6f66  er and getter of
+000089c0: 2073 616d 706c 696e 6720 6d65 7368 206e   sampling mesh n
+000089d0: 756d 6265 7273 2069 6e20 7265 6369 7072  umbers in recipr
+000089e0: 6f63 616c 2073 7061 6365 2e22 2222 0a20  ocal space.""". 
+000089f0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00008a00: 627a 5f67 7269 6420 6973 204e 6f6e 653a  bz_grid is None:
+00008a10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00008a20: 7572 6e20 4e6f 6e65 0a20 2020 2020 2020  urn None.       
+00008a30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00008a40: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00008a50: 627a 5f67 7269 642e 445f 6469 6167 0a0a  bz_grid.D_diag..
+00008a60: 2020 2020 406d 6573 685f 6e75 6d62 6572      @mesh_number
+00008a70: 732e 7365 7474 6572 0a20 2020 2064 6566  s.setter.    def
+00008a80: 206d 6573 685f 6e75 6d62 6572 7328 7365   mesh_numbers(se
+00008a90: 6c66 2c20 6d65 7368 5f6e 756d 6265 7273  lf, mesh_numbers
+00008aa0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00008ab0: 5f73 6574 5f6d 6573 685f 6e75 6d62 6572  _set_mesh_number
+00008ac0: 7328 6d65 7368 5f6e 756d 6265 7273 290a  s(mesh_numbers).
+00008ad0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00008ae0: 2020 2064 6566 2074 6865 726d 616c 5f63     def thermal_c
+00008af0: 6f6e 6475 6374 6976 6974 7928 7365 6c66  onductivity(self
+00008b00: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+00008b10: 7475 726e 2074 6865 726d 616c 2063 6f6e  turn thermal con
+00008b20: 6475 6374 6976 6974 7920 636c 6173 7320  ductivity class 
+00008b30: 696e 7374 616e 6365 2e22 2222 0a20 2020  instance.""".   
+00008b40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00008b50: 2e5f 7468 6572 6d61 6c5f 636f 6e64 7563  ._thermal_conduc
+00008b60: 7469 7669 7479 0a0a 2020 2020 6465 6620  tivity..    def 
+00008b70: 6765 745f 7468 6572 6d61 6c5f 636f 6e64  get_thermal_cond
+00008b80: 7563 7469 7669 7479 2873 656c 6629 3a0a  uctivity(self):.
+00008b90: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00008ba0: 6e20 7468 6572 6d61 6c20 636f 6e64 7563  n thermal conduc
+00008bb0: 7469 7669 7479 2063 6c61 7373 2069 6e73  tivity class ins
+00008bc0: 7461 6e63 652e 2222 220a 2020 2020 2020  tance.""".      
+00008bd0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00008be0: 0a20 2020 2020 2020 2020 2020 2022 5068  .            "Ph
+00008bf0: 6f6e 6f33 7079 2e67 6574 5f74 6865 726d  ono3py.get_therm
+00008c00: 616c 5f63 6f6e 6475 6374 6976 6974 7928  al_conductivity(
+00008c10: 2920 6973 2064 6570 7265 6361 7465 642e  ) is deprecated.
+00008c20: 220a 2020 2020 2020 2020 2020 2020 2255  ".            "U
+00008c30: 7365 2050 686f 6e6f 3370 792e 7468 6572  se Phono3py.ther
+00008c40: 6d61 6c5f 636f 6e64 7563 7469 7669 7479  mal_conductivity
+00008c50: 2061 7474 7269 6275 7465 2069 6e73 7465   attribute inste
+00008c60: 6164 2e22 2c0a 2020 2020 2020 2020 2020  ad.",.          
+00008c70: 2020 4465 7072 6563 6174 696f 6e57 6172    DeprecationWar
+00008c80: 6e69 6e67 2c0a 2020 2020 2020 2020 290a  ning,.        ).
+00008c90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00008ca0: 656c 662e 7468 6572 6d61 6c5f 636f 6e64  elf.thermal_cond
+00008cb0: 7563 7469 7669 7479 0a0a 2020 2020 4070  uctivity..    @p
+00008cc0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00008cd0: 6469 7370 6c61 6365 6d65 6e74 7328 7365  displacements(se
+00008ce0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00008cf0: 5365 7474 6572 2061 6e64 2067 6574 7465  Setter and gette
+00008d00: 7220 6469 7370 6c61 6365 6d65 6e74 7320  r displacements 
+00008d10: 696e 2073 7570 6572 6365 6c6c 732e 0a0a  in supercells...
+00008d20: 2020 2020 2020 2020 5468 6572 6520 6172          There ar
+00008d30: 6520 7477 6f20 7479 7065 7320 6f66 2064  e two types of d
+00008d40: 6973 706c 6163 656d 656e 7420 6461 7461  isplacement data
+00008d50: 7365 742e 2053 6565 2074 6865 2064 6f63  set. See the doc
+00008d60: 7374 7269 6e67 0a20 2020 2020 2020 206f  string.        o
+00008d70: 6620 6461 7461 7365 7420 6162 6f75 7420  f dataset about 
+00008d80: 7479 7065 7320 3120 616e 6420 3220 666f  types 1 and 2 fo
+00008d90: 7220 7468 6520 6469 7370 6c61 6365 6d65  r the displaceme
+00008da0: 6e74 2064 6174 6173 6574 2066 6f72 6d61  nt dataset forma
+00008db0: 7473 2e0a 2020 2020 2020 2020 4469 7370  ts..        Disp
+00008dc0: 6c61 6365 6d65 6e74 7320 7365 7420 7265  lacements set re
+00008dd0: 7475 726e 6564 2064 6570 656e 6473 206f  turned depends o
+00008de0: 6e20 6569 7468 6572 2074 7970 652d 3120  n either type-1 
+00008df0: 6f72 2074 7970 652d 3220 6173 0a20 2020  or type-2 as.   
+00008e00: 2020 2020 2066 6f6c 6c6f 7773 3a0a 0a20       follows:.. 
+00008e10: 2020 2020 2020 2054 7970 652d 312c 204c         Type-1, L
+00008e20: 6973 7420 6f66 206c 6973 740a 2020 2020  ist of list.    
+00008e30: 2020 2020 2020 2020 5468 6520 696e 7465          The inte
+00008e40: 726e 616c 206c 6973 7420 6861 7320 3420  rnal list has 4 
+00008e50: 656c 656d 656e 7473 2073 7563 6820 6173  elements such as
+00008e60: 205b 3332 2c20 302e 3031 2c20 302e 302c   [32, 0.01, 0.0,
+00008e70: 2030 2e30 5d5d 2e0a 2020 2020 2020 2020   0.0]]..        
+00008e80: 2020 2020 5468 6520 6669 7273 7420 656c      The first el
+00008e90: 656d 656e 7420 6973 2074 6865 2073 7570  ement is the sup
+00008ea0: 6572 6365 6c6c 2061 746f 6d20 696e 6465  ercell atom inde
+00008eb0: 7820 7374 6172 7469 6e67 2077 6974 6820  x starting with 
+00008ec0: 302e 0a20 2020 2020 2020 2020 2020 2054  0..            T
+00008ed0: 6865 2072 656d 6169 6e69 6e67 2074 6872  he remaining thr
+00008ee0: 6565 2065 6c65 6d65 6e74 7320 6769 7665  ee elements give
+00008ef0: 2074 6865 2064 6973 706c 6163 656d 656e   the displacemen
+00008f00: 7420 696e 2043 6172 7465 7369 616e 0a20  t in Cartesian. 
+00008f10: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
+00008f20: 696e 6174 6573 2e0a 2020 2020 2020 2020  inates..        
+00008f30: 5479 7065 2d32 2c20 6172 7261 795f 6c69  Type-2, array_li
+00008f40: 6b65 0a20 2020 2020 2020 2020 2020 2044  ke.            D
+00008f50: 6973 706c 6163 656d 656e 7473 206f 6620  isplacements of 
+00008f60: 616c 6c20 6174 6f6d 7320 6f66 2061 6c6c  all atoms of all
+00008f70: 2073 7570 6572 6365 6c6c 7320 696e 2043   supercells in C
+00008f80: 6172 7465 7369 616e 0a20 2020 2020 2020  artesian.       
+00008f90: 2020 2020 2063 6f6f 7264 696e 6174 6573       coordinates
+00008fa0: 2e0a 2020 2020 2020 2020 2020 2020 7368  ..            sh
+00008fb0: 6170 653d 2873 7570 6572 6365 6c6c 732c  ape=(supercells,
+00008fc0: 206e 6174 6f6d 2c20 3329 0a20 2020 2020   natom, 3).     
+00008fd0: 2020 2020 2020 2064 7479 7065 3d27 646f         dtype='do
+00008fe0: 7562 6c65 270a 0a0a 2020 2020 2020 2020  uble'...        
+00008ff0: 466f 7220 7365 7474 6572 2c20 6f6e 6c79  For setter, only
+00009000: 2074 7970 652d 3220 6461 7461 7365 7420   type-2 dataset 
+00009010: 666f 726d 6174 2069 7320 616c 6c6f 7765  format is allowe
+00009020: 642e 0a0a 2020 2020 2020 2020 6469 7370  d...        disp
+00009030: 6c61 6365 6d65 6e74 7320 3a20 6172 7261  lacements : arra
+00009040: 795f 6c69 6b65 0a20 2020 2020 2020 2020  y_like.         
+00009050: 2020 2041 746f 6d69 6320 6469 7370 6c61     Atomic displa
+00009060: 6365 6d65 6e74 7320 6f66 2061 6c6c 2061  cements of all a
+00009070: 746f 6d73 206f 6620 616c 6c20 7375 7065  toms of all supe
+00009080: 7263 656c 6c73 2e0a 2020 2020 2020 2020  rcells..        
+00009090: 2020 2020 4f6e 6c79 2061 6c6c 2064 6973      Only all dis
+000090a0: 706c 6163 656d 656e 7473 2069 6e20 6561  placements in ea
+000090b0: 6368 2073 7570 6572 6365 6c6c 2063 6173  ch supercell cas
+000090c0: 6520 2874 7970 652d 3229 2069 730a 2020  e (type-2) is.  
+000090d0: 2020 2020 2020 2020 2020 7375 7070 6f72            suppor
+000090e0: 7465 642e 0a20 2020 2020 2020 2020 2020  ted..           
+000090f0: 2073 6861 7065 3d28 7375 7065 7263 656c   shape=(supercel
+00009100: 6c73 2c20 6e61 746f 6d2c 2033 292c 2064  ls, natom, 3), d
+00009110: 7479 7065 3d27 646f 7562 6c65 272c 206f  type='double', o
+00009120: 7264 6572 3d27 4327 0a0a 2020 2020 2020  rder='C'..      
+00009130: 2020 2222 220a 2020 2020 2020 2020 6461    """.        da
+00009140: 7461 7365 7420 3d20 7365 6c66 2e5f 6461  taset = self._da
+00009150: 7461 7365 740a 0a20 2020 2020 2020 2069  taset..        i
+00009160: 6620 2266 6972 7374 5f61 746f 6d73 2220  f "first_atoms" 
+00009170: 696e 2064 6174 6173 6574 3a0a 2020 2020  in dataset:.    
+00009180: 2020 2020 2020 2020 6e75 6d5f 7363 656c          num_scel
+00009190: 6c73 203d 206c 656e 2864 6174 6173 6574  ls = len(dataset
+000091a0: 5b22 6669 7273 745f 6174 6f6d 7322 5d29  ["first_atoms"])
+000091b0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000091c0: 2064 6973 7031 2069 6e20 6461 7461 7365   disp1 in datase
+000091d0: 745b 2266 6972 7374 5f61 746f 6d73 225d  t["first_atoms"]
+000091e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000091f0: 2020 6e75 6d5f 7363 656c 6c73 202b 3d20    num_scells += 
+00009200: 6c65 6e28 6469 7370 315b 2273 6563 6f6e  len(disp1["secon
+00009210: 645f 6174 6f6d 7322 5d29 0a20 2020 2020  d_atoms"]).     
+00009220: 2020 2020 2020 2064 6973 706c 6163 656d         displacem
+00009230: 656e 7473 203d 206e 702e 7a65 726f 7328  ents = np.zeros(
+00009240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009250: 2028 6e75 6d5f 7363 656c 6c73 2c20 7365   (num_scells, se
+00009260: 6c66 2e5f 7375 7065 7263 656c 6c2e 6765  lf._supercell.ge
+00009270: 745f 6e75 6d62 6572 5f6f 665f 6174 6f6d  t_number_of_atom
+00009280: 7328 292c 2033 292c 0a20 2020 2020 2020  s(), 3),.       
+00009290: 2020 2020 2020 2020 2064 7479 7065 3d22           dtype="
+000092a0: 646f 7562 6c65 222c 0a20 2020 2020 2020  double",.       
+000092b0: 2020 2020 2020 2020 206f 7264 6572 3d22           order="
+000092c0: 4322 2c0a 2020 2020 2020 2020 2020 2020  C",.            
+000092d0: 290a 2020 2020 2020 2020 2020 2020 6920  ).            i 
+000092e0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+000092f0: 666f 7220 6469 7370 3120 696e 2064 6174  for disp1 in dat
+00009300: 6173 6574 5b22 6669 7273 745f 6174 6f6d  aset["first_atom
+00009310: 7322 5d3a 0a20 2020 2020 2020 2020 2020  s"]:.           
+00009320: 2020 2020 2064 6973 706c 6163 656d 656e       displacemen
+00009330: 7473 5b69 2c20 6469 7370 315b 226e 756d  ts[i, disp1["num
+00009340: 6265 7222 5d5d 203d 2064 6973 7031 5b22  ber"]] = disp1["
+00009350: 6469 7370 6c61 6365 6d65 6e74 225d 0a20  displacement"]. 
+00009360: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00009370: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+00009380: 2020 666f 7220 6469 7370 3120 696e 2064    for disp1 in d
+00009390: 6174 6173 6574 5b22 6669 7273 745f 6174  ataset["first_at
+000093a0: 6f6d 7322 5d3a 0a20 2020 2020 2020 2020  oms"]:.         
+000093b0: 2020 2020 2020 2066 6f72 2064 6973 7032         for disp2
+000093c0: 2069 6e20 6469 7370 315b 2273 6563 6f6e   in disp1["secon
+000093d0: 645f 6174 6f6d 7322 5d3a 0a20 2020 2020  d_atoms"]:.     
+000093e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000093f0: 6973 706c 6163 656d 656e 7473 5b69 2c20  isplacements[i, 
+00009400: 6469 7370 325b 226e 756d 6265 7222 5d5d  disp2["number"]]
+00009410: 203d 2064 6973 7032 5b22 6469 7370 6c61   = disp2["displa
+00009420: 6365 6d65 6e74 225d 0a20 2020 2020 2020  cement"].       
+00009430: 2020 2020 2020 2020 2020 2020 2069 202b               i +
+00009440: 3d20 310a 2020 2020 2020 2020 656c 6966  = 1.        elif
+00009450: 2022 666f 7263 6573 2220 696e 2064 6174   "forces" in dat
+00009460: 6173 6574 206f 7220 2264 6973 706c 6163  aset or "displac
+00009470: 656d 656e 7473 2220 696e 2064 6174 6173  ements" in datas
+00009480: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
+00009490: 6469 7370 6c61 6365 6d65 6e74 7320 3d20  displacements = 
+000094a0: 6461 7461 7365 745b 2264 6973 706c 6163  dataset["displac
+000094b0: 656d 656e 7473 225d 0a20 2020 2020 2020  ements"].       
+000094c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000094d0: 2020 2072 6169 7365 2052 756e 7469 6d65     raise Runtime
+000094e0: 4572 726f 7228 2264 6973 706c 6163 656d  Error("displacem
+000094f0: 656e 7420 6461 7461 7365 7420 6861 7320  ent dataset has 
+00009500: 7772 6f6e 6720 666f 726d 6174 2e22 290a  wrong format.").
+00009510: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00009520: 6469 7370 6c61 6365 6d65 6e74 730a 0a20  displacements.. 
+00009530: 2020 2040 6469 7370 6c61 6365 6d65 6e74     @displacement
+00009540: 732e 7365 7474 6572 0a20 2020 2064 6566  s.setter.    def
+00009550: 2064 6973 706c 6163 656d 656e 7473 2873   displacements(s
+00009560: 656c 662c 2064 6973 706c 6163 656d 656e  elf, displacemen
+00009570: 7473 293a 0a20 2020 2020 2020 2064 6973  ts):.        dis
+00009580: 7073 203d 206e 702e 6172 7261 7928 6469  ps = np.array(di
+00009590: 7370 6c61 6365 6d65 6e74 732c 2064 7479  splacements, dty
+000095a0: 7065 3d22 646f 7562 6c65 222c 206f 7264  pe="double", ord
+000095b0: 6572 3d22 4322 290a 2020 2020 2020 2020  er="C").        
+000095c0: 6e61 746f 6d20 3d20 6c65 6e28 7365 6c66  natom = len(self
+000095d0: 2e5f 7375 7065 7263 656c 6c29 0a20 2020  ._supercell).   
+000095e0: 2020 2020 2069 6620 6469 7370 732e 6e64       if disps.nd
+000095f0: 696d 2021 3d20 3320 6f72 2064 6973 7073  im != 3 or disps
+00009600: 2e73 6861 7065 5b31 3a5d 2021 3d20 286e  .shape[1:] != (n
+00009610: 6174 6f6d 2c20 3329 3a0a 2020 2020 2020  atom, 3):.      
+00009620: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
+00009630: 696d 6545 7272 6f72 2822 4172 7261 7920  imeError("Array 
+00009640: 7368 6170 6520 6f66 2064 6973 706c 6163  shape of displac
+00009650: 656d 656e 7473 2069 7320 696e 636f 7272  ements is incorr
+00009660: 6563 742e 2229 0a20 2020 2020 2020 2069  ect.").        i
+00009670: 6620 7365 6c66 2e5f 6461 7461 7365 7420  f self._dataset 
+00009680: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00009690: 2020 2020 2073 656c 662e 5f64 6174 6173       self._datas
+000096a0: 6574 203d 207b 7d0a 2020 2020 2020 2020  et = {}.        
+000096b0: 656c 6966 2022 6669 7273 745f 6174 6f6d  elif "first_atom
+000096c0: 7322 2069 6e20 7365 6c66 2e5f 6461 7461  s" in self._data
+000096d0: 7365 743a 0a20 2020 2020 2020 2020 2020  set:.           
+000096e0: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
+000096f0: 726f 7228 2244 6973 706c 6163 656d 656e  ror("Displacemen
+00009700: 7473 2061 7265 2069 6e63 6f6d 7061 7469  ts are incompati
+00009710: 626c 6520 7769 7468 2064 6174 6173 6574  ble with dataset
+00009720: 2e22 290a 2020 2020 2020 2020 7365 6c66  .").        self
+00009730: 2e5f 6461 7461 7365 745b 2264 6973 706c  ._dataset["displ
+00009740: 6163 656d 656e 7473 225d 203d 2064 6973  acements"] = dis
+00009750: 7073 0a20 2020 2020 2020 2073 656c 662e  ps.        self.
+00009760: 5f73 7570 6572 6365 6c6c 735f 7769 7468  _supercells_with
+00009770: 5f64 6973 706c 6163 656d 656e 7473 203d  _displacements =
+00009780: 204e 6f6e 650a 0a20 2020 2040 7072 6f70   None..    @prop
+00009790: 6572 7479 0a20 2020 2064 6566 2066 6f72  erty.    def for
+000097a0: 6365 7328 7365 6c66 293a 0a20 2020 2020  ces(self):.     
+000097b0: 2020 2022 2222 5365 7474 6572 2061 6e64     """Setter and
+000097c0: 2067 6574 7465 7220 6f66 2066 6f72 6365   getter of force
+000097d0: 7320 696e 2064 6973 706c 6163 656d 656e  s in displacemen
+000097e0: 7420 6461 7461 7365 742e 0a0a 2020 2020  t dataset...    
+000097f0: 2020 2020 4120 7365 7420 6f66 2061 746f      A set of ato
+00009800: 6d69 6320 666f 7263 6573 2069 6e20 6469  mic forces in di
+00009810: 7370 6c61 6365 6420 7375 7065 7263 656c  splaced supercel
+00009820: 6c73 2e20 5468 6520 6f72 6465 7220 6f66  ls. The order of
+00009830: 0a20 2020 2020 2020 2064 6973 706c 6163  .        displac
+00009840: 6564 2073 7570 6572 6365 6c6c 7320 6861  ed supercells ha
+00009850: 7320 746f 206d 6174 6368 2077 6974 6820  s to match with 
+00009860: 7468 6174 2069 6e20 6469 7370 6c61 6365  that in displace
+00009870: 6d65 6e74 2064 6174 6173 6574 2e0a 2020  ment dataset..  
+00009880: 2020 2020 2020 7368 6170 653d 2864 6973        shape=(dis
+00009890: 706c 6163 6564 2073 7570 6572 6365 6c6c  placed supercell
+000098a0: 732c 2061 746f 6d73 2069 6e20 7375 7065  s, atoms in supe
+000098b0: 7263 656c 6c2c 2033 290a 0a20 2020 2020  rcell, 3)..     
+000098c0: 2020 2067 6574 7465 7220 3a20 6e64 6172     getter : ndar
+000098d0: 7261 790a 0a20 2020 2020 2020 2073 6574  ray..        set
+000098e0: 7465 7220 3a20 6172 7261 795f 6c69 6b65  ter : array_like
+000098f0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00009900: 206f 7264 6572 206f 6620 7375 7065 7263   order of superc
+00009910: 656c 6c73 2075 7365 6420 666f 7220 6361  ells used for ca
+00009920: 6c63 756c 6174 696e 6720 666f 7263 6573  lculating forces
+00009930: 2068 6173 2074 6f0a 2020 2020 2020 2020   has to.        
+00009940: 2020 2020 6265 2074 6865 2073 616d 6520      be the same 
+00009950: 6f72 6465 7220 6f66 2073 7570 6572 6365  order of superce
+00009960: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
+00009970: 656d 656e 7473 2e0a 0a20 2020 2020 2020  ements...       
+00009980: 2022 2222 0a20 2020 2020 2020 2064 6174   """.        dat
+00009990: 6173 6574 203d 2073 656c 662e 5f64 6174  aset = self._dat
+000099a0: 6173 6574 0a20 2020 2020 2020 2069 6620  aset.        if 
+000099b0: 2266 6f72 6365 7322 2069 6e20 6461 7461  "forces" in data
+000099c0: 7365 743a 0a20 2020 2020 2020 2020 2020  set:.           
+000099d0: 2072 6574 7572 6e20 6461 7461 7365 745b   return dataset[
+000099e0: 2266 6f72 6365 7322 5d0a 2020 2020 2020  "forces"].      
+000099f0: 2020 656c 6966 2022 6669 7273 745f 6174    elif "first_at
+00009a00: 6f6d 7322 2069 6e20 6461 7461 7365 743a  oms" in dataset:
+00009a10: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+00009a20: 5f73 6365 6c6c 7320 3d20 6c65 6e28 6461  _scells = len(da
+00009a30: 7461 7365 745b 2266 6972 7374 5f61 746f  taset["first_ato
+00009a40: 6d73 225d 290a 2020 2020 2020 2020 2020  ms"]).          
+00009a50: 2020 666f 7220 6469 7370 3120 696e 2064    for disp1 in d
+00009a60: 6174 6173 6574 5b22 6669 7273 745f 6174  ataset["first_at
+00009a70: 6f6d 7322 5d3a 0a20 2020 2020 2020 2020  oms"]:.         
+00009a80: 2020 2020 2020 206e 756d 5f73 6365 6c6c         num_scell
+00009a90: 7320 2b3d 206c 656e 2864 6973 7031 5b22  s += len(disp1["
+00009aa0: 7365 636f 6e64 5f61 746f 6d73 225d 290a  second_atoms"]).
+00009ab0: 2020 2020 2020 2020 2020 2020 666f 7263              forc
+00009ac0: 6573 203d 206e 702e 7a65 726f 7328 0a20  es = np.zeros(. 
+00009ad0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00009ae0: 6e75 6d5f 7363 656c 6c73 2c20 7365 6c66  num_scells, self
+00009af0: 2e5f 7375 7065 7263 656c 6c2e 6765 745f  ._supercell.get_
+00009b00: 6e75 6d62 6572 5f6f 665f 6174 6f6d 7328  number_of_atoms(
+00009b10: 292c 2033 292c 0a20 2020 2020 2020 2020  ), 3),.         
+00009b20: 2020 2020 2020 2064 7479 7065 3d22 646f         dtype="do
+00009b30: 7562 6c65 222c 0a20 2020 2020 2020 2020  uble",.         
+00009b40: 2020 2020 2020 206f 7264 6572 3d22 4322         order="C"
+00009b50: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00009b60: 2020 2020 2020 2020 2020 2020 6920 3d20              i = 
+00009b70: 300a 2020 2020 2020 2020 2020 2020 666f  0.            fo
+00009b80: 7220 6469 7370 3120 696e 2064 6174 6173  r disp1 in datas
+00009b90: 6574 5b22 6669 7273 745f 6174 6f6d 7322  et["first_atoms"
+00009ba0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00009bb0: 2020 2066 6f72 6365 735b 695d 203d 2064     forces[i] = d
+00009bc0: 6973 7031 5b22 666f 7263 6573 225d 0a20  isp1["forces"]. 
+00009bd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00009be0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+00009bf0: 2020 666f 7220 6469 7370 3120 696e 2064    for disp1 in d
+00009c00: 6174 6173 6574 5b22 6669 7273 745f 6174  ataset["first_at
+00009c10: 6f6d 7322 5d3a 0a20 2020 2020 2020 2020  oms"]:.         
+00009c20: 2020 2020 2020 2066 6f72 2064 6973 7032         for disp2
+00009c30: 2069 6e20 6469 7370 315b 2273 6563 6f6e   in disp1["secon
+00009c40: 645f 6174 6f6d 7322 5d3a 0a20 2020 2020  d_atoms"]:.     
+00009c50: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00009c60: 6f72 6365 735b 695d 203d 2064 6973 7032  orces[i] = disp2
+00009c70: 5b22 666f 7263 6573 225d 0a20 2020 2020  ["forces"].     
+00009c80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00009c90: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+00009ca0: 2020 7265 7475 726e 2066 6f72 6365 730a    return forces.
+00009cb0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00009cc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00009cd0: 5275 6e74 696d 6545 7272 6f72 2822 6469  RuntimeError("di
+00009ce0: 7370 6c61 6365 6d65 6e74 2064 6174 6173  splacement datas
+00009cf0: 6574 2068 6173 2077 726f 6e67 2066 6f72  et has wrong for
+00009d00: 6d61 742e 2229 0a0a 2020 2020 4066 6f72  mat.")..    @for
+00009d10: 6365 732e 7365 7474 6572 0a20 2020 2064  ces.setter.    d
+00009d20: 6566 2066 6f72 6365 7328 7365 6c66 2c20  ef forces(self, 
+00009d30: 666f 7263 6573 5f66 6333 293a 0a20 2020  forces_fc3):.   
+00009d40: 2020 2020 2066 6f72 6365 7320 3d20 6e70       forces = np
+00009d50: 2e61 7272 6179 2866 6f72 6365 735f 6663  .array(forces_fc
+00009d60: 332c 2064 7479 7065 3d22 646f 7562 6c65  3, dtype="double
+00009d70: 222c 206f 7264 6572 3d22 4322 290a 2020  ", order="C").  
+00009d80: 2020 2020 2020 6461 7461 7365 7420 3d20        dataset = 
+00009d90: 7365 6c66 2e5f 6461 7461 7365 740a 2020  self._dataset.  
+00009da0: 2020 2020 2020 6966 2022 6669 7273 745f        if "first_
+00009db0: 6174 6f6d 7322 2069 6e20 6461 7461 7365  atoms" in datase
+00009dc0: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
+00009dd0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00009de0: 2066 6f72 2064 6973 7031 2069 6e20 6461   for disp1 in da
+00009df0: 7461 7365 745b 2266 6972 7374 5f61 746f  taset["first_ato
+00009e00: 6d73 225d 3a0a 2020 2020 2020 2020 2020  ms"]:.          
+00009e10: 2020 2020 2020 6469 7370 315b 2266 6f72        disp1["for
+00009e20: 6365 7322 5d20 3d20 666f 7263 6573 5b69  ces"] = forces[i
+00009e30: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00009e40: 2020 6920 2b3d 2031 0a20 2020 2020 2020    i += 1.       
+00009e50: 2020 2020 2066 6f72 2064 6973 7031 2069       for disp1 i
+00009e60: 6e20 6461 7461 7365 745b 2266 6972 7374  n dataset["first
+00009e70: 5f61 746f 6d73 225d 3a0a 2020 2020 2020  _atoms"]:.      
+00009e80: 2020 2020 2020 2020 2020 666f 7220 6469            for di
+00009e90: 7370 3220 696e 2064 6973 7031 5b22 7365  sp2 in disp1["se
+00009ea0: 636f 6e64 5f61 746f 6d73 225d 3a0a 2020  cond_atoms"]:.  
+00009eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ec0: 2020 6469 7370 325b 2266 6f72 6365 7322    disp2["forces"
+00009ed0: 5d20 3d20 666f 7263 6573 5b69 5d0a 2020  ] = forces[i].  
+00009ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ef0: 2020 6920 2b3d 2031 0a20 2020 2020 2020    i += 1.       
+00009f00: 2065 6c69 6620 2264 6973 706c 6163 656d   elif "displacem
+00009f10: 656e 7473 2220 696e 2064 6174 6173 6574  ents" in dataset
+00009f20: 206f 7220 2266 6f72 6365 7322 2069 6e20   or "forces" in 
+00009f30: 6461 7461 7365 743a 0a20 2020 2020 2020  dataset:.       
+00009f40: 2020 2020 2064 6174 6173 6574 5b22 666f       dataset["fo
+00009f50: 7263 6573 225d 203d 2066 6f72 6365 730a  rces"] = forces.
+00009f60: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00009f70: 2020 2064 6566 2070 686f 6e6f 6e5f 6469     def phonon_di
+00009f80: 7370 6c61 6365 6d65 6e74 7328 7365 6c66  splacements(self
+00009f90: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
+00009fa0: 7474 6572 2061 6e64 2067 6574 7465 7220  tter and getter 
+00009fb0: 6f66 2064 6973 706c 6163 656d 656e 7473  of displacements
+00009fc0: 2069 6e20 7375 7065 7263 656c 6c73 2066   in supercells f
+00009fd0: 6f72 2066 6332 2e0a 0a20 2020 2020 2020  or fc2...       
+00009fe0: 2054 6865 7265 2061 7265 2074 776f 2074   There are two t
+00009ff0: 7970 6573 206f 6620 6469 7370 6c61 6365  ypes of displace
+0000a000: 6d65 6e74 2064 6174 6173 6574 2e20 5365  ment dataset. Se
+0000a010: 6520 7468 6520 646f 6373 7472 696e 670a  e the docstring.
+0000a020: 2020 2020 2020 2020 6f66 2064 6174 6173          of datas
+0000a030: 6574 2061 626f 7574 2074 7970 6573 2031  et about types 1
+0000a040: 2061 6e64 2032 2066 6f72 2074 6865 2064   and 2 for the d
+0000a050: 6973 706c 6163 656d 656e 7420 6461 7461  isplacement data
+0000a060: 7365 7420 666f 726d 6174 732e 0a20 2020  set formats..   
+0000a070: 2020 2020 2044 6973 706c 6163 656d 656e       Displacemen
+0000a080: 7473 2073 6574 2072 6574 7572 6e65 6420  ts set returned 
+0000a090: 6465 7065 6e64 7320 6f6e 2065 6974 6865  depends on eithe
+0000a0a0: 7220 7479 7065 2d31 206f 7220 7479 7065  r type-1 or type
+0000a0b0: 2d32 2061 730a 2020 2020 2020 2020 666f  -2 as.        fo
+0000a0c0: 6c6c 6f77 733a 0a0a 2020 2020 2020 2020  llows:..        
+0000a0d0: 5479 7065 2d31 2c20 4c69 7374 206f 6620  Type-1, List of 
+0000a0e0: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
+0000a0f0: 2054 6865 2069 6e74 6572 6e61 6c20 6c69   The internal li
+0000a100: 7374 2068 6173 2034 2065 6c65 6d65 6e74  st has 4 element
+0000a110: 7320 7375 6368 2061 7320 5b33 322c 2030  s such as [32, 0
+0000a120: 2e30 312c 2030 2e30 2c20 302e 305d 5d2e  .01, 0.0, 0.0]].
+0000a130: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0000a140: 2066 6972 7374 2065 6c65 6d65 6e74 2069   first element i
+0000a150: 7320 7468 6520 7375 7065 7263 656c 6c20  s the supercell 
+0000a160: 6174 6f6d 2069 6e64 6578 2073 7461 7274  atom index start
+0000a170: 696e 6720 7769 7468 2030 2e0a 2020 2020  ing with 0..    
+0000a180: 2020 2020 2020 2020 5468 6520 7265 6d61          The rema
+0000a190: 696e 696e 6720 7468 7265 6520 656c 656d  ining three elem
+0000a1a0: 656e 7473 2067 6976 6520 7468 6520 6469  ents give the di
+0000a1b0: 7370 6c61 6365 6d65 6e74 2069 6e20 4361  splacement in Ca
+0000a1c0: 7274 6573 6961 6e0a 2020 2020 2020 2020  rtesian.        
+0000a1d0: 2020 2020 636f 6f72 6469 6e61 7465 732e      coordinates.
+0000a1e0: 0a20 2020 2020 2020 2054 7970 652d 322c  .        Type-2,
+0000a1f0: 2061 7272 6179 5f6c 696b 650a 2020 2020   array_like.    
+0000a200: 2020 2020 2020 2020 4469 7370 6c61 6365          Displace
+0000a210: 6d65 6e74 7320 6f66 2061 6c6c 2061 746f  ments of all ato
+0000a220: 6d73 206f 6620 616c 6c20 7375 7065 7263  ms of all superc
+0000a230: 656c 6c73 2069 6e20 4361 7274 6573 6961  ells in Cartesia
+0000a240: 6e0a 2020 2020 2020 2020 2020 2020 636f  n.            co
+0000a250: 6f72 6469 6e61 7465 732e 0a20 2020 2020  ordinates..     
+0000a260: 2020 2020 2020 2073 6861 7065 3d28 7375         shape=(su
+0000a270: 7065 7263 656c 6c73 2c20 6e61 746f 6d2c  percells, natom,
+0000a280: 2033 290a 2020 2020 2020 2020 2020 2020   3).            
+0000a290: 6474 7970 653d 2764 6f75 626c 6527 0a0a  dtype='double'..
+0000a2a0: 0a20 2020 2020 2020 2046 6f72 2073 6574  .        For set
+0000a2b0: 7465 722c 206f 6e6c 7920 7479 7065 2d32  ter, only type-2
+0000a2c0: 2064 6174 6173 6574 2066 6f72 6d61 7420   dataset format 
+0000a2d0: 6973 2061 6c6c 6f77 6564 2e0a 0a20 2020  is allowed...   
+0000a2e0: 2020 2020 2064 6973 706c 6163 656d 656e       displacemen
+0000a2f0: 7473 203a 2061 7272 6179 5f6c 696b 650a  ts : array_like.
+0000a300: 2020 2020 2020 2020 2020 2020 4174 6f6d              Atom
+0000a310: 6963 2064 6973 706c 6163 656d 656e 7473  ic displacements
+0000a320: 206f 6620 616c 6c20 6174 6f6d 7320 6f66   of all atoms of
+0000a330: 2061 6c6c 2073 7570 6572 6365 6c6c 732e   all supercells.
+0000a340: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+0000a350: 7920 616c 6c20 6469 7370 6c61 6365 6d65  y all displaceme
+0000a360: 6e74 7320 696e 2065 6163 6820 7375 7065  nts in each supe
+0000a370: 7263 656c 6c20 6361 7365 2028 7479 7065  rcell case (type
+0000a380: 2d32 2920 6973 0a20 2020 2020 2020 2020  -2) is.         
+0000a390: 2020 2073 7570 706f 7274 6564 2e0a 2020     supported..  
+0000a3a0: 2020 2020 2020 2020 2020 7368 6170 653d            shape=
+0000a3b0: 2873 7570 6572 6365 6c6c 732c 206e 6174  (supercells, nat
+0000a3c0: 6f6d 2c20 3329 2c20 6474 7970 653d 2764  om, 3), dtype='d
+0000a3d0: 6f75 626c 6527 2c20 6f72 6465 723d 2743  ouble', order='C
+0000a3e0: 270a 0a20 2020 2020 2020 2022 2222 0a20  '..        """. 
+0000a3f0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0000a400: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
+0000a410: 5f6d 6174 7269 7820 6973 204e 6f6e 653a  _matrix is None:
+0000a420: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000a430: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
+0000a440: 2270 686f 6e6f 6e5f 7375 7065 7263 656c  "phonon_supercel
+0000a450: 6c5f 6d61 7472 6978 2069 7320 6e6f 7420  l_matrix is not 
+0000a460: 7365 742e 2229 0a0a 2020 2020 2020 2020  set.")..        
+0000a470: 6461 7461 7365 7420 3d20 7365 6c66 2e5f  dataset = self._
+0000a480: 7068 6f6e 6f6e 5f64 6174 6173 6574 0a20  phonon_dataset. 
+0000a490: 2020 2020 2020 2069 6620 2266 6972 7374         if "first
+0000a4a0: 5f61 746f 6d73 2220 696e 2064 6174 6173  _atoms" in datas
+0000a4b0: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
+0000a4c0: 6e75 6d5f 7363 656c 6c73 203d 206c 656e  num_scells = len
+0000a4d0: 2864 6174 6173 6574 5b22 6669 7273 745f  (dataset["first_
+0000a4e0: 6174 6f6d 7322 5d29 0a20 2020 2020 2020  atoms"]).       
+0000a4f0: 2020 2020 206e 6174 6f6d 203d 206c 656e       natom = len
+0000a500: 2873 656c 662e 5f70 686f 6e6f 6e5f 7375  (self._phonon_su
+0000a510: 7065 7263 656c 6c29 0a20 2020 2020 2020  percell).       
+0000a520: 2020 2020 2064 6973 706c 6163 656d 656e       displacemen
+0000a530: 7473 203d 206e 702e 7a65 726f 7328 286e  ts = np.zeros((n
+0000a540: 756d 5f73 6365 6c6c 732c 206e 6174 6f6d  um_scells, natom
+0000a550: 2c20 3329 2c20 6474 7970 653d 2264 6f75  , 3), dtype="dou
+0000a560: 626c 6522 2c20 6f72 6465 723d 2243 2229  ble", order="C")
+0000a570: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000a580: 2069 2c20 6469 7370 3120 696e 2065 6e75   i, disp1 in enu
+0000a590: 6d65 7261 7465 2864 6174 6173 6574 5b22  merate(dataset["
+0000a5a0: 6669 7273 745f 6174 6f6d 7322 5d29 3a0a  first_atoms"]):.
+0000a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a5c0: 6469 7370 6c61 6365 6d65 6e74 735b 692c  displacements[i,
+0000a5d0: 2064 6973 7031 5b22 6e75 6d62 6572 225d   disp1["number"]
+0000a5e0: 5d20 3d20 6469 7370 315b 2264 6973 706c  ] = disp1["displ
+0000a5f0: 6163 656d 656e 7422 5d0a 2020 2020 2020  acement"].      
+0000a600: 2020 656c 6966 2022 666f 7263 6573 2220    elif "forces" 
+0000a610: 696e 2064 6174 6173 6574 206f 7220 2264  in dataset or "d
+0000a620: 6973 706c 6163 656d 656e 7473 2220 696e  isplacements" in
+0000a630: 2064 6174 6173 6574 3a0a 2020 2020 2020   dataset:.      
+0000a640: 2020 2020 2020 6469 7370 6c61 6365 6d65        displaceme
+0000a650: 6e74 7320 3d20 6461 7461 7365 745b 2264  nts = dataset["d
+0000a660: 6973 706c 6163 656d 656e 7473 225d 0a20  isplacements"]. 
+0000a670: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000a680: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+0000a690: 756e 7469 6d65 4572 726f 7228 2264 6973  untimeError("dis
+0000a6a0: 706c 6163 656d 656e 7420 6461 7461 7365  placement datase
+0000a6b0: 7420 6861 7320 7772 6f6e 6720 666f 726d  t has wrong form
+0000a6c0: 6174 2e22 290a 0a20 2020 2020 2020 2072  at.")..        r
+0000a6d0: 6574 7572 6e20 6469 7370 6c61 6365 6d65  eturn displaceme
+0000a6e0: 6e74 730a 0a20 2020 2040 7068 6f6e 6f6e  nts..    @phonon
+0000a6f0: 5f64 6973 706c 6163 656d 656e 7473 2e73  _displacements.s
+0000a700: 6574 7465 720a 2020 2020 6465 6620 7068  etter.    def ph
+0000a710: 6f6e 6f6e 5f64 6973 706c 6163 656d 656e  onon_displacemen
+0000a720: 7473 2873 656c 662c 2064 6973 706c 6163  ts(self, displac
+0000a730: 656d 656e 7473 293a 0a20 2020 2020 2020  ements):.       
+0000a740: 2069 6620 7365 6c66 2e5f 7068 6f6e 6f6e   if self._phonon
+0000a750: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
+0000a760: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+0000a770: 2020 2020 2020 2072 6169 7365 2052 756e         raise Run
+0000a780: 7469 6d65 4572 726f 7228 2270 686f 6e6f  timeError("phono
+0000a790: 6e5f 7375 7065 7263 656c 6c5f 6d61 7472  n_supercell_matr
+0000a7a0: 6978 2069 7320 6e6f 7420 7365 742e 2229  ix is not set.")
+0000a7b0: 0a0a 2020 2020 2020 2020 6469 7370 7320  ..        disps 
+0000a7c0: 3d20 6e70 2e61 7272 6179 2864 6973 706c  = np.array(displ
+0000a7d0: 6163 656d 656e 7473 2c20 6474 7970 653d  acements, dtype=
+0000a7e0: 2264 6f75 626c 6522 2c20 6f72 6465 723d  "double", order=
+0000a7f0: 2243 2229 0a20 2020 2020 2020 206e 6174  "C").        nat
+0000a800: 6f6d 203d 206c 656e 2873 656c 662e 5f70  om = len(self._p
+0000a810: 686f 6e6f 6e5f 7375 7065 7263 656c 6c29  honon_supercell)
+0000a820: 0a20 2020 2020 2020 2069 6620 6469 7370  .        if disp
+0000a830: 732e 6e64 696d 2021 3d20 3320 6f72 2064  s.ndim != 3 or d
+0000a840: 6973 7073 2e73 6861 7065 5b31 3a5d 2021  isps.shape[1:] !
+0000a850: 3d20 286e 6174 6f6d 2c20 3329 3a0a 2020  = (natom, 3):.  
+0000a860: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000a870: 5275 6e74 696d 6545 7272 6f72 2822 4172  RuntimeError("Ar
+0000a880: 7261 7920 7368 6170 6520 6f66 2064 6973  ray shape of dis
+0000a890: 706c 6163 656d 656e 7473 2069 7320 696e  placements is in
+0000a8a0: 636f 7272 6563 742e 2229 0a20 2020 2020  correct.").     
+0000a8b0: 2020 2069 6620 7365 6c66 2e5f 7068 6f6e     if self._phon
+0000a8c0: 6f6e 5f64 6174 6173 6574 2069 7320 4e6f  on_dataset is No
+0000a8d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000a8e0: 7365 6c66 2e5f 7068 6f6e 6f6e 5f64 6174  self._phonon_dat
+0000a8f0: 6173 6574 203d 207b 7d0a 2020 2020 2020  aset = {}.      
+0000a900: 2020 656c 6966 2022 6669 7273 745f 6174    elif "first_at
+0000a910: 6f6d 7322 2069 6e20 7365 6c66 2e5f 7068  oms" in self._ph
+0000a920: 6f6e 6f6e 5f64 6174 6173 6574 3a0a 2020  onon_dataset:.  
+0000a930: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000a940: 5275 6e74 696d 6545 7272 6f72 2822 4469  RuntimeError("Di
+0000a950: 7370 6c61 6365 6d65 6e74 7320 6172 6520  splacements are 
+0000a960: 696e 636f 6d70 6174 6962 6c65 2077 6974  incompatible wit
+0000a970: 6820 6461 7461 7365 742e 2229 0a0a 2020  h dataset.")..  
+0000a980: 2020 2020 2020 7365 6c66 2e5f 7068 6f6e        self._phon
+0000a990: 6f6e 5f64 6174 6173 6574 5b22 6469 7370  on_dataset["disp
+0000a9a0: 6c61 6365 6d65 6e74 7322 5d20 3d20 6469  lacements"] = di
+0000a9b0: 7370 730a 2020 2020 2020 2020 7365 6c66  sps.        self
+0000a9c0: 2e5f 7068 6f6e 6f6e 5f73 7570 6572 6365  ._phonon_superce
+0000a9d0: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
+0000a9e0: 656d 656e 7473 203d 204e 6f6e 650a 0a20  ements = None.. 
+0000a9f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000aa00: 2064 6566 2070 686f 6e6f 6e5f 666f 7263   def phonon_forc
+0000aa10: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
+0000aa20: 2020 2222 2253 6574 7465 7220 616e 6420    """Setter and 
+0000aa30: 6765 7474 6572 206f 6620 666f 7263 6573  getter of forces
+0000aa40: 2069 6e20 6469 7370 6c61 6365 6d65 6e74   in displacement
+0000aa50: 2064 6174 6173 6574 2066 6f72 2066 6332   dataset for fc2
+0000aa60: 2e0a 0a20 2020 2020 2020 2041 2073 6574  ...        A set
+0000aa70: 206f 6620 6174 6f6d 6963 2066 6f72 6365   of atomic force
+0000aa80: 7320 696e 2064 6973 706c 6163 6564 2073  s in displaced s
+0000aa90: 7570 6572 6365 6c6c 732e 2054 6865 206f  upercells. The o
+0000aaa0: 7264 6572 206f 660a 2020 2020 2020 2020  rder of.        
+0000aab0: 6469 7370 6c61 6365 6420 7375 7065 7263  displaced superc
+0000aac0: 656c 6c73 2068 6173 2074 6f20 6d61 7463  ells has to matc
+0000aad0: 6820 7769 7468 2074 6861 7420 696e 2070  h with that in p
+0000aae0: 686f 6e6f 6e20 6469 7370 6c61 6365 6d65  honon displaceme
+0000aaf0: 6e74 0a20 2020 2020 2020 2064 6174 6173  nt.        datas
+0000ab00: 6574 2e0a 2020 2020 2020 2020 7368 6170  et..        shap
+0000ab10: 653d 2864 6973 706c 6163 6564 2073 7570  e=(displaced sup
+0000ab20: 6572 6365 6c6c 732c 2061 746f 6d73 2069  ercells, atoms i
+0000ab30: 6e20 7375 7065 7263 656c 6c2c 2033 290a  n supercell, 3).
+0000ab40: 0a20 2020 2020 2020 2067 6574 7465 7220  .        getter 
+0000ab50: 3a20 6e64 6172 7261 790a 0a20 2020 2020  : ndarray..     
+0000ab60: 2020 2073 6574 7465 7220 3a20 6172 7261     setter : arra
+0000ab70: 795f 6c69 6b65 0a20 2020 2020 2020 2020  y_like.         
+0000ab80: 2020 2054 6865 206f 7264 6572 206f 6620     The order of 
+0000ab90: 7375 7065 7263 656c 6c73 2075 7365 6420  supercells used 
+0000aba0: 666f 7220 6361 6c63 756c 6174 696e 6720  for calculating 
+0000abb0: 666f 7263 6573 2068 6173 2074 6f0a 2020  forces has to.  
+0000abc0: 2020 2020 2020 2020 2020 6265 2074 6865            be the
+0000abd0: 2073 616d 6520 6f72 6465 7220 6f66 2070   same order of p
+0000abe0: 686f 6e6f 6e5f 7375 7065 7263 656c 6c73  honon_supercells
+0000abf0: 5f77 6974 685f 6469 7370 6c61 6365 6d65  _with_displaceme
+0000ac00: 6e74 732e 0a0a 2020 2020 2020 2020 2222  nts...        ""
+0000ac10: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0000ac20: 662e 5f70 686f 6e6f 6e5f 6461 7461 7365  f._phonon_datase
+0000ac30: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
+0000ac40: 2020 2020 2020 2072 6169 7365 2052 756e         raise Run
+0000ac50: 7469 6d65 4572 726f 7228 2270 686f 6e6f  timeError("phono
+0000ac60: 6e5f 6469 7370 6c61 6365 6d65 6e74 5f64  n_displacement_d
+0000ac70: 6174 6173 6574 2064 6f65 7320 6e6f 7420  ataset does not 
+0000ac80: 6578 6973 742e 2229 0a0a 2020 2020 2020  exist.")..      
+0000ac90: 2020 6461 7461 7365 7420 3d20 7365 6c66    dataset = self
+0000aca0: 2e5f 7068 6f6e 6f6e 5f64 6174 6173 6574  ._phonon_dataset
+0000acb0: 0a20 2020 2020 2020 2069 6620 2266 6f72  .        if "for
+0000acc0: 6365 7322 2069 6e20 6461 7461 7365 743a  ces" in dataset:
+0000acd0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ace0: 7572 6e20 6461 7461 7365 745b 2266 6f72  urn dataset["for
+0000acf0: 6365 7322 5d0a 2020 2020 2020 2020 656c  ces"].        el
+0000ad00: 6966 2022 6669 7273 745f 6174 6f6d 7322  if "first_atoms"
+0000ad10: 2069 6e20 6461 7461 7365 743a 0a20 2020   in dataset:.   
+0000ad20: 2020 2020 2020 2020 206e 756d 5f73 6365           num_sce
+0000ad30: 6c6c 7320 3d20 6c65 6e28 6461 7461 7365  lls = len(datase
+0000ad40: 745b 2266 6972 7374 5f61 746f 6d73 225d  t["first_atoms"]
+0000ad50: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0000ad60: 7263 6573 203d 206e 702e 7a65 726f 7328  rces = np.zeros(
+0000ad70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ad80: 2028 6e75 6d5f 7363 656c 6c73 2c20 7365   (num_scells, se
+0000ad90: 6c66 2e5f 7068 6f6e 6f6e 5f73 7570 6572  lf._phonon_super
+0000ada0: 6365 6c6c 2e67 6574 5f6e 756d 6265 725f  cell.get_number_
+0000adb0: 6f66 5f61 746f 6d73 2829 2c20 3329 2c0a  of_atoms(), 3),.
+0000adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000add0: 6474 7970 653d 2264 6f75 626c 6522 2c0a  dtype="double",.
+0000ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000adf0: 6f72 6465 723d 2243 222c 0a20 2020 2020  order="C",.     
+0000ae00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000ae10: 2020 2020 2066 6f72 2069 2c20 6469 7370       for i, disp
+0000ae20: 3120 696e 2065 6e75 6d65 7261 7465 2864  1 in enumerate(d
+0000ae30: 6174 6173 6574 5b22 6669 7273 745f 6174  ataset["first_at
+0000ae40: 6f6d 7322 5d29 3a0a 2020 2020 2020 2020  oms"]):.        
+0000ae50: 2020 2020 2020 2020 666f 7263 6573 5b69          forces[i
+0000ae60: 5d20 3d20 6469 7370 315b 2266 6f72 6365  ] = disp1["force
+0000ae70: 7322 5d0a 2020 2020 2020 2020 2020 2020  s"].            
+0000ae80: 7265 7475 726e 2066 6f72 6365 730a 2020  return forces.  
+0000ae90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000aea0: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
+0000aeb0: 6e74 696d 6545 7272 6f72 2822 6469 7370  ntimeError("disp
+0000aec0: 6c61 6365 6d65 6e74 2064 6174 6173 6574  lacement dataset
+0000aed0: 2068 6173 2077 726f 6e67 2066 6f72 6d61   has wrong forma
+0000aee0: 742e 2229 0a0a 2020 2020 4070 686f 6e6f  t.")..    @phono
+0000aef0: 6e5f 666f 7263 6573 2e73 6574 7465 720a  n_forces.setter.
+0000af00: 2020 2020 6465 6620 7068 6f6e 6f6e 5f66      def phonon_f
+0000af10: 6f72 6365 7328 7365 6c66 2c20 666f 7263  orces(self, forc
+0000af20: 6573 5f66 6332 293a 0a20 2020 2020 2020  es_fc2):.       
+0000af30: 2069 6620 7365 6c66 2e5f 7068 6f6e 6f6e   if self._phonon
+0000af40: 5f64 6174 6173 6574 2069 7320 4e6f 6e65  _dataset is None
+0000af50: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000af60: 6973 6520 5275 6e74 696d 6545 7272 6f72  ise RuntimeError
+0000af70: 2822 7068 6f6e 6f6e 5f64 6973 706c 6163  ("phonon_displac
+0000af80: 656d 656e 745f 6461 7461 7365 7420 646f  ement_dataset do
+0000af90: 6573 206e 6f74 2065 7869 7374 2e22 290a  es not exist.").
+0000afa0: 0a20 2020 2020 2020 2066 6f72 6365 7320  .        forces 
+0000afb0: 3d20 6e70 2e61 7272 6179 2866 6f72 6365  = np.array(force
+0000afc0: 735f 6663 322c 2064 7479 7065 3d22 646f  s_fc2, dtype="do
+0000afd0: 7562 6c65 222c 206f 7264 6572 3d22 4322  uble", order="C"
+0000afe0: 290a 2020 2020 2020 2020 6461 7461 7365  ).        datase
+0000aff0: 7420 3d20 7365 6c66 2e5f 7068 6f6e 6f6e  t = self._phonon
+0000b000: 5f64 6174 6173 6574 0a20 2020 2020 2020  _dataset.       
+0000b010: 2069 6620 2266 6972 7374 5f61 746f 6d73   if "first_atoms
+0000b020: 2220 696e 2064 6174 6173 6574 3a0a 2020  " in dataset:.  
+0000b030: 2020 2020 2020 2020 2020 6920 3d20 300a            i = 0.
+0000b040: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000b050: 692c 2064 6973 7031 2069 6e20 656e 756d  i, disp1 in enum
+0000b060: 6572 6174 6528 6461 7461 7365 745b 2266  erate(dataset["f
+0000b070: 6972 7374 5f61 746f 6d73 225d 293a 0a20  irst_atoms"]):. 
+0000b080: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000b090: 6973 7031 5b22 666f 7263 6573 225d 203d  isp1["forces"] =
+0000b0a0: 2066 6f72 6365 735b 695d 0a20 2020 2020   forces[i].     
+0000b0b0: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
+0000b0c0: 310a 2020 2020 2020 2020 656c 6966 2022  1.        elif "
+0000b0d0: 6469 7370 6c61 6365 6d65 6e74 7322 2069  displacements" i
+0000b0e0: 6e20 6461 7461 7365 7420 6f72 2022 666f  n dataset or "fo
+0000b0f0: 7263 6573 2220 696e 2064 6174 6173 6574  rces" in dataset
+0000b100: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+0000b110: 7461 7365 745b 2266 6f72 6365 7322 5d20  taset["forces"] 
+0000b120: 3d20 666f 7263 6573 0a0a 2020 2020 4070  = forces..    @p
+0000b130: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000b140: 7068 7068 5f69 6e74 6572 6163 7469 6f6e  phph_interaction
+0000b150: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000b160: 2222 2252 6574 7572 6e20 496e 7465 7261  """Return Intera
+0000b170: 6374 696f 6e20 696e 7374 616e 6365 2e22  ction instance."
+0000b180: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0000b190: 6e20 7365 6c66 2e5f 696e 7465 7261 6374  n self._interact
+0000b1a0: 696f 6e0a 0a20 2020 2064 6566 2067 6574  ion..    def get
+0000b1b0: 5f70 6870 685f 696e 7465 7261 6374 696f  _phph_interactio
+0000b1c0: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
+0000b1d0: 2022 2222 5265 7475 726e 2049 6e74 6572   """Return Inter
+0000b1e0: 6163 7469 6f6e 2069 6e73 7461 6e63 652e  action instance.
+0000b1f0: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
+0000b200: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+0000b210: 2020 2020 2020 2022 5068 6f6e 6f33 7079         "Phono3py
+0000b220: 2e67 6574 5f70 6870 685f 696e 7465 7261  .get_phph_intera
+0000b230: 6374 696f 6e28 2920 6973 2064 6570 7265  ction() is depre
+0000b240: 6361 7465 642e 220a 2020 2020 2020 2020  cated.".        
+0000b250: 2020 2020 2255 7365 2050 686f 6e6f 3370      "Use Phono3p
+0000b260: 792e 7068 7068 5f69 6e74 6572 6163 7469  y.phph_interacti
+0000b270: 6f6e 2061 7474 7269 6275 7465 2069 6e73  on attribute ins
+0000b280: 7465 6164 2e22 2c0a 2020 2020 2020 2020  tead.",.        
+0000b290: 2020 2020 4465 7072 6563 6174 696f 6e57      DeprecationW
+0000b2a0: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+0000b2b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000b2c0: 2073 656c 662e 7068 7068 5f69 6e74 6572   self.phph_inter
+0000b2d0: 6163 7469 6f6e 0a0a 2020 2020 4070 726f  action..    @pro
+0000b2e0: 7065 7274 790a 2020 2020 6465 6620 6465  perty.    def de
+0000b2f0: 7461 696c 6564 5f67 616d 6d61 7328 7365  tailed_gammas(se
+0000b300: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000b310: 5265 7475 726e 2064 6574 6169 6c65 6420  Return detailed 
+0000b320: 6761 6d6d 612e 2222 220a 2020 2020 2020  gamma.""".      
+0000b330: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0000b340: 6574 6169 6c65 645f 6761 6d6d 6173 0a0a  etailed_gammas..
+0000b350: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000b360: 2020 6465 6620 6772 6964 2873 656c 6629    def grid(self)
+0000b370: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000b380: 7572 6e20 4272 696c 6c6f 7569 6e20 7a6f  urn Brillouin zo
+0000b390: 6e65 2067 7269 6420 696e 666f 726d 6174  ne grid informat
+0000b3a0: 696f 6e2e 0a0a 2020 2020 2020 2020 425a  ion...        BZ
+0000b3b0: 4772 6964 0a20 2020 2020 2020 2020 2020  Grid.           
+0000b3c0: 2041 6e20 696e 7374 616e 6365 206f 6620   An instance of 
+0000b3d0: 425a 4772 6964 2075 7365 6420 666f 7220  BZGrid used for 
+0000b3e0: 656e 7469 7265 2070 686f 6e6f 3370 7920  entire phono3py 
+0000b3f0: 6361 6c63 756c 6174 696f 6e2e 0a0a 2020  calculation...  
+0000b400: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000b410: 2020 7265 7475 726e 2073 656c 662e 5f62    return self._b
+0000b420: 7a5f 6772 6964 0a0a 2020 2020 6465 6620  z_grid..    def 
+0000b430: 696e 6974 5f70 6870 685f 696e 7465 7261  init_phph_intera
+0000b440: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
+0000b450: 656c 662c 0a20 2020 2020 2020 206e 6163  elf,.        nac
+0000b460: 5f71 5f64 6972 6563 7469 6f6e 3d4e 6f6e  _q_direction=Non
+0000b470: 652c 0a20 2020 2020 2020 2063 6f6e 7374  e,.        const
+0000b480: 616e 745f 6176 6572 6167 6564 5f69 6e74  ant_averaged_int
+0000b490: 6572 6163 7469 6f6e 3d4e 6f6e 652c 0a20  eraction=None,. 
+0000b4a0: 2020 2020 2020 2066 7265 7175 656e 6379         frequency
+0000b4b0: 5f73 6361 6c65 5f66 6163 746f 723d 4e6f  _scale_factor=No
+0000b4c0: 6e65 2c0a 2020 2020 2020 2020 7379 6d6d  ne,.        symm
+0000b4d0: 6574 7269 7a65 5f66 6333 713d 4661 6c73  etrize_fc3q=Fals
+0000b4e0: 652c 0a20 2020 2020 2020 206d 616b 655f  e,.        make_
+0000b4f0: 7230 5f61 7665 7261 6765 3d46 616c 7365  r0_average=False
+0000b500: 2c0a 2020 2020 2020 2020 6c61 7061 636b  ,.        lapack
+0000b510: 5f7a 6865 6576 5f75 706c 6f3d 224c 222c  _zheev_uplo="L",
+0000b520: 0a20 2020 2020 2020 206f 7065 6e6d 705f  .        openmp_
+0000b530: 7065 725f 7472 6970 6c65 7473 3d4e 6f6e  per_triplets=Non
+0000b540: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+0000b550: 2020 2222 2249 6e69 7469 616c 697a 6520    """Initialize 
+0000b560: 7068 2d70 6820 696e 7465 7261 6374 696f  ph-ph interactio
+0000b570: 6e20 6361 6c63 756c 6174 696f 6e2e 0a0a  n calculation...
+0000b580: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+0000b590: 686f 6420 6372 6561 7465 7320 616e 2069  hod creates an i
+0000b5a0: 6e73 7461 6e63 6520 6f66 2049 6e74 6572  nstance of Inter
+0000b5b0: 6163 7469 6f6e 2063 6c61 7373 2c20 7768  action class, wh
+0000b5c0: 6963 680a 2020 2020 2020 2020 6973 206e  ich.        is n
+0000b5d0: 6563 6573 7361 7279 2074 6f20 7275 6e20  ecessary to run 
+0000b5e0: 7068 2d70 6820 696e 7465 7261 6374 696f  ph-ph interactio
+0000b5f0: 6e20 6361 6c63 756c 6174 696f 6e2e 0a20  n calculation.. 
+0000b600: 2020 2020 2020 2054 6865 2069 6e70 7574         The input
+0000b610: 2064 6174 6120 7375 6368 2061 7320 6772   data such as gr
+0000b620: 6964 732c 2066 6f72 6365 2063 6f6e 7374  ids, force const
+0000b630: 616e 7473 2c20 6574 632c 2061 7265 0a20  ants, etc, are. 
+0000b640: 2020 2020 2020 2073 746f 7265 6420 746f         stored to
+0000b650: 2062 6520 7265 6164 7920 666f 7220 7468   be ready for th
+0000b660: 6520 6361 6c63 756c 6174 696f 6e2e 0a0a  e calculation...
+0000b670: 2020 2020 2020 2020 4e6f 7465 0a20 2020          Note.   
+0000b680: 2020 2020 202d 2d2d 2d0a 2020 2020 2020       ----.      
+0000b690: 2020 6663 3320 616e 6420 6663 322c 2061    fc3 and fc2, a
+0000b6a0: 6e64 206f 7074 696f 6e61 6c6c 7920 6e61  nd optionally na
+0000b6b0: 635f 7061 7261 6d73 2068 6176 6520 746f  c_params have to
+0000b6c0: 2062 6520 7365 7420 6265 666f 7265 2063   be set before c
+0000b6d0: 616c 6c69 6e67 0a20 2020 2020 2020 2074  alling.        t
+0000b6e0: 6869 7320 6d65 7468 6f64 2e20 6663 3320  his method. fc3 
+0000b6f0: 616e 6420 6663 3220 6361 6e20 6265 206d  and fc2 can be m
+0000b700: 6164 6520 6569 7468 6572 2066 726f 6d20  ade either from 
+0000b710: 7365 7473 206f 6620 666f 7263 6573 0a20  sets of forces. 
+0000b720: 2020 2020 2020 2061 6e64 2064 6973 706c         and displ
+0000b730: 6163 656d 656e 7473 206f 6620 7375 7065  acements of supe
+0000b740: 7263 656c 6c73 206f 7220 6265 2073 6574  rcells or be set
+0000b750: 2073 696d 706c 7920 7669 6120 6174 7472   simply via attr
+0000b760: 6962 7574 6573 2e0a 0a20 2020 2020 2020  ibutes...       
+0000b770: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0000b780: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0000b790: 2020 2020 2020 206e 6163 5f71 5f64 6972         nac_q_dir
+0000b7a0: 6563 7469 6f6e 203a 2061 7272 6179 5f6c  ection : array_l
+0000b7b0: 696b 652c 206f 7074 696f 6e61 6c0a 2020  ike, optional.  
+0000b7c0: 2020 2020 2020 2020 2020 4469 7265 6374            Direct
+0000b7d0: 696f 6e20 6f66 2071 2d76 6563 746f 7220  ion of q-vector 
+0000b7e0: 7761 7463 6869 6e67 2066 726f 6d20 4761  watching from Ga
+0000b7f0: 6d6d 6120 706f 696e 7420 7573 6564 2066  mma point used f
+0000b800: 6f72 0a20 2020 2020 2020 2020 2020 206e  or.            n
+0000b810: 6f6e 2d61 6e61 6c79 7469 6361 6c20 7465  on-analytical te
+0000b820: 726d 2063 6f72 7265 6374 696f 6e2e 2054  rm correction. T
+0000b830: 6869 7320 6973 2065 6666 6563 7469 7665  his is effective
+0000b840: 206f 6e6c 7920 6174 2071 3d30 0a20 2020   only at q=0.   
+0000b850: 2020 2020 2020 2020 2028 7068 7973 6963           (physic
+0000b860: 616c 6c79 2071 2d3e 3029 2e20 5468 6520  ally q->0). The 
+0000b870: 6469 7265 6374 696f 6e20 6973 2067 6976  direction is giv
+0000b880: 656e 2069 6e20 6372 7973 7461 6c6c 6f67  en in crystallog
+0000b890: 7261 7068 6963 0a20 2020 2020 2020 2020  raphic.         
+0000b8a0: 2020 2028 6672 6163 7469 6f6e 616c 2920     (fractional) 
+0000b8b0: 636f 6f72 6469 6e61 7465 732e 0a20 2020  coordinates..   
+0000b8c0: 2020 2020 2020 2020 2073 6861 7065 3d28           shape=(
+0000b8d0: 332c 292c 2064 7479 7065 3d27 646f 7562  3,), dtype='doub
+0000b8e0: 6c65 272e 0a20 2020 2020 2020 2020 2020  le'..           
+0000b8f0: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
+0000b900: 7320 4e6f 6e65 2c20 7768 6963 6820 6d65  s None, which me
+0000b910: 616e 7320 7468 6973 2066 6561 7475 7265  ans this feature
+0000b920: 2069 7320 6e6f 7420 7573 6564 2e0a 2020   is not used..  
+0000b930: 2020 2020 2020 636f 6e73 7461 6e74 5f61        constant_a
+0000b940: 7665 7261 6765 645f 696e 7465 7261 6374  veraged_interact
+0000b950: 696f 6e20 3a20 666c 6f61 742c 206f 7074  ion : float, opt
+0000b960: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000b970: 2020 5068 2d70 6820 696e 7465 7261 6374    Ph-ph interact
+0000b980: 696f 6e20 7374 7265 6e67 7468 2061 7272  ion strength arr
+0000b990: 6179 2069 7320 7265 706c 6163 6564 2062  ay is replaced b
+0000b9a0: 7920 6120 7363 616c 6172 2076 616c 7565  y a scalar value
+0000b9b0: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+0000b9c0: 6661 756c 7420 6973 204e 6f6e 652c 2077  fault is None, w
+0000b9d0: 6869 6368 206d 6561 6e73 2074 6869 7320  hich means this 
+0000b9e0: 6665 6174 7572 6520 6973 206e 6f74 2075  feature is not u
+0000b9f0: 7365 642e 0a20 2020 2020 2020 2066 7265  sed..        fre
+0000ba00: 7175 656e 6379 5f73 6361 6c65 5f66 6163  quency_scale_fac
+0000ba10: 746f 7220 3a20 666c 6f61 742c 206f 7074  tor : float, opt
+0000ba20: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000ba30: 2020 416c 6c20 7068 6f6e 6f6e 2066 7265    All phonon fre
+0000ba40: 7175 656e 6365 7320 6172 6520 7363 616c  quences are scal
+0000ba50: 6564 2062 7920 7468 6973 2076 616c 7565  ed by this value
+0000ba60: 2e20 4465 6661 756c 7420 6973 204e 6f6e  . Default is Non
+0000ba70: 652c 0a20 2020 2020 2020 2020 2020 2077  e,.            w
+0000ba80: 6869 6368 206d 6561 6e73 2070 686f 6e6f  hich means phono
+0000ba90: 6e20 6672 6571 7565 6e63 6965 7320 6172  n frequencies ar
+0000baa0: 6520 6e6f 7420 7363 616c 6564 2e0a 2020  e not scaled..  
+0000bab0: 2020 2020 2020 7379 6d6d 6574 7269 7a65        symmetrize
+0000bac0: 5f66 6333 7120 3a20 626f 6f6c 2c20 6f70  _fc3q : bool, op
+0000bad0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0000bae0: 2020 2066 6333 2069 6e20 7068 6f6e 6f6e     fc3 in phonon
+0000baf0: 2073 7061 6365 2069 7320 7379 6d6d 6574   space is symmet
+0000bb00: 7269 7a65 6420 6279 2070 6572 6d75 7461  rized by permuta
+0000bb10: 7469 6f6e 2073 796d 6d65 7472 792e 0a20  tion symmetry.. 
+0000bb20: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+0000bb30: 6c74 2069 7320 4661 6c73 652e 0a20 2020  lt is False..   
+0000bb40: 2020 2020 206d 616b 655f 7230 5f61 7665       make_r0_ave
+0000bb50: 7261 6765 203a 2062 6f6f 6c2c 206f 7074  rage : bool, opt
+0000bb60: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000bb70: 2020 6663 3320 7472 616e 7366 6f72 6d61    fc3 transforma
+0000bb80: 7469 6f6e 2066 726f 6d20 7265 616c 2074  tion from real t
+0000bb90: 6f20 7265 6369 7072 6f63 616c 2073 7061  o reciprocal spa
+0000bba0: 6365 2069 7320 646f 6e65 0a20 2020 2020  ce is done.     
+0000bbb0: 2020 2020 2020 2061 726f 756e 6420 7468         around th
+0000bbc0: 7265 6520 6174 6f6d 7320 616e 6420 6176  ree atoms and av
+0000bbd0: 6572 6167 6564 2077 6865 6e20 5472 7565  eraged when True
+0000bbe0: 2e20 4465 6661 756c 7420 6973 2046 616c  . Default is Fal
+0000bbf0: 7365 2c20 692e 652e 2c0a 2020 2020 2020  se, i.e.,.      
+0000bc00: 2020 2020 2020 6f6e 6c79 2061 726f 756e        only aroun
+0000bc10: 6420 7468 6520 6669 7273 7420 6174 6f6d  d the first atom
+0000bc20: 2e0a 2020 2020 2020 2020 6c61 7061 636b  ..        lapack
+0000bc30: 5f7a 6865 6576 5f75 706c 6f20 3a20 7374  _zheev_uplo : st
+0000bc40: 722c 206f 7074 696f 6e61 6c0a 2020 2020  r, optional.    
+0000bc50: 2020 2020 2020 2020 274c 2720 6f72 2027          'L' or '
+0000bc60: 5527 2e20 4465 6661 756c 7420 6973 2027  U'. Default is '
+0000bc70: 4c27 2e20 5468 6973 2069 7320 7061 7373  L'. This is pass
+0000bc80: 6564 2074 6f20 4c41 5041 434b 207a 6865  ed to LAPACK zhe
+0000bc90: 6576 0a20 2020 2020 2020 2020 2020 2075  ev.            u
+0000bca0: 7365 6420 666f 7220 7068 6f6e 6f6e 2073  sed for phonon s
+0000bcb0: 6f6c 7665 722e 0a20 2020 2020 2020 206f  olver..        o
+0000bcc0: 7065 6e6d 705f 7065 725f 7472 6970 6c65  penmp_per_triple
+0000bcd0: 7473 203a 2062 6f6f 6c20 6f72 204e 6f6e  ts : bool or Non
+0000bce0: 652c 206f 7074 696f 6e61 6c2c 2064 6566  e, optional, def
+0000bcf0: 6175 6c74 2069 7320 4e6f 6e65 0a20 2020  ault is None.   
+0000bd00: 2020 2020 2020 2020 204e 6f72 6d61 6c6c           Normall
+0000bd10: 7920 7468 6973 2070 6172 616d 6574 6572  y this parameter
+0000bd20: 2073 686f 756c 6420 6e6f 7420 6265 2074   should not be t
+0000bd30: 6f75 6368 6564 2e0a 2020 2020 2020 2020  ouched..        
+0000bd40: 2020 2020 5768 656e 2060 5472 7565 602c      When `True`,
+0000bd50: 2070 682d 7068 2069 6e74 6572 6163 7469   ph-ph interacti
+0000bd60: 6f6e 2073 7472 656e 6774 6820 6361 6c63  on strength calc
+0000bd70: 756c 6174 696f 6e20 7275 6e73 2077 6974  ulation runs wit
+0000bd80: 680a 2020 2020 2020 2020 2020 2020 4f70  h.            Op
+0000bd90: 656e 4d50 2064 6973 7472 6962 7574 696f  enMP distributio
+0000bda0: 6e20 6f76 6572 2074 7269 706c 6574 732c  n over triplets,
+0000bdb0: 2061 6e64 206f 7665 7220 6261 6e64 7320   and over bands 
+0000bdc0: 7768 656e 2060 4661 6c73 6560 2e0a 2020  when `False`..  
+0000bdd0: 2020 2020 2020 2020 2020 604e 6f6e 6560            `None`
+0000bde0: 2077 696c 6c20 6368 6f6f 7365 206f 6e65   will choose one
+0000bdf0: 206f 6620 7468 656d 2061 7574 6f6d 6174   of them automat
+0000be00: 6963 616c 6c79 2e0a 0a20 2020 2020 2020  ically...       
+0000be10: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+0000be20: 7365 6c66 2e6d 6573 685f 6e75 6d62 6572  self.mesh_number
+0000be30: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+0000be40: 2020 2020 2020 206d 7367 203d 2022 5068         msg = "Ph
+0000be50: 6f6e 6f33 7079 2e6d 6573 685f 6e75 6d62  ono3py.mesh_numb
+0000be60: 6572 7320 6f66 2069 6e73 7461 6e63 6520  ers of instance 
+0000be70: 6861 7320 746f 2062 6520 7365 742e 220a  has to be set.".
+0000be80: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000be90: 6520 5275 6e74 696d 6545 7272 6f72 286d  e RuntimeError(m
+0000bea0: 7367 290a 0a20 2020 2020 2020 2069 6620  sg)..        if 
+0000beb0: 7365 6c66 2e5f 6663 3220 6973 204e 6f6e  self._fc2 is Non
+0000bec0: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+0000bed0: 7367 203d 2022 5068 6f6e 6f33 7079 2e66  sg = "Phono3py.f
+0000bee0: 6332 206f 6620 696e 7374 616e 6365 2069  c2 of instance i
+0000bef0: 7320 6e6f 7420 666f 756e 642e 220a 2020  s not found.".  
+0000bf00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000bf10: 5275 6e74 696d 6545 7272 6f72 286d 7367  RuntimeError(msg
+0000bf20: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
+0000bf30: 6c66 2e5f 7379 6d6d 6574 7269 7a65 5f66  lf._symmetrize_f
+0000bf40: 6333 7120 6973 204e 6f6e 653a 0a20 2020  c3q is None:.   
+0000bf50: 2020 2020 2020 2020 205f 7379 6d6d 6574           _symmet
+0000bf60: 7269 7a65 5f66 6333 7120 3d20 7379 6d6d  rize_fc3q = symm
+0000bf70: 6574 7269 7a65 5f66 6333 710a 2020 2020  etrize_fc3q.    
+0000bf80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000bf90: 2020 2020 2020 5f73 796d 6d65 7472 697a        _symmetriz
+0000bfa0: 655f 6663 3371 203d 2073 656c 662e 5f73  e_fc3q = self._s
+0000bfb0: 796d 6d65 7472 697a 655f 6663 3371 0a0a  ymmetrize_fc3q..
+0000bfc0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000bfd0: 5f6c 6170 6163 6b5f 7a68 6565 765f 7570  _lapack_zheev_up
+0000bfe0: 6c6f 2069 7320 4e6f 6e65 3a0a 2020 2020  lo is None:.    
+0000bff0: 2020 2020 2020 2020 5f6c 6170 6163 6b5f          _lapack_
+0000c000: 7a68 6565 765f 7570 6c6f 203d 206c 6170  zheev_uplo = lap
+0000c010: 6163 6b5f 7a68 6565 765f 7570 6c6f 0a20  ack_zheev_uplo. 
+0000c020: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000c030: 2020 2020 2020 2020 205f 6c61 7061 636b           _lapack
+0000c040: 5f7a 6865 6576 5f75 706c 6f20 3d20 7365  _zheev_uplo = se
+0000c050: 6c66 2e5f 6c61 7061 636b 5f7a 6865 6576  lf._lapack_zheev
+0000c060: 5f75 706c 6f0a 0a20 2020 2020 2020 2073  _uplo..        s
+0000c070: 656c 662e 5f69 6e74 6572 6163 7469 6f6e  elf._interaction
+0000c080: 203d 2049 6e74 6572 6163 7469 6f6e 280a   = Interaction(.
+0000c090: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000c0a0: 2e5f 7072 696d 6974 6976 652c 0a20 2020  ._primitive,.   
+0000c0b0: 2020 2020 2020 2020 2073 656c 662e 5f62           self._b
+0000c0c0: 7a5f 6772 6964 2c0a 2020 2020 2020 2020  z_grid,.        
+0000c0d0: 2020 2020 7365 6c66 2e5f 7072 696d 6974      self._primit
+0000c0e0: 6976 655f 7379 6d6d 6574 7279 2c0a 2020  ive_symmetry,.  
+0000c0f0: 2020 2020 2020 2020 2020 6663 333d 7365            fc3=se
+0000c100: 6c66 2e5f 6663 332c 0a20 2020 2020 2020  lf._fc3,.       
+0000c110: 2020 2020 2062 616e 645f 696e 6469 6365       band_indice
+0000c120: 733d 7365 6c66 2e5f 6261 6e64 5f69 6e64  s=self._band_ind
+0000c130: 6963 6573 5f66 6c61 7474 656e 2c0a 2020  ices_flatten,.  
+0000c140: 2020 2020 2020 2020 2020 636f 6e73 7461            consta
+0000c150: 6e74 5f61 7665 7261 6765 645f 696e 7465  nt_averaged_inte
+0000c160: 7261 6374 696f 6e3d 636f 6e73 7461 6e74  raction=constant
+0000c170: 5f61 7665 7261 6765 645f 696e 7465 7261  _averaged_intera
+0000c180: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+0000c190: 2020 2066 7265 7175 656e 6379 5f66 6163     frequency_fac
+0000c1a0: 746f 725f 746f 5f54 487a 3d73 656c 662e  tor_to_THz=self.
+0000c1b0: 5f66 7265 7175 656e 6379 5f66 6163 746f  _frequency_facto
+0000c1c0: 725f 746f 5f54 487a 2c0a 2020 2020 2020  r_to_THz,.      
+0000c1d0: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
+0000c1e0: 7363 616c 655f 6661 6374 6f72 3d66 7265  scale_factor=fre
+0000c1f0: 7175 656e 6379 5f73 6361 6c65 5f66 6163  quency_scale_fac
+0000c200: 746f 722c 0a20 2020 2020 2020 2020 2020  tor,.           
+0000c210: 2063 7574 6f66 665f 6672 6571 7565 6e63   cutoff_frequenc
+0000c220: 793d 7365 6c66 2e5f 6375 746f 6666 5f66  y=self._cutoff_f
+0000c230: 7265 7175 656e 6379 2c0a 2020 2020 2020  requency,.      
+0000c240: 2020 2020 2020 6973 5f6d 6573 685f 7379        is_mesh_sy
+0000c250: 6d6d 6574 7279 3d73 656c 662e 5f69 735f  mmetry=self._is_
+0000c260: 6d65 7368 5f73 796d 6d65 7472 792c 0a20  mesh_symmetry,. 
+0000c270: 2020 2020 2020 2020 2020 2073 796d 6d65             symme
+0000c280: 7472 697a 655f 6663 3371 3d5f 7379 6d6d  trize_fc3q=_symm
+0000c290: 6574 7269 7a65 5f66 6333 712c 0a20 2020  etrize_fc3q,.   
+0000c2a0: 2020 2020 2020 2020 206d 616b 655f 7230           make_r0
+0000c2b0: 5f61 7665 7261 6765 3d6d 616b 655f 7230  _average=make_r0
+0000c2c0: 5f61 7665 7261 6765 2c0a 2020 2020 2020  _average,.      
+0000c2d0: 2020 2020 2020 6c61 7061 636b 5f7a 6865        lapack_zhe
+0000c2e0: 6576 5f75 706c 6f3d 5f6c 6170 6163 6b5f  ev_uplo=_lapack_
+0000c2f0: 7a68 6565 765f 7570 6c6f 2c0a 2020 2020  zheev_uplo,.    
+0000c300: 2020 2020 2020 2020 6f70 656e 6d70 5f70          openmp_p
+0000c310: 6572 5f74 7269 706c 6574 733d 6f70 656e  er_triplets=open
+0000c320: 6d70 5f70 6572 5f74 7269 706c 6574 732c  mp_per_triplets,
+0000c330: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0000c340: 2020 2073 656c 662e 5f69 6e74 6572 6163     self._interac
+0000c350: 7469 6f6e 2e6e 6163 5f71 5f64 6972 6563  tion.nac_q_direc
+0000c360: 7469 6f6e 203d 206e 6163 5f71 5f64 6972  tion = nac_q_dir
+0000c370: 6563 7469 6f6e 0a20 2020 2020 2020 2073  ection.        s
+0000c380: 656c 662e 5f69 6e69 745f 6479 6e61 6d69  elf._init_dynami
+0000c390: 6361 6c5f 6d61 7472 6978 2829 0a0a 2020  cal_matrix()..  
+0000c3a0: 2020 6465 6620 7365 745f 7068 6f6e 6f6e    def set_phonon
+0000c3b0: 5f64 6174 6128 7365 6c66 2c20 6672 6571  _data(self, freq
+0000c3c0: 7565 6e63 6965 732c 2065 6967 656e 7665  uencies, eigenve
+0000c3d0: 6374 6f72 732c 2067 7269 645f 6164 6472  ctors, grid_addr
+0000c3e0: 6573 7329 3a0a 2020 2020 2020 2020 2222  ess):.        ""
+0000c3f0: 2253 6574 2070 686f 6e6f 6e20 6672 6571  "Set phonon freq
+0000c400: 7565 6e63 6965 7320 616e 6420 6569 6765  uencies and eige
+0000c410: 6e76 6563 746f 7273 2069 6e20 496e 7465  nvectors in Inte
+0000c420: 7261 6374 696f 6e20 696e 7374 616e 6365  raction instance
+0000c430: 2e0a 0a20 2020 2020 2020 2048 6172 6d6f  ...        Harmo
+0000c440: 6e69 6320 7068 6f6e 6f6e 2069 6e66 6f72  nic phonon infor
+0000c450: 6d61 7469 6f6e 2069 7320 7374 6f72 6564  mation is stored
+0000c460: 2069 6e20 496e 7465 7261 6374 696f 6e20   in Interaction 
+0000c470: 696e 7374 616e 6365 2e20 466f 720a 2020  instance. For.  
+0000c480: 2020 2020 2020 6578 616d 706c 652c 2074        example, t
+0000c490: 6869 7320 696e 666f 726d 6174 696f 6e20  his information 
+0000c4a0: 7374 6f72 6520 696e 2061 2066 696c 6520  store in a file 
+0000c4b0: 6973 2072 6561 6420 616e 6420 7061 7373  is read and pass
+0000c4c0: 6564 2074 6f0a 2020 2020 2020 2020 5068  ed to.        Ph
+0000c4d0: 6f6e 6f33 7079 2069 6e73 7461 6e63 6520  ono3py instance 
+0000c4e0: 6279 2075 7369 6e67 2074 6869 7320 6d65  by using this me
+0000c4f0: 7468 6f64 2e20 5468 6520 6772 6964 5f61  thod. The grid_a
+0000c500: 6464 7265 7373 2069 7320 7573 6564 0a20  ddress is used. 
+0000c510: 2020 2020 2020 2066 6f72 2074 6865 2063         for the c
+0000c520: 6f6e 7369 7374 656e 6379 2063 6865 636b  onsistency check
+0000c530: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+0000c540: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+0000c550: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000c560: 2066 7265 7175 656e 6369 6573 203a 2061   frequencies : a
+0000c570: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
+0000c580: 2020 2020 2020 5068 6f6e 6f6e 2066 7265        Phonon fre
+0000c590: 7175 656e 6369 6573 2e0a 2020 2020 2020  quencies..      
+0000c5a0: 2020 2020 2020 7368 6170 653d 286e 756d        shape=(num
+0000c5b0: 5f67 7269 645f 706f 696e 7473 2c20 6e75  _grid_points, nu
+0000c5c0: 6d5f 6261 6e64 292c 2064 7479 7065 3d27  m_band), dtype='
+0000c5d0: 646f 7562 6c65 272c 206f 7264 6572 3d27  double', order='
+0000c5e0: 4327 0a20 2020 2020 2020 2065 6967 656e  C'.        eigen
+0000c5f0: 7665 6374 6f72 7320 3a20 6172 7261 795f  vectors : array_
+0000c600: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
+0000c610: 2050 686f 6e6f 6e20 6569 6765 6e76 6563   Phonon eigenvec
+0000c620: 746f 7273 0a20 2020 2020 2020 2020 2020  tors.           
+0000c630: 2073 6861 7065 3d28 6e75 6d5f 6772 6964   shape=(num_grid
+0000c640: 5f70 6f69 6e74 732c 206e 756d 5f62 616e  _points, num_ban
+0000c650: 642c 206e 756d 5f62 616e 6429 0a20 2020  d, num_band).   
+0000c660: 2020 2020 2020 2020 2064 7479 7065 3d27           dtype='
+0000c670: 636f 6d70 6c65 7831 3238 272c 206f 7264  complex128', ord
+0000c680: 6572 3d27 4327 0a20 2020 2020 2020 2067  er='C'.        g
+0000c690: 7269 645f 6164 6472 6573 7320 3a20 6172  rid_address : ar
+0000c6a0: 7261 795f 6c69 6b65 0a20 2020 2020 2020  ray_like.       
+0000c6b0: 2020 2020 2047 7269 6420 706f 696e 7420       Grid point 
+0000c6c0: 6164 6472 6573 7365 7320 6279 2069 6e74  addresses by int
+0000c6d0: 6567 6572 732e 2054 6865 2066 6972 7374  egers. The first
+0000c6e0: 2064 696d 656e 7369 6f6e 206d 6179 206e   dimension may n
+0000c6f0: 6f74 2062 650a 2020 2020 2020 2020 2020  ot be.          
+0000c700: 2020 7072 6f64 286d 6573 6829 2062 6563    prod(mesh) bec
+0000c710: 6175 7365 2069 7420 696e 636c 7564 6573  ause it includes
+0000c720: 2042 7269 6c6c 6f75 696e 207a 6f6e 6520   Brillouin zone 
+0000c730: 626f 756e 6461 7279 2e20 5468 6520 6465  boundary. The de
+0000c740: 7461 696c 0a20 2020 2020 2020 2020 2020  tail.           
+0000c750: 2069 7320 666f 756e 6420 696e 2074 6865   is found in the
+0000c760: 2064 6f63 7374 7269 6e67 206f 660a 2020   docstring of.  
+0000c770: 2020 2020 2020 2020 2020 7068 6f6e 6f33            phono3
+0000c780: 7079 2e70 686f 6e6f 6e33 2e74 7269 706c  py.phonon3.tripl
+0000c790: 6574 732e 6765 745f 7472 6970 6c65 7473  ets.get_triplets
+0000c7a0: 5f61 745f 712e 0a20 2020 2020 2020 2020  _at_q..         
+0000c7b0: 2020 2073 6861 7065 3d28 6e75 6d5f 6772     shape=(num_gr
+0000c7c0: 6964 5f70 6f69 6e74 732c 2033 292c 2064  id_points, 3), d
+0000c7d0: 7479 7065 3d69 6e74 0a0a 2020 2020 2020  type=int..      
+0000c7e0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0000c7f0: 2073 656c 662e 5f69 6e74 6572 6163 7469   self._interacti
+0000c800: 6f6e 2069 7320 6e6f 7420 4e6f 6e65 3a0a  on is not None:.
+0000c810: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000c820: 2e5f 696e 7465 7261 6374 696f 6e2e 7365  ._interaction.se
+0000c830: 745f 7068 6f6e 6f6e 5f64 6174 6128 6672  t_phonon_data(fr
+0000c840: 6571 7565 6e63 6965 732c 2065 6967 656e  equencies, eigen
+0000c850: 7665 6374 6f72 732c 2067 7269 645f 6164  vectors, grid_ad
+0000c860: 6472 6573 7329 0a0a 2020 2020 6465 6620  dress)..    def 
+0000c870: 6765 745f 7068 6f6e 6f6e 5f64 6174 6128  get_phonon_data(
+0000c880: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000c890: 2222 4765 7420 7068 6f6e 6f6e 2066 7265  ""Get phonon fre
+0000c8a0: 7175 656e 6369 6573 2061 6e64 2065 6967  quencies and eig
+0000c8b0: 656e 7665 6374 6f72 7320 696e 2049 6e74  envectors in Int
+0000c8c0: 6572 6163 7469 6f6e 2069 6e73 7461 6e63  eraction instanc
+0000c8d0: 652e 0a0a 2020 2020 2020 2020 4861 726d  e...        Harm
+0000c8e0: 6f6e 6963 2070 686f 6e6f 6e20 696e 666f  onic phonon info
+0000c8f0: 726d 6174 696f 6e20 6973 2073 746f 7265  rmation is store
+0000c900: 6420 696e 2049 6e74 6572 6163 7469 6f6e  d in Interaction
+0000c910: 2069 6e73 7461 6e63 652e 2054 6869 730a   instance. This.
+0000c920: 2020 2020 2020 2020 696e 666f 726d 6174          informat
+0000c930: 696f 6e20 6361 6e20 6265 206f 6274 6169  ion can be obtai
+0000c940: 6e65 642e 2054 6865 2067 7269 645f 6164  ned. The grid_ad
+0000c950: 6472 6573 7320 7265 7475 726e 6564 2067  dress returned g
+0000c960: 6976 6520 7468 650a 2020 2020 2020 2020  ive the.        
+0000c970: 712d 706f 696e 7473 206c 6f63 6174 696f  q-points locatio
+0000c980: 6e73 2077 6974 6820 7265 7370 6563 7420  ns with respect 
+0000c990: 746f 2072 6563 6970 726f 6361 6c20 6261  to reciprocal ba
+0000c9a0: 7369 7320 7665 6374 6f72 7320 6279 0a20  sis vectors by. 
+0000c9b0: 2020 2020 2020 2069 6e74 6567 6572 7320         integers 
+0000c9c0: 696e 2074 6865 2077 6179 2074 6861 740a  in the way that.
+0000c9d0: 2020 2020 2020 2020 2020 2020 715f 706f              q_po
+0000c9e0: 696e 7473 203d 2067 7269 645f 6164 6472  ints = grid_addr
+0000c9f0: 6573 7320 2f20 6e70 2e61 7272 6179 286d  ess / np.array(m
+0000ca00: 6573 682c 2064 7479 7065 3d27 646f 7562  esh, dtype='doub
+0000ca10: 6c65 2729 2e0a 0a20 2020 2020 2020 2052  le')...        R
+0000ca20: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0000ca30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2074  ------.        t
+0000ca40: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
+0000ca50: 2028 6672 6571 7565 6e63 6965 732c 2065   (frequencies, e
+0000ca60: 6967 656e 7665 6374 6f72 732c 2067 7269  igenvectors, gri
+0000ca70: 645f 6164 6472 6573 7329 0a20 2020 2020  d_address).     
+0000ca80: 2020 2020 2020 2053 6565 206d 6f72 6520         See more 
+0000ca90: 6465 7461 696c 7320 6174 2074 6865 2064  details at the d
+0000caa0: 6f63 7374 7269 6e67 206f 6620 7365 745f  ocstring of set_
+0000cab0: 7068 6f6e 6f6e 5f64 6174 612e 0a0a 2020  phonon_data...  
+0000cac0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000cad0: 2020 6966 2073 656c 662e 5f69 6e74 6572    if self._inter
+0000cae0: 6163 7469 6f6e 2069 7320 6e6f 7420 4e6f  action is not No
+0000caf0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000cb00: 6672 6571 732c 2065 6967 7665 6373 2c20  freqs, eigvecs, 
+0000cb10: 5f20 3d20 7365 6c66 2e5f 696e 7465 7261  _ = self._intera
+0000cb20: 6374 696f 6e2e 6765 745f 7068 6f6e 6f6e  ction.get_phonon
+0000cb30: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0000cb40: 7265 7475 726e 2066 7265 7173 2c20 6569  return freqs, ei
+0000cb50: 6776 6563 732c 2073 656c 662e 5f69 6e74  gvecs, self._int
+0000cb60: 6572 6163 7469 6f6e 2e62 7a5f 6772 6964  eraction.bz_grid
+0000cb70: 2e61 6464 7265 7373 6573 0a20 2020 2020  .addresses.     
+0000cb80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000cb90: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
+0000cba0: 2020 2020 2020 2020 2020 2020 2022 5068               "Ph
+0000cbb0: 6f6e 6f33 7079 2e69 6e69 745f 7068 7068  ono3py.init_phph
+0000cbc0: 5f69 6e74 6572 6163 7469 6f6e 2068 6173  _interaction has
+0000cbd0: 2074 6f20 6265 2063 616c 6c65 6420 220a   to be called ".
+0000cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cbf0: 2262 6566 6f72 6520 7275 6e6e 696e 6720  "before running 
+0000cc00: 7468 6973 206d 6574 686f 642e 220a 2020  this method.".  
+0000cc10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000cc20: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
+0000cc30: 6e74 696d 6545 7272 6f72 286d 7367 290a  ntimeError(msg).
+0000cc40: 0a20 2020 2064 6566 2072 756e 5f70 686f  .    def run_pho
+0000cc50: 6e6f 6e5f 736f 6c76 6572 2873 656c 662c  non_solver(self,
+0000cc60: 2067 7269 645f 706f 696e 7473 3d4e 6f6e   grid_points=Non
+0000cc70: 6529 3a0a 2020 2020 2020 2020 2222 2252  e):.        """R
+0000cc80: 756e 2068 6172 6d6f 6e69 6320 7068 6f6e  un harmonic phon
+0000cc90: 6f6e 2063 616c 6375 6c61 7469 6f6e 206f  on calculation o
+0000cca0: 6e20 6772 6964 2070 6f69 6e74 732e 0a0a  n grid points...
+0000ccb0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000ccc0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0000ccd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6772  -----.        gr
+0000cce0: 6964 5f70 6f69 6e74 7320 3a20 6172 7261  id_points : arra
+0000ccf0: 795f 6c69 6b65 206f 7220 4e6f 6e65 2c20  y_like or None, 
+0000cd00: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0000cd10: 2020 2020 2041 206c 6973 7420 6f66 2067       A list of g
+0000cd20: 7269 6420 706f 696e 7420 696e 6469 6365  rid point indice
+0000cd30: 7320 6f66 2050 686f 6e6f 3370 792e 6772  s of Phono3py.gr
+0000cd40: 6964 2e61 6464 7265 7373 6573 2e0a 2020  id.addresses..  
+0000cd50: 2020 2020 2020 2020 2020 5370 6563 6966            Specif
+0000cd60: 7969 6e67 204e 6f6e 6520 7275 6e73 2061  ying None runs a
+0000cd70: 6c6c 2070 686f 6e6f 6e73 206f 6e20 7468  ll phonons on th
+0000cd80: 6520 6772 6964 2070 6f69 6e74 7320 756e  e grid points un
+0000cd90: 6c65 7373 0a20 2020 2020 2020 2020 2020  less.           
+0000cda0: 2074 686f 7365 2070 686f 6e6f 6e73 2077   those phonons w
+0000cdb0: 6572 6520 616c 7265 6164 7920 6361 6c63  ere already calc
+0000cdc0: 756c 6174 6564 2e20 4e6f 726d 616c 6c79  ulated. Normally
+0000cdd0: 2070 686f 6e6f 6e73 2061 740a 2020 2020   phonons at.    
+0000cde0: 2020 2020 2020 2020 5b30 2c20 302c 2030          [0, 0, 0
+0000cdf0: 5d20 706f 696e 7420 6973 2061 6c72 6561  ] point is alrea
+0000ce00: 6479 2063 616c 6375 6c61 7465 6420 6265  dy calculated be
+0000ce10: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
+0000ce20: 7320 6d65 7468 6f64 2e0a 2020 2020 2020  s method..      
+0000ce30: 2020 2020 2020 5068 6f6e 6f6e 2063 616c        Phonon cal
+0000ce40: 6375 6c61 7469 6f6e 7320 6172 6520 7065  culations are pe
+0000ce50: 7266 6f72 6d65 6420 6175 746f 6d61 7469  rformed automati
+0000ce60: 6361 6c6c 7920 7768 656e 206e 6565 6465  cally when neede
+0000ce70: 640a 2020 2020 2020 2020 2020 2020 696e  d.            in
+0000ce80: 7465 726e 616c 6c79 2066 6f72 2070 682d  ternally for ph-
+0000ce90: 7068 2063 616c 6375 6c61 7469 6f6e 2e20  ph calculation. 
+0000cea0: 5468 6572 6566 6f72 6520 6361 6c6c 696e  Therefore callin
+0000ceb0: 6720 7468 6973 206d 6574 686f 640a 2020  g this method.  
+0000cec0: 2020 2020 2020 2020 2020 6973 206e 6f74            is not
+0000ced0: 206e 6563 6573 7361 7279 2069 6e20 6d6f   necessary in mo
+0000cee0: 7374 2063 6173 6573 2e0a 2020 2020 2020  st cases..      
+0000cef0: 2020 2020 2020 5468 6520 7068 6f6e 6f6e        The phonon
+0000cf00: 2072 6573 756c 7473 2061 7265 206f 6274   results are obt
+0000cf10: 6169 6e65 6420 6279 2050 686f 6e6f 3370  ained by Phono3p
+0000cf20: 792e 6765 745f 7068 6f6e 6f6e 5f64 6174  y.get_phonon_dat
+0000cf30: 6128 292e 0a0a 2020 2020 2020 2020 2222  a()...        ""
+0000cf40: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0000cf50: 662e 5f69 6e74 6572 6163 7469 6f6e 2069  f._interaction i
+0000cf60: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0000cf70: 2020 2020 2020 2020 7365 6c66 2e5f 696e          self._in
+0000cf80: 7465 7261 6374 696f 6e2e 7275 6e5f 7068  teraction.run_ph
+0000cf90: 6f6e 6f6e 5f73 6f6c 7665 7228 6772 6964  onon_solver(grid
+0000cfa0: 5f70 6f69 6e74 733d 6772 6964 5f70 6f69  _points=grid_poi
+0000cfb0: 6e74 7329 0a20 2020 2020 2020 2065 6c73  nts).        els
+0000cfc0: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+0000cfd0: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
+0000cfe0: 2020 2020 2020 2022 5068 6f6e 6f33 7079         "Phono3py
+0000cff0: 2e69 6e69 745f 7068 7068 5f69 6e74 6572  .init_phph_inter
+0000d000: 6163 7469 6f6e 2068 6173 2074 6f20 6265  action has to be
+0000d010: 2063 616c 6c65 6420 220a 2020 2020 2020   called ".      
+0000d020: 2020 2020 2020 2020 2020 2262 6566 6f72            "befor
+0000d030: 6520 7275 6e6e 696e 6720 7468 6973 206d  e running this m
+0000d040: 6574 686f 642e 220a 2020 2020 2020 2020  ethod.".        
+0000d050: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000d060: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
+0000d070: 7272 6f72 286d 7367 290a 0a20 2020 2064  rror(msg)..    d
+0000d080: 6566 2067 656e 6572 6174 655f 6469 7370  ef generate_disp
+0000d090: 6c61 6365 6d65 6e74 7328 0a20 2020 2020  lacements(.     
+0000d0a0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000d0b0: 2064 6973 7461 6e63 653d 302e 3033 2c0a   distance=0.03,.
+0000d0c0: 2020 2020 2020 2020 6375 746f 6666 5f70          cutoff_p
+0000d0d0: 6169 725f 6469 7374 616e 6365 3d4e 6f6e  air_distance=Non
+0000d0e0: 652c 0a20 2020 2020 2020 2069 735f 706c  e,.        is_pl
+0000d0f0: 7573 6d69 6e75 733d 2261 7574 6f22 2c0a  usminus="auto",.
+0000d100: 2020 2020 2020 2020 6973 5f64 6961 676f          is_diago
+0000d110: 6e61 6c3d 5472 7565 2c0a 2020 2020 293a  nal=True,.    ):
+0000d120: 0a20 2020 2020 2020 2022 2222 4765 6e65  .        """Gene
+0000d130: 7261 7465 2064 6973 706c 6163 656d 656e  rate displacemen
+0000d140: 7420 6461 7461 7365 7420 696e 2073 7570  t dataset in sup
+0000d150: 6572 6365 6c6c 2066 6f72 2066 6333 2e0a  ercell for fc3..
+0000d160: 0a20 2020 2020 2020 2054 6869 7320 7379  .        This sy
+0000d170: 7374 656d 6174 6963 616c 6c79 2067 656e  stematically gen
+0000d180: 6572 6174 6573 2073 696e 676c 6520 616e  erates single an
+0000d190: 6420 7061 6972 2061 746f 6d69 6320 6469  d pair atomic di
+0000d1a0: 7370 6c61 6365 6d65 6e74 730a 2020 2020  splacements.    
+0000d1b0: 2020 2020 696e 2073 7570 6572 6365 6c6c      in supercell
+0000d1c0: 7320 746f 2063 616c 6375 6c61 7465 2066  s to calculate f
+0000d1d0: 6333 2063 6f6e 7369 6465 7269 6e67 2063  c3 considering c
+0000d1e0: 7279 7374 616c 2073 796d 6d65 7472 792e  rystal symmetry.
+0000d1f0: 0a20 2020 2020 2020 2057 6865 6e20 7468  .        When th
+0000d200: 6973 206d 6574 686f 6420 6973 2063 616c  is method is cal
+0000d210: 6c65 642c 2065 7869 7374 696e 6720 6361  led, existing ca
+0000d220: 6368 6520 6f66 2073 7570 6572 6365 6c6c  che of supercell
+0000d230: 7320 7769 7468 0a20 2020 2020 2020 2064  s with.        d
+0000d240: 6973 706c 6163 656d 656e 7473 2066 6f72  isplacements for
+0000d250: 2066 6333 2061 7265 2072 656d 6f76 6564   fc3 are removed
+0000d260: 2e0a 0a20 2020 2020 2020 2046 6f72 2066  ...        For f
+0000d270: 6333 2c20 7477 6f20 6174 6f6d 7320 6172  c3, two atoms ar
+0000d280: 6520 6469 7370 6c61 6365 6420 666f 7220  e displaced for 
+0000d290: 6561 6368 2063 6f6e 6669 6775 7261 7469  each configurati
+0000d2a0: 6f6e 0a20 2020 2020 2020 2063 6f6e 7369  on.        consi
+0000d2b0: 6465 7269 6e67 2063 7279 7374 616c 2073  dering crystal s
+0000d2c0: 796d 6d65 7472 792e 2054 6865 2066 6972  ymmetry. The fir
+0000d2d0: 7374 2064 6973 706c 6163 656d 656e 7420  st displacement 
+0000d2e0: 6973 2063 686f 7365 6e0a 2020 2020 2020  is chosen.      
+0000d2f0: 2020 696e 2074 6865 2070 6572 6665 6374    in the perfect
+0000d300: 2073 7570 6572 6365 6c6c 2c20 616e 6420   supercell, and 
+0000d310: 7468 6520 7365 636f 6e64 2064 6973 706c  the second displ
+0000d320: 6163 656d 656e 7420 696e 2074 6865 0a20  acement in the. 
+0000d330: 2020 2020 2020 2064 6973 706c 6163 6564         displaced
+0000d340: 2073 7570 6572 6365 6c6c 2e20 5468 6520   supercell. The 
+0000d350: 6669 7273 7420 6469 7370 6c61 6365 6d65  first displaceme
+0000d360: 6e74 7320 6172 6520 7461 6b65 6e20 616c  nts are taken al
+0000d370: 6f6e 670a 2020 2020 2020 2020 7468 6520  ong.        the 
+0000d380: 6261 7369 7320 7665 6374 6f72 7320 6f66  basis vectors of
+0000d390: 2074 6865 2073 7570 6572 6365 6c6c 2e20   the supercell. 
+0000d3a0: 5468 6973 2069 7320 6265 6361 7573 6520  This is because 
+0000d3b0: 7468 650a 2020 2020 2020 2020 7379 6d6d  the.        symm
+0000d3c0: 6574 7279 2069 7320 6578 7065 6374 6564  etry is expected
+0000d3d0: 2074 6f20 6265 206c 6573 7320 6272 6f6b   to be less brok
+0000d3e0: 656e 2062 7920 7468 6520 696e 7472 6f64  en by the introd
+0000d3f0: 7563 6564 2066 6972 7374 0a20 2020 2020  uced first.     
+0000d400: 2020 2064 6973 706c 6163 656d 656e 742c     displacement,
+0000d410: 2061 6e64 2061 7320 7468 6520 7265 7375   and as the resu
+0000d420: 6c74 2c20 7468 6520 6e75 6d62 6572 206f  lt, the number o
+0000d430: 6620 7365 636f 6e64 0a20 2020 2020 2020  f second.       
+0000d440: 2064 6973 706c 6163 656d 656e 7473 206d   displacements m
+0000d450: 6179 2062 6563 6f6d 6520 736d 616c 6c65  ay become smalle
+0000d460: 7220 7468 616e 2074 6865 2063 6173 6520  r than the case 
+0000d470: 7468 6174 2074 6865 2066 6972 7374 0a20  that the first. 
+0000d480: 2020 2020 2020 2061 746f 6d20 6973 2064         atom is d
+0000d490: 6973 706c 6163 6564 206e 6f74 2061 6c6f  isplaced not alo
+0000d4a0: 6e67 2074 6865 2062 6173 6973 2076 6563  ng the basis vec
+0000d4b0: 746f 7273 2e0a 0a20 2020 2020 2020 204e  tors...        N
+0000d4c0: 6f74 650a 2020 2020 2020 2020 2d2d 2d2d  ote.        ----
+0000d4d0: 0a20 2020 2020 2020 2057 6865 6e20 7068  .        When ph
+0000d4e0: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
+0000d4f0: 6174 7269 7820 6973 206e 6f74 2067 6976  atrix is not giv
+0000d500: 656e 2c20 6663 3220 6973 2061 6c73 6f0a  en, fc2 is also.
+0000d510: 2020 2020 2020 2020 636f 6d70 7574 6564          computed
+0000d520: 2066 726f 6d20 7468 6520 7361 6d65 2073   from the same s
+0000d530: 6574 206f 6620 7468 6520 6469 7370 6c61  et of the displa
+0000d540: 6365 6d65 6e74 7320 666f 7220 6663 3320  cements for fc3 
+0000d550: 616e 640a 2020 2020 2020 2020 7265 7370  and.        resp
+0000d560: 6563 7469 7665 2073 7570 6572 6365 6c6c  ective supercell
+0000d570: 2066 6f72 6365 732e 2057 6865 6e20 7068   forces. When ph
+0000d580: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
+0000d590: 6174 7269 7820 6973 0a20 2020 2020 2020  atrix is.       
+0000d5a0: 2073 6574 2c20 7468 6520 6469 7370 6c61   set, the displa
+0000d5b0: 6365 6d65 6e74 7320 696e 2070 686f 6e6f  cements in phono
+0000d5c0: 6e5f 7375 7065 7263 656c 6c20 6172 6520  n_supercell are 
+0000d5d0: 6765 6e65 7261 7465 6420 756e 6c65 7373  generated unless
+0000d5e0: 0a20 2020 2020 2020 2074 686f 7365 2061  .        those a
+0000d5f0: 6c72 6561 6479 2065 7869 7374 2e0a 0a20  lready exist... 
+0000d600: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000d610: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0000d620: 2d2d 2d2d 0a20 2020 2020 2020 2064 6973  ----.        dis
+0000d630: 7461 6e63 6520 3a20 666c 6f61 742c 206f  tance : float, o
+0000d640: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000d650: 2020 2020 436f 6e73 7461 6e74 2064 6973      Constant dis
+0000d660: 706c 6163 656d 656e 7420 4575 636c 6964  placement Euclid
+0000d670: 6561 6e20 6469 7374 616e 6365 2e20 4465  ean distance. De
+0000d680: 6661 756c 7420 6973 2030 2e30 332e 0a20  fault is 0.03.. 
+0000d690: 2020 2020 2020 2063 7574 6f66 665f 7061         cutoff_pa
+0000d6a0: 6972 5f64 6973 7461 6e63 6520 3a20 666c  ir_distance : fl
+0000d6b0: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
+0000d6c0: 2020 2020 2020 2020 2020 5468 6973 2069            This i
+0000d6d0: 7320 7573 6564 2061 7320 6120 6375 746f  s used as a cuto
+0000d6e0: 6666 2045 7563 6c69 6465 616e 2064 6973  ff Euclidean dis
+0000d6f0: 7461 6e63 6520 746f 2064 6574 6572 6d69  tance to determi
+0000d700: 6e65 2069 660a 2020 2020 2020 2020 2020  ne if.          
+0000d710: 2020 6561 6368 2070 6169 7220 6f66 2064    each pair of d
+0000d720: 6973 706c 6163 656d 656e 7473 2069 7320  isplacements is 
+0000d730: 636f 6e73 6964 6572 6564 2074 6f20 6361  considered to ca
+0000d740: 6c63 756c 6174 6520 6663 3320 6f72 206e  lculate fc3 or n
+0000d750: 6f74 2e0a 2020 2020 2020 2020 2020 2020  ot..            
+0000d760: 4465 6661 756c 7420 6973 204e 6f6e 652c  Default is None,
+0000d770: 2077 6869 6368 206d 6561 6e73 2063 7574   which means cut
+0000d780: 6f66 6620 6973 206e 6f74 2075 7365 642e  off is not used.
+0000d790: 0a20 2020 2020 2020 2069 735f 706c 7573  .        is_plus
+0000d7a0: 6d69 6e75 7320 3a20 5472 7565 2c20 4661  minus : True, Fa
+0000d7b0: 6c73 652c 206f 7220 2761 7574 6f27 2c20  lse, or 'auto', 
+0000d7c0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0000d7d0: 2020 2020 2057 6974 6820 5472 7565 2c20       With True, 
+0000d7e0: 6174 6f6d 6973 2061 7265 2064 6973 706c  atomis are displ
+0000d7f0: 6163 6564 2069 6e20 626f 7468 2070 6f73  aced in both pos
+0000d800: 6974 6976 6520 616e 6420 6e65 6761 7469  itive and negati
+0000d810: 7665 0a20 2020 2020 2020 2020 2020 2064  ve.            d
+0000d820: 6972 6563 7469 6f6e 732e 2057 6974 6820  irections. With 
+0000d830: 4661 6c73 652c 206f 6e6c 7920 6f6e 6520  False, only one 
+0000d840: 6469 7265 6374 696f 6e2e 2057 6974 6820  direction. With 
+0000d850: 2761 7574 6f27 2c0a 2020 2020 2020 2020  'auto',.        
+0000d860: 2020 2020 6d6f 7374 6c79 2065 7175 6976      mostly equiv
+0000d870: 616c 656e 7420 746f 2069 735f 706c 7573  alent to is_plus
+0000d880: 6d69 6e75 733d 5472 7565 2c20 6275 7420  minus=True, but 
+0000d890: 6f6e 6c79 206f 6e65 2064 6972 6563 7469  only one directi
+0000d8a0: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
+0000d8b0: 7320 6368 6f73 656e 2077 6865 6e20 7468  s chosen when th
+0000d8c0: 6520 6469 7370 6c61 6365 6d65 6e74 7320  e displacements 
+0000d8d0: 696e 2062 6f74 6820 6469 7265 6374 696f  in both directio
+0000d8e0: 6e73 2061 7265 0a20 2020 2020 2020 2020  ns are.         
+0000d8f0: 2020 2073 796d 6d65 7472 6963 616c 6c79     symmetrically
+0000d900: 2065 7175 6976 616c 656e 742e 2044 6566   equivalent. Def
+0000d910: 6175 6c74 2069 7320 2761 7574 6f27 2e0a  ault is 'auto'..
+0000d920: 2020 2020 2020 2020 6973 5f64 6961 676f          is_diago
+0000d930: 6e61 6c20 3a20 426f 6f6c 2c20 6f70 7469  nal : Bool, opti
+0000d940: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0000d950: 2057 6974 6820 4661 6c73 652c 2074 6865   With False, the
+0000d960: 2073 6563 6f6e 6420 6469 7370 6c61 6365   second displace
+0000d970: 6d65 6e74 7320 6172 6520 6d61 6465 2061  ments are made a
+0000d980: 6c6f 6e67 2074 6865 2062 6173 6973 0a20  long the basis. 
+0000d990: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+0000d9a0: 7273 206f 6620 7468 6520 7375 7065 7263  rs of the superc
+0000d9b0: 656c 6c2e 2057 6974 6820 5472 7565 2c20  ell. With True, 
+0000d9c0: 6469 7265 6374 696f 6e20 6e6f 7420 616c  direction not al
+0000d9d0: 6f6e 6720 7468 6520 6261 7369 730a 2020  ong the basis.  
+0000d9e0: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
+0000d9f0: 7320 6361 6e20 6265 2063 686f 7365 6e20  s can be chosen 
+0000da00: 7768 656e 2074 6865 206e 756d 6265 7220  when the number 
+0000da10: 6f66 2074 6865 2064 6973 706c 6163 656d  of the displacem
+0000da20: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+0000da30: 206d 6179 2062 6520 7265 6475 6365 642e   may be reduced.
+0000da40: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000da50: 2020 2020 2020 6469 7265 6374 696f 6e5f        direction_
+0000da60: 6461 7461 7365 7420 3d20 6765 745f 7468  dataset = get_th
+0000da70: 6972 645f 6f72 6465 725f 6469 7370 6c61  ird_order_displa
+0000da80: 6365 6d65 6e74 7328 0a20 2020 2020 2020  cements(.       
+0000da90: 2020 2020 2073 656c 662e 5f73 7570 6572       self._super
+0000daa0: 6365 6c6c 2c0a 2020 2020 2020 2020 2020  cell,.          
+0000dab0: 2020 7365 6c66 2e5f 7379 6d6d 6574 7279    self._symmetry
+0000dac0: 2c0a 2020 2020 2020 2020 2020 2020 6973  ,.            is
+0000dad0: 5f70 6c75 736d 696e 7573 3d69 735f 706c  _plusminus=is_pl
+0000dae0: 7573 6d69 6e75 732c 0a20 2020 2020 2020  usminus,.       
+0000daf0: 2020 2020 2069 735f 6469 6167 6f6e 616c       is_diagonal
+0000db00: 3d69 735f 6469 6167 6f6e 616c 2c0a 2020  =is_diagonal,.  
+0000db10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000db20: 7365 6c66 2e5f 6461 7461 7365 7420 3d20  self._dataset = 
+0000db30: 6469 7265 6374 696f 6e5f 746f 5f64 6973  direction_to_dis
+0000db40: 706c 6163 656d 656e 7428 0a20 2020 2020  placement(.     
+0000db50: 2020 2020 2020 2064 6972 6563 7469 6f6e         direction
+0000db60: 5f64 6174 6173 6574 2c0a 2020 2020 2020  _dataset,.      
+0000db70: 2020 2020 2020 6469 7374 616e 6365 2c0a        distance,.
+0000db80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000db90: 2e5f 7375 7065 7263 656c 6c2c 0a20 2020  ._supercell,.   
+0000dba0: 2020 2020 2020 2020 2063 7574 6f66 665f           cutoff_
+0000dbb0: 6469 7374 616e 6365 3d63 7574 6f66 665f  distance=cutoff_
+0000dbc0: 7061 6972 5f64 6973 7461 6e63 652c 0a20  pair_distance,. 
+0000dbd0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000dbe0: 2073 656c 662e 5f73 7570 6572 6365 6c6c   self._supercell
+0000dbf0: 735f 7769 7468 5f64 6973 706c 6163 656d  s_with_displacem
+0000dc00: 656e 7473 203d 204e 6f6e 650a 0a20 2020  ents = None..   
+0000dc10: 2020 2020 2069 6620 7365 6c66 2e5f 7068       if self._ph
+0000dc20: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
+0000dc30: 6174 7269 7820 6973 206e 6f74 204e 6f6e  atrix is not Non
+0000dc40: 6520 616e 6420 7365 6c66 2e5f 7068 6f6e  e and self._phon
+0000dc50: 6f6e 5f64 6174 6173 6574 2069 7320 4e6f  on_dataset is No
+0000dc60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000dc70: 7365 6c66 2e67 656e 6572 6174 655f 6663  self.generate_fc
+0000dc80: 325f 6469 7370 6c61 6365 6d65 6e74 7328  2_displacements(
+0000dc90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dca0: 2064 6973 7461 6e63 653d 6469 7374 616e   distance=distan
+0000dcb0: 6365 2c20 6973 5f70 6c75 736d 696e 7573  ce, is_plusminus
+0000dcc0: 3d69 735f 706c 7573 6d69 6e75 732c 2069  =is_plusminus, i
+0000dcd0: 735f 6469 6167 6f6e 616c 3d46 616c 7365  s_diagonal=False
+0000dce0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000dcf0: 2020 2020 6465 6620 6765 6e65 7261 7465      def generate
+0000dd00: 5f66 6332 5f64 6973 706c 6163 656d 656e  _fc2_displacemen
+0000dd10: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
+0000dd20: 2c20 6469 7374 616e 6365 3d30 2e30 332c  , distance=0.03,
+0000dd30: 2069 735f 706c 7573 6d69 6e75 733d 2261   is_plusminus="a
+0000dd40: 7574 6f22 2c20 6973 5f64 6961 676f 6e61  uto", is_diagona
+0000dd50: 6c3d 4661 6c73 650a 2020 2020 293a 0a20  l=False.    ):. 
+0000dd60: 2020 2020 2020 2022 2222 4765 6e65 7261         """Genera
+0000dd70: 7465 2064 6973 706c 6163 656d 656e 7420  te displacement 
+0000dd80: 6461 7461 7365 7420 696e 2070 686f 6e6f  dataset in phono
+0000dd90: 6e20 7375 7065 7263 656c 6c20 666f 7220  n supercell for 
+0000dda0: 6663 322e 0a0a 2020 2020 2020 2020 5468  fc2...        Th
+0000ddb0: 6973 2073 7973 7465 6d61 7469 6361 6c6c  is systematicall
+0000ddc0: 7920 6765 6e65 7261 7465 7320 7369 6e67  y generates sing
+0000ddd0: 6c65 2061 746f 6d69 6320 6469 7370 6c61  le atomic displa
+0000dde0: 6365 6d65 6e74 730a 2020 2020 2020 2020  cements.        
+0000ddf0: 696e 2073 7570 6572 6365 6c6c 7320 746f  in supercells to
+0000de00: 2063 616c 6375 6c61 7465 2070 686f 6e6f   calculate phono
+0000de10: 6e5f 6663 3220 636f 6e73 6964 6572 696e  n_fc2 considerin
+0000de20: 6720 6372 7973 7461 6c20 7379 6d6d 6574  g crystal symmet
+0000de30: 7279 2e0a 2020 2020 2020 2020 5768 656e  ry..        When
+0000de40: 2074 6869 7320 6d65 7468 6f64 2069 7320   this method is 
+0000de50: 6361 6c6c 6564 2c20 6578 6973 7469 6e67  called, existing
+0000de60: 2063 6163 6865 206f 6620 7375 7065 7263   cache of superc
+0000de70: 656c 6c73 2077 6974 680a 2020 2020 2020  ells with.      
+0000de80: 2020 6469 7370 6c61 6365 6d65 6e74 7320    displacements 
+0000de90: 666f 7220 6663 3220 6172 6520 7265 6d6f  for fc2 are remo
+0000dea0: 7665 642e 0a0a 2020 2020 2020 2020 4e6f  ved...        No
+0000deb0: 7465 0a20 2020 2020 2020 202d 2d2d 2d0a  te.        ----.
+0000dec0: 2020 2020 2020 2020 6973 5f64 6961 676f          is_diago
+0000ded0: 6e61 6c3d 4661 6c73 6520 6973 2063 686f  nal=False is cho
+0000dee0: 7365 6e20 6173 2074 6865 2064 6566 6175  sen as the defau
+0000def0: 6c74 2073 6574 7469 6e67 2069 6e74 656e  lt setting inten
+0000df00: 7469 6f6e 616c 6c79 0a20 2020 2020 2020  tionally.       
+0000df10: 2074 6f20 6265 2063 6f6e 7369 7374 656e   to be consisten
+0000df20: 7420 746f 2074 6865 2066 6972 7374 2064  t to the first d
+0000df30: 6973 706c 6163 656d 656e 7473 206f 6620  isplacements of 
+0000df40: 7468 6520 6663 3320 7061 6972 0a20 2020  the fc3 pair.   
+0000df50: 2020 2020 2064 6973 706c 6163 656d 6574       displacemet
+0000df60: 7320 696e 2073 7570 6572 6365 6c6c 2e0a  s in supercell..
+0000df70: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000df80: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0000df90: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+0000dfa0: 6973 7461 6e63 6520 3a20 666c 6f61 742c  istance : float,
+0000dfb0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0000dfc0: 2020 2020 2020 436f 6e73 7461 6e74 2064        Constant d
+0000dfd0: 6973 706c 6163 656d 656e 7420 4575 636c  isplacement Eucl
+0000dfe0: 6964 6561 6e20 6469 7374 616e 6365 2e20  idean distance. 
+0000dff0: 4465 6661 756c 7420 6973 2030 2e30 332e  Default is 0.03.
+0000e000: 0a20 2020 2020 2020 2069 735f 706c 7573  .        is_plus
+0000e010: 6d69 6e75 7320 3a20 5472 7565 2c20 4661  minus : True, Fa
+0000e020: 6c73 652c 206f 7220 2761 7574 6f27 2c20  lse, or 'auto', 
+0000e030: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0000e040: 2020 2020 2057 6974 6820 5472 7565 2c20       With True, 
+0000e050: 6174 6f6d 6973 2061 7265 2064 6973 706c  atomis are displ
+0000e060: 6163 6564 2069 6e20 626f 7468 2070 6f73  aced in both pos
+0000e070: 6974 6976 6520 616e 6420 6e65 6761 7469  itive and negati
+0000e080: 7665 0a20 2020 2020 2020 2020 2020 2064  ve.            d
+0000e090: 6972 6563 7469 6f6e 732e 2057 6974 6820  irections. With 
+0000e0a0: 4661 6c73 652c 206f 6e6c 7920 6f6e 6520  False, only one 
+0000e0b0: 6469 7265 6374 696f 6e2e 2057 6974 6820  direction. With 
+0000e0c0: 2761 7574 6f27 2c0a 2020 2020 2020 2020  'auto',.        
+0000e0d0: 2020 2020 6d6f 7374 6c79 2065 7175 6976      mostly equiv
+0000e0e0: 616c 656e 7420 746f 2069 735f 706c 7573  alent to is_plus
+0000e0f0: 6d69 6e75 733d 5472 7565 2c20 6275 7420  minus=True, but 
+0000e100: 6f6e 6c79 206f 6e65 2064 6972 6563 7469  only one directi
+0000e110: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
+0000e120: 7320 6368 6f73 656e 2077 6865 6e20 7468  s chosen when th
+0000e130: 6520 6469 7370 6c61 6365 6d65 6e74 7320  e displacements 
+0000e140: 696e 2062 6f74 6820 6469 7265 6374 696f  in both directio
+0000e150: 6e73 2061 7265 0a20 2020 2020 2020 2020  ns are.         
+0000e160: 2020 2073 796d 6d65 7472 6963 616c 6c79     symmetrically
+0000e170: 2065 7175 6976 616c 656e 742e 2044 6566   equivalent. Def
+0000e180: 6175 6c74 2069 7320 2761 7574 6f27 2e0a  ault is 'auto'..
+0000e190: 2020 2020 2020 2020 6973 5f64 6961 676f          is_diago
+0000e1a0: 6e61 6c20 3a20 426f 6f6c 2c20 6f70 7469  nal : Bool, opti
+0000e1b0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0000e1c0: 2057 6974 6820 4661 6c73 652c 2074 6865   With False, the
+0000e1d0: 2064 6973 706c 6163 656d 656e 7473 2061   displacements a
+0000e1e0: 7265 206d 6164 6520 616c 6f6e 6720 7468  re made along th
+0000e1f0: 6520 6261 7369 730a 2020 2020 2020 2020  e basis.        
+0000e200: 2020 2020 7665 6374 6f72 7320 6f66 2074      vectors of t
+0000e210: 6865 2073 7570 6572 6365 6c6c 2e20 5769  he supercell. Wi
+0000e220: 7468 2054 7275 652c 2064 6972 6563 7469  th True, directi
+0000e230: 6f6e 206e 6f74 2061 6c6f 6e67 2074 6865  on not along the
+0000e240: 2062 6173 6973 0a20 2020 2020 2020 2020   basis.         
+0000e250: 2020 2076 6563 746f 7273 2063 616e 2062     vectors can b
+0000e260: 6520 6368 6f73 656e 2077 6865 6e20 7468  e chosen when th
+0000e270: 6520 6e75 6d62 6572 206f 6620 7468 6520  e number of the 
+0000e280: 6469 7370 6c61 6365 6d65 6e74 730a 2020  displacements.  
+0000e290: 2020 2020 2020 2020 2020 6d61 7920 6265            may be
+0000e2a0: 2072 6564 7563 6564 2e20 4465 6661 756c   reduced. Defaul
+0000e2b0: 7420 6973 2046 616c 7365 2e0a 0a20 2020  t is False...   
+0000e2c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000e2d0: 2069 6620 7365 6c66 2e5f 7068 6f6e 6f6e   if self._phonon
+0000e2e0: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
+0000e2f0: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+0000e300: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
+0000e310: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000e320: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
+0000e330: 5f6d 6174 7269 7820 6973 206e 6f74 2073  _matrix is not s
+0000e340: 6574 2e20 220a 2020 2020 2020 2020 2020  et. ".          
+0000e350: 2020 2020 2020 2254 6869 7320 6d65 7468        "This meth
+0000e360: 6f64 2069 7320 7573 6564 2074 6f20 6765  od is used to ge
+0000e370: 6e65 7261 7465 2064 6973 706c 6163 656d  nerate displacem
+0000e380: 656e 7473 2074 6f20 220a 2020 2020 2020  ents to ".      
+0000e390: 2020 2020 2020 2020 2020 2263 616c 6375            "calcu
+0000e3a0: 6c61 7465 2070 686f 6e6f 6e5f 6663 322e  late phonon_fc2.
+0000e3b0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0000e3c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000e3d0: 6520 5275 6e74 696d 6545 7272 6f72 286d  e RuntimeError(m
+0000e3e0: 7367 290a 0a20 2020 2020 2020 2070 686f  sg)..        pho
+0000e3f0: 6e6f 6e5f 6469 7370 6c61 6365 6d65 6e74  non_displacement
+0000e400: 5f64 6972 6563 7469 6f6e 7320 3d20 6765  _directions = ge
+0000e410: 745f 6c65 6173 745f 6469 7370 6c61 6365  t_least_displace
+0000e420: 6d65 6e74 7328 0a20 2020 2020 2020 2020  ments(.         
+0000e430: 2020 2073 656c 662e 5f70 686f 6e6f 6e5f     self._phonon_
+0000e440: 7375 7065 7263 656c 6c5f 7379 6d6d 6574  supercell_symmet
+0000e450: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+0000e460: 6973 5f70 6c75 736d 696e 7573 3d69 735f  is_plusminus=is_
+0000e470: 706c 7573 6d69 6e75 732c 0a20 2020 2020  plusminus,.     
+0000e480: 2020 2020 2020 2069 735f 6469 6167 6f6e         is_diagon
+0000e490: 616c 3d69 735f 6469 6167 6f6e 616c 2c0a  al=is_diagonal,.
+0000e4a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000e4b0: 2020 7365 6c66 2e5f 7068 6f6e 6f6e 5f64    self._phonon_d
+0000e4c0: 6174 6173 6574 203d 2064 6972 6563 7469  ataset = directi
+0000e4d0: 6f6e 735f 746f 5f64 6973 706c 6163 656d  ons_to_displacem
+0000e4e0: 656e 745f 6461 7461 7365 7428 0a20 2020  ent_dataset(.   
+0000e4f0: 2020 2020 2020 2020 2070 686f 6e6f 6e5f           phonon_
+0000e500: 6469 7370 6c61 6365 6d65 6e74 5f64 6972  displacement_dir
+0000e510: 6563 7469 6f6e 732c 2064 6973 7461 6e63  ections, distanc
+0000e520: 652c 2073 656c 662e 5f70 686f 6e6f 6e5f  e, self._phonon_
+0000e530: 7375 7065 7263 656c 6c0a 2020 2020 2020  supercell.      
+0000e540: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0000e550: 2e5f 7068 6f6e 6f6e 5f73 7570 6572 6365  ._phonon_superce
+0000e560: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
+0000e570: 656d 656e 7473 203d 204e 6f6e 650a 0a20  ements = None.. 
+0000e580: 2020 2064 6566 2070 726f 6475 6365 5f66     def produce_f
+0000e590: 6333 280a 2020 2020 2020 2020 7365 6c66  c3(.        self
+0000e5a0: 2c0a 2020 2020 2020 2020 7379 6d6d 6574  ,.        symmet
+0000e5b0: 7269 7a65 5f66 6333 723d 4661 6c73 652c  rize_fc3r=False,
+0000e5c0: 0a20 2020 2020 2020 2069 735f 636f 6d70  .        is_comp
+0000e5d0: 6163 745f 6663 3d46 616c 7365 2c0a 2020  act_fc=False,.  
+0000e5e0: 2020 2020 2020 6663 5f63 616c 6375 6c61        fc_calcula
+0000e5f0: 746f 723d 4e6f 6e65 2c0a 2020 2020 2020  tor=None,.      
+0000e600: 2020 6663 5f63 616c 6375 6c61 746f 725f    fc_calculator_
+0000e610: 6f70 7469 6f6e 733d 4e6f 6e65 2c0a 2020  options=None,.  
+0000e620: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0000e630: 4361 6c63 756c 6174 6520 6663 3320 6672  Calculate fc3 fr
+0000e640: 6f6d 2064 6973 706c 6163 656d 656e 7473  om displacements
+0000e650: 2061 6e64 2066 6f72 6365 732e 0a0a 2020   and forces...  
+0000e660: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000e670: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000e680: 2d2d 2d0a 2020 2020 2020 2020 7379 6d6d  ---.        symm
+0000e690: 6574 7269 7a65 5f66 6333 7220 3a20 626f  etrize_fc3r : bo
+0000e6a0: 6f6c 0a20 2020 2020 2020 2020 2020 204f  ol.            O
+0000e6b0: 6e6c 7920 666f 7220 7479 7065 2031 2064  nly for type 1 d
+0000e6c0: 6973 706c 6163 656d 656e 745f 6461 7461  isplacement_data
+0000e6d0: 7365 742c 2074 7261 6e73 6c61 7469 6f6e  set, translation
+0000e6e0: 616c 2061 6e64 0a20 2020 2020 2020 2020  al and.         
+0000e6f0: 2020 2070 6572 6d75 7461 7469 6f6e 2073     permutation s
+0000e700: 796d 6d65 7472 6965 7320 6172 6520 6170  ymmetries are ap
+0000e710: 706c 6965 6420 6166 7465 7220 6372 6561  plied after crea
+0000e720: 7469 6e67 2066 6333 2e20 5468 6973 0a20  ting fc3. This. 
+0000e730: 2020 2020 2020 2020 2020 2073 796d 6d65             symme
+0000e740: 7472 697a 6174 696f 6e20 6973 206e 6f74  trization is not
+0000e750: 2076 6572 7920 736f 7068 6973 7469 6361   very sophistica
+0000e760: 7465 6420 616e 6420 6361 6e20 6272 6561  ted and can brea
+0000e770: 6b20 7370 6163 650a 2020 2020 2020 2020  k space.        
+0000e780: 2020 2020 6772 6f75 7020 7379 6d6d 6574      group symmet
+0000e790: 7279 2c20 6275 7420 6f66 7465 6e20 7573  ry, but often us
+0000e7a0: 6566 756c 2e20 4966 2062 6574 7465 7220  eful. If better 
+0000e7b0: 7379 6d6d 6574 7269 7a61 7469 6f6e 2069  symmetrization i
+0000e7c0: 730a 2020 2020 2020 2020 2020 2020 6578  s.            ex
+0000e7d0: 7065 6374 6564 2c20 6974 2069 7320 7265  pected, it is re
+0000e7e0: 636f 6d6d 656e 6465 6420 746f 2075 7365  commended to use
+0000e7f0: 2065 7874 6572 6e61 6c20 666f 7263 6520   external force 
+0000e800: 636f 6e73 7461 6e74 730a 2020 2020 2020  constants.      
+0000e810: 2020 2020 2020 6361 6c63 756c 6174 6f72        calculator
+0000e820: 2073 7563 6820 6173 2041 4c4d 2e20 4465   such as ALM. De
+0000e830: 6661 756c 7420 6973 2046 616c 7365 2e0a  fault is False..
+0000e840: 2020 2020 2020 2020 6973 5f63 6f6d 7061          is_compa
+0000e850: 6374 5f66 6320 3a20 626f 6f6c 0a20 2020  ct_fc : bool.   
+0000e860: 2020 2020 2020 2020 2066 6333 2073 6861           fc3 sha
+0000e870: 7065 2069 730a 2020 2020 2020 2020 2020  pe is.          
+0000e880: 2020 2020 2020 4661 6c73 653a 2028 7375        False: (su
+0000e890: 7065 7263 656c 6c2c 2073 7570 6572 6365  percell, superce
+0000e8a0: 6c6c 2c20 7375 7065 6365 6c6c 2c20 332c  ll, supecell, 3,
+0000e8b0: 2033 2c20 3329 0a20 2020 2020 2020 2020   3, 3).         
+0000e8c0: 2020 2020 2020 2054 7275 653a 2028 7072         True: (pr
+0000e8d0: 696d 6974 6976 652c 2073 7570 6572 6365  imitive, superce
+0000e8e0: 6c6c 2c20 7375 7065 6365 6c6c 2c20 332c  ll, supecell, 3,
+0000e8f0: 2033 2c20 3329 0a20 2020 2020 2020 2020   3, 3).         
+0000e900: 2020 2077 6865 7265 2027 7375 7065 7263     where 'superc
+0000e910: 656c 6c27 2061 6e64 2027 7072 696d 6974  ell' and 'primit
+0000e920: 6976 6527 2069 6e64 6963 6174 6520 6e75  ive' indicate nu
+0000e930: 6d62 6572 206f 6620 6174 6f6d 7320 696e  mber of atoms in
+0000e940: 2074 6865 7365 0a20 2020 2020 2020 2020   these.         
+0000e950: 2020 2063 656c 6c73 2e20 4465 6661 756c     cells. Defaul
+0000e960: 7420 6973 2046 616c 7365 2e0a 2020 2020  t is False..    
+0000e970: 2020 2020 6663 5f63 616c 6375 6c61 746f      fc_calculato
+0000e980: 7220 3a20 7374 7220 6f72 204e 6f6e 650a  r : str or None.
+0000e990: 2020 2020 2020 2020 2020 2020 466f 7263              Forc
+0000e9a0: 6520 636f 6e73 7461 6e74 7320 6361 6c63  e constants calc
+0000e9b0: 756c 6174 6f72 2067 6976 656e 2062 7920  ulator given by 
+0000e9c0: 7374 722e 0a20 2020 2020 2020 2066 635f  str..        fc_
+0000e9d0: 6361 6c63 756c 6174 6f72 5f6f 7074 696f  calculator_optio
+0000e9e0: 6e73 203a 2064 6963 740a 2020 2020 2020  ns : dict.      
+0000e9f0: 2020 2020 2020 4f70 7469 6f6e 7320 666f        Options fo
+0000ea00: 7220 6578 7465 726e 616c 2066 6f72 6365  r external force
+0000ea10: 2063 6f6e 7374 616e 7473 2063 616c 6375   constants calcu
+0000ea20: 6c61 746f 722e 0a0a 2020 2020 2020 2020  lator...        
+0000ea30: 2222 220a 2020 2020 2020 2020 6469 7370  """.        disp
+0000ea40: 5f64 6174 6173 6574 203d 2073 656c 662e  _dataset = self.
+0000ea50: 5f64 6174 6173 6574 0a0a 2020 2020 2020  _dataset..      
+0000ea60: 2020 6663 335f 6361 6c63 756c 6174 6f72    fc3_calculator
+0000ea70: 2c20 6663 335f 6361 6c63 756c 6174 6f72  , fc3_calculator
+0000ea80: 5f6f 7074 696f 6e73 203d 2073 656c 662e  _options = self.
+0000ea90: 5f65 7874 7261 6374 5f66 6332 5f66 6333  _extract_fc2_fc3
+0000eaa0: 5f63 616c 6375 6c61 746f 7273 280a 2020  _calculators(.  
+0000eab0: 2020 2020 2020 2020 2020 6663 5f63 616c            fc_cal
+0000eac0: 6375 6c61 746f 722c 2066 635f 6361 6c63  culator, fc_calc
+0000ead0: 756c 6174 6f72 5f6f 7074 696f 6e73 2c20  ulator_options, 
+0000eae0: 330a 2020 2020 2020 2020 290a 0a20 2020  3.        )..   
+0000eaf0: 2020 2020 2069 6620 6663 335f 6361 6c63       if fc3_calc
+0000eb00: 756c 6174 6f72 2069 7320 6e6f 7420 4e6f  ulator is not No
+0000eb10: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000eb20: 6469 7370 732c 2066 6f72 6365 7320 3d20  disps, forces = 
+0000eb30: 6765 745f 6469 7370 6c61 6365 6d65 6e74  get_displacement
+0000eb40: 735f 616e 645f 666f 7263 6573 5f66 6333  s_and_forces_fc3
+0000eb50: 2864 6973 705f 6461 7461 7365 7429 0a20  (disp_dataset). 
+0000eb60: 2020 2020 2020 2020 2020 2066 6332 2c20             fc2, 
+0000eb70: 6663 3320 3d20 6765 745f 6663 3328 0a20  fc3 = get_fc3(. 
+0000eb80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000eb90: 656c 662e 5f73 7570 6572 6365 6c6c 2c0a  elf._supercell,.
+0000eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ebb0: 7365 6c66 2e5f 7072 696d 6974 6976 652c  self._primitive,
+0000ebc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ebd0: 2064 6973 7073 2c0a 2020 2020 2020 2020   disps,.        
+0000ebe0: 2020 2020 2020 2020 666f 7263 6573 2c0a          forces,.
+0000ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec00: 6663 5f63 616c 6375 6c61 746f 723d 6663  fc_calculator=fc
+0000ec10: 335f 6361 6c63 756c 6174 6f72 2c0a 2020  3_calculator,.  
+0000ec20: 2020 2020 2020 2020 2020 2020 2020 6663                fc
+0000ec30: 5f63 616c 6375 6c61 746f 725f 6f70 7469  _calculator_opti
+0000ec40: 6f6e 733d 6663 335f 6361 6c63 756c 6174  ons=fc3_calculat
+0000ec50: 6f72 5f6f 7074 696f 6e73 2c0a 2020 2020  or_options,.    
+0000ec60: 2020 2020 2020 2020 2020 2020 6973 5f63              is_c
+0000ec70: 6f6d 7061 6374 5f66 633d 6973 5f63 6f6d  ompact_fc=is_com
+0000ec80: 7061 6374 5f66 632c 0a20 2020 2020 2020  pact_fc,.       
+0000ec90: 2020 2020 2020 2020 206c 6f67 5f6c 6576           log_lev
+0000eca0: 656c 3d73 656c 662e 5f6c 6f67 5f6c 6576  el=self._log_lev
+0000ecb0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+0000ecc0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000ecd0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
+0000ece0: 6469 7370 6c61 6365 6d65 6e74 7322 2069  displacements" i
+0000ecf0: 6e20 6469 7370 5f64 6174 6173 6574 3a0a  n disp_dataset:.
+0000ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed10: 6d73 6720 3d20 280a 2020 2020 2020 2020  msg = (.        
+0000ed20: 2020 2020 2020 2020 2020 2020 2266 635f              "fc_
+0000ed30: 6361 6c63 756c 6174 6f72 2068 6173 2074  calculator has t
+0000ed40: 6f20 6265 2073 6574 2074 6f20 7072 6f64  o be set to prod
+0000ed50: 7563 6520 666f 7263 6520 220a 2020 2020  uce force ".    
+0000ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed70: 2263 6f6e 7374 616e 7320 6672 6f6d 2074  "constans from t
+0000ed80: 6869 7320 6461 7461 7365 742e 220a 2020  his dataset.".  
+0000ed90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
 0000eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000edb0: 2020 2020 7365 745f 7472 616e 736c 6174      set_translat
-0000edc0: 696f 6e61 6c5f 696e 7661 7269 616e 6365  ional_invariance
-0000edd0: 5f66 6333 2866 6333 290a 2020 2020 2020  _fc3(fc3).      
-0000ede0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000edf0: 745f 7065 726d 7574 6174 696f 6e5f 7379  t_permutation_sy
-0000ee00: 6d6d 6574 7279 5f66 6333 2866 6333 290a  mmetry_fc3(fc3).
-0000ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee20: 2020 2020 6966 2073 656c 662e 5f66 6332      if self._fc2
-0000ee30: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee50: 2020 7379 6d6d 6574 7269 7a65 5f66 6f72    symmetrize_for
-0000ee60: 6365 5f63 6f6e 7374 616e 7473 2866 6332  ce_constants(fc2
-0000ee70: 290a 0a20 2020 2020 2020 2023 2053 6574  )..        # Set
-0000ee80: 2066 6332 2061 6e64 2066 6333 0a20 2020   fc2 and fc3.   
-0000ee90: 2020 2020 2073 656c 662e 5f66 6333 203d       self._fc3 =
-0000eea0: 2066 6333 0a0a 2020 2020 2020 2020 2320   fc3..        # 
-0000eeb0: 6663 3220 6173 206f 6274 6169 6e65 6420  fc2 as obtained 
-0000eec0: 6162 6f76 6520 7769 6c6c 206e 6f74 2062  above will not b
-0000eed0: 6520 7365 7420 7768 656e 2022 7c22 2069  e set when "|" i
-0000eee0: 6e20 6663 2d63 616c 6375 6c61 746f 7220  n fc-calculator 
-0000eef0: 7365 7474 696e 672e 0a20 2020 2020 2020  setting..       
-0000ef00: 2069 6620 6663 5f63 616c 6375 6c61 746f   if fc_calculato
-0000ef10: 7220 6973 206e 6f74 204e 6f6e 6520 616e  r is not None an
-0000ef20: 6420 227c 2220 696e 2066 635f 6361 6c63  d "|" in fc_calc
-0000ef30: 756c 6174 6f72 3a0a 2020 2020 2020 2020  ulator:.        
-0000ef40: 2020 2020 6663 3220 3d20 4e6f 6e65 0a20      fc2 = None. 
-0000ef50: 2020 2020 2020 2069 6620 6663 5f63 616c         if fc_cal
-0000ef60: 6375 6c61 746f 725f 6f70 7469 6f6e 7320  culator_options 
-0000ef70: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-0000ef80: 227c 2220 696e 2066 635f 6361 6c63 756c  "|" in fc_calcul
-0000ef90: 6174 6f72 5f6f 7074 696f 6e73 3a0a 2020  ator_options:.  
-0000efa0: 2020 2020 2020 2020 2020 6663 3220 3d20            fc2 = 
-0000efb0: 4e6f 6e65 0a0a 2020 2020 2020 2020 2320  None..        # 
-0000efc0: 4e6f 726d 616c 6c79 2073 656c 662e 5f66  Normally self._f
-0000efd0: 6332 2069 7320 6f76 6572 7772 6974 7465  c2 is overwritte
-0000efe0: 6e20 696e 2070 726f 6475 6365 5f66 6332  n in produce_fc2
-0000eff0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0000f000: 2e5f 6663 3220 6973 204e 6f6e 653a 0a20  ._fc2 is None:. 
-0000f010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000f020: 5f66 6332 203d 2066 6332 0a0a 2020 2020  _fc2 = fc2..    
-0000f030: 6465 6620 7072 6f64 7563 655f 6663 3228  def produce_fc2(
-0000f040: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000f050: 2020 2020 2020 2073 796d 6d65 7472 697a         symmetriz
-0000f060: 655f 6663 323d 4661 6c73 652c 0a20 2020  e_fc2=False,.   
-0000f070: 2020 2020 2069 735f 636f 6d70 6163 745f       is_compact_
-0000f080: 6663 3d46 616c 7365 2c0a 2020 2020 2020  fc=False,.      
-0000f090: 2020 6663 5f63 616c 6375 6c61 746f 723d    fc_calculator=
-0000f0a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6663  None,.        fc
-0000f0b0: 5f63 616c 6375 6c61 746f 725f 6f70 7469  _calculator_opti
-0000f0c0: 6f6e 733d 4e6f 6e65 2c0a 2020 2020 293a  ons=None,.    ):
-0000f0d0: 0a20 2020 2020 2020 2022 2222 4361 6c63  .        """Calc
-0000f0e0: 756c 6174 6520 6663 3220 6672 6f6d 2064  ulate fc2 from d
-0000f0f0: 6973 706c 6163 656d 656e 7473 2061 6e64  isplacements and
-0000f100: 2066 6f72 6365 732e 0a0a 2020 2020 2020   forces...      
-0000f110: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0000f120: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0000f130: 2020 2020 2020 2020 7379 6d6d 6574 7269          symmetri
-0000f140: 7a65 5f66 6332 203a 2062 6f6f 6c0a 2020  ze_fc2 : bool.  
-0000f150: 2020 2020 2020 2020 2020 4f6e 6c79 2066            Only f
-0000f160: 6f72 2074 7970 6520 3120 6469 7370 6c61  or type 1 displa
-0000f170: 6365 6d65 6e74 5f64 6174 6173 6574 2c20  cement_dataset, 
-0000f180: 7472 616e 736c 6174 696f 6e61 6c20 616e  translational an
-0000f190: 640a 2020 2020 2020 2020 2020 2020 7065  d.            pe
-0000f1a0: 726d 7574 6174 696f 6e20 7379 6d6d 6574  rmutation symmet
-0000f1b0: 7269 6573 2061 7265 2061 7070 6c69 6564  ries are applied
-0000f1c0: 2061 6674 6572 2063 7265 6174 696e 6720   after creating 
-0000f1d0: 6663 332e 2054 6869 730a 2020 2020 2020  fc3. This.      
-0000f1e0: 2020 2020 2020 7379 6d6d 6574 7269 7a61        symmetriza
-0000f1f0: 7469 6f6e 2069 7320 6e6f 7420 7665 7279  tion is not very
-0000f200: 2073 6f70 6869 7374 6963 6174 6564 2061   sophisticated a
-0000f210: 6e64 2063 616e 2062 7265 616b 2073 7061  nd can break spa
-0000f220: 6365 0a20 2020 2020 2020 2020 2020 2067  ce.            g
-0000f230: 726f 7570 2073 796d 6d65 7472 792c 2062  roup symmetry, b
-0000f240: 7574 206f 6674 656e 2075 7365 6675 6c2e  ut often useful.
-0000f250: 2049 6620 6265 7474 6572 2073 796d 6d65   If better symme
-0000f260: 7472 697a 6174 696f 6e20 6973 0a20 2020  trization is.   
-0000f270: 2020 2020 2020 2020 2065 7870 6563 7465           expecte
-0000f280: 642c 2069 7420 6973 2072 6563 6f6d 6d65  d, it is recomme
-0000f290: 6e64 6564 2074 6f20 7573 6520 6578 7465  nded to use exte
-0000f2a0: 726e 616c 2066 6f72 6365 2063 6f6e 7374  rnal force const
-0000f2b0: 616e 7473 0a20 2020 2020 2020 2020 2020  ants.           
-0000f2c0: 2063 616c 6375 6c61 746f 7220 7375 6368   calculator such
-0000f2d0: 2061 7320 414c 4d2e 2044 6566 6175 6c74   as ALM. Default
-0000f2e0: 2069 7320 4661 6c73 652e 0a20 2020 2020   is False..     
-0000f2f0: 2020 2069 735f 636f 6d70 6163 745f 6663     is_compact_fc
-0000f300: 203a 2062 6f6f 6c0a 2020 2020 2020 2020   : bool.        
-0000f310: 2020 2020 6663 3220 7368 6170 6520 6973      fc2 shape is
-0000f320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f330: 2046 616c 7365 3a20 2873 7570 6572 6365   False: (superce
-0000f340: 6c6c 2c20 7375 7065 6365 6c6c 2c20 332c  ll, supecell, 3,
-0000f350: 2033 290a 2020 2020 2020 2020 2020 2020   3).            
-0000f360: 2020 2020 5472 7565 3a20 2870 7269 6d69      True: (primi
-0000f370: 7469 7665 2c20 7375 7065 6365 6c6c 2c20  tive, supecell, 
-0000f380: 332c 2033 290a 2020 2020 2020 2020 2020  3, 3).          
-0000f390: 2020 7768 6572 6520 2773 7570 6572 6365    where 'superce
-0000f3a0: 6c6c 2720 616e 6420 2770 7269 6d69 7469  ll' and 'primiti
-0000f3b0: 7665 2720 696e 6469 6361 7465 206e 756d  ve' indicate num
-0000f3c0: 6265 7220 6f66 2061 746f 6d73 2069 6e20  ber of atoms in 
-0000f3d0: 7468 6573 650a 2020 2020 2020 2020 2020  these.          
-0000f3e0: 2020 6365 6c6c 732e 2044 6566 6175 6c74    cells. Default
-0000f3f0: 2069 7320 4661 6c73 652e 0a20 2020 2020   is False..     
-0000f400: 2020 2066 635f 6361 6c63 756c 6174 6f72     fc_calculator
-0000f410: 203a 2073 7472 206f 7220 4e6f 6e65 0a20   : str or None. 
-0000f420: 2020 2020 2020 2020 2020 2046 6f72 6365             Force
-0000f430: 2063 6f6e 7374 616e 7473 2063 616c 6375   constants calcu
-0000f440: 6c61 746f 7220 6769 7665 6e20 6279 2073  lator given by s
-0000f450: 7472 2e0a 2020 2020 2020 2020 6663 5f63  tr..        fc_c
-0000f460: 616c 6375 6c61 746f 725f 6f70 7469 6f6e  alculator_option
-0000f470: 7320 3a20 6469 6374 0a20 2020 2020 2020  s : dict.       
-0000f480: 2020 2020 204f 7074 696f 6e73 2066 6f72       Options for
-0000f490: 2065 7874 6572 6e61 6c20 666f 7263 6520   external force 
-0000f4a0: 636f 6e73 7461 6e74 7320 6361 6c63 756c  constants calcul
-0000f4b0: 6174 6f72 2e0a 0a20 2020 2020 2020 2022  ator...        "
-0000f4c0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-0000f4d0: 6c66 2e5f 7068 6f6e 6f6e 5f64 6174 6173  lf._phonon_datas
-0000f4e0: 6574 2069 7320 4e6f 6e65 3a0a 2020 2020  et is None:.    
-0000f4f0: 2020 2020 2020 2020 6469 7370 5f64 6174          disp_dat
-0000f500: 6173 6574 203d 2073 656c 662e 5f64 6174  aset = self._dat
-0000f510: 6173 6574 0a20 2020 2020 2020 2065 6c73  aset.        els
-0000f520: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0000f530: 6973 705f 6461 7461 7365 7420 3d20 7365  isp_dataset = se
-0000f540: 6c66 2e5f 7068 6f6e 6f6e 5f64 6174 6173  lf._phonon_datas
-0000f550: 6574 0a0a 2020 2020 2020 2020 6966 2069  et..        if i
-0000f560: 735f 636f 6d70 6163 745f 6663 3a0a 2020  s_compact_fc:.  
-0000f570: 2020 2020 2020 2020 2020 7032 735f 6d61            p2s_ma
-0000f580: 7020 3d20 7365 6c66 2e5f 7068 6f6e 6f6e  p = self._phonon
-0000f590: 5f70 7269 6d69 7469 7665 2e70 3273 5f6d  _primitive.p2s_m
-0000f5a0: 6170 0a20 2020 2020 2020 2065 6c73 653a  ap.        else:
-0000f5b0: 0a20 2020 2020 2020 2020 2020 2070 3273  .            p2s
-0000f5c0: 5f6d 6170 203d 204e 6f6e 650a 0a20 2020  _map = None..   
-0000f5d0: 2020 2020 2066 6332 5f63 616c 6375 6c61       fc2_calcula
-0000f5e0: 746f 722c 2066 6332 5f63 616c 6375 6c61  tor, fc2_calcula
-0000f5f0: 746f 725f 6f70 7469 6f6e 7320 3d20 7365  tor_options = se
-0000f600: 6c66 2e5f 6578 7472 6163 745f 6663 325f  lf._extract_fc2_
-0000f610: 6663 335f 6361 6c63 756c 6174 6f72 7328  fc3_calculators(
-0000f620: 0a20 2020 2020 2020 2020 2020 2066 635f  .            fc_
-0000f630: 6361 6c63 756c 6174 6f72 2c20 6663 5f63  calculator, fc_c
-0000f640: 616c 6375 6c61 746f 725f 6f70 7469 6f6e  alculator_option
-0000f650: 732c 2032 0a20 2020 2020 2020 2029 0a0a  s, 2.        )..
-0000f660: 2020 2020 2020 2020 6966 2066 6332 5f63          if fc2_c
-0000f670: 616c 6375 6c61 746f 7220 6973 206e 6f74  alculator is not
-0000f680: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000f690: 2020 2064 6973 7073 2c20 666f 7263 6573     disps, forces
-0000f6a0: 203d 2067 6574 5f64 6973 706c 6163 656d   = get_displacem
-0000f6b0: 656e 7473 5f61 6e64 5f66 6f72 6365 7328  ents_and_forces(
-0000f6c0: 6469 7370 5f64 6174 6173 6574 290a 2020  disp_dataset).  
-0000f6d0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000f6e0: 6663 3220 3d20 6765 745f 6663 3228 0a20  fc2 = get_fc2(. 
-0000f6f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000f700: 656c 662e 5f70 686f 6e6f 6e5f 7375 7065  elf._phonon_supe
-0000f710: 7263 656c 6c2c 0a20 2020 2020 2020 2020  rcell,.         
-0000f720: 2020 2020 2020 2073 656c 662e 5f70 686f         self._pho
-0000f730: 6e6f 6e5f 7072 696d 6974 6976 652c 0a20  non_primitive,. 
-0000f740: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000f750: 6973 7073 2c0a 2020 2020 2020 2020 2020  isps,.          
-0000f760: 2020 2020 2020 666f 7263 6573 2c0a 2020        forces,.  
-0000f770: 2020 2020 2020 2020 2020 2020 2020 6663                fc
-0000f780: 5f63 616c 6375 6c61 746f 723d 6663 325f  _calculator=fc2_
-0000f790: 6361 6c63 756c 6174 6f72 2c0a 2020 2020  calculator,.    
-0000f7a0: 2020 2020 2020 2020 2020 2020 6663 5f63              fc_c
-0000f7b0: 616c 6375 6c61 746f 725f 6f70 7469 6f6e  alculator_option
-0000f7c0: 733d 6663 325f 6361 6c63 756c 6174 6f72  s=fc2_calculator
-0000f7d0: 5f6f 7074 696f 6e73 2c0a 2020 2020 2020  _options,.      
-0000f7e0: 2020 2020 2020 2020 2020 6174 6f6d 5f6c            atom_l
-0000f7f0: 6973 743d 7032 735f 6d61 702c 0a20 2020  ist=p2s_map,.   
-0000f800: 2020 2020 2020 2020 2020 2020 206c 6f67               log
-0000f810: 5f6c 6576 656c 3d73 656c 662e 5f6c 6f67  _level=self._log
-0000f820: 5f6c 6576 656c 2c0a 2020 2020 2020 2020  _level,.        
-0000f830: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-0000f840: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000f850: 6966 2022 6469 7370 6c61 6365 6d65 6e74  if "displacement
-0000f860: 7322 2069 6e20 6469 7370 5f64 6174 6173  s" in disp_datas
-0000f870: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
-0000f880: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
-0000f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8a0: 2266 635f 6361 6c63 756c 6174 6f72 2068  "fc_calculator h
-0000f8b0: 6173 2074 6f20 6265 2073 6574 2074 6f20  as to be set to 
-0000f8c0: 7072 6f64 7563 6520 666f 7263 6520 220a  produce force ".
-0000f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8e0: 2020 2020 2263 6f6e 7374 616e 7320 6672      "constans fr
-0000f8f0: 6f6d 2074 6869 7320 6461 7461 7365 7420  om this dataset 
-0000f900: 666f 7220 6663 322e 220a 2020 2020 2020  for fc2.".      
-0000f910: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000f920: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000f930: 6520 5275 6e74 696d 6545 7272 6f72 286d  e RuntimeError(m
-0000f940: 7367 290a 2020 2020 2020 2020 2020 2020  sg).            
-0000f950: 7365 6c66 2e5f 6663 3220 3d20 6765 745f  self._fc2 = get_
-0000f960: 7068 6f6e 6f70 795f 6663 3228 0a20 2020  phonopy_fc2(.   
-0000f970: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000f980: 662e 5f70 686f 6e6f 6e5f 7375 7065 7263  f._phonon_superc
-0000f990: 656c 6c2c 0a20 2020 2020 2020 2020 2020  ell,.           
-0000f9a0: 2020 2020 2073 656c 662e 5f70 686f 6e6f       self._phono
-0000f9b0: 6e5f 7375 7065 7263 656c 6c5f 7379 6d6d  n_supercell_symm
-0000f9c0: 6574 7279 2c0a 2020 2020 2020 2020 2020  etry,.          
-0000f9d0: 2020 2020 2020 6469 7370 5f64 6174 6173        disp_datas
-0000f9e0: 6574 2c0a 2020 2020 2020 2020 2020 2020  et,.            
-0000f9f0: 2020 2020 6174 6f6d 5f6c 6973 743d 7032      atom_list=p2
-0000fa00: 735f 6d61 702c 0a20 2020 2020 2020 2020  s_map,.         
-0000fa10: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000fa20: 2069 6620 7379 6d6d 6574 7269 7a65 5f66   if symmetrize_f
-0000fa30: 6332 3a0a 2020 2020 2020 2020 2020 2020  c2:.            
-0000fa40: 2020 2020 6966 2069 735f 636f 6d70 6163      if is_compac
-0000fa50: 745f 6663 3a0a 2020 2020 2020 2020 2020  t_fc:.          
-0000fa60: 2020 2020 2020 2020 2020 7379 6d6d 6574            symmet
-0000fa70: 7269 7a65 5f63 6f6d 7061 6374 5f66 6f72  rize_compact_for
-0000fa80: 6365 5f63 6f6e 7374 616e 7473 280a 2020  ce_constants(.  
-0000fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000faa0: 2020 2020 2020 7365 6c66 2e5f 6663 322c        self._fc2,
-0000fab0: 2073 656c 662e 5f70 686f 6e6f 6e5f 7072   self._phonon_pr
-0000fac0: 696d 6974 6976 650a 2020 2020 2020 2020  imitive.        
-0000fad0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000fae0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0000faf0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000fb00: 2020 2020 2020 2020 7379 6d6d 6574 7269          symmetri
-0000fb10: 7a65 5f66 6f72 6365 5f63 6f6e 7374 616e  ze_force_constan
-0000fb20: 7473 2873 656c 662e 5f66 6332 290a 0a20  ts(self._fc2).. 
-0000fb30: 2020 2064 6566 2063 7574 6f66 665f 6663     def cutoff_fc
-0000fb40: 335f 6279 5f7a 6572 6f28 7365 6c66 2c20  3_by_zero(self, 
-0000fb50: 6375 746f 6666 5f64 6973 7461 6e63 652c  cutoff_distance,
-0000fb60: 2066 6333 3d4e 6f6e 6529 3a0a 2020 2020   fc3=None):.    
-0000fb70: 2020 2020 2222 2253 6574 207a 6572 6f20      """Set zero 
-0000fb80: 746f 2066 6333 2065 6c65 6d65 6e74 7320  to fc3 elements 
-0000fb90: 6f75 7420 6f66 2063 7574 6f66 6620 6469  out of cutoff di
-0000fba0: 7374 616e 6365 2e0a 0a20 2020 2020 2020  stance...       
-0000fbb0: 204e 6f74 650a 2020 2020 2020 2020 2d2d   Note.        --
-0000fbc0: 2d2d 0a20 2020 2020 2020 2066 6333 2069  --.        fc3 i
-0000fbd0: 7320 6f76 6572 7772 6974 7465 6e2e 0a0a  s overwritten...
-0000fbe0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000fbf0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000fc00: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6375  -----.        cu
-0000fc10: 746f 6666 5f64 6973 7461 6e63 6520 3a20  toff_distance : 
-0000fc20: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-0000fc30: 2020 4166 7465 7220 6372 6561 7469 6e67    After creating
-0000fc40: 2066 6f72 6365 2063 6f6e 7374 616e 7473   force constants
-0000fc50: 2c20 6663 2065 6c65 6d65 6e74 7320 7768  , fc elements wh
-0000fc60: 6572 6520 616e 7920 7061 6972 0a20 2020  ere any pair.   
-0000fc70: 2020 2020 2020 2020 2064 6973 7461 6e63           distanc
-0000fc80: 6520 696e 2061 746f 6d20 7472 6970 6c65  e in atom triple
-0000fc90: 7473 206c 6172 6765 7220 7468 616e 2063  ts larger than c
-0000fca0: 7574 6f66 665f 6469 7374 616e 6365 2061  utoff_distance a
-0000fcb0: 7265 2073 6574 207a 6572 6f2e 0a0a 2020  re set zero...  
-0000fcc0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000fcd0: 2020 6966 2066 6333 2069 7320 4e6f 6e65    if fc3 is None
-0000fce0: 3a0a 2020 2020 2020 2020 2020 2020 5f66  :.            _f
-0000fcf0: 6333 203d 2073 656c 662e 5f66 6333 0a20  c3 = self._fc3. 
-0000fd00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000fd10: 2020 2020 2020 2020 205f 6663 3320 3d20           _fc3 = 
-0000fd20: 6663 330a 2020 2020 2020 2020 6375 746f  fc3.        cuto
-0000fd30: 6666 5f66 6333 5f62 795f 7a65 726f 280a  ff_fc3_by_zero(.
-0000fd40: 2020 2020 2020 2020 2020 2020 5f66 6333              _fc3
-0000fd50: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-0000fd60: 6c66 2e5f 7375 7065 7263 656c 6c2c 0a20  lf._supercell,. 
-0000fd70: 2020 2020 2020 2020 2020 2063 7574 6f66             cutof
-0000fd80: 665f 6469 7374 616e 6365 2c0a 2020 2020  f_distance,.    
-0000fd90: 2020 2020 2020 2020 7032 735f 6d61 703d          p2s_map=
-0000fda0: 7365 6c66 2e5f 7072 696d 6974 6976 652e  self._primitive.
-0000fdb0: 7032 735f 6d61 702c 0a20 2020 2020 2020  p2s_map,.       
-0000fdc0: 2020 2020 2073 796d 7072 6563 3d73 656c       symprec=sel
-0000fdd0: 662e 5f73 796d 7072 6563 2c0a 2020 2020  f._symprec,.    
-0000fde0: 2020 2020 290a 0a20 2020 2064 6566 2073      )..    def s
-0000fdf0: 6574 5f70 6572 6d75 7461 7469 6f6e 5f73  et_permutation_s
-0000fe00: 796d 6d65 7472 7928 7365 6c66 293a 0a20  ymmetry(self):. 
-0000fe10: 2020 2020 2020 2022 2222 456e 666f 7263         """Enforc
-0000fe20: 6520 7065 726d 7574 6174 696f 6e20 7379  e permutation sy
-0000fe30: 6d6d 6574 7279 2074 6f20 6663 3220 616e  mmetry to fc2 an
-0000fe40: 6420 6663 332e 2222 220a 2020 2020 2020  d fc3.""".      
-0000fe50: 2020 6966 2073 656c 662e 5f66 6332 2069    if self._fc2 i
-0000fe60: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000fe70: 2020 2020 2020 2020 7365 745f 7065 726d          set_perm
-0000fe80: 7574 6174 696f 6e5f 7379 6d6d 6574 7279  utation_symmetry
-0000fe90: 2873 656c 662e 5f66 6332 290a 2020 2020  (self._fc2).    
-0000fea0: 2020 2020 6966 2073 656c 662e 5f66 6333      if self._fc3
-0000feb0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000fec0: 2020 2020 2020 2020 2020 7365 745f 7065            set_pe
-0000fed0: 726d 7574 6174 696f 6e5f 7379 6d6d 6574  rmutation_symmet
-0000fee0: 7279 5f66 6333 2873 656c 662e 5f66 6333  ry_fc3(self._fc3
-0000fef0: 290a 0a20 2020 2064 6566 2073 6574 5f74  )..    def set_t
-0000ff00: 7261 6e73 6c61 7469 6f6e 616c 5f69 6e76  ranslational_inv
-0000ff10: 6172 6961 6e63 6528 7365 6c66 293a 0a20  ariance(self):. 
-0000ff20: 2020 2020 2020 2022 2222 456e 666f 7263         """Enforc
-0000ff30: 6520 7472 616e 736c 6174 696f 6e20 696e  e translation in
-0000ff40: 7661 7269 616e 6365 2e0a 0a20 2020 2020  variance...     
-0000ff50: 2020 2054 6869 7320 7375 6274 7261 6374     This subtract
-0000ff60: 7320 6472 6966 7420 6469 7669 6465 6420  s drift divided 
-0000ff70: 6279 206e 756d 6265 7220 6f66 2065 6c65  by number of ele
-0000ff80: 6d65 6e74 7320 696e 2065 6163 6820 726f  ments in each ro
-0000ff90: 7720 616e 640a 2020 2020 2020 2020 636f  w and.        co
-0000ffa0: 6c75 6d6e 2e0a 0a20 2020 2020 2020 2022  lumn...        "
-0000ffb0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-0000ffc0: 6c66 2e5f 6663 3220 6973 206e 6f74 204e  lf._fc2 is not N
-0000ffd0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000ffe0: 2073 6574 5f74 7261 6e73 6c61 7469 6f6e   set_translation
-0000fff0: 616c 5f69 6e76 6172 6961 6e63 6528 7365  al_invariance(se
-00010000: 6c66 2e5f 6663 3229 0a20 2020 2020 2020  lf._fc2).       
-00010010: 2069 6620 7365 6c66 2e5f 6663 3320 6973   if self._fc3 is
-00010020: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00010030: 2020 2020 2020 2073 6574 5f74 7261 6e73         set_trans
-00010040: 6c61 7469 6f6e 616c 5f69 6e76 6172 6961  lational_invaria
-00010050: 6e63 655f 6663 3328 7365 6c66 2e5f 6663  nce_fc3(self._fc
-00010060: 3329 0a0a 2020 2020 6465 6620 7275 6e5f  3)..    def run_
-00010070: 696d 6167 5f73 656c 665f 656e 6572 6779  imag_self_energy
-00010080: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00010090: 2020 2020 2020 2020 6772 6964 5f70 6f69          grid_poi
-000100a0: 6e74 732c 0a20 2020 2020 2020 2074 656d  nts,.        tem
-000100b0: 7065 7261 7475 7265 732c 0a20 2020 2020  peratures,.     
-000100c0: 2020 2066 7265 7175 656e 6379 5f70 6f69     frequency_poi
-000100d0: 6e74 733d 4e6f 6e65 2c0a 2020 2020 2020  nts=None,.      
-000100e0: 2020 6672 6571 7565 6e63 795f 7374 6570    frequency_step
-000100f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00010100: 756d 5f66 7265 7175 656e 6379 5f70 6f69  um_frequency_poi
-00010110: 6e74 733d 4e6f 6e65 2c0a 2020 2020 2020  nts=None,.      
-00010120: 2020 6e75 6d5f 706f 696e 7473 5f69 6e5f    num_points_in_
-00010130: 6261 7463 683d 4e6f 6e65 2c0a 2020 2020  batch=None,.    
-00010140: 2020 2020 6672 6571 7565 6e63 795f 706f      frequency_po
-00010150: 696e 7473 5f61 745f 6261 6e64 733d 4661  ints_at_bands=Fa
-00010160: 6c73 652c 0a20 2020 2020 2020 2073 6361  lse,.        sca
-00010170: 7474 6572 696e 675f 6576 656e 745f 636c  ttering_event_cl
-00010180: 6173 733d 4e6f 6e65 2c0a 2020 2020 2020  ass=None,.      
-00010190: 2020 7772 6974 655f 7478 743d 4661 6c73    write_txt=Fals
-000101a0: 652c 0a20 2020 2020 2020 2077 7269 7465  e,.        write
-000101b0: 5f67 616d 6d61 5f64 6574 6169 6c3d 4661  _gamma_detail=Fa
-000101c0: 6c73 652c 0a20 2020 2020 2020 206b 6565  lse,.        kee
-000101d0: 705f 6761 6d6d 615f 6465 7461 696c 3d46  p_gamma_detail=F
-000101e0: 616c 7365 2c0a 2020 2020 2020 2020 6f75  alse,.        ou
-000101f0: 7470 7574 5f66 696c 656e 616d 653d 4e6f  tput_filename=No
-00010200: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00010210: 2020 2022 2222 4361 6c63 756c 6174 6520     """Calculate 
-00010220: 696d 6167 696e 6172 7920 7061 7274 206f  imaginary part o
-00010230: 6620 7365 6c66 2d65 6e65 7267 7920 6f66  f self-energy of
-00010240: 2062 7562 626c 6520 6469 6167 7261 6d20   bubble diagram 
-00010250: 2847 616d 6d61 292e 0a0a 2020 2020 2020  (Gamma)...      
-00010260: 2020 5069 203d 2044 656c 7461 202d 2069    Pi = Delta - i
-00010270: 2047 616d 6d61 2e0a 0a20 2020 2020 2020   Gamma...       
-00010280: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00010290: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000102a0: 2020 2020 2020 2067 7269 645f 706f 696e         grid_poin
-000102b0: 7473 203a 2061 7272 6179 5f6c 696b 650a  ts : array_like.
-000102c0: 2020 2020 2020 2020 2020 2020 4772 6964              Grid
-000102d0: 2d70 6f69 6e74 2069 6e64 6963 6573 2077  -point indices w
-000102e0: 6865 7265 2069 6d61 6769 6e61 7279 2070  here imaginary p
-000102f0: 6172 7420 6f66 2073 656c 662d 656e 6572  art of self-ener
-00010300: 6769 6573 2061 7265 0a20 2020 2020 2020  gies are.       
-00010310: 2020 2020 2063 6163 6c63 756c 6174 6564       caclculated
-00010320: 2e0a 2020 2020 2020 2020 2020 2020 6474  ..            dt
-00010330: 7970 653d 696e 742c 2073 6861 7065 3d28  ype=int, shape=(
-00010340: 6772 6964 5f70 6f69 6e74 732c 290a 2020  grid_points,).  
-00010350: 2020 2020 2020 7465 6d70 6572 6174 7572        temperatur
-00010360: 6573 203a 2061 7272 6179 5f6c 696b 650a  es : array_like.
-00010370: 2020 2020 2020 2020 2020 2020 5465 6d70              Temp
-00010380: 6572 6174 7572 6573 2077 6865 7265 2069  eratures where i
-00010390: 6d61 6769 6e61 7279 2070 6172 7420 6f66  maginary part of
-000103a0: 2073 656c 662d 656e 6572 6769 6573 2061   self-energies a
-000103b0: 7265 2063 616c 6375 6c61 7465 642e 0a20  re calculated.. 
-000103c0: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-000103d0: 3d66 6c6f 6174 2c20 7368 6170 653d 2874  =float, shape=(t
-000103e0: 656d 7065 7261 7475 7265 732c 290a 2020  emperatures,).  
-000103f0: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
-00010400: 706f 696e 7473 203a 2061 7272 6179 5f6c  points : array_l
-00010410: 696b 652c 206f 7074 696f 6e61 6c0a 2020  ike, optional.  
-00010420: 2020 2020 2020 2020 2020 4672 6571 7565            Freque
-00010430: 6e63 7920 7361 6d70 6c69 6e67 2070 6f69  ncy sampling poi
-00010440: 6e74 732e 2044 6566 6175 6c74 2069 7320  nts. Default is 
-00010450: 4e6f 6e65 2e20 5769 7468 0a20 2020 2020  None. With.     
-00010460: 2020 2020 2020 2066 7265 7175 656e 6379         frequency
-00010470: 5f70 6f69 6e74 735f 6174 5f62 616e 6473  _points_at_bands
-00010480: 3d46 616c 7365 2061 6e64 2066 7265 7175  =False and frequ
-00010490: 656e 6379 5f70 6f69 6e74 7320 6973 204e  ency_points is N
-000104a0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-000104b0: 206e 756d 5f66 7265 7175 656e 6379 5f70   num_frequency_p
-000104c0: 6f69 6e74 7320 6f72 2066 7265 7175 656e  oints or frequen
-000104d0: 6379 5f73 7465 7020 6973 2075 7365 6420  cy_step is used 
-000104e0: 746f 2067 656e 6572 6174 6520 756e 6966  to generate unif
-000104f0: 6f72 6d0a 2020 2020 2020 2020 2020 2020  orm.            
-00010500: 6672 6571 7565 6e63 7920 7361 6d70 6c69  frequency sampli
-00010510: 6e67 2070 6f69 6e74 732e 0a20 2020 2020  ng points..     
-00010520: 2020 2020 2020 2064 7479 7065 3d66 6c6f         dtype=flo
-00010530: 6174 2c20 7368 6170 653d 2866 7265 7175  at, shape=(frequ
-00010540: 656e 6379 5f70 6f69 6e74 732c 290a 2020  ency_points,).  
-00010550: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
-00010560: 7374 6570 203a 2066 6c6f 6174 2c20 6f70  step : float, op
-00010570: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00010580: 2020 2055 6e69 666f 726d 2070 6974 6368     Uniform pitch
-00010590: 206f 6620 6672 6571 7565 6e63 7920 7361   of frequency sa
-000105a0: 6d70 6c69 6e67 2070 6f69 6e74 732e 2044  mpling points. D
-000105b0: 6566 6175 6c74 2069 7320 4e6f 6e65 2e20  efault is None. 
-000105c0: 5468 6973 0a20 2020 2020 2020 2020 2020  This.           
-000105d0: 2072 6573 756c 7473 2069 6e20 7573 696e   results in usin
-000105e0: 6720 6e75 6d5f 6672 6571 7565 6e63 795f  g num_frequency_
-000105f0: 706f 696e 7473 2e0a 2020 2020 2020 2020  points..        
-00010600: 6e75 6d5f 6672 6571 7565 6e63 795f 706f  num_frequency_po
-00010610: 696e 7473 3a20 496e 742c 206f 7074 696f  ints: Int, optio
-00010620: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00010630: 4e75 6d62 6572 206f 6620 7361 6d70 6c69  Number of sampli
-00010640: 6e67 2073 616d 706c 696e 6720 706f 696e  ng sampling poin
-00010650: 7473 2074 6f20 6265 2075 7365 6420 696e  ts to be used in
-00010660: 7374 6561 6420 6f66 0a20 2020 2020 2020  stead of.       
-00010670: 2020 2020 2066 7265 7175 656e 6379 5f73       frequency_s
-00010680: 7465 702e 2054 6869 7320 6e75 6d62 6572  tep. This number
-00010690: 2069 6e63 6c75 6465 7320 656e 6420 706f   includes end po
-000106a0: 696e 7473 2e20 4465 6661 756c 7420 6973  ints. Default is
-000106b0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-000106c0: 2020 2077 6869 6368 2067 6976 6573 2032     which gives 2
-000106d0: 3031 2e0a 2020 2020 2020 2020 6e75 6d5f  01..        num_
-000106e0: 706f 696e 7473 5f69 6e5f 6261 7463 683a  points_in_batch:
-000106f0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-00010700: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-00010710: 7220 6f66 2073 616d 706c 696e 6720 706f  r of sampling po
-00010720: 696e 7473 2069 6e20 6f6e 6520 6261 7463  ints in one batc
-00010730: 682e 2054 6869 7320 6973 2066 6f72 2074  h. This is for t
-00010740: 6865 2066 7265 7175 656e 6379 0a20 2020  he frequency.   
-00010750: 2020 2020 2020 2020 2073 616d 706c 696e           samplin
-00010760: 6720 6d6f 6465 2061 6e64 2074 6865 2073  g mode and the s
-00010770: 616d 706c 696e 6720 706f 696e 7473 2061  ampling points a
-00010780: 7265 2064 6976 6964 6564 2069 6e74 6f20  re divided into 
-00010790: 6261 7463 6865 732e 0a20 2020 2020 2020  batches..       
-000107a0: 2020 2020 204c 6167 6572 206e 756d 6265       Lager numbe
-000107b0: 7220 7072 6f76 6964 6573 2065 6666 6963  r provides effic
-000107c0: 6965 6e74 2075 7365 206f 6620 6d75 6c74  ient use of mult
-000107d0: 692d 636f 7265 7320 6275 7420 6d6f 7265  i-cores but more
-000107e0: 0a20 2020 2020 2020 2020 2020 206d 656d  .            mem
-000107f0: 6f72 7920 6465 6d61 6e64 696e 672e 2044  ory demanding. D
-00010800: 6566 6175 6c74 2069 7320 4e6f 6e65 2c20  efault is None, 
-00010810: 7768 6963 6820 6769 7665 2074 6865 206e  which give the n
-00010820: 756d 6265 7220 6f66 2031 302e 0a20 2020  umber of 10..   
-00010830: 2020 2020 2066 7265 7175 656e 6379 5f70       frequency_p
-00010840: 6f69 6e74 735f 6174 5f62 616e 6473 203a  oints_at_bands :
-00010850: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
-00010860: 2020 2020 2020 2020 2020 2020 5068 6f6e              Phon
-00010870: 6f6e 2062 616e 6420 6672 6571 7565 6e63  on band frequenc
-00010880: 6965 7320 6172 6520 7573 6564 2061 7320  ies are used as 
-00010890: 6672 6571 7565 6e63 7920 706f 696e 7473  frequency points
-000108a0: 2077 6865 6e20 5472 7565 2e0a 2020 2020   when True..    
-000108b0: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-000108c0: 6973 2046 616c 7365 2e0a 2020 2020 2020  is False..      
-000108d0: 2020 7363 6174 7465 7269 6e67 5f65 7665    scattering_eve
-000108e0: 6e74 5f63 6c61 7373 203a 2069 6e74 2c20  nt_class : int, 
-000108f0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00010900: 2020 2020 2053 7065 6369 6669 6320 6368       Specific ch
-00010910: 6f69 6365 206f 6620 7363 6174 7465 7269  oice of scatteri
-00010920: 6e67 2065 7665 6e74 2063 6c61 7373 2c20  ng event class, 
-00010930: 3120 6f72 2032 2074 6861 7420 6973 2073  1 or 2 that is s
-00010940: 7065 6369 6669 6564 0a20 2020 2020 2020  pecified.       
-00010950: 2020 2020 2031 206f 7220 322c 2072 6573       1 or 2, res
-00010960: 7065 6374 6976 656c 792e 2054 6865 2072  pectively. The r
-00010970: 6573 756c 7420 6973 2073 746f 7265 6420  esult is stored 
-00010980: 696e 2067 616d 6d61 732e 2054 6865 7265  in gammas. There
-00010990: 666f 7265 0a20 2020 2020 2020 2020 2020  fore.           
-000109a0: 2075 7375 616c 2067 616d 6d61 7320 6172   usual gammas ar
-000109b0: 6520 6e6f 7420 7374 6f72 6564 2069 6e20  e not stored in 
-000109c0: 7468 6520 7661 7269 6162 6c65 2e20 4465  the variable. De
-000109d0: 6661 756c 7420 6973 204e 6f6e 652c 2077  fault is None, w
-000109e0: 6869 6368 0a20 2020 2020 2020 2020 2020  hich.           
-000109f0: 2064 6f65 736e 2774 2073 7065 6369 6679   doesn't specify
-00010a00: 2073 6361 7474 6572 696e 675f 6576 656e   scattering_even
-00010a10: 745f 636c 6173 732e 0a20 2020 2020 2020  t_class..       
-00010a20: 2077 7269 7465 5f74 7874 203a 2062 6f6f   write_txt : boo
-00010a30: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-00010a40: 2020 2020 2020 2020 4672 6571 7565 6e63          Frequenc
-00010a50: 7920 706f 696e 7473 2061 6e64 2069 6d61  y points and ima
-00010a60: 6769 6e61 7279 2070 6172 7420 6f66 2073  ginary part of s
-00010a70: 656c 662d 656e 6572 6769 6573 2061 7265  elf-energies are
-00010a80: 2077 7269 7474 656e 0a20 2020 2020 2020   written.       
-00010a90: 2020 2020 2069 6e74 6f20 7465 7874 2066       into text f
-00010aa0: 696c 6573 2e0a 2020 2020 2020 2020 7772  iles..        wr
-00010ab0: 6974 655f 6761 6d6d 615f 6465 7461 696c  ite_gamma_detail
-00010ac0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-00010ad0: 6c0a 2020 2020 2020 2020 2020 2020 4465  l.            De
-00010ae0: 7461 696c 6564 2067 616d 6d61 7320 6172  tailed gammas ar
-00010af0: 6520 7772 6974 7465 6e20 696e 746f 2061  e written into a
-00010b00: 2066 696c 6520 696e 2068 6466 352e 2044   file in hdf5. D
-00010b10: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
-00010b20: 0a20 2020 2020 2020 206b 6565 705f 6761  .        keep_ga
-00010b30: 6d6d 615f 6465 7461 696c 203a 2062 6f6f  mma_detail : boo
-00010b40: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-00010b50: 2020 2020 2020 2020 5769 7468 2054 7275          With Tru
-00010b60: 652c 2064 6574 6169 6c65 6420 6761 6d6d  e, detailed gamm
-00010b70: 6173 2061 7265 2073 746f 7265 642e 2044  as are stored. D
-00010b80: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
-00010b90: 0a20 2020 2020 2020 206f 7574 7075 745f  .        output_
-00010ba0: 6669 6c65 6e61 6d65 203a 2073 7472 0a20  filename : str. 
-00010bb0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-00010bc0: 7374 7269 6e67 2069 7320 696e 7365 7274  string is insert
-00010bd0: 6564 2069 6e20 7468 6520 6f75 7470 7574  ed in the output
-00010be0: 2066 696c 6520 6e61 6d65 732e 0a0a 2020   file names...  
-00010bf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00010c00: 2020 6966 2073 656c 662e 5f69 6e74 6572    if self._inter
-00010c10: 6163 7469 6f6e 2069 7320 4e6f 6e65 3a0a  action is None:.
-00010c20: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00010c30: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00010c40: 2020 2020 2250 686f 6e6f 3370 792e 696e      "Phono3py.in
-00010c50: 6974 5f70 6870 685f 696e 7465 7261 6374  it_phph_interact
-00010c60: 696f 6e20 6861 7320 746f 2062 6520 6361  ion has to be ca
-00010c70: 6c6c 6564 2022 0a20 2020 2020 2020 2020  lled ".         
-00010c80: 2020 2020 2020 2022 6265 666f 7265 2072         "before r
-00010c90: 756e 6e69 6e67 2074 6869 7320 6d65 7468  unning this meth
-00010ca0: 6f64 2e22 0a20 2020 2020 2020 2020 2020  od.".           
-00010cb0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-00010cc0: 6169 7365 2052 756e 7469 6d65 4572 726f  aise RuntimeErro
-00010cd0: 7228 6d73 6729 0a0a 2020 2020 2020 2020  r(msg)..        
-00010ce0: 6966 2074 656d 7065 7261 7475 7265 7320  if temperatures 
-00010cf0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00010d00: 2020 2020 2073 656c 662e 5f74 656d 7065       self._tempe
-00010d10: 7261 7475 7265 7320 3d20 5b0a 2020 2020  ratures = [.    
-00010d20: 2020 2020 2020 2020 2020 2020 3330 302e              300.
-00010d30: 302c 0a20 2020 2020 2020 2020 2020 205d  0,.            ]
-00010d40: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00010d50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00010d60: 5f74 656d 7065 7261 7475 7265 7320 3d20  _temperatures = 
-00010d70: 7465 6d70 6572 6174 7572 6573 0a20 2020  temperatures.   
-00010d80: 2020 2020 2073 656c 662e 5f67 7269 645f       self._grid_
-00010d90: 706f 696e 7473 203d 2067 7269 645f 706f  points = grid_po
-00010da0: 696e 7473 0a20 2020 2020 2020 2073 656c  ints.        sel
-00010db0: 662e 5f73 6361 7474 6572 696e 675f 6576  f._scattering_ev
-00010dc0: 656e 745f 636c 6173 7320 3d20 7363 6174  ent_class = scat
-00010dd0: 7465 7269 6e67 5f65 7665 6e74 5f63 6c61  tering_event_cla
-00010de0: 7373 0a20 2020 2020 2020 2076 616c 7320  ss.        vals 
-00010df0: 3d20 6765 745f 696d 6167 5f73 656c 665f  = get_imag_self_
-00010e00: 656e 6572 6779 280a 2020 2020 2020 2020  energy(.        
-00010e10: 2020 2020 7365 6c66 2e5f 696e 7465 7261      self._intera
-00010e20: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
-00010e30: 2020 2067 7269 645f 706f 696e 7473 2c0a     grid_points,.
-00010e40: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
-00010e50: 6572 6174 7572 6573 2c0a 2020 2020 2020  eratures,.      
-00010e60: 2020 2020 2020 7369 676d 6173 3d73 656c        sigmas=sel
-00010e70: 662e 5f73 6967 6d61 732c 0a20 2020 2020  f._sigmas,.     
-00010e80: 2020 2020 2020 2066 7265 7175 656e 6379         frequency
-00010e90: 5f70 6f69 6e74 733d 6672 6571 7565 6e63  _points=frequenc
-00010ea0: 795f 706f 696e 7473 2c0a 2020 2020 2020  y_points,.      
-00010eb0: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
-00010ec0: 7374 6570 3d66 7265 7175 656e 6379 5f73  step=frequency_s
-00010ed0: 7465 702c 0a20 2020 2020 2020 2020 2020  tep,.           
-00010ee0: 2066 7265 7175 656e 6379 5f70 6f69 6e74   frequency_point
-00010ef0: 735f 6174 5f62 616e 6473 3d66 7265 7175  s_at_bands=frequ
-00010f00: 656e 6379 5f70 6f69 6e74 735f 6174 5f62  ency_points_at_b
-00010f10: 616e 6473 2c0a 2020 2020 2020 2020 2020  ands,.          
-00010f20: 2020 6e75 6d5f 6672 6571 7565 6e63 795f    num_frequency_
-00010f30: 706f 696e 7473 3d6e 756d 5f66 7265 7175  points=num_frequ
-00010f40: 656e 6379 5f70 6f69 6e74 732c 0a20 2020  ency_points,.   
-00010f50: 2020 2020 2020 2020 206e 756d 5f70 6f69           num_poi
-00010f60: 6e74 735f 696e 5f62 6174 6368 3d6e 756d  nts_in_batch=num
-00010f70: 5f70 6f69 6e74 735f 696e 5f62 6174 6368  _points_in_batch
-00010f80: 2c0a 2020 2020 2020 2020 2020 2020 7363  ,.            sc
-00010f90: 6174 7465 7269 6e67 5f65 7665 6e74 5f63  attering_event_c
-00010fa0: 6c61 7373 3d73 6361 7474 6572 696e 675f  lass=scattering_
-00010fb0: 6576 656e 745f 636c 6173 732c 0a20 2020  event_class,.   
-00010fc0: 2020 2020 2020 2020 2077 7269 7465 5f67           write_g
-00010fd0: 616d 6d61 5f64 6574 6169 6c3d 7772 6974  amma_detail=writ
-00010fe0: 655f 6761 6d6d 615f 6465 7461 696c 2c0a  e_gamma_detail,.
-00010ff0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00011000: 726e 5f67 616d 6d61 5f64 6574 6169 6c3d  rn_gamma_detail=
-00011010: 6b65 6570 5f67 616d 6d61 5f64 6574 6169  keep_gamma_detai
-00011020: 6c2c 0a20 2020 2020 2020 2020 2020 206f  l,.            o
-00011030: 7574 7075 745f 6669 6c65 6e61 6d65 3d6f  utput_filename=o
-00011040: 7574 7075 745f 6669 6c65 6e61 6d65 2c0a  utput_filename,.
-00011050: 2020 2020 2020 2020 2020 2020 6c6f 675f              log_
-00011060: 6c65 7665 6c3d 7365 6c66 2e5f 6c6f 675f  level=self._log_
-00011070: 6c65 7665 6c2c 0a20 2020 2020 2020 2029  level,.        )
-00011080: 0a20 2020 2020 2020 2069 6620 6b65 6570  .        if keep
-00011090: 5f67 616d 6d61 5f64 6574 6169 6c3a 0a20  _gamma_detail:. 
-000110a0: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
-000110b0: 2e5f 6672 6571 7565 6e63 795f 706f 696e  ._frequency_poin
-000110c0: 7473 2c20 7365 6c66 2e5f 6761 6d6d 6173  ts, self._gammas
-000110d0: 2c20 7365 6c66 2e5f 6465 7461 696c 6564  , self._detailed
-000110e0: 5f67 616d 6d61 7329 203d 2076 616c 730a  _gammas) = vals.
-000110f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00011100: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00011110: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
-00011120: 2c20 7365 6c66 2e5f 6761 6d6d 6173 203d  , self._gammas =
-00011130: 2076 616c 730a 0a20 2020 2020 2020 2069   vals..        i
-00011140: 6620 7772 6974 655f 7478 743a 0a20 2020  f write_txt:.   
-00011150: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-00011160: 7269 7465 5f69 6d61 675f 7365 6c66 5f65  rite_imag_self_e
-00011170: 6e65 7267 7928 6f75 7470 7574 5f66 696c  nergy(output_fil
-00011180: 656e 616d 653d 6f75 7470 7574 5f66 696c  ename=output_fil
-00011190: 656e 616d 6529 0a0a 2020 2020 2020 2020  ename)..        
-000111a0: 7265 7475 726e 2076 616c 730a 0a20 2020  return vals..   
-000111b0: 2064 6566 2077 7269 7465 5f69 6d61 675f   def write_imag_
-000111c0: 7365 6c66 5f65 6e65 7267 7928 7365 6c66  self_energy(self
-000111d0: 2c20 6669 6c65 6e61 6d65 3d4e 6f6e 6529  , filename=None)
-000111e0: 3a0a 2020 2020 2020 2020 2222 2257 7269  :.        """Wri
-000111f0: 7465 2069 6d61 6769 6e61 7279 2070 6172  te imaginary par
-00011200: 7420 6f66 2073 656c 6620 656e 6572 6779  t of self energy
-00011210: 2074 6f20 6120 6669 6c65 2e22 2222 0a20   to a file.""". 
-00011220: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00011230: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-00011240: 2020 2250 686f 6e6f 3370 792e 7772 6974    "Phono3py.writ
-00011250: 655f 696d 6167 5f73 656c 665f 656e 6572  e_imag_self_ener
-00011260: 6779 2069 7320 6465 7072 6563 6174 6564  gy is deprecated
-00011270: 2e22 0a20 2020 2020 2020 2020 2020 2022  .".            "
-00011280: 5573 6520 5068 6f6e 6f33 7079 2e72 756e  Use Phono3py.run
-00011290: 5f69 6d61 675f 7365 6c66 5f65 6e65 7267  _imag_self_energ
-000112a0: 7920 7769 7468 2077 7269 7465 5f74 7874  y with write_txt
-000112b0: 3d54 7275 652e 222c 0a20 2020 2020 2020  =True.",.       
-000112c0: 2020 2020 2044 6570 7265 6361 7469 6f6e       Deprecation
-000112d0: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-000112e0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-000112f0: 5f77 7269 7465 5f69 6d61 675f 7365 6c66  _write_imag_self
-00011300: 5f65 6e65 7267 7928 6f75 7470 7574 5f66  _energy(output_f
-00011310: 696c 656e 616d 653d 6669 6c65 6e61 6d65  ilename=filename
-00011320: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
-00011330: 655f 696d 6167 5f73 656c 665f 656e 6572  e_imag_self_ener
-00011340: 6779 2873 656c 662c 206f 7574 7075 745f  gy(self, output_
-00011350: 6669 6c65 6e61 6d65 3d4e 6f6e 6529 3a0a  filename=None):.
-00011360: 2020 2020 2020 2020 7772 6974 655f 696d          write_im
-00011370: 6167 5f73 656c 665f 656e 6572 6779 280a  ag_self_energy(.
-00011380: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00011390: 2e5f 6761 6d6d 6173 2c0a 2020 2020 2020  ._gammas,.      
-000113a0: 2020 2020 2020 7365 6c66 2e6d 6573 685f        self.mesh_
-000113b0: 6e75 6d62 6572 732c 0a20 2020 2020 2020  numbers,.       
-000113c0: 2020 2020 2073 656c 662e 5f67 7269 645f       self._grid_
-000113d0: 706f 696e 7473 2c0a 2020 2020 2020 2020  points,.        
-000113e0: 2020 2020 7365 6c66 2e5f 6261 6e64 5f69      self._band_i
-000113f0: 6e64 6963 6573 2c0a 2020 2020 2020 2020  ndices,.        
-00011400: 2020 2020 7365 6c66 2e5f 6672 6571 7565      self._freque
-00011410: 6e63 795f 706f 696e 7473 2c0a 2020 2020  ncy_points,.    
-00011420: 2020 2020 2020 2020 7365 6c66 2e5f 7465          self._te
-00011430: 6d70 6572 6174 7572 6573 2c0a 2020 2020  mperatures,.    
-00011440: 2020 2020 2020 2020 7365 6c66 2e5f 7369          self._si
-00011450: 676d 6173 2c0a 2020 2020 2020 2020 2020  gmas,.          
-00011460: 2020 7363 6174 7465 7269 6e67 5f65 7665    scattering_eve
-00011470: 6e74 5f63 6c61 7373 3d73 656c 662e 5f73  nt_class=self._s
-00011480: 6361 7474 6572 696e 675f 6576 656e 745f  cattering_event_
-00011490: 636c 6173 732c 0a20 2020 2020 2020 2020  class,.         
-000114a0: 2020 206f 7574 7075 745f 6669 6c65 6e61     output_filena
-000114b0: 6d65 3d6f 7574 7075 745f 6669 6c65 6e61  me=output_filena
-000114c0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-000114d0: 6973 5f6d 6573 685f 7379 6d6d 6574 7279  is_mesh_symmetry
-000114e0: 3d73 656c 662e 5f69 735f 6d65 7368 5f73  =self._is_mesh_s
-000114f0: 796d 6d65 7472 792c 0a20 2020 2020 2020  ymmetry,.       
-00011500: 2020 2020 206c 6f67 5f6c 6576 656c 3d73       log_level=s
-00011510: 656c 662e 5f6c 6f67 5f6c 6576 656c 2c0a  elf._log_level,.
-00011520: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00011530: 6566 2072 756e 5f72 6561 6c5f 7365 6c66  ef run_real_self
-00011540: 5f65 6e65 7267 7928 0a20 2020 2020 2020  _energy(.       
-00011550: 2073 656c 662c 0a20 2020 2020 2020 2067   self,.        g
-00011560: 7269 645f 706f 696e 7473 2c0a 2020 2020  rid_points,.    
-00011570: 2020 2020 7465 6d70 6572 6174 7572 6573      temperatures
-00011580: 2c0a 2020 2020 2020 2020 6672 6571 7565  ,.        freque
-00011590: 6e63 795f 706f 696e 7473 5f61 745f 6261  ncy_points_at_ba
-000115a0: 6e64 733d 4661 6c73 652c 0a20 2020 2020  nds=False,.     
-000115b0: 2020 2066 7265 7175 656e 6379 5f70 6f69     frequency_poi
-000115c0: 6e74 733d 4e6f 6e65 2c0a 2020 2020 2020  nts=None,.      
-000115d0: 2020 6672 6571 7565 6e63 795f 7374 6570    frequency_step
-000115e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-000115f0: 756d 5f66 7265 7175 656e 6379 5f70 6f69  um_frequency_poi
-00011600: 6e74 733d 4e6f 6e65 2c0a 2020 2020 2020  nts=None,.      
-00011610: 2020 6570 7369 6c6f 6e73 3d4e 6f6e 652c    epsilons=None,
-00011620: 0a20 2020 2020 2020 2077 7269 7465 5f74  .        write_t
-00011630: 7874 3d46 616c 7365 2c0a 2020 2020 2020  xt=False,.      
-00011640: 2020 7772 6974 655f 6864 6635 3d46 616c    write_hdf5=Fal
-00011650: 7365 2c0a 2020 2020 2020 2020 6f75 7470  se,.        outp
-00011660: 7574 5f66 696c 656e 616d 653d 4e6f 6e65  ut_filename=None
-00011670: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00011680: 2022 2222 4361 6c63 756c 6174 6520 7265   """Calculate re
-00011690: 616c 2d70 6172 7420 6f66 2073 656c 662d  al-part of self-
-000116a0: 656e 6572 6779 206f 6620 6275 6262 6c65  energy of bubble
-000116b0: 2064 6961 6772 616d 2028 4465 6c74 6129   diagram (Delta)
-000116c0: 2e0a 0a20 2020 2020 2020 2050 6920 3d20  ...        Pi = 
-000116d0: 4465 6c74 6120 2d20 6920 4761 6d6d 612e  Delta - i Gamma.
-000116e0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000116f0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00011700: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011710: 6772 6964 5f70 6f69 6e74 7320 3a20 6172  grid_points : ar
-00011720: 7261 795f 6c69 6b65 0a20 2020 2020 2020  ray_like.       
-00011730: 2020 2020 2047 7269 642d 706f 696e 7420       Grid-point 
-00011740: 696e 6469 6365 7320 7768 6572 6520 7265  indices where re
-00011750: 616c 2070 6172 7420 6f66 2073 656c 662d  al part of self-
-00011760: 656e 6572 6769 6573 2061 7265 0a20 2020  energies are.   
-00011770: 2020 2020 2020 2020 2063 6163 6c63 756c           caclcul
-00011780: 6174 6564 2e0a 2020 2020 2020 2020 2020  ated..          
-00011790: 2020 6474 7970 653d 696e 742c 2073 6861    dtype=int, sha
-000117a0: 7065 3d28 6772 6964 5f70 6f69 6e74 732c  pe=(grid_points,
-000117b0: 290a 2020 2020 2020 2020 7465 6d70 6572  ).        temper
-000117c0: 6174 7572 6573 203a 2061 7272 6179 5f6c  atures : array_l
-000117d0: 696b 650a 2020 2020 2020 2020 2020 2020  ike.            
-000117e0: 5465 6d70 6572 6174 7572 6573 2077 6865  Temperatures whe
-000117f0: 7265 2072 6561 6c20 7061 7274 206f 6620  re real part of 
-00011800: 7365 6c66 2d65 6e65 7267 6965 7320 2061  self-energies  a
-00011810: 7265 2063 616c 6375 6c61 7465 642e 0a20  re calculated.. 
-00011820: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-00011830: 3d66 6c6f 6174 2c20 7368 6170 653d 2874  =float, shape=(t
-00011840: 656d 7065 7261 7475 7265 732c 290a 2020  emperatures,).  
-00011850: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
-00011860: 706f 696e 7473 5f61 745f 6261 6e64 7320  points_at_bands 
-00011870: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-00011880: 0a20 2020 2020 2020 2020 2020 2057 6974  .            Wit
-00011890: 6820 4661 6c73 652c 2066 7265 7175 656e  h False, frequen
-000118a0: 6379 2073 6869 6674 7320 6172 6520 6361  cy shifts are ca
-000118b0: 6c63 756c 6174 6564 2061 7420 6672 7175  lculated at frqu
-000118c0: 656e 6379 2073 616d 706c 696e 670a 2020  ency sampling.  
-000118d0: 2020 2020 2020 2020 2020 706f 696e 7473            points
-000118e0: 2e20 5768 656e 2054 7275 652c 2074 6865  . When True, the
-000118f0: 7920 6172 6520 646f 6e65 2061 7420 7468  y are done at th
-00011900: 6520 7068 6f6e 6f6e 2066 7265 7175 656e  e phonon frequen
-00011910: 6369 6573 2e0a 2020 2020 2020 2020 2020  cies..          
-00011920: 2020 4465 6661 756c 7420 6973 2046 616c    Default is Fal
-00011930: 7365 2e0a 2020 2020 2020 2020 6672 6571  se..        freq
-00011940: 7565 6e63 795f 706f 696e 7473 203a 2061  uency_points : a
-00011950: 7272 6179 5f6c 696b 652c 206f 7074 696f  rray_like, optio
-00011960: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00011970: 4672 6571 7565 6e63 7920 7361 6d70 6c69  Frequency sampli
-00011980: 6e67 2070 6f69 6e74 732e 2044 6566 6175  ng points. Defau
-00011990: 6c74 2069 7320 4e6f 6e65 2e20 496e 2074  lt is None. In t
-000119a0: 6869 7320 6361 7365 2c0a 2020 2020 2020  his case,.      
-000119b0: 2020 2020 2020 6e75 6d5f 6672 6571 7565        num_freque
-000119c0: 6e63 795f 706f 696e 7473 206f 7220 6672  ncy_points or fr
-000119d0: 6571 7565 6e63 795f 7374 6570 2069 7320  equency_step is 
-000119e0: 7573 6564 2074 6f20 6765 6e65 7261 7465  used to generate
-000119f0: 2075 6e69 666f 726d 0a20 2020 2020 2020   uniform.       
-00011a00: 2020 2020 2066 7265 7175 656e 6379 2073       frequency s
-00011a10: 616d 706c 696e 6720 706f 696e 7473 2e0a  ampling points..
-00011a20: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00011a30: 653d 666c 6f61 742c 2073 6861 7065 3d28  e=float, shape=(
-00011a40: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
-00011a50: 2c29 0a20 2020 2020 2020 2066 7265 7175  ,).        frequ
-00011a60: 656e 6379 5f73 7465 7020 3a20 666c 6f61  ency_step : floa
-00011a70: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00011a80: 2020 2020 2020 2020 556e 6966 6f72 6d20          Uniform 
-00011a90: 7069 7463 6820 6f66 2066 7265 7175 656e  pitch of frequen
-00011aa0: 6379 2073 616d 706c 696e 6720 706f 696e  cy sampling poin
-00011ab0: 7473 2e20 4465 6661 756c 7420 6973 204e  ts. Default is N
-00011ac0: 6f6e 652e 2054 6869 730a 2020 2020 2020  one. This.      
-00011ad0: 2020 2020 2020 7265 7375 6c74 7320 696e        results in
-00011ae0: 2075 7369 6e67 206e 756d 5f66 7265 7175   using num_frequ
-00011af0: 656e 6379 5f70 6f69 6e74 732e 0a20 2020  ency_points..   
-00011b00: 2020 2020 206e 756d 5f66 7265 7175 656e       num_frequen
-00011b10: 6379 5f70 6f69 6e74 733a 2049 6e74 2c20  cy_points: Int, 
-00011b20: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00011b30: 2020 2020 204e 756d 6265 7220 6f66 2073       Number of s
-00011b40: 616d 706c 696e 6720 7361 6d70 6c69 6e67  ampling sampling
-00011b50: 2070 6f69 6e74 7320 746f 2062 6520 7573   points to be us
-00011b60: 6564 2069 6e73 7465 6164 206f 660a 2020  ed instead of.  
-00011b70: 2020 2020 2020 2020 2020 6672 6571 7565            freque
-00011b80: 6e63 795f 7374 6570 2e20 5468 6973 206e  ncy_step. This n
-00011b90: 756d 6265 7220 696e 636c 7564 6573 2065  umber includes e
-00011ba0: 6e64 2070 6f69 6e74 732e 2044 6566 6175  nd points. Defau
-00011bb0: 6c74 2069 7320 4e6f 6e65 2c0a 2020 2020  lt is None,.    
-00011bc0: 2020 2020 2020 2020 7768 6963 6820 6769          which gi
-00011bd0: 7665 7320 3230 312e 0a20 2020 2020 2020  ves 201..       
-00011be0: 2065 7073 696c 6f6e 7320 3a20 6172 7261   epsilons : arra
-00011bf0: 795f 6c69 6b65 0a20 2020 2020 2020 2020  y_like.         
-00011c00: 2020 2053 6d65 6172 696e 6720 7769 6474     Smearing widt
-00011c10: 6873 2074 6f20 636f 6d70 7574 6572 2070  hs to computer p
-00011c20: 7269 6e63 6970 616c 2070 6172 742e 2057  rincipal part. W
-00011c30: 6865 6e20 6d75 6c74 6970 6c65 2076 616c  hen multiple val
-00011c40: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
-00011c50: 6172 6520 6769 7665 6e20 6672 6571 7565  are given freque
-00011c60: 6e63 7920 7368 6966 7473 2066 6f72 2074  ncy shifts for t
-00011c70: 686f 7365 2076 616c 7565 7320 6172 6520  hose values are 
-00011c80: 7265 7475 726e 6564 2e0a 2020 2020 2020  returned..      
-00011c90: 2020 2020 2020 6474 7970 653d 666c 6f61        dtype=floa
-00011ca0: 742c 2073 6861 7065 3d28 6570 7369 6c6f  t, shape=(epsilo
-00011cb0: 6e73 2c29 0a20 2020 2020 2020 2077 7269  ns,).        wri
-00011cc0: 7465 5f74 7874 203a 2062 6f6f 6c2c 206f  te_txt : bool, o
-00011cd0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00011ce0: 2020 2020 4672 6571 7565 6e63 7920 706f      Frequency po
-00011cf0: 696e 7473 2061 6e64 2072 6561 6c20 7061  ints and real pa
-00011d00: 7274 206f 6620 7365 6c66 2d65 6e65 7267  rt of self-energ
-00011d10: 6965 7320 6172 6520 7772 6974 7465 6e0a  ies are written.
-00011d20: 2020 2020 2020 2020 2020 2020 696e 746f              into
-00011d30: 2074 6578 7420 6669 6c65 732e 0a20 2020   text files..   
-00011d40: 2020 2020 2077 7269 7465 5f68 6466 3520       write_hdf5 
-00011d50: 3a20 626f 6f6c 0a20 2020 2020 2020 2020  : bool.         
-00011d60: 2020 2052 6573 756c 7473 2061 7265 2073     Results are s
-00011d70: 746f 7265 6420 696e 2068 6466 3520 6669  tored in hdf5 fi
-00011d80: 6c65 7320 696e 6465 7065 6e64 656e 746c  les independentl
-00011d90: 7920 6174 2067 7269 6420 706f 696e 7473  y at grid points
-00011da0: 2c0a 2020 2020 2020 2020 2020 2020 6570  ,.            ep
-00011db0: 7369 6c6f 6e73 2c20 616e 6420 7465 6d70  silons, and temp
-00011dc0: 6572 6174 7572 6573 2e0a 2020 2020 2020  eratures..      
-00011dd0: 2020 6f75 7470 7574 5f66 696c 656e 616d    output_filenam
-00011de0: 6520 3a20 7374 720a 2020 2020 2020 2020  e : str.        
-00011df0: 2020 2020 5468 6973 2073 7472 696e 6720      This string 
-00011e00: 6973 2069 6e73 6572 7465 6420 696e 2074  is inserted in t
-00011e10: 6865 206f 7574 7075 7420 6669 6c65 206e  he output file n
-00011e20: 616d 6573 2e0a 0a20 2020 2020 2020 2022  ames...        "
-00011e30: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-00011e40: 6c66 2e5f 696e 7465 7261 6374 696f 6e20  lf._interaction 
-00011e50: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00011e60: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
-00011e70: 2020 2020 2020 2020 2020 2020 2022 5068               "Ph
-00011e80: 6f6e 6f33 7079 2e69 6e69 745f 7068 7068  ono3py.init_phph
-00011e90: 5f69 6e74 6572 6163 7469 6f6e 2068 6173  _interaction has
-00011ea0: 2074 6f20 6265 2063 616c 6c65 6420 220a   to be called ".
-00011eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ec0: 2262 6566 6f72 6520 7275 6e6e 696e 6720  "before running 
-00011ed0: 7468 6973 206d 6574 686f 642e 220a 2020  this method.".  
-00011ee0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00011ef0: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
-00011f00: 6e74 696d 6545 7272 6f72 286d 7367 290a  ntimeError(msg).
-00011f10: 0a20 2020 2020 2020 2069 6620 6570 7369  .        if epsi
-00011f20: 6c6f 6e73 2069 7320 6e6f 7420 4e6f 6e65  lons is not None
-00011f30: 3a0a 2020 2020 2020 2020 2020 2020 5f65  :.            _e
-00011f40: 7073 696c 6f6e 7320 3d20 6570 7369 6c6f  psilons = epsilo
-00011f50: 6e73 0a20 2020 2020 2020 2065 6c73 653a  ns.        else:
-00011f60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00011f70: 6c65 6e28 7365 6c66 2e5f 7369 676d 6173  len(self._sigmas
-00011f80: 2920 3d3d 2031 2061 6e64 2073 656c 662e  ) == 1 and self.
-00011f90: 5f73 6967 6d61 735b 305d 2069 7320 4e6f  _sigmas[0] is No
-00011fa0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00011fb0: 2020 2020 5f65 7073 696c 6f6e 7320 3d20      _epsilons = 
-00011fc0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00011fd0: 2065 6c69 6620 7365 6c66 2e5f 7369 676d   elif self._sigm
-00011fe0: 6173 5b30 5d20 6973 204e 6f6e 653a 0a20  as[0] is None:. 
-00011ff0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00012000: 6570 7369 6c6f 6e73 203d 2073 656c 662e  epsilons = self.
-00012010: 5f73 6967 6d61 735b 313a 5d0a 2020 2020  _sigmas[1:].    
-00012020: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00012030: 2020 2020 2020 2020 2020 2020 2020 5f65                _e
-00012040: 7073 696c 6f6e 7320 3d20 7365 6c66 2e5f  psilons = self._
-00012050: 7369 676d 6173 0a0a 2020 2020 2020 2020  sigmas..        
-00012060: 2320 2865 7073 696c 6f6e 2c20 6772 6964  # (epsilon, grid
-00012070: 5f70 6f69 6e74 2c20 7465 6d70 6572 6174  _point, temperat
-00012080: 7572 652c 2062 616e 6429 0a20 2020 2020  ure, band).     
-00012090: 2020 2066 7265 7175 656e 6379 5f70 6f69     frequency_poi
-000120a0: 6e74 732c 2064 656c 7461 7320 3d20 6765  nts, deltas = ge
-000120b0: 745f 7265 616c 5f73 656c 665f 656e 6572  t_real_self_ener
-000120c0: 6779 280a 2020 2020 2020 2020 2020 2020  gy(.            
-000120d0: 7365 6c66 2e5f 696e 7465 7261 6374 696f  self._interactio
-000120e0: 6e2c 0a20 2020 2020 2020 2020 2020 2067  n,.            g
-000120f0: 7269 645f 706f 696e 7473 2c0a 2020 2020  rid_points,.    
-00012100: 2020 2020 2020 2020 7465 6d70 6572 6174          temperat
-00012110: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
-00012120: 2020 6570 7369 6c6f 6e73 3d5f 6570 7369    epsilons=_epsi
-00012130: 6c6f 6e73 2c0a 2020 2020 2020 2020 2020  lons,.          
-00012140: 2020 6672 6571 7565 6e63 795f 706f 696e    frequency_poin
-00012150: 7473 3d66 7265 7175 656e 6379 5f70 6f69  ts=frequency_poi
-00012160: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-00012170: 2066 7265 7175 656e 6379 5f73 7465 703d   frequency_step=
-00012180: 6672 6571 7565 6e63 795f 7374 6570 2c0a  frequency_step,.
-00012190: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
-000121a0: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
-000121b0: 3d6e 756d 5f66 7265 7175 656e 6379 5f70  =num_frequency_p
-000121c0: 6f69 6e74 732c 0a20 2020 2020 2020 2020  oints,.         
-000121d0: 2020 2066 7265 7175 656e 6379 5f70 6f69     frequency_poi
-000121e0: 6e74 735f 6174 5f62 616e 6473 3d66 7265  nts_at_bands=fre
-000121f0: 7175 656e 6379 5f70 6f69 6e74 735f 6174  quency_points_at
-00012200: 5f62 616e 6473 2c0a 2020 2020 2020 2020  _bands,.        
-00012210: 2020 2020 7772 6974 655f 6864 6635 3d77      write_hdf5=w
-00012220: 7269 7465 5f68 6466 352c 0a20 2020 2020  rite_hdf5,.     
-00012230: 2020 2020 2020 206f 7574 7075 745f 6669         output_fi
-00012240: 6c65 6e61 6d65 3d6f 7574 7075 745f 6669  lename=output_fi
-00012250: 6c65 6e61 6d65 2c0a 2020 2020 2020 2020  lename,.        
-00012260: 2020 2020 6c6f 675f 6c65 7665 6c3d 7365      log_level=se
-00012270: 6c66 2e5f 6c6f 675f 6c65 7665 6c2c 0a20  lf._log_level,. 
-00012280: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00012290: 2020 6966 2077 7269 7465 5f74 7874 3a0a    if write_txt:.
-000122a0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-000122b0: 655f 7265 616c 5f73 656c 665f 656e 6572  e_real_self_ener
-000122c0: 6779 280a 2020 2020 2020 2020 2020 2020  gy(.            
-000122d0: 2020 2020 6465 6c74 6173 2c0a 2020 2020      deltas,.    
-000122e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000122f0: 2e6d 6573 685f 6e75 6d62 6572 732c 0a20  .mesh_numbers,. 
-00012300: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00012310: 7269 645f 706f 696e 7473 2c0a 2020 2020  rid_points,.    
-00012320: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00012330: 2e5f 6261 6e64 5f69 6e64 6963 6573 2c0a  ._band_indices,.
-00012340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012350: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
-00012360: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012370: 2020 7465 6d70 6572 6174 7572 6573 2c0a    temperatures,.
-00012380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012390: 5f65 7073 696c 6f6e 732c 0a20 2020 2020  _epsilons,.     
-000123a0: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
-000123b0: 745f 6669 6c65 6e61 6d65 3d6f 7574 7075  t_filename=outpu
-000123c0: 745f 6669 6c65 6e61 6d65 2c0a 2020 2020  t_filename,.    
-000123d0: 2020 2020 2020 2020 2020 2020 6973 5f6d              is_m
-000123e0: 6573 685f 7379 6d6d 6574 7279 3d73 656c  esh_symmetry=sel
-000123f0: 662e 5f69 735f 6d65 7368 5f73 796d 6d65  f._is_mesh_symme
-00012400: 7472 792c 0a20 2020 2020 2020 2020 2020  try,.           
-00012410: 2020 2020 206c 6f67 5f6c 6576 656c 3d73       log_level=s
-00012420: 656c 662e 5f6c 6f67 5f6c 6576 656c 2c0a  elf._log_level,.
-00012430: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00012440: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
-00012450: 6571 7565 6e63 795f 706f 696e 7473 2c20  equency_points, 
-00012460: 6465 6c74 6173 0a0a 2020 2020 6465 6620  deltas..    def 
-00012470: 7275 6e5f 7370 6563 7472 616c 5f66 756e  run_spectral_fun
-00012480: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
-00012490: 656c 662c 0a20 2020 2020 2020 2067 7269  elf,.        gri
-000124a0: 645f 706f 696e 7473 2c0a 2020 2020 2020  d_points,.      
-000124b0: 2020 7465 6d70 6572 6174 7572 6573 2c0a    temperatures,.
-000124c0: 2020 2020 2020 2020 6672 6571 7565 6e63          frequenc
-000124d0: 795f 706f 696e 7473 3d4e 6f6e 652c 0a20  y_points=None,. 
-000124e0: 2020 2020 2020 2066 7265 7175 656e 6379         frequency
-000124f0: 5f73 7465 703d 4e6f 6e65 2c0a 2020 2020  _step=None,.    
-00012500: 2020 2020 6e75 6d5f 6672 6571 7565 6e63      num_frequenc
-00012510: 795f 706f 696e 7473 3d4e 6f6e 652c 0a20  y_points=None,. 
-00012520: 2020 2020 2020 206e 756d 5f70 6f69 6e74         num_point
-00012530: 735f 696e 5f62 6174 6368 3d4e 6f6e 652c  s_in_batch=None,
-00012540: 0a20 2020 2020 2020 2077 7269 7465 5f74  .        write_t
-00012550: 7874 3d46 616c 7365 2c0a 2020 2020 2020  xt=False,.      
-00012560: 2020 7772 6974 655f 6864 6635 3d46 616c    write_hdf5=Fal
-00012570: 7365 2c0a 2020 2020 2020 2020 6f75 7470  se,.        outp
-00012580: 7574 5f66 696c 656e 616d 653d 4e6f 6e65  ut_filename=None
-00012590: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-000125a0: 2022 2222 4672 6571 7565 6e63 7920 7368   """Frequency sh
-000125b0: 6966 7420 6672 6f6d 206c 6f77 6573 7420  ift from lowest 
-000125c0: 6f72 6465 7220 6469 6167 7261 6d20 6973  order diagram is
-000125d0: 2063 616c 6375 6c61 7465 642e 0a0a 2020   calculated...  
-000125e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000125f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00012600: 2d2d 2d0a 2020 2020 2020 2020 6772 6964  ---.        grid
-00012610: 5f70 6f69 6e74 7320 3a20 6172 7261 795f  _points : array_
-00012620: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
-00012630: 2047 7269 642d 706f 696e 7420 696e 6469   Grid-point indi
-00012640: 6365 7320 7768 6572 6520 696d 6167 2d73  ces where imag-s
-00012650: 656c 662d 656e 6572 6765 6973 2061 7265  elf-energeis are
-00012660: 2063 6163 6c63 756c 6174 6564 2e0a 2020   caclculated..  
-00012670: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
-00012680: 696e 742c 2073 6861 7065 3d28 6772 6964  int, shape=(grid
-00012690: 5f70 6f69 6e74 732c 290a 2020 2020 2020  _points,).      
-000126a0: 2020 7465 6d70 6572 6174 7572 6573 203a    temperatures :
-000126b0: 2061 7272 6179 5f6c 696b 650a 2020 2020   array_like.    
-000126c0: 2020 2020 2020 2020 5465 6d70 6572 6174          Temperat
-000126d0: 7572 6573 2077 6865 7265 2069 6d61 672d  ures where imag-
-000126e0: 7365 6c66 2d65 6e65 7267 6965 7320 6172  self-energies ar
-000126f0: 6520 6361 6c63 756c 6174 6564 2e0a 2020  e calculated..  
-00012700: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
-00012710: 666c 6f61 742c 2073 6861 7065 3d28 7465  float, shape=(te
-00012720: 6d70 6572 6174 7572 6573 2c29 0a20 2020  mperatures,).   
-00012730: 2020 2020 2066 7265 7175 656e 6379 5f70       frequency_p
-00012740: 6f69 6e74 7320 3a20 6172 7261 795f 6c69  oints : array_li
-00012750: 6b65 2c20 6f70 7469 6f6e 616c 0a20 2020  ke, optional.   
-00012760: 2020 2020 2020 2020 2046 7265 7175 656e           Frequen
-00012770: 6379 2073 616d 706c 696e 6720 706f 696e  cy sampling poin
-00012780: 7473 2e20 4465 6661 756c 7420 6973 204e  ts. Default is N
-00012790: 6f6e 652e 2049 6e20 7468 6973 2063 6173  one. In this cas
-000127a0: 652c 0a20 2020 2020 2020 2020 2020 206e  e,.            n
-000127b0: 756d 5f66 7265 7175 656e 6379 5f70 6f69  um_frequency_poi
-000127c0: 6e74 7320 6f72 2066 7265 7175 656e 6379  nts or frequency
-000127d0: 5f73 7465 7020 6973 2075 7365 6420 746f  _step is used to
-000127e0: 2067 656e 6572 6174 6520 756e 6966 6f72   generate unifor
-000127f0: 6d0a 2020 2020 2020 2020 2020 2020 6672  m.            fr
-00012800: 6571 7565 6e63 7920 7361 6d70 6c69 6e67  equency sampling
-00012810: 2070 6f69 6e74 732e 0a20 2020 2020 2020   points..       
-00012820: 2020 2020 2064 7479 7065 3d66 6c6f 6174       dtype=float
-00012830: 2c20 7368 6170 653d 2866 7265 7175 656e  , shape=(frequen
-00012840: 6379 5f70 6f69 6e74 732c 290a 2020 2020  cy_points,).    
-00012850: 2020 2020 6672 6571 7565 6e63 795f 7374      frequency_st
-00012860: 6570 203a 2066 6c6f 6174 2c20 6f70 7469  ep : float, opti
-00012870: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00012880: 2055 6e69 666f 726d 2070 6974 6368 206f   Uniform pitch o
-00012890: 6620 6672 6571 7565 6e63 7920 7361 6d70  f frequency samp
-000128a0: 6c69 6e67 2070 6f69 6e74 732e 2044 6566  ling points. Def
-000128b0: 6175 6c74 2069 7320 4e6f 6e65 2e20 5468  ault is None. Th
-000128c0: 6973 0a20 2020 2020 2020 2020 2020 2072  is.            r
-000128d0: 6573 756c 7473 2069 6e20 7573 696e 6720  esults in using 
-000128e0: 6e75 6d5f 6672 6571 7565 6e63 795f 706f  num_frequency_po
-000128f0: 696e 7473 2e0a 2020 2020 2020 2020 6e75  ints..        nu
-00012900: 6d5f 6672 6571 7565 6e63 795f 706f 696e  m_frequency_poin
-00012910: 7473 3a20 496e 742c 206f 7074 696f 6e61  ts: Int, optiona
-00012920: 6c0a 2020 2020 2020 2020 2020 2020 4e75  l.            Nu
-00012930: 6d62 6572 206f 6620 7361 6d70 6c69 6e67  mber of sampling
-00012940: 2073 616d 706c 696e 6720 706f 696e 7473   sampling points
-00012950: 2074 6f20 6265 2075 7365 6420 696e 7374   to be used inst
-00012960: 6561 6420 6f66 0a20 2020 2020 2020 2020  ead of.         
-00012970: 2020 2066 7265 7175 656e 6379 5f73 7465     frequency_ste
-00012980: 702e 2054 6869 7320 6e75 6d62 6572 2069  p. This number i
-00012990: 6e63 6c75 6465 7320 656e 6420 706f 696e  ncludes end poin
-000129a0: 7473 2e20 4465 6661 756c 7420 6973 204e  ts. Default is N
-000129b0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-000129c0: 2077 6869 6368 2067 6976 6573 2032 3031   which gives 201
-000129d0: 2e0a 2020 2020 2020 2020 6e75 6d5f 706f  ..        num_po
-000129e0: 696e 7473 5f69 6e5f 6261 7463 683a 2069  ints_in_batch: i
-000129f0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
-00012a00: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-00012a10: 6f66 2073 616d 706c 696e 6720 706f 696e  of sampling poin
-00012a20: 7473 2069 6e20 6f6e 6520 6261 7463 682e  ts in one batch.
-00012a30: 2054 6869 7320 6973 2066 6f72 2074 6865   This is for the
-00012a40: 2066 7265 7175 656e 6379 0a20 2020 2020   frequency.     
-00012a50: 2020 2020 2020 2073 616d 706c 696e 6720         sampling 
-00012a60: 6d6f 6465 2061 6e64 2074 6865 2073 616d  mode and the sam
-00012a70: 706c 696e 6720 706f 696e 7473 2061 7265  pling points are
-00012a80: 2064 6976 6964 6564 2069 6e74 6f20 6261   divided into ba
-00012a90: 7463 6865 732e 0a20 2020 2020 2020 2020  tches..         
-00012aa0: 2020 204c 6167 6572 206e 756d 6265 7220     Lager number 
-00012ab0: 7072 6f76 6964 6573 2065 6666 6963 6965  provides efficie
-00012ac0: 6e74 2075 7365 206f 6620 6d75 6c74 692d  nt use of multi-
-00012ad0: 636f 7265 7320 6275 7420 6d6f 7265 0a20  cores but more. 
-00012ae0: 2020 2020 2020 2020 2020 206d 656d 6f72             memor
-00012af0: 7920 6465 6d61 6e64 696e 672e 2044 6566  y demanding. Def
-00012b00: 6175 6c74 2069 7320 4e6f 6e65 2c20 7768  ault is None, wh
-00012b10: 6963 6820 6769 7665 2074 6865 206e 756d  ich give the num
-00012b20: 6265 7220 6f66 2031 302e 0a20 2020 2020  ber of 10..     
-00012b30: 2020 2077 7269 7465 5f74 7874 203a 2062     write_txt : b
-00012b40: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
-00012b50: 2020 2020 2020 2020 2020 4672 6571 7565            Freque
-00012b60: 6e63 7920 706f 696e 7473 2061 6e64 2073  ncy points and s
-00012b70: 7065 6374 7261 6c20 6675 6e63 7469 6f6e  pectral function
-00012b80: 7320 6172 6520 7772 6974 7465 6e0a 2020  s are written.  
-00012b90: 2020 2020 2020 2020 2020 696e 746f 2074            into t
-00012ba0: 6578 7420 6669 6c65 732e 2044 6566 6175  ext files. Defau
-00012bb0: 6c74 2069 7320 4661 6c73 652e 0a20 2020  lt is False..   
-00012bc0: 2020 2020 2077 7269 7465 5f68 6466 3520       write_hdf5 
-00012bd0: 3a20 626f 6f6c 0a20 2020 2020 2020 2020  : bool.         
-00012be0: 2020 2052 6573 756c 7473 2061 7265 2073     Results are s
-00012bf0: 746f 7265 6420 696e 2068 6466 3520 6669  tored in hdf5 fi
-00012c00: 6c65 7320 696e 6465 7065 6e64 656e 746c  les independentl
-00012c10: 7920 6174 2067 7269 6420 706f 696e 7473  y at grid points
-00012c20: 2c0a 2020 2020 2020 2020 2020 2020 6570  ,.            ep
-00012c30: 7369 6c6f 6e73 2e20 4465 6661 756c 7420  silons. Default 
-00012c40: 6973 2046 616c 7365 2e0a 2020 2020 2020  is False..      
-00012c50: 2020 6f75 7470 7574 5f66 696c 656e 616d    output_filenam
-00012c60: 6520 3a20 7374 720a 2020 2020 2020 2020  e : str.        
-00012c70: 2020 2020 5468 6973 2073 7472 696e 6720      This string 
-00012c80: 6973 2069 6e73 6572 7465 6420 696e 2074  is inserted in t
-00012c90: 6865 206f 7574 7075 7420 6669 6c65 206e  he output file n
-00012ca0: 616d 6573 2e0a 0a20 2020 2020 2020 2022  ames...        "
-00012cb0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-00012cc0: 6c66 2e5f 696e 7465 7261 6374 696f 6e20  lf._interaction 
-00012cd0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00012ce0: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
-00012cf0: 2020 2020 2020 2020 2020 2020 2022 5068               "Ph
-00012d00: 6f6e 6f33 7079 2e69 6e69 745f 7068 7068  ono3py.init_phph
-00012d10: 5f69 6e74 6572 6163 7469 6f6e 2068 6173  _interaction has
-00012d20: 2074 6f20 6265 2063 616c 6c65 6420 220a   to be called ".
-00012d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d40: 2262 6566 6f72 6520 7275 6e6e 696e 6720  "before running 
-00012d50: 7468 6973 206d 6574 686f 642e 220a 2020  this method.".  
-00012d60: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00012d70: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
-00012d80: 6e74 696d 6545 7272 6f72 286d 7367 290a  ntimeError(msg).
-00012d90: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
-00012da0: 7065 6374 7261 6c5f 6675 6e63 7469 6f6e  pectral_function
-00012db0: 203d 2072 756e 5f73 7065 6374 7261 6c5f   = run_spectral_
-00012dc0: 6675 6e63 7469 6f6e 280a 2020 2020 2020  function(.      
-00012dd0: 2020 2020 2020 7365 6c66 2e5f 696e 7465        self._inte
-00012de0: 7261 6374 696f 6e2c 0a20 2020 2020 2020  raction,.       
-00012df0: 2020 2020 2067 7269 645f 706f 696e 7473       grid_points
-00012e00: 2c0a 2020 2020 2020 2020 2020 2020 7465  ,.            te
-00012e10: 6d70 6572 6174 7572 6573 3d74 656d 7065  mperatures=tempe
-00012e20: 7261 7475 7265 732c 0a20 2020 2020 2020  ratures,.       
-00012e30: 2020 2020 2073 6967 6d61 733d 7365 6c66       sigmas=self
-00012e40: 2e5f 7369 676d 6173 2c0a 2020 2020 2020  ._sigmas,.      
-00012e50: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
-00012e60: 706f 696e 7473 3d66 7265 7175 656e 6379  points=frequency
-00012e70: 5f70 6f69 6e74 732c 0a20 2020 2020 2020  _points,.       
-00012e80: 2020 2020 2066 7265 7175 656e 6379 5f73       frequency_s
-00012e90: 7465 703d 6672 6571 7565 6e63 795f 7374  tep=frequency_st
-00012ea0: 6570 2c0a 2020 2020 2020 2020 2020 2020  ep,.            
-00012eb0: 6e75 6d5f 6672 6571 7565 6e63 795f 706f  num_frequency_po
-00012ec0: 696e 7473 3d6e 756d 5f66 7265 7175 656e  ints=num_frequen
-00012ed0: 6379 5f70 6f69 6e74 732c 0a20 2020 2020  cy_points,.     
-00012ee0: 2020 2020 2020 206e 756d 5f70 6f69 6e74         num_point
-00012ef0: 735f 696e 5f62 6174 6368 3d6e 756d 5f70  s_in_batch=num_p
-00012f00: 6f69 6e74 735f 696e 5f62 6174 6368 2c0a  oints_in_batch,.
-00012f10: 2020 2020 2020 2020 2020 2020 6261 6e64              band
-00012f20: 5f69 6e64 6963 6573 3d73 656c 662e 5f62  _indices=self._b
-00012f30: 616e 645f 696e 6469 6365 732c 0a20 2020  and_indices,.   
-00012f40: 2020 2020 2020 2020 2077 7269 7465 5f74           write_t
-00012f50: 7874 3d77 7269 7465 5f74 7874 2c0a 2020  xt=write_txt,.  
-00012f60: 2020 2020 2020 2020 2020 7772 6974 655f            write_
-00012f70: 6864 6635 3d77 7269 7465 5f68 6466 352c  hdf5=write_hdf5,
-00012f80: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00012f90: 7075 745f 6669 6c65 6e61 6d65 3d6f 7574  put_filename=out
-00012fa0: 7075 745f 6669 6c65 6e61 6d65 2c0a 2020  put_filename,.  
-00012fb0: 2020 2020 2020 2020 2020 6c6f 675f 6c65            log_le
-00012fc0: 7665 6c3d 7365 6c66 2e5f 6c6f 675f 6c65  vel=self._log_le
-00012fd0: 7665 6c2c 0a20 2020 2020 2020 2029 0a0a  vel,.        )..
-00012fe0: 2020 2020 6465 6620 7275 6e5f 7468 6572      def run_ther
-00012ff0: 6d61 6c5f 636f 6e64 7563 7469 7669 7479  mal_conductivity
-00013000: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00013010: 2020 2020 2020 2020 6973 5f4c 4254 453d          is_LBTE=
-00013020: 4661 6c73 652c 0a20 2020 2020 2020 2074  False,.        t
-00013030: 656d 7065 7261 7475 7265 733d 4e6f 6e65  emperatures=None
-00013040: 2c0a 2020 2020 2020 2020 6973 5f69 736f  ,.        is_iso
-00013050: 746f 7065 3d46 616c 7365 2c0a 2020 2020  tope=False,.    
-00013060: 2020 2020 6d61 7373 5f76 6172 6961 6e63      mass_varianc
-00013070: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
-00013080: 2067 7269 645f 706f 696e 7473 3d4e 6f6e   grid_points=Non
-00013090: 652c 0a20 2020 2020 2020 2062 6f75 6e64  e,.        bound
-000130a0: 6172 795f 6d66 703d 4e6f 6e65 2c20 2023  ary_mfp=None,  #
-000130b0: 2069 6e20 6d69 6372 6f6d 6574 7265 0a20   in micrometre. 
-000130c0: 2020 2020 2020 2073 6f6c 7665 5f63 6f6c         solve_col
-000130d0: 6c65 6374 6976 655f 7068 6f6e 6f6e 3d46  lective_phonon=F
-000130e0: 616c 7365 2c0a 2020 2020 2020 2020 7573  alse,.        us
-000130f0: 655f 6176 655f 7070 3d46 616c 7365 2c0a  e_ave_pp=False,.
-00013100: 2020 2020 2020 2020 6973 5f72 6564 7563          is_reduc
-00013110: 6962 6c65 5f63 6f6c 6c69 7369 6f6e 5f6d  ible_collision_m
-00013120: 6174 7269 783d 4661 6c73 652c 0a20 2020  atrix=False,.   
-00013130: 2020 2020 2069 735f 6b61 7070 615f 7374       is_kappa_st
-00013140: 6172 3d54 7275 652c 0a20 2020 2020 2020  ar=True,.       
-00013150: 2067 765f 6465 6c74 615f 713d 4e6f 6e65   gv_delta_q=None
-00013160: 2c20 2023 2066 6f72 2067 726f 7570 2076  ,  # for group v
-00013170: 656c 6f63 6974 790a 2020 2020 2020 2020  elocity.        
-00013180: 6973 5f66 756c 6c5f 7070 3d46 616c 7365  is_full_pp=False
-00013190: 2c0a 2020 2020 2020 2020 7069 6e76 5f63  ,.        pinv_c
-000131a0: 7574 6f66 663d 312e 3065 2d38 2c20 2023  utoff=1.0e-8,  #
-000131b0: 2066 6f72 2070 7365 7564 6f2d 696e 7665   for pseudo-inve
-000131c0: 7273 696f 6e20 6f66 2063 6f6c 6c69 7369  rsion of collisi
-000131d0: 6f6e 206d 6174 7269 780a 2020 2020 2020  on matrix.      
-000131e0: 2020 7069 6e76 5f6d 6574 686f 643d 302c    pinv_method=0,
-000131f0: 2020 2320 666f 7220 7073 6575 646f 2d69    # for pseudo-i
-00013200: 6e76 6572 7369 6f6e 206f 6620 636f 6c6c  nversion of coll
-00013210: 6973 696f 6e20 6d61 7472 6978 0a20 2020  ision matrix.   
-00013220: 2020 2020 2070 696e 765f 736f 6c76 6572       pinv_solver
-00013230: 3d30 2c20 2023 2073 6f6c 7665 7220 6f66  =0,  # solver of
-00013240: 2070 7365 7564 6f2d 696e 7665 7273 696f   pseudo-inversio
-00013250: 6e20 6f66 2063 6f6c 6c69 7369 6f6e 206d  n of collision m
-00013260: 6174 7269 780a 2020 2020 2020 2020 7772  atrix.        wr
-00013270: 6974 655f 6761 6d6d 613d 4661 6c73 652c  ite_gamma=False,
-00013280: 0a20 2020 2020 2020 2072 6561 645f 6761  .        read_ga
-00013290: 6d6d 613d 4661 6c73 652c 0a20 2020 2020  mma=False,.     
-000132a0: 2020 2069 735f 4e5f 553d 4661 6c73 652c     is_N_U=False,
-000132b0: 0a20 2020 2020 2020 2063 6f6e 6475 6374  .        conduct
-000132c0: 6976 6974 795f 7479 7065 3d4e 6f6e 652c  ivity_type=None,
-000132d0: 0a20 2020 2020 2020 2077 7269 7465 5f6b  .        write_k
-000132e0: 6170 7061 3d46 616c 7365 2c0a 2020 2020  appa=False,.    
-000132f0: 2020 2020 7772 6974 655f 6761 6d6d 615f      write_gamma_
-00013300: 6465 7461 696c 3d46 616c 7365 2c0a 2020  detail=False,.  
-00013310: 2020 2020 2020 7772 6974 655f 636f 6c6c        write_coll
-00013320: 6973 696f 6e3d 4661 6c73 652c 0a20 2020  ision=False,.   
-00013330: 2020 2020 2072 6561 645f 636f 6c6c 6973       read_collis
-00013340: 696f 6e3d 4661 6c73 652c 0a20 2020 2020  ion=False,.     
-00013350: 2020 2077 7269 7465 5f70 703d 4661 6c73     write_pp=Fals
-00013360: 652c 0a20 2020 2020 2020 2072 6561 645f  e,.        read_
-00013370: 7070 3d46 616c 7365 2c0a 2020 2020 2020  pp=False,.      
-00013380: 2020 7772 6974 655f 4c42 5445 5f73 6f6c    write_LBTE_sol
-00013390: 7574 696f 6e3d 4661 6c73 652c 0a20 2020  ution=False,.   
-000133a0: 2020 2020 2063 6f6d 7072 6573 7369 6f6e       compression
-000133b0: 3d22 677a 6970 222c 0a20 2020 2020 2020  ="gzip",.       
-000133c0: 2069 6e70 7574 5f66 696c 656e 616d 653d   input_filename=
-000133d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f75  None,.        ou
-000133e0: 7470 7574 5f66 696c 656e 616d 653d 4e6f  tput_filename=No
-000133f0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00013400: 2020 2022 2222 5275 6e20 7468 6572 6d61     """Run therma
-00013410: 6c20 636f 6e64 7563 7469 7669 7479 2063  l conductivity c
-00013420: 616c 6375 6c61 7469 6f6e 2e0a 0a20 2020  alculation...   
-00013430: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00013440: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00013450: 2d2d 0a20 2020 2020 2020 2069 735f 4c42  --.        is_LB
-00013460: 5445 203a 2062 6f6f 6c2c 206f 7074 696f  TE : bool, optio
-00013470: 6e61 6c2c 2064 6566 6175 6c74 2069 7320  nal, default is 
-00013480: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00013490: 2020 5254 4120 2846 616c 7365 2920 6f72    RTA (False) or
-000134a0: 2064 6972 6563 7420 736f 6c75 7469 6f6e   direct solution
-000134b0: 2028 5472 7565 292e 0a20 2020 2020 2020   (True)..       
-000134c0: 2074 656d 7065 7261 7475 7265 7320 3a20   temperatures : 
-000134d0: 6172 7261 795f 6c69 6b65 2c20 6f70 7469  array_like, opti
-000134e0: 6f6e 616c 2c20 6465 6661 756c 7420 6973  onal, default is
-000134f0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-00013500: 2020 5465 6d70 6572 6174 7572 6573 2061    Temperatures a
-00013510: 7420 7768 6963 6820 7468 6572 6d61 6c20  t which thermal 
-00013520: 636f 6e64 7563 7469 7669 7479 2069 7320  conductivity is 
-00013530: 6361 6c63 756c 6174 6564 2e0a 2020 2020  calculated..    
-00013540: 2020 2020 2020 2020 7368 6170 653d 2874          shape=(t
-00013550: 656d 7065 7261 7475 7265 5f70 6f69 6e74  emperature_point
-00013560: 732c 2029 2c20 6474 7970 653d 2764 6f75  s, ), dtype='dou
-00013570: 626c 6527 2e0a 2020 2020 2020 2020 2020  ble'..          
-00013580: 2020 5769 7468 204e 6f6e 652c 0a20 2020    With None,.   
-00013590: 2020 2020 2020 2020 2020 2020 2060 6973               `is
-000135a0: 5f4c 4254 453d 4661 6c73 6560 2067 6976  _LBTE=False` giv
-000135b0: 6573 2074 656d 7065 7261 7475 7265 733d  es temperatures=
-000135c0: 5b30 2c20 3130 2c20 2e2e 2e2c 2031 3030  [0, 10, ..., 100
-000135d0: 305d 2e0a 2020 2020 2020 2020 2020 2020  0]..            
-000135e0: 2020 2020 6069 735f 4c42 5445 3d54 7275      `is_LBTE=Tru
-000135f0: 6560 2067 6976 6573 2074 656d 7065 7261  e` gives tempera
-00013600: 7475 7265 733d 5b33 3030 2c20 5d2e 0a20  tures=[300, ].. 
-00013610: 2020 2020 2020 2069 735f 6973 6f74 6f70         is_isotop
-00013620: 6520 3a20 626f 6f6c 2c20 6f70 7469 6f6e  e : bool, option
-00013630: 616c 2c20 6465 6661 756c 7420 6973 2046  al, default is F
-00013640: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00013650: 2057 6974 6820 6f72 2077 6974 686f 7574   With or without
-00013660: 2069 736f 746f 7065 2073 6361 7474 6572   isotope scatter
-00013670: 696e 672e 0a20 2020 2020 2020 206d 6173  ing..        mas
-00013680: 735f 7661 7269 616e 6365 7320 3a20 6172  s_variances : ar
-00013690: 7261 795f 6c69 6b65 2c20 6f70 7469 6f6e  ray_like, option
-000136a0: 616c 2c20 6465 6661 756c 7420 6973 204e  al, default is N
-000136b0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-000136c0: 4d61 7373 2076 6172 6961 6e63 6573 2066  Mass variances f
-000136d0: 6f72 2069 736f 746f 7065 2073 6361 7474  or isotope scatt
-000136e0: 6572 696e 6720 6361 6c63 756c 6174 696f  ering calculatio
-000136f0: 6e2e 2057 6865 6e20 4e6f 6e65 2c0a 2020  n. When None,.  
-00013700: 2020 2020 2020 2020 2020 7468 6520 7661            the va
-00013710: 6c75 6573 2073 746f 7265 6420 696e 2070  lues stored in p
-00013720: 686f 6e6f 3370 7920 6172 6520 7573 6564  hono3py are used
-00013730: 2077 6974 6820 6069 735f 6973 6f74 6f70   with `is_isotop
-00013740: 653d 5472 7565 602e 0a20 2020 2020 2020  e=True`..       
-00013750: 2020 2020 2073 6861 7065 2861 746f 6d73       shape(atoms
-00013760: 5f69 6e5f 7072 696d 6974 6976 652c 2029  _in_primitive, )
-00013770: 2c20 6474 7970 653d 2764 6f75 626c 6527  , dtype='double'
-00013780: 2e0a 2020 2020 2020 2020 6772 6964 5f70  ..        grid_p
-00013790: 6f69 6e74 7320 3a20 6172 7261 795f 6c69  oints : array_li
-000137a0: 6b65 2c20 6f70 7469 6f6e 616c 2c20 6465  ke, optional, de
-000137b0: 6661 756c 7420 6973 204e 6f6e 650a 2020  fault is None.  
-000137c0: 2020 2020 2020 2020 2020 4c69 7374 206f            List o
-000137d0: 6620 6772 6964 2070 6f69 6e74 2069 6e64  f grid point ind
-000137e0: 6963 6573 2077 6865 7265 206d 6f64 6520  ices where mode 
-000137f0: 7468 6572 6d61 6c20 636f 6e64 7563 7469  thermal conducti
-00013800: 7669 7469 6573 2061 7265 0a20 2020 2020  vities are.     
-00013810: 2020 2020 2020 2063 616c 6375 6c61 7465         calculate
-00013820: 642e 2057 6974 6820 4e6f 6e65 2c20 616c  d. With None, al
-00013830: 6c20 7468 6520 6772 6964 2070 6f69 6e74  l the grid point
-00013840: 7320 7468 6174 2061 7265 206e 6563 6573  s that are neces
-00013850: 7361 7279 0a20 2020 2020 2020 2020 2020  sary.           
-00013860: 2066 6f72 2074 6865 726d 616c 2063 6f6e   for thermal con
-00013870: 6475 6374 6976 6974 7920 6172 6520 7365  ductivity are se
-00013880: 7420 696e 7465 726e 616c 6c79 2e0a 2020  t internally..  
-00013890: 2020 2020 2020 2020 2020 7368 6170 6528            shape(
-000138a0: 6e75 6d5f 6772 6964 5f70 6f69 6e74 732c  num_grid_points,
-000138b0: 2029 2c20 6474 7970 653d 2769 6e74 5f27   ), dtype='int_'
-000138c0: 2e0a 2020 2020 2020 2020 626f 756e 6461  ..        bounda
-000138d0: 7279 5f6d 6670 203a 2066 6c6f 6174 2c20  ry_mfp : float, 
-000138e0: 6f70 7469 6f6e 612c 2064 6566 6175 6c74  optiona, default
-000138f0: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
-00013900: 2020 2020 204d 6561 6e20 6672 6565 2070       Mean free p
-00013910: 6174 6820 696e 206d 6963 726f 6d65 7472  ath in micrometr
-00013920: 6520 746f 2063 616c 6375 6c61 7465 2073  e to calculate s
-00013930: 696d 706c 6520 626f 756e 6461 7279 0a20  imple boundary. 
-00013940: 2020 2020 2020 2020 2020 2073 6361 7474             scatt
-00013950: 6572 696e 6720 636f 6e74 7269 6275 7469  ering contributi
-00013960: 6f6e 2074 6f20 7468 6572 6d61 6c20 636f  on to thermal co
-00013970: 6e64 7563 7469 7669 7479 2e0a 2020 2020  nductivity..    
-00013980: 2020 2020 2020 2020 4e6f 6e65 2067 6976          None giv
-00013990: 6573 2031 206d 6574 7265 2c20 7768 6963  es 1 metre, whic
-000139a0: 6820 6973 2073 7570 706f 7365 6420 6e65  h is supposed ne
-000139b0: 676c 6967 6962 6c65 2063 6f6e 7472 6962  gligible contrib
-000139c0: 7574 696f 6e2c 0a20 2020 2020 2020 2020  ution,.         
-000139d0: 2020 2062 7574 2074 6869 7320 7661 6c75     but this valu
-000139e0: 6520 6973 2075 7365 6420 746f 2061 766f  e is used to avo
-000139f0: 6964 2064 6976 6572 6765 6e63 6520 6f66  id divergence of
-00013a00: 2070 686f 6e6f 6e20 6c69 6665 7469 6d65   phonon lifetime
-00013a10: 2e0a 2020 2020 2020 2020 736f 6c76 655f  ..        solve_
-00013a20: 636f 6c6c 6563 7469 7665 5f70 686f 6e6f  collective_phono
-00013a30: 6e20 3a20 626f 6f6c 2c20 6f70 7469 6f6e  n : bool, option
-00013a40: 616c 2c20 6465 6661 756c 7420 6973 2046  al, default is F
-00013a50: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00013a60: 2054 6869 7320 6973 2061 6e20 6f70 7469   This is an opti
-00013a70: 6f6e 2066 6f72 2074 6865 2066 6561 7475  on for the featu
-00013a80: 7265 2075 6e64 6572 2064 6576 656c 6f70  re under develop
-00013a90: 6d65 6e74 2e0a 2020 2020 2020 2020 7573  ment..        us
-00013aa0: 655f 6176 655f 7070 203a 2062 6f6f 6c2c  e_ave_pp : bool,
-00013ab0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-00013ac0: 6c74 2069 7320 4661 6c73 650a 2020 2020  lt is False.    
-00013ad0: 2020 2020 2020 2020 5254 4120 6f6e 6c79          RTA only
-00013ae0: 2028 6069 735f 4c42 5445 3d46 616c 7365   (`is_LBTE=False
-00013af0: 6029 2e20 4176 6572 6167 6564 2070 686f  `). Averaged pho
-00013b00: 6e6f 6e2d 7068 6f6e 6f6e 2069 6e74 6572  non-phonon inter
-00013b10: 6163 7469 6f6e 0a20 2020 2020 2020 2020  action.         
-00013b20: 2020 2073 7472 656e 6774 6820 6973 2075     strength is u
-00013b30: 7365 6420 746f 2063 616c 6375 6c61 7465  sed to calculate
-00013b40: 2070 686f 6e6f 6e20 6c69 6665 7469 6d65   phonon lifetime
-00013b50: 2e20 5468 6973 2064 6f65 7320 6e6f 740a  . This does not.
-00013b60: 2020 2020 2020 2020 2020 2020 7265 6475              redu
-00013b70: 6365 2063 6f6d 7075 7461 7469 6f6e 616c  ce computational
-00013b80: 2064 656d 616e 642c 2062 7574 206d 6179   demand, but may
-00013b90: 2062 6520 7573 6564 2074 6f20 6d6f 6465   be used to mode
-00013ba0: 6c20 7468 6572 6d61 6c0a 2020 2020 2020  l thermal.      
-00013bb0: 2020 2020 2020 636f 6e64 7563 7469 7669        conductivi
-00013bc0: 7479 2066 6f72 2061 6e61 6c79 7a65 2074  ty for analyze t
-00013bd0: 6865 2063 616c 6375 6c61 7469 6f6e 2072  he calculation r
-00013be0: 6573 756c 7473 2e0a 2020 2020 2020 2020  esults..        
-00013bf0: 6973 5f72 6564 7563 6962 6c65 5f63 6f6c  is_reducible_col
-00013c00: 6c69 7369 6f6e 5f6d 6174 7269 7820 3a20  lision_matrix : 
-00013c10: 626f 6f6c 2c20 6f70 7469 6f6e 616c 2c20  bool, optional, 
-00013c20: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
-00013c30: 0a20 2020 2020 2020 2020 2020 2044 6972  .            Dir
-00013c40: 6563 7420 736f 6c75 7469 6f6e 206f 6e6c  ect solution onl
-00013c50: 7920 2860 6973 5f4c 4254 453d 5472 7565  y (`is_LBTE=True
-00013c60: 6029 2e20 5468 6973 2069 7320 616e 2065  `). This is an e
-00013c70: 7870 6572 696d 656e 7461 6c0a 2020 2020  xperimental.    
-00013c80: 2020 2020 2020 2020 6f70 7469 6f6e 2e20          option. 
-00013c90: 5769 7468 2054 7275 652c 2066 756c 6c20  With True, full 
-00013ca0: 636f 6c6c 6973 696f 6e20 6d61 7472 6978  collision matrix
-00013cb0: 2069 7320 6372 6561 7465 6420 616e 6420   is created and 
-00013cc0: 736f 6c76 6564 2e0a 2020 2020 2020 2020  solved..        
-00013cd0: 6973 5f6b 6170 7061 5f73 7461 7220 3a20  is_kappa_star : 
-00013ce0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 2c20  bool, optional, 
-00013cf0: 6465 6661 756c 7420 6973 2054 7275 650a  default is True.
-00013d00: 2020 2020 2020 2020 2020 2020 5769 7468              With
-00013d10: 2074 7275 652c 2073 796d 6d65 7472 7920   true, symmetry 
-00013d20: 6973 2063 6f6e 7369 6465 7265 6420 7768  is considered wh
-00013d30: 656e 2073 616d 706c 696e 6720 6772 6964  en sampling grid
-00013d40: 2070 6f69 6e74 730a 2020 2020 2020 2020   points.        
-00013d50: 2020 2020 6174 2077 6869 6368 206d 6f64      at which mod
-00013d60: 6520 7468 6572 6d61 6c20 636f 6e64 7563  e thermal conduc
-00013d70: 7469 7669 7469 6573 2061 7265 2063 616c  tivities are cal
-00013d80: 6375 6c61 7465 642e 0a20 2020 2020 2020  culated..       
-00013d90: 2067 765f 6465 6c74 615f 7120 3a20 666c   gv_delta_q : fl
-00013da0: 6f61 742c 206f 7074 696f 6e61 6c2c 2064  oat, optional, d
-00013db0: 6566 6175 6c74 2069 7320 4e6f 6e65 2c20  efault is None, 
-00013dc0: 2023 2066 6f72 2067 726f 7570 2076 656c   # for group vel
-00013dd0: 6f63 6974 790a 2020 2020 2020 2020 2020  ocity.          
-00013de0: 2020 5769 7468 206e 6f6e 2d61 6e61 6c79    With non-analy
-00013df0: 7469 6361 6c20 636f 7272 6563 7469 6f6e  tical correction
-00013e00: 2c20 6772 6f75 7020 7665 6c6f 6369 7479  , group velocity
-00013e10: 2069 7320 6361 6c63 756c 6174 6564 0a20   is calculated. 
-00013e20: 2020 2020 2020 2020 2020 2062 7920 6365             by ce
-00013e30: 6e74 7261 6c20 6669 6e69 7465 2064 6966  ntral finite dif
-00013e40: 6665 7265 6e63 6520 6d65 7468 6f64 2e20  ference method. 
-00013e50: 5468 6973 2076 616c 7565 2067 6976 6573  This value gives
-00013e60: 2074 6865 2064 6973 7461 6e63 650a 2020   the distance.  
-00013e70: 2020 2020 2020 2020 2020 696e 2062 6f74            in bot
-00013e80: 6820 6469 7265 6374 696f 6e73 2069 6e20  h directions in 
-00013e90: 312f 416e 6773 7472 6f6d 2e20 5468 6520  1/Angstrom. The 
-00013ea0: 6465 6661 756c 7420 7661 6c75 6520 7769  default value wi
-00013eb0: 6c6c 2062 6520 3165 2d35 2e0a 2020 2020  ll be 1e-5..    
-00013ec0: 2020 2020 6973 5f66 756c 6c5f 7070 203a      is_full_pp :
-00013ed0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c2c   bool, optional,
-00013ee0: 2064 6566 6175 6c74 2069 7320 4661 6c73   default is Fals
-00013ef0: 650a 2020 2020 2020 2020 2020 2020 5769  e.            Wi
-00013f00: 7468 2054 7275 652c 2066 756c 6c20 656c  th True, full el
-00013f10: 656d 656e 7473 206f 6620 7068 6f6e 6f6e  ements of phonon
-00013f20: 2d70 686f 6e6f 6e20 696e 7465 7261 6374  -phonon interact
-00013f30: 696f 6e20 7374 7265 6e67 7468 0a20 2020  ion strength.   
-00013f40: 2020 2020 2020 2020 2061 7265 2063 6f6d           are com
-00013f50: 7075 7465 642e 2048 6f77 6576 6572 2077  puted. However w
-00013f60: 6974 6820 7465 7472 6168 6564 726f 6e20  ith tetrahedron 
-00013f70: 6d65 7468 6f64 2c20 7061 7274 206f 6620  method, part of 
-00013f80: 7468 656d 2061 7265 0a20 2020 2020 2020  them are.       
-00013f90: 2020 2020 206b 6e6f 776e 2074 6f20 6265       known to be
-00013fa0: 207a 6572 6f20 616e 6420 756e 6e65 6365   zero and unnece
-00013fb0: 7373 6172 7920 746f 2063 616c 6375 6c61  ssary to calcula
-00013fc0: 7469 6f6e 2e20 5769 7468 2046 616c 7365  tion. With False
-00013fd0: 2c0a 2020 2020 2020 2020 2020 2020 7468  ,.            th
-00013fe0: 6f73 6520 656c 656d 656e 7473 2061 7265  ose elements are
-00013ff0: 206e 6f74 2063 616c 6375 6c61 7465 642c   not calculated,
-00014000: 2062 7920 7768 6963 6820 636f 6e73 6964   by which consid
-00014010: 6572 6162 6c65 0a20 2020 2020 2020 2020  erable.         
-00014020: 2020 2069 6d70 726f 7665 206f 6620 6566     improve of ef
-00014030: 6669 6369 656e 6379 2069 7320 6578 7065  ficiency is expe
-00014040: 6374 6564 2e0a 2020 2020 2020 2020 2020  cted..          
-00014050: 2020 5769 7468 2073 6d65 6172 696e 6720    With smearing 
-00014060: 6d65 7468 6f64 2c20 6576 656e 2069 6620  method, even if 
-00014070: 7468 6973 2069 7320 7365 7420 4661 6c73  this is set Fals
-00014080: 652c 2066 756c 6c20 656c 656d 656e 7473  e, full elements
-00014090: 0a20 2020 2020 2020 2020 2020 2061 7265  .            are
-000140a0: 2063 6f6d 7075 7465 6420 756e 6c65 7373   computed unless
-000140b0: 2060 7369 676d 615f 6375 746f 6666 6020   `sigma_cutoff` 
-000140c0: 6973 2073 7065 6369 6669 6564 2e0a 2020  is specified..  
-000140d0: 2020 2020 2020 7069 6e76 5f63 7574 6f66        pinv_cutof
-000140e0: 6620 3a20 666c 6f61 742c 206f 7074 696f  f : float, optio
-000140f0: 6e61 6c2c 2064 6566 6175 6c74 2069 7320  nal, default is 
-00014100: 312e 3065 2d38 0a20 2020 2020 2020 2020  1.0e-8.         
-00014110: 2020 2044 6972 6563 7420 736f 6c75 7469     Direct soluti
-00014120: 6f6e 206f 6e6c 7920 2860 6973 5f4c 4254  on only (`is_LBT
-00014130: 453d 5472 7565 6029 2e20 5468 6973 2069  E=True`). This i
-00014140: 7320 7573 6564 2061 7320 6120 6372 6974  s used as a crit
-00014150: 6572 696f 6e0a 2020 2020 2020 2020 2020  erion.          
-00014160: 2020 746f 206a 7564 6765 2074 6865 2065    to judge the e
-00014170: 6967 656e 7661 6c75 6573 2061 7265 2063  igenvalues are c
-00014180: 6f6e 7369 6465 7265 6420 6173 207a 6572  onsidered as zer
-00014190: 6f20 6f72 206e 6f74 2069 6e0a 2020 2020  o or not in.    
-000141a0: 2020 2020 2020 2020 7073 6575 646f 2d69          pseudo-i
-000141b0: 6e76 6572 7369 6f6e 206f 6620 636f 6c6c  nversion of coll
-000141c0: 6973 696f 6e20 6d61 7472 6978 2e20 5365  ision matrix. Se
-000141d0: 6520 616c 736f 2060 7069 6e76 5f6d 6574  e also `pinv_met
-000141e0: 686f 6460 2e0a 2020 2020 2020 2020 7069  hod`..        pi
-000141f0: 6e76 5f6d 6574 686f 6420 3a20 696e 742c  nv_method : int,
-00014200: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-00014210: 6c74 2069 7320 302e 0a20 2020 2020 2020  lt is 0..       
-00014220: 2020 2020 2044 6972 6563 7420 736f 6c75       Direct solu
-00014230: 7469 6f6e 206f 6e6c 7920 2860 6973 5f4c  tion only (`is_L
-00014240: 4254 453d 5472 7565 6029 2e0a 2020 2020  BTE=True`)..    
-00014250: 2020 2020 2020 2020 2020 2020 302e 2061              0. a
-00014260: 6273 2865 6967 656e 7661 6c75 6529 203c  bs(eigenvalue) <
-00014270: 2060 7069 6e76 5f63 7574 6f66 6660 0a20   `pinv_cutoff`. 
-00014280: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-00014290: 2e20 6569 6765 6e76 616c 7565 203c 2060  . eigenvalue < `
-000142a0: 7069 6e76 5f63 7574 6f66 6660 0a20 2020  pinv_cutoff`.   
-000142b0: 2020 2020 2070 696e 765f 736f 6c76 6572       pinv_solver
-000142c0: 203a 2069 6e74 2c20 6f70 7469 6f6e 616c   : int, optional
-000142d0: 2c20 6465 6661 756c 7420 6973 2030 0a20  , default is 0. 
-000142e0: 2020 2020 2020 2020 2020 2044 6972 6563             Direc
-000142f0: 7420 736f 6c75 7469 6f6e 206f 6e6c 7920  t solution only 
-00014300: 2860 6973 5f4c 4254 453d 5472 7565 6029  (`is_LBTE=True`)
-00014310: 2e20 4368 6f69 6365 206f 6620 736f 6c76  . Choice of solv
-00014320: 6572 206f 660a 2020 2020 2020 2020 2020  er of.          
-00014330: 2020 7073 6575 646f 2d69 6e76 6572 7369    pseudo-inversi
-00014340: 6f6e 206f 6620 636f 6c6c 6973 696f 6e20  on of collision 
-00014350: 6d61 7472 6978 2e20 3020 6d65 616e 7320  matrix. 0 means 
-00014360: 7468 6520 6465 6661 756c 7420 6368 6f69  the default choi
-00014370: 6365 2e0a 2020 2020 2020 2020 2020 2020  ce..            
-00014380: 2020 2020 312e 204c 6170 6163 6b65 2064      1. Lapacke d
-00014390: 7379 6576 3a20 536d 616c 6c65 7220 6d65  syev: Smaller me
-000143a0: 6d6f 7279 2063 6f6e 7375 6d70 7469 6f6e  mory consumption
-000143b0: 2074 6861 6e20 6473 7965 7664 2c20 6275   than dsyevd, bu
-000143c0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-000143d0: 2020 2020 2073 6c6f 7765 722e 2054 6869       slower. Thi
-000143e0: 7320 6973 2074 6865 2064 6566 6175 6c74  s is the default
-000143f0: 2073 6f6c 7665 7220 7768 656e 204d 4b4c   solver when MKL
-00014400: 204c 4150 4143 4b45 2069 730a 2020 2020   LAPACKE is.    
-00014410: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00014420: 6e74 6567 7261 7465 6420 6f72 2073 6369  ntegrated or sci
-00014430: 7079 2069 7320 6e6f 7420 696e 7374 616c  py is not instal
-00014440: 6c65 642e 0a20 2020 2020 2020 2020 2020  led..           
-00014450: 2020 2020 2032 2e20 4c61 7061 636b 6520       2. Lapacke 
-00014460: 6473 7965 7664 3a20 4c61 7267 6572 206d  dsyevd: Larger m
-00014470: 656d 6f72 7920 636f 6e73 756d 7074 696f  emory consumptio
-00014480: 6e20 7468 616e 2064 7379 6576 2c20 6275  n than dsyev, bu
-00014490: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-000144a0: 2020 2020 2066 6173 7465 722e 2054 6869       faster. Thi
-000144b0: 7320 6973 206e 6f74 2072 6563 6f6d 6d65  s is not recomme
-000144c0: 6e64 6564 2062 6563 6175 7365 2073 6f6d  nded because som
-000144d0: 6574 696d 6573 2061 2077 726f 6e67 0a20  etimes a wrong. 
-000144e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144f0: 2020 7265 7375 6c74 2069 7320 6f62 7461    result is obta
-00014500: 696e 6564 2e0a 2020 2020 2020 2020 2020  ined..          
-00014510: 2020 2020 2020 332e 204e 756d 7079 e280        3. Numpy..
-00014520: 9973 2064 7379 6576 6420 286c 696e 616c  .s dsyevd (linal
-00014530: 672e 6569 6768 292e 2054 6869 7320 6973  g.eigh). This is
-00014540: 206e 6f74 2072 6563 6f6d 6d65 6e64 6564   not recommended
-00014550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014560: 2020 2020 6265 6361 7573 6520 736f 6d65      because some
-00014570: 7469 6d65 7320 6120 7772 6f6e 6720 7265  times a wrong re
-00014580: 7375 6c74 2069 7320 6f62 7461 696e 6564  sult is obtained
-00014590: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000145a0: 2020 342e 2053 6369 7079 e280 9973 2064    4. Scipy...s d
-000145b0: 7379 6576 3a20 5468 6973 2069 7320 7468  syev: This is th
-000145c0: 6520 6465 6661 756c 7420 736f 6c76 6572  e default solver
-000145d0: 2077 6865 6e20 7363 6970 7920 6973 0a20   when scipy is. 
-000145e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000145f0: 2020 696e 7374 616c 6c65 6420 616e 6420    installed and 
-00014600: 4d4b 4c20 4c41 5041 434b 4520 6973 206e  MKL LAPACKE is n
-00014610: 6f74 2069 6e74 6567 7261 7465 642e 0a20  ot integrated.. 
-00014620: 2020 2020 2020 2020 2020 2020 2020 2035                 5
-00014630: 2e20 5363 6970 79e2 8099 7320 6473 7965  . Scipy...s dsye
-00014640: 7664 2e20 5468 6973 2069 7320 6e6f 7420  vd. This is not 
-00014650: 7265 636f 6d6d 656e 6465 6420 6265 6361  recommended beca
-00014660: 7573 6520 736f 6d65 7469 6d65 730a 2020  use sometimes.  
-00014670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014680: 2061 2077 726f 6e67 2072 6573 756c 7420   a wrong result 
-00014690: 6973 206f 6274 6169 6e65 642e 0a20 2020  is obtained..   
-000146a0: 2020 2020 2020 2020 2054 6865 2073 6f6c           The sol
-000146b0: 7665 7220 6368 6f69 6365 7320 6f74 6865  ver choices othe
-000146c0: 7220 7468 616e 202d 2d70 696e 762d 736f  r than --pinv-so
-000146d0: 6c76 6572 3d31 2061 6e64 0a20 2020 2020  lver=1 and.     
-000146e0: 2020 2020 2020 202d 2d70 696e 762d 736f         --pinv-so
-000146f0: 6c76 6572 3d34 2061 7265 2064 616e 6765  lver=4 are dange
-00014700: 726f 7573 2061 6e64 206e 6f74 2072 6563  rous and not rec
-00014710: 6f6d 6d65 6e64 2e0a 2020 2020 2020 2020  ommend..        
-00014720: 7772 6974 655f 6761 6d6d 6120 3a20 626f  write_gamma : bo
-00014730: 6f6c 2c20 6f70 7469 6f6e 616c 2c20 6465  ol, optional, de
-00014740: 6661 756c 7420 6973 2046 616c 7365 0a20  fault is False. 
-00014750: 2020 2020 2020 2020 2020 2052 5441 206f             RTA o
-00014760: 6e6c 7920 2860 6973 5f4c 4254 453d 4661  nly (`is_LBTE=Fa
-00014770: 6c73 6560 292e 2057 6974 6820 5472 7565  lse`). With True
-00014780: 2c20 5772 6974 6520 6d6f 6465 2074 6865  , Write mode the
-00014790: 726d 616c 0a20 2020 2020 2020 2020 2020  rmal.           
-000147a0: 2063 6f6e 6475 6374 6976 6974 7920 7072   conductivity pr
-000147b0: 6f70 6572 7469 6573 2069 6e74 6f20 6669  operties into fi
-000147c0: 6c65 7320 6174 2065 6163 6820 6772 6964  les at each grid
-000147d0: 2070 6f69 6e74 2e20 5769 7468 0a20 2020   point. With.   
-000147e0: 2020 2020 2020 2020 2060 6261 6e64 5f69           `band_i
-000147f0: 6e64 6963 6573 6020 6f72 206d 756c 7469  ndices` or multi
-00014800: 706c 6520 6073 6967 6d61 7360 2069 7320  ple `sigmas` is 
-00014810: 7370 6563 6966 6965 642c 2074 6865 2066  specified, the f
-00014820: 696c 6573 0a20 2020 2020 2020 2020 2020  iles.           
-00014830: 2061 7265 206d 6164 6520 666f 7220 6561   are made for ea
-00014840: 6368 206f 6620 7468 656d 2c20 746f 6f2e  ch of them, too.
-00014850: 0a20 2020 2020 2020 2072 6561 645f 6761  .        read_ga
-00014860: 6d6d 6120 3a20 626f 6f6c 2c20 6f70 7469  mma : bool, opti
-00014870: 6f6e 616c 2c20 6465 6661 756c 7420 6973  onal, default is
-00014880: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00014890: 2020 2052 5441 206f 6e6c 7920 2860 6973     RTA only (`is
-000148a0: 5f4c 4254 453d 4661 6c73 6560 292e 2057  _LBTE=False`). W
-000148b0: 6974 6820 5472 7565 2c20 6465 6164 2066  ith True, dead f
-000148c0: 696c 6573 2063 7265 6174 6564 2062 790a  iles created by.
-000148d0: 2020 2020 2020 2020 2020 2020 6077 7269              `wri
-000148e0: 7465 5f67 616d 6d61 3d54 7275 6560 2069  te_gamma=True` i
-000148f0: 6e73 7465 6164 206f 6620 6361 6c63 756c  nstead of calcul
-00014900: 6174 696e 6720 7068 6f6e 6f6e 2d70 686f  ating phonon-pho
-00014910: 6e6f 6e0a 2020 2020 2020 2020 2020 2020  non.            
-00014920: 696e 7465 7261 6374 696f 6e20 7374 7265  interaction stre
-00014930: 6e67 7468 2061 6e64 2069 6d61 6769 6e61  ngth and imagina
-00014940: 7279 2070 6172 7473 206f 6620 7365 6c66  ry parts of self
-00014950: 2d65 6e65 7267 792e 0a20 2020 2020 2020  -energy..       
-00014960: 2069 735f 4e5f 5520 3a20 626f 6f6c 2c20   is_N_U : bool, 
-00014970: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-00014980: 7420 6973 2046 616c 7365 0a20 2020 2020  t is False.     
-00014990: 2020 2020 2020 2052 5441 206f 6e6c 7920         RTA only 
-000149a0: 2860 6973 5f4c 4254 453d 4661 6c73 6560  (`is_LBTE=False`
-000149b0: 292e 2057 6974 6820 5472 7565 2c20 6361  ). With True, ca
-000149c0: 7465 676f 7269 7a61 7469 6f6e 206f 6620  tegorization of 
-000149d0: 6e6f 726d 616c 0a20 2020 2020 2020 2020  normal.         
-000149e0: 2020 2061 6e64 2055 6d6b 6c61 7070 2073     and Umklapp s
-000149f0: 6361 7474 6572 696e 6720 6973 206d 6164  cattering is mad
-00014a00: 6520 616e 6420 696d 6167 696e 6172 7920  e and imaginary 
-00014a10: 7061 7274 7320 6f66 2073 656c 6620 656e  parts of self en
-00014a20: 6572 6779 0a20 2020 2020 2020 2020 2020  ergy.           
-00014a30: 2066 6f72 2074 6865 6d20 6172 6520 7365   for them are se
-00014a40: 7061 7261 7465 642e 0a20 2020 2020 2020  parated..       
-00014a50: 2063 6f6e 6475 6374 6976 6974 795f 7479   conductivity_ty
-00014a60: 7065 203a 2073 7472 2c20 6f70 7469 6f6e  pe : str, option
-00014a70: 616c 0a20 2020 2020 2020 2020 2020 2022  al.            "
-00014a80: 7769 676e 6572 222c 2022 6b75 626f 222c  wigner", "kubo",
-00014a90: 206f 7220 4e6f 6e65 2e20 4465 6661 756c   or None. Defaul
-00014aa0: 7420 6973 204e 6f6e 652e 0a20 2020 2020  t is None..     
-00014ab0: 2020 2077 7269 7465 5f6b 6170 7061 203a     write_kappa :
-00014ac0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c2c   bool, optional,
-00014ad0: 2064 6566 6175 6c74 2069 7320 4661 6c73   default is Fals
-00014ae0: 650a 2020 2020 2020 2020 2020 2020 5769  e.            Wi
-00014af0: 7468 2054 7275 652c 2074 6865 726d 616c  th True, thermal
-00014b00: 2063 6f6e 6475 6374 6976 6974 7920 616e   conductivity an
-00014b10: 6420 7265 6c61 7465 6420 7072 6f70 6572  d related proper
-00014b20: 7469 6573 2061 7265 0a20 2020 2020 2020  ties are.       
-00014b30: 2020 2020 2077 7269 7474 656e 2069 6e74       written int
-00014b40: 6f20 6120 6669 6c65 2e20 5769 7468 206d  o a file. With m
-00014b50: 756c 7469 706c 6520 6073 6967 6d61 7360  ultiple `sigmas`
-00014b60: 2c20 7265 7370 6563 7469 7665 2066 696c  , respective fil
-00014b70: 6573 0a20 2020 2020 2020 2020 2020 2061  es.            a
-00014b80: 7265 2063 7265 6174 6564 2e0a 2020 2020  re created..    
-00014b90: 2020 2020 7772 6974 655f 6761 6d6d 615f      write_gamma_
-00014ba0: 6465 7461 696c 203a 2062 6f6f 6c2c 206f  detail : bool, o
-00014bb0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00014bc0: 2069 7320 4661 6c73 650a 2020 2020 2020   is False.      
-00014bd0: 2020 2020 2020 5254 4120 6f6e 6c79 2028        RTA only (
-00014be0: 6069 735f 4c42 5445 3d46 616c 7365 6029  `is_LBTE=False`)
-00014bf0: 2e20 5769 7468 2054 7275 652c 2064 6574  . With True, det
-00014c00: 6169 6c65 6420 696e 666f 726d 6174 696f  ailed informatio
-00014c10: 6e20 6f66 0a20 2020 2020 2020 2020 2020  n of.           
-00014c20: 2069 6d61 6769 6e61 7279 2070 6172 7473   imaginary parts
-00014c30: 206f 6620 7365 6c66 2065 6e65 7267 7920   of self energy 
-00014c40: 6973 2073 746f 7265 6420 696e 746f 2066  is stored into f
-00014c50: 696c 6573 2073 7563 6820 6173 0a20 2020  iles such as.   
-00014c60: 2020 2020 2020 2020 2074 686f 7365 206d           those m
-00014c70: 6164 6520 6279 2060 7772 6974 655f 6761  ade by `write_ga
-00014c80: 6d6d 6160 2e0a 2020 2020 2020 2020 7772  mma`..        wr
-00014c90: 6974 655f 636f 6c6c 6973 696f 6e20 3a20  ite_collision : 
-00014ca0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 2c20  bool, optional, 
-00014cb0: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
-00014cc0: 0a20 2020 2020 2020 2020 2020 2044 6972  .            Dir
-00014cd0: 6563 7420 736f 6c75 7469 6f6e 206f 6e6c  ect solution onl
-00014ce0: 7920 2860 6973 5f4c 4254 453d 5472 7565  y (`is_LBTE=True
-00014cf0: 6029 2e20 5769 7468 2054 7275 652c 2063  `). With True, c
-00014d00: 6f6c 6c69 7369 6f6e 206d 6174 7269 780a  ollision matrix.
-00014d10: 2020 2020 2020 2020 2020 2020 6973 2077              is w
-00014d20: 7269 7474 656e 2069 6e74 6f20 6120 6669  ritten into a fi
-00014d30: 6c65 2e20 5769 7468 206d 756c 7469 706c  le. With multipl
-00014d40: 6520 6073 6967 6d61 7360 2073 7065 6369  e `sigmas` speci
-00014d50: 6669 6564 2c0a 2020 2020 2020 2020 2020  fied,.          
-00014d60: 2020 7265 7370 6563 7469 7665 2066 696c    respective fil
-00014d70: 6573 2061 7265 2063 7265 6174 6564 2e20  es are created. 
-00014d80: 4265 2063 6172 6566 756c 2074 6861 7420  Be careful that 
-00014d90: 7468 6973 2066 696c 6520 6361 6e20 6265  this file can be
-00014da0: 0a20 2020 2020 2020 2020 2020 2068 7567  .            hug
-00014db0: 652e 0a20 2020 2020 2020 2072 6561 645f  e..        read_
-00014dc0: 636f 6c6c 6973 696f 6e20 3a20 626f 6f6c  collision : bool
-00014dd0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-00014de0: 756c 7420 6973 2046 616c 7365 0a20 2020  ult is False.   
-00014df0: 2020 2020 2020 2020 2044 6972 6563 7420           Direct 
-00014e00: 736f 6c75 7469 6f6e 206f 6e6c 7920 2860  solution only (`
-00014e10: 6973 5f4c 4254 453d 5472 7565 6029 2e20  is_LBTE=True`). 
-00014e20: 5769 7468 2054 7275 652c 2063 6f6c 6c69  With True, colli
-00014e30: 7369 6f6e 206d 6174 7269 780a 2020 2020  sion matrix.    
-00014e40: 2020 2020 2020 2020 6973 2072 6561 6420          is read 
-00014e50: 6672 6f6d 2061 2066 696c 652e 0a20 2020  from a file..   
-00014e60: 2020 2020 2077 7269 7465 5f70 7020 3a20       write_pp : 
-00014e70: 626f 6f6c 2c20 6f70 7469 6f6e 616c 2c20  bool, optional, 
-00014e80: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
-00014e90: 0a20 2020 2020 2020 2020 2020 2057 6974  .            Wit
-00014ea0: 6820 5472 7565 2c20 7068 6f6e 6f6e 2d70  h True, phonon-p
-00014eb0: 686f 6e6f 6e20 696e 7465 7261 6374 696f  honon interactio
-00014ec0: 6e20 7374 7265 6e67 7468 2069 7320 7772  n strength is wr
-00014ed0: 6974 7465 6e20 696e 746f 0a20 2020 2020  itten into.     
-00014ee0: 2020 2020 2020 2066 696c 6573 2061 7420         files at 
-00014ef0: 6561 6368 2067 7269 6420 706f 696e 742e  each grid point.
-00014f00: 2054 6869 7320 6f70 7469 6f6e 2061 7373   This option ass
-00014f10: 756d 6573 2073 696e 676c 6520 7661 6c75  umes single valu
-00014f20: 6520 6973 2069 6e0a 2020 2020 2020 2020  e is in.        
-00014f30: 2020 2020 6073 6967 6d61 7360 2e0a 2020      `sigmas`..  
-00014f40: 2020 2020 2020 7265 6164 5f70 7020 3a20        read_pp : 
-00014f50: 626f 6f6c 2c20 6f70 7469 6f6e 616c 2c20  bool, optional, 
-00014f60: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
-00014f70: 0a20 2020 2020 2020 2020 2020 2057 6974  .            Wit
-00014f80: 6820 5472 7565 2c20 7068 6f6e 6f6e 2d70  h True, phonon-p
-00014f90: 686f 6e6f 6e20 696e 7465 7261 6374 696f  honon interactio
-00014fa0: 6e20 7374 7265 6e67 7468 2069 7320 7265  n strength is re
-00014fb0: 6164 2066 726f 6d20 6669 6c65 732e 0a20  ad from files.. 
-00014fc0: 2020 2020 2020 2077 7269 7465 5f4c 4254         write_LBT
-00014fd0: 455f 736f 6c75 7469 6f6e 203a 2062 6f6f  E_solution : boo
-00014fe0: 6c2c 206f 7074 696f 6e61 6c2c 2064 6566  l, optional, def
-00014ff0: 6175 6c74 2069 7320 4661 6c73 650a 2020  ault is False.  
-00015000: 2020 2020 2020 2020 2020 4469 7265 6374            Direct
-00015010: 2073 6f6c 7574 696f 6e20 6f6e 6c79 2028   solution only (
-00015020: 6069 735f 4c42 5445 3d54 7275 6560 292e  `is_LBTE=True`).
-00015030: 2057 6974 6820 5472 7565 2c20 6569 6765   With True, eige
-00015040: 6e76 6563 746f 7273 206f 660a 2020 2020  nvectors of.    
-00015050: 2020 2020 2020 2020 636f 6c6c 6973 696f          collisio
-00015060: 6e20 6d61 7472 6978 2069 7320 7772 6974  n matrix is writ
-00015070: 7465 6e20 696e 2061 2066 696c 6520 6173  ten in a file as
-00015080: 2074 6865 2072 6f77 2076 6563 746f 7273   the row vectors
-00015090: 2065 7863 6570 740a 2020 2020 2020 2020   except.        
-000150a0: 2020 2020 756e 6c65 7373 2060 7069 6e76      unless `pinv
-000150b0: 5f73 6f6c 7665 723d 3360 2028 666f 7220  _solver=3` (for 
-000150c0: 7468 6973 2c20 636f 6c75 6d6e 2076 6563  this, column vec
-000150d0: 746f 7273 292e 2057 6974 6820 6d75 6c74  tors). With mult
-000150e0: 6970 6c65 0a20 2020 2020 2020 2020 2020  iple.           
-000150f0: 2060 7369 676d 6173 6020 7370 6563 6966   `sigmas` specif
-00015100: 6965 642c 2072 6573 7065 6374 6976 6520  ied, respective 
-00015110: 6669 6c65 7320 6172 6520 6372 6561 7465  files are create
-00015120: 642e 2042 6520 6361 7265 6675 6c20 7468  d. Be careful th
-00015130: 6174 0a20 2020 2020 2020 2020 2020 2074  at.            t
-00015140: 6869 7320 6669 6c65 2063 616e 2062 6520  his file can be 
-00015150: 6875 6765 2e0a 2020 2020 2020 2020 636f  huge..        co
-00015160: 6d70 7265 7373 696f 6e3a 2073 7472 2c20  mpression: str, 
-00015170: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-00015180: 7420 6973 2022 677a 6970 220a 2020 2020  t is "gzip".    
-00015190: 2020 2020 2020 2020 5768 656e 2077 7269          When wri
-000151a0: 7469 6e67 2072 6573 756c 7473 2069 6e74  ting results int
-000151b0: 6f20 6669 6c65 7320 696e 2068 6466 352c  o files in hdf5,
-000151c0: 206c 6172 6765 2064 6174 6120 6172 6520   large data are 
-000151d0: 636f 6d70 7265 7373 6564 0a20 2020 2020  compressed.     
-000151e0: 2020 2020 2020 2062 7920 7468 6973 206f         by this o
-000151f0: 7074 696f 6e73 2e20 5365 6520 7468 6520  ptions. See the 
-00015200: 6465 7461 696c 2061 7420 6835 7079 2064  detail at h5py d
-00015210: 6f63 756d 656e 7461 7469 6f6e 2e0a 2020  ocumentation..  
-00015220: 2020 2020 2020 696e 7075 745f 6669 6c65        input_file
-00015230: 6e61 6d65 203a 2073 7472 2c20 6f70 7469  name : str, opti
-00015240: 6f6e 616c 2c20 6465 6661 756c 7420 6973  onal, default is
-00015250: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-00015260: 2020 5768 656e 2073 7065 6369 6669 6564    When specified
-00015270: 2c20 7468 6520 7374 7269 6e67 2069 7320  , the string is 
-00015280: 696e 7365 7274 6564 2062 6566 6f72 6520  inserted before 
-00015290: 6669 6c65 6e61 6d65 2065 7874 656e 7369  filename extensi
-000152a0: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
-000152b0: 6e20 7265 6164 696e 6720 6669 6c65 732e  n reading files.
-000152c0: 0a20 2020 2020 2020 206f 7574 7075 745f  .        output_
-000152d0: 6669 6c65 6e61 6d65 203a 2073 7472 2c20  filename : str, 
-000152e0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-000152f0: 7420 6973 204e 6f6e 650a 2020 2020 2020  t is None.      
-00015300: 2020 2020 2020 5768 656e 2073 7065 6369        When speci
-00015310: 6669 6564 2c20 7468 6520 7374 7269 6e67  fied, the string
-00015320: 2069 7320 696e 7365 7274 6564 2062 6566   is inserted bef
-00015330: 6f72 6520 6669 6c65 6e61 6d65 2065 7874  ore filename ext
-00015340: 656e 7369 6f6e 0a20 2020 2020 2020 2020  ension.         
-00015350: 2020 2069 6e20 7772 6974 696e 6720 6669     in writing fi
-00015360: 6c65 732e 0a0a 2020 2020 2020 2020 2222  les...        ""
-00015370: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-00015380: 662e 5f69 6e74 6572 6163 7469 6f6e 2069  f._interaction i
-00015390: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-000153a0: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
-000153b0: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
-000153c0: 6e6f 3370 792e 696e 6974 5f70 6870 685f  no3py.init_phph_
-000153d0: 696e 7465 7261 6374 696f 6e20 6861 7320  interaction has 
-000153e0: 746f 2062 6520 6361 6c6c 6564 2022 0a20  to be called ". 
-000153f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00015400: 6265 666f 7265 2072 756e 6e69 6e67 2074  before running t
-00015410: 6869 7320 6d65 7468 6f64 2e22 0a20 2020  his method.".   
-00015420: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00015430: 2020 2020 2020 2072 6169 7365 2052 756e         raise Run
-00015440: 7469 6d65 4572 726f 7228 6d73 6729 0a0a  timeError(msg)..
-00015450: 2020 2020 2020 2020 6966 2069 735f 4c42          if is_LB
-00015460: 5445 3a0a 2020 2020 2020 2020 2020 2020  TE:.            
-00015470: 6966 2074 656d 7065 7261 7475 7265 7320  if temperatures 
-00015480: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00015490: 2020 2020 2020 2020 205f 7465 6d70 6572           _temper
-000154a0: 6174 7572 6573 203d 205b 0a20 2020 2020  atures = [.     
-000154b0: 2020 2020 2020 2020 2020 2020 2020 2033                 3
-000154c0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-000154d0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-000154e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000154f0: 2020 2020 2020 2020 5f74 656d 7065 7261          _tempera
-00015500: 7475 7265 7320 3d20 7465 6d70 6572 6174  tures = temperat
-00015510: 7572 6573 0a20 2020 2020 2020 2020 2020  ures.           
-00015520: 2073 656c 662e 5f74 6865 726d 616c 5f63   self._thermal_c
-00015530: 6f6e 6475 6374 6976 6974 7920 3d20 6765  onductivity = ge
-00015540: 745f 7468 6572 6d61 6c5f 636f 6e64 7563  t_thermal_conduc
-00015550: 7469 7669 7479 5f4c 4254 4528 0a20 2020  tivity_LBTE(.   
-00015560: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00015570: 662e 5f69 6e74 6572 6163 7469 6f6e 2c0a  f._interaction,.
-00015580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015590: 7465 6d70 6572 6174 7572 6573 3d5f 7465  temperatures=_te
-000155a0: 6d70 6572 6174 7572 6573 2c0a 2020 2020  mperatures,.    
-000155b0: 2020 2020 2020 2020 2020 2020 7369 676d              sigm
-000155c0: 6173 3d73 656c 662e 5f73 6967 6d61 732c  as=self._sigmas,
-000155d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000155e0: 2073 6967 6d61 5f63 7574 6f66 663d 7365   sigma_cutoff=se
-000155f0: 6c66 2e5f 7369 676d 615f 6375 746f 6666  lf._sigma_cutoff
-00015600: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015610: 2020 6973 5f69 736f 746f 7065 3d69 735f    is_isotope=is_
-00015620: 6973 6f74 6f70 652c 0a20 2020 2020 2020  isotope,.       
-00015630: 2020 2020 2020 2020 206d 6173 735f 7661           mass_va
-00015640: 7269 616e 6365 733d 6d61 7373 5f76 6172  riances=mass_var
-00015650: 6961 6e63 6573 2c0a 2020 2020 2020 2020  iances,.        
-00015660: 2020 2020 2020 2020 6772 6964 5f70 6f69          grid_poi
-00015670: 6e74 733d 6772 6964 5f70 6f69 6e74 732c  nts=grid_points,
-00015680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015690: 2062 6f75 6e64 6172 795f 6d66 703d 626f   boundary_mfp=bo
-000156a0: 756e 6461 7279 5f6d 6670 2c0a 2020 2020  undary_mfp,.    
-000156b0: 2020 2020 2020 2020 2020 2020 736f 6c76              solv
-000156c0: 655f 636f 6c6c 6563 7469 7665 5f70 686f  e_collective_pho
-000156d0: 6e6f 6e3d 736f 6c76 655f 636f 6c6c 6563  non=solve_collec
-000156e0: 7469 7665 5f70 686f 6e6f 6e2c 0a20 2020  tive_phonon,.   
-000156f0: 2020 2020 2020 2020 2020 2020 2069 735f               is_
-00015700: 7265 6475 6369 626c 655f 636f 6c6c 6973  reducible_collis
-00015710: 696f 6e5f 6d61 7472 6978 3d69 735f 7265  ion_matrix=is_re
-00015720: 6475 6369 626c 655f 636f 6c6c 6973 696f  ducible_collisio
-00015730: 6e5f 6d61 7472 6978 2c0a 2020 2020 2020  n_matrix,.      
-00015740: 2020 2020 2020 2020 2020 6973 5f6b 6170            is_kap
-00015750: 7061 5f73 7461 723d 6973 5f6b 6170 7061  pa_star=is_kappa
-00015760: 5f73 7461 722c 0a20 2020 2020 2020 2020  _star,.         
-00015770: 2020 2020 2020 2067 765f 6465 6c74 615f         gv_delta_
-00015780: 713d 6776 5f64 656c 7461 5f71 2c0a 2020  q=gv_delta_q,.  
-00015790: 2020 2020 2020 2020 2020 2020 2020 6973                is
-000157a0: 5f66 756c 6c5f 7070 3d69 735f 6675 6c6c  _full_pp=is_full
-000157b0: 5f70 702c 0a20 2020 2020 2020 2020 2020  _pp,.           
-000157c0: 2020 2020 2063 6f6e 6475 6374 6976 6974       conductivit
-000157d0: 795f 7479 7065 3d63 6f6e 6475 6374 6976  y_type=conductiv
-000157e0: 6974 795f 7479 7065 2c0a 2020 2020 2020  ity_type,.      
-000157f0: 2020 2020 2020 2020 2020 7069 6e76 5f63            pinv_c
-00015800: 7574 6f66 663d 7069 6e76 5f63 7574 6f66  utoff=pinv_cutof
-00015810: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-00015820: 2020 2070 696e 765f 736f 6c76 6572 3d70     pinv_solver=p
-00015830: 696e 765f 736f 6c76 6572 2c0a 2020 2020  inv_solver,.    
-00015840: 2020 2020 2020 2020 2020 2020 7069 6e76              pinv
-00015850: 5f6d 6574 686f 643d 7069 6e76 5f6d 6574  _method=pinv_met
-00015860: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
-00015870: 2020 2020 2077 7269 7465 5f63 6f6c 6c69       write_colli
-00015880: 7369 6f6e 3d77 7269 7465 5f63 6f6c 6c69  sion=write_colli
-00015890: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-000158a0: 2020 2020 2020 7265 6164 5f63 6f6c 6c69        read_colli
-000158b0: 7369 6f6e 3d72 6561 645f 636f 6c6c 6973  sion=read_collis
-000158c0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-000158d0: 2020 2020 2077 7269 7465 5f6b 6170 7061       write_kappa
-000158e0: 3d77 7269 7465 5f6b 6170 7061 2c0a 2020  =write_kappa,.  
-000158f0: 2020 2020 2020 2020 2020 2020 2020 7772                wr
-00015900: 6974 655f 7070 3d77 7269 7465 5f70 702c  ite_pp=write_pp,
-00015910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015920: 2072 6561 645f 7070 3d72 6561 645f 7070   read_pp=read_pp
-00015930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015940: 2020 7772 6974 655f 4c42 5445 5f73 6f6c    write_LBTE_sol
-00015950: 7574 696f 6e3d 7772 6974 655f 4c42 5445  ution=write_LBTE
-00015960: 5f73 6f6c 7574 696f 6e2c 0a20 2020 2020  _solution,.     
-00015970: 2020 2020 2020 2020 2020 2063 6f6d 7072             compr
-00015980: 6573 7369 6f6e 3d63 6f6d 7072 6573 7369  ession=compressi
-00015990: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-000159a0: 2020 2020 696e 7075 745f 6669 6c65 6e61      input_filena
-000159b0: 6d65 3d69 6e70 7574 5f66 696c 656e 616d  me=input_filenam
-000159c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-000159d0: 2020 206f 7574 7075 745f 6669 6c65 6e61     output_filena
-000159e0: 6d65 3d6f 7574 7075 745f 6669 6c65 6e61  me=output_filena
-000159f0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00015a00: 2020 2020 6c6f 675f 6c65 7665 6c3d 7365      log_level=se
-00015a10: 6c66 2e5f 6c6f 675f 6c65 7665 6c2c 0a20  lf._log_level,. 
-00015a20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00015a30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00015a40: 2020 2020 2020 2069 6620 7465 6d70 6572         if temper
-00015a50: 6174 7572 6573 2069 7320 4e6f 6e65 3a0a  atures is None:.
-00015a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a70: 5f74 656d 7065 7261 7475 7265 7320 3d20  _temperatures = 
-00015a80: 6e70 2e61 7261 6e67 6528 302c 2031 3030  np.arange(0, 100
-00015a90: 312c 2031 302c 2064 7479 7065 3d22 646f  1, 10, dtype="do
-00015aa0: 7562 6c65 2229 0a20 2020 2020 2020 2020  uble").         
-00015ab0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00015ac0: 2020 2020 2020 2020 205f 7465 6d70 6572           _temper
-00015ad0: 6174 7572 6573 203d 2074 656d 7065 7261  atures = tempera
-00015ae0: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
-00015af0: 2020 7365 6c66 2e5f 7468 6572 6d61 6c5f    self._thermal_
-00015b00: 636f 6e64 7563 7469 7669 7479 203d 2067  conductivity = g
-00015b10: 6574 5f74 6865 726d 616c 5f63 6f6e 6475  et_thermal_condu
-00015b20: 6374 6976 6974 795f 5254 4128 0a20 2020  ctivity_RTA(.   
-00015b30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00015b40: 662e 5f69 6e74 6572 6163 7469 6f6e 2c0a  f._interaction,.
+0000edb0: 7261 6973 6520 466f 7263 6543 616c 6375  raise ForceCalcu
+0000edc0: 6c61 746f 7252 6571 7569 7265 6445 7272  latorRequiredErr
+0000edd0: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
+0000ede0: 2020 2020 6663 322c 2066 6333 203d 2067      fc2, fc3 = g
+0000edf0: 6574 5f70 686f 6e6f 3370 795f 6663 3328  et_phono3py_fc3(
+0000ee00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ee10: 2073 656c 662e 5f73 7570 6572 6365 6c6c   self._supercell
+0000ee20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ee30: 2020 7365 6c66 2e5f 7072 696d 6974 6976    self._primitiv
+0000ee40: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000ee50: 2020 2064 6973 705f 6461 7461 7365 742c     disp_dataset,
+0000ee60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ee70: 2073 656c 662e 5f73 796d 6d65 7472 792c   self._symmetry,
+0000ee80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ee90: 2069 735f 636f 6d70 6163 745f 6663 3d69   is_compact_fc=i
+0000eea0: 735f 636f 6d70 6163 745f 6663 2c0a 2020  s_compact_fc,.  
+0000eeb0: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+0000eec0: 7262 6f73 653d 7365 6c66 2e5f 6c6f 675f  rbose=self._log_
+0000eed0: 6c65 7665 6c2c 0a20 2020 2020 2020 2020  level,.         
+0000eee0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000eef0: 2069 6620 7379 6d6d 6574 7269 7a65 5f66   if symmetrize_f
+0000ef00: 6333 723a 0a20 2020 2020 2020 2020 2020  c3r:.           
+0000ef10: 2020 2020 2069 6620 6973 5f63 6f6d 7061       if is_compa
+0000ef20: 6374 5f66 633a 0a20 2020 2020 2020 2020  ct_fc:.         
+0000ef30: 2020 2020 2020 2020 2020 2073 6574 5f74             set_t
+0000ef40: 7261 6e73 6c61 7469 6f6e 616c 5f69 6e76  ranslational_inv
+0000ef50: 6172 6961 6e63 655f 636f 6d70 6163 745f  ariance_compact_
+0000ef60: 6663 3328 6663 332c 2073 656c 662e 5f70  fc3(fc3, self._p
+0000ef70: 7269 6d69 7469 7665 290a 2020 2020 2020  rimitive).      
+0000ef80: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000ef90: 745f 7065 726d 7574 6174 696f 6e5f 7379  t_permutation_sy
+0000efa0: 6d6d 6574 7279 5f63 6f6d 7061 6374 5f66  mmetry_compact_f
+0000efb0: 6333 2866 6333 2c20 7365 6c66 2e5f 7072  c3(fc3, self._pr
+0000efc0: 696d 6974 6976 6529 0a20 2020 2020 2020  imitive).       
+0000efd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000efe0: 7365 6c66 2e5f 6663 3220 6973 204e 6f6e  self._fc2 is Non
+0000eff0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000f000: 2020 2020 2020 2020 2020 2073 796d 6d65             symme
+0000f010: 7472 697a 655f 636f 6d70 6163 745f 666f  trize_compact_fo
+0000f020: 7263 655f 636f 6e73 7461 6e74 7328 6663  rce_constants(fc
+0000f030: 322c 2073 656c 662e 5f70 7269 6d69 7469  2, self._primiti
+0000f040: 7665 290a 2020 2020 2020 2020 2020 2020  ve).            
+0000f050: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000f060: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000f070: 745f 7472 616e 736c 6174 696f 6e61 6c5f  t_translational_
+0000f080: 696e 7661 7269 616e 6365 5f66 6333 2866  invariance_fc3(f
+0000f090: 6333 290a 2020 2020 2020 2020 2020 2020  c3).            
+0000f0a0: 2020 2020 2020 2020 7365 745f 7065 726d          set_perm
+0000f0b0: 7574 6174 696f 6e5f 7379 6d6d 6574 7279  utation_symmetry
+0000f0c0: 5f66 6333 2866 6333 290a 2020 2020 2020  _fc3(fc3).      
+0000f0d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000f0e0: 2073 656c 662e 5f66 6332 2069 7320 4e6f   self._fc2 is No
+0000f0f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000f100: 2020 2020 2020 2020 2020 2020 7379 6d6d              symm
+0000f110: 6574 7269 7a65 5f66 6f72 6365 5f63 6f6e  etrize_force_con
+0000f120: 7374 616e 7473 2866 6332 290a 0a20 2020  stants(fc2)..   
+0000f130: 2020 2020 2023 2053 6574 2066 6332 2061       # Set fc2 a
+0000f140: 6e64 2066 6333 0a20 2020 2020 2020 2073  nd fc3.        s
+0000f150: 656c 662e 5f66 6333 203d 2066 6333 0a0a  elf._fc3 = fc3..
+0000f160: 2020 2020 2020 2020 2320 6663 3220 6173          # fc2 as
+0000f170: 206f 6274 6169 6e65 6420 6162 6f76 6520   obtained above 
+0000f180: 7769 6c6c 206e 6f74 2062 6520 7365 7420  will not be set 
+0000f190: 7768 656e 2022 7c22 2069 6e20 6663 2d63  when "|" in fc-c
+0000f1a0: 616c 6375 6c61 746f 7220 7365 7474 696e  alculator settin
+0000f1b0: 672e 0a20 2020 2020 2020 2069 6620 6663  g..        if fc
+0000f1c0: 5f63 616c 6375 6c61 746f 7220 6973 206e  _calculator is n
+0000f1d0: 6f74 204e 6f6e 6520 616e 6420 227c 2220  ot None and "|" 
+0000f1e0: 696e 2066 635f 6361 6c63 756c 6174 6f72  in fc_calculator
+0000f1f0: 3a0a 2020 2020 2020 2020 2020 2020 6663  :.            fc
+0000f200: 3220 3d20 4e6f 6e65 0a20 2020 2020 2020  2 = None.       
+0000f210: 2069 6620 6663 5f63 616c 6375 6c61 746f   if fc_calculato
+0000f220: 725f 6f70 7469 6f6e 7320 6973 206e 6f74  r_options is not
+0000f230: 204e 6f6e 6520 616e 6420 227c 2220 696e   None and "|" in
+0000f240: 2066 635f 6361 6c63 756c 6174 6f72 5f6f   fc_calculator_o
+0000f250: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
+0000f260: 2020 2020 6663 3220 3d20 4e6f 6e65 0a0a      fc2 = None..
+0000f270: 2020 2020 2020 2020 2320 4e6f 726d 616c          # Normal
+0000f280: 6c79 2073 656c 662e 5f66 6332 2069 7320  ly self._fc2 is 
+0000f290: 6f76 6572 7772 6974 7465 6e20 696e 2070  overwritten in p
+0000f2a0: 726f 6475 6365 5f66 6332 0a20 2020 2020  roduce_fc2.     
+0000f2b0: 2020 2069 6620 7365 6c66 2e5f 6663 3220     if self._fc2 
+0000f2c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000f2d0: 2020 2020 2073 656c 662e 5f66 6332 203d       self._fc2 =
+0000f2e0: 2066 6332 0a0a 2020 2020 6465 6620 7072   fc2..    def pr
+0000f2f0: 6f64 7563 655f 6663 3228 0a20 2020 2020  oduce_fc2(.     
+0000f300: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000f310: 2073 796d 6d65 7472 697a 655f 6663 323d   symmetrize_fc2=
+0000f320: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
+0000f330: 735f 636f 6d70 6163 745f 6663 3d46 616c  s_compact_fc=Fal
+0000f340: 7365 2c0a 2020 2020 2020 2020 6663 5f63  se,.        fc_c
+0000f350: 616c 6375 6c61 746f 723d 4e6f 6e65 2c0a  alculator=None,.
+0000f360: 2020 2020 2020 2020 6663 5f63 616c 6375          fc_calcu
+0000f370: 6c61 746f 725f 6f70 7469 6f6e 733d 4e6f  lator_options=No
+0000f380: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+0000f390: 2020 2022 2222 4361 6c63 756c 6174 6520     """Calculate 
+0000f3a0: 6663 3220 6672 6f6d 2064 6973 706c 6163  fc2 from displac
+0000f3b0: 656d 656e 7473 2061 6e64 2066 6f72 6365  ements and force
+0000f3c0: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
+0000f3d0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0000f3e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000f3f0: 2020 7379 6d6d 6574 7269 7a65 5f66 6332    symmetrize_fc2
+0000f400: 203a 2062 6f6f 6c0a 2020 2020 2020 2020   : bool.        
+0000f410: 2020 2020 4f6e 6c79 2066 6f72 2074 7970      Only for typ
+0000f420: 6520 3120 6469 7370 6c61 6365 6d65 6e74  e 1 displacement
+0000f430: 5f64 6174 6173 6574 2c20 7472 616e 736c  _dataset, transl
+0000f440: 6174 696f 6e61 6c20 616e 640a 2020 2020  ational and.    
+0000f450: 2020 2020 2020 2020 7065 726d 7574 6174          permutat
+0000f460: 696f 6e20 7379 6d6d 6574 7269 6573 2061  ion symmetries a
+0000f470: 7265 2061 7070 6c69 6564 2061 6674 6572  re applied after
+0000f480: 2063 7265 6174 696e 6720 6663 332e 2054   creating fc3. T
+0000f490: 6869 730a 2020 2020 2020 2020 2020 2020  his.            
+0000f4a0: 7379 6d6d 6574 7269 7a61 7469 6f6e 2069  symmetrization i
+0000f4b0: 7320 6e6f 7420 7665 7279 2073 6f70 6869  s not very sophi
+0000f4c0: 7374 6963 6174 6564 2061 6e64 2063 616e  sticated and can
+0000f4d0: 2062 7265 616b 2073 7061 6365 0a20 2020   break space.   
+0000f4e0: 2020 2020 2020 2020 2067 726f 7570 2073           group s
+0000f4f0: 796d 6d65 7472 792c 2062 7574 206f 6674  ymmetry, but oft
+0000f500: 656e 2075 7365 6675 6c2e 2049 6620 6265  en useful. If be
+0000f510: 7474 6572 2073 796d 6d65 7472 697a 6174  tter symmetrizat
+0000f520: 696f 6e20 6973 0a20 2020 2020 2020 2020  ion is.         
+0000f530: 2020 2065 7870 6563 7465 642c 2069 7420     expected, it 
+0000f540: 6973 2072 6563 6f6d 6d65 6e64 6564 2074  is recommended t
+0000f550: 6f20 7573 6520 6578 7465 726e 616c 2066  o use external f
+0000f560: 6f72 6365 2063 6f6e 7374 616e 7473 0a20  orce constants. 
+0000f570: 2020 2020 2020 2020 2020 2063 616c 6375             calcu
+0000f580: 6c61 746f 7220 7375 6368 2061 7320 414c  lator such as AL
+0000f590: 4d2e 2044 6566 6175 6c74 2069 7320 4661  M. Default is Fa
+0000f5a0: 6c73 652e 0a20 2020 2020 2020 2069 735f  lse..        is_
+0000f5b0: 636f 6d70 6163 745f 6663 203a 2062 6f6f  compact_fc : boo
+0000f5c0: 6c0a 2020 2020 2020 2020 2020 2020 6663  l.            fc
+0000f5d0: 3220 7368 6170 6520 6973 0a20 2020 2020  2 shape is.     
+0000f5e0: 2020 2020 2020 2020 2020 2046 616c 7365             False
+0000f5f0: 3a20 2873 7570 6572 6365 6c6c 2c20 7375  : (supercell, su
+0000f600: 7065 6365 6c6c 2c20 332c 2033 290a 2020  pecell, 3, 3).  
+0000f610: 2020 2020 2020 2020 2020 2020 2020 5472                Tr
+0000f620: 7565 3a20 2870 7269 6d69 7469 7665 2c20  ue: (primitive, 
+0000f630: 7375 7065 6365 6c6c 2c20 332c 2033 290a  supecell, 3, 3).
+0000f640: 2020 2020 2020 2020 2020 2020 7768 6572              wher
+0000f650: 6520 2773 7570 6572 6365 6c6c 2720 616e  e 'supercell' an
+0000f660: 6420 2770 7269 6d69 7469 7665 2720 696e  d 'primitive' in
+0000f670: 6469 6361 7465 206e 756d 6265 7220 6f66  dicate number of
+0000f680: 2061 746f 6d73 2069 6e20 7468 6573 650a   atoms in these.
+0000f690: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+0000f6a0: 732e 2044 6566 6175 6c74 2069 7320 4661  s. Default is Fa
+0000f6b0: 6c73 652e 0a20 2020 2020 2020 2066 635f  lse..        fc_
+0000f6c0: 6361 6c63 756c 6174 6f72 203a 2073 7472  calculator : str
+0000f6d0: 206f 7220 4e6f 6e65 0a20 2020 2020 2020   or None.       
+0000f6e0: 2020 2020 2046 6f72 6365 2063 6f6e 7374       Force const
+0000f6f0: 616e 7473 2063 616c 6375 6c61 746f 7220  ants calculator 
+0000f700: 6769 7665 6e20 6279 2073 7472 2e0a 2020  given by str..  
+0000f710: 2020 2020 2020 6663 5f63 616c 6375 6c61        fc_calcula
+0000f720: 746f 725f 6f70 7469 6f6e 7320 3a20 6469  tor_options : di
+0000f730: 6374 0a20 2020 2020 2020 2020 2020 204f  ct.            O
+0000f740: 7074 696f 6e73 2066 6f72 2065 7874 6572  ptions for exter
+0000f750: 6e61 6c20 666f 7263 6520 636f 6e73 7461  nal force consta
+0000f760: 6e74 7320 6361 6c63 756c 6174 6f72 2e0a  nts calculator..
+0000f770: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000f780: 2020 2020 2069 6620 7365 6c66 2e5f 7068       if self._ph
+0000f790: 6f6e 6f6e 5f64 6174 6173 6574 2069 7320  onon_dataset is 
+0000f7a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000f7b0: 2020 6469 7370 5f64 6174 6173 6574 203d    disp_dataset =
+0000f7c0: 2073 656c 662e 5f64 6174 6173 6574 0a20   self._dataset. 
+0000f7d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000f7e0: 2020 2020 2020 2020 2064 6973 705f 6461           disp_da
+0000f7f0: 7461 7365 7420 3d20 7365 6c66 2e5f 7068  taset = self._ph
+0000f800: 6f6e 6f6e 5f64 6174 6173 6574 0a0a 2020  onon_dataset..  
+0000f810: 2020 2020 2020 6966 2069 735f 636f 6d70        if is_comp
+0000f820: 6163 745f 6663 3a0a 2020 2020 2020 2020  act_fc:.        
+0000f830: 2020 2020 7032 735f 6d61 7020 3d20 7365      p2s_map = se
+0000f840: 6c66 2e5f 7068 6f6e 6f6e 5f70 7269 6d69  lf._phonon_primi
+0000f850: 7469 7665 2e70 3273 5f6d 6170 0a20 2020  tive.p2s_map.   
+0000f860: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000f870: 2020 2020 2020 2070 3273 5f6d 6170 203d         p2s_map =
+0000f880: 204e 6f6e 650a 0a20 2020 2020 2020 2066   None..        f
+0000f890: 6332 5f63 616c 6375 6c61 746f 722c 2066  c2_calculator, f
+0000f8a0: 6332 5f63 616c 6375 6c61 746f 725f 6f70  c2_calculator_op
+0000f8b0: 7469 6f6e 7320 3d20 7365 6c66 2e5f 6578  tions = self._ex
+0000f8c0: 7472 6163 745f 6663 325f 6663 335f 6361  tract_fc2_fc3_ca
+0000f8d0: 6c63 756c 6174 6f72 7328 0a20 2020 2020  lculators(.     
+0000f8e0: 2020 2020 2020 2066 635f 6361 6c63 756c         fc_calcul
+0000f8f0: 6174 6f72 2c20 6663 5f63 616c 6375 6c61  ator, fc_calcula
+0000f900: 746f 725f 6f70 7469 6f6e 732c 2032 0a20  tor_options, 2. 
+0000f910: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000f920: 2020 6966 2066 6332 5f63 616c 6375 6c61    if fc2_calcula
+0000f930: 746f 7220 6973 206e 6f74 204e 6f6e 653a  tor is not None:
+0000f940: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+0000f950: 7073 2c20 666f 7263 6573 203d 2067 6574  ps, forces = get
+0000f960: 5f64 6973 706c 6163 656d 656e 7473 5f61  _displacements_a
+0000f970: 6e64 5f66 6f72 6365 7328 6469 7370 5f64  nd_forces(disp_d
+0000f980: 6174 6173 6574 290a 2020 2020 2020 2020  ataset).        
+0000f990: 2020 2020 7365 6c66 2e5f 6663 3220 3d20      self._fc2 = 
+0000f9a0: 6765 745f 6663 3228 0a20 2020 2020 2020  get_fc2(.       
+0000f9b0: 2020 2020 2020 2020 2073 656c 662e 5f70           self._p
+0000f9c0: 686f 6e6f 6e5f 7375 7065 7263 656c 6c2c  honon_supercell,
+0000f9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f9e0: 2073 656c 662e 5f70 686f 6e6f 6e5f 7072   self._phonon_pr
+0000f9f0: 696d 6974 6976 652c 0a20 2020 2020 2020  imitive,.       
+0000fa00: 2020 2020 2020 2020 2064 6973 7073 2c0a           disps,.
+0000fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa20: 666f 7263 6573 2c0a 2020 2020 2020 2020  forces,.        
+0000fa30: 2020 2020 2020 2020 6663 5f63 616c 6375          fc_calcu
+0000fa40: 6c61 746f 723d 6663 325f 6361 6c63 756c  lator=fc2_calcul
+0000fa50: 6174 6f72 2c0a 2020 2020 2020 2020 2020  ator,.          
+0000fa60: 2020 2020 2020 6663 5f63 616c 6375 6c61        fc_calcula
+0000fa70: 746f 725f 6f70 7469 6f6e 733d 6663 325f  tor_options=fc2_
+0000fa80: 6361 6c63 756c 6174 6f72 5f6f 7074 696f  calculator_optio
+0000fa90: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+0000faa0: 2020 2020 6174 6f6d 5f6c 6973 743d 7032      atom_list=p2
+0000fab0: 735f 6d61 702c 0a20 2020 2020 2020 2020  s_map,.         
+0000fac0: 2020 2020 2020 206c 6f67 5f6c 6576 656c         log_level
+0000fad0: 3d73 656c 662e 5f6c 6f67 5f6c 6576 656c  =self._log_level
+0000fae0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0000faf0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000fb00: 2020 2020 2020 2020 2020 6966 2022 6469            if "di
+0000fb10: 7370 6c61 6365 6d65 6e74 7322 2069 6e20  splacements" in 
+0000fb20: 6469 7370 5f64 6174 6173 6574 3a0a 2020  disp_dataset:.  
+0000fb30: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
+0000fb40: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
+0000fb50: 2020 2020 2020 2020 2020 2266 635f 6361            "fc_ca
+0000fb60: 6c63 756c 6174 6f72 2068 6173 2074 6f20  lculator has to 
+0000fb70: 6265 2073 6574 2074 6f20 7072 6f64 7563  be set to produc
+0000fb80: 6520 666f 7263 6520 220a 2020 2020 2020  e force ".      
+0000fb90: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+0000fba0: 6f6e 7374 616e 7320 6672 6f6d 2074 6869  onstans from thi
+0000fbb0: 7320 6461 7461 7365 7420 666f 7220 6663  s dataset for fc
+0000fbc0: 322e 220a 2020 2020 2020 2020 2020 2020  2.".            
+0000fbd0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000fbe0: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
+0000fbf0: 696d 6545 7272 6f72 286d 7367 290a 2020  imeError(msg).  
+0000fc00: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000fc10: 6663 3220 3d20 6765 745f 7068 6f6e 6f70  fc2 = get_phonop
+0000fc20: 795f 6663 3228 0a20 2020 2020 2020 2020  y_fc2(.         
+0000fc30: 2020 2020 2020 2073 656c 662e 5f70 686f         self._pho
+0000fc40: 6e6f 6e5f 7375 7065 7263 656c 6c2c 0a20  non_supercell,. 
+0000fc50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000fc60: 656c 662e 5f70 686f 6e6f 6e5f 7375 7065  elf._phonon_supe
+0000fc70: 7263 656c 6c5f 7379 6d6d 6574 7279 2c0a  rcell_symmetry,.
+0000fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc90: 6469 7370 5f64 6174 6173 6574 2c0a 2020  disp_dataset,.  
+0000fca0: 2020 2020 2020 2020 2020 2020 2020 6174                at
+0000fcb0: 6f6d 5f6c 6973 743d 7032 735f 6d61 702c  om_list=p2s_map,
+0000fcc0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000fcd0: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
+0000fce0: 6d6d 6574 7269 7a65 5f66 6332 3a0a 2020  mmetrize_fc2:.  
+0000fcf0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000fd00: 2069 735f 636f 6d70 6163 745f 6663 3a0a   is_compact_fc:.
+0000fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd20: 2020 2020 7379 6d6d 6574 7269 7a65 5f63      symmetrize_c
+0000fd30: 6f6d 7061 6374 5f66 6f72 6365 5f63 6f6e  ompact_force_con
+0000fd40: 7374 616e 7473 280a 2020 2020 2020 2020  stants(.        
+0000fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd60: 7365 6c66 2e5f 6663 322c 2073 656c 662e  self._fc2, self.
+0000fd70: 5f70 686f 6e6f 6e5f 7072 696d 6974 6976  _phonon_primitiv
+0000fd80: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0000fd90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000fda0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000fdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fdc0: 2020 7379 6d6d 6574 7269 7a65 5f66 6f72    symmetrize_for
+0000fdd0: 6365 5f63 6f6e 7374 616e 7473 2873 656c  ce_constants(sel
+0000fde0: 662e 5f66 6332 290a 0a20 2020 2064 6566  f._fc2)..    def
+0000fdf0: 2063 7574 6f66 665f 6663 335f 6279 5f7a   cutoff_fc3_by_z
+0000fe00: 6572 6f28 7365 6c66 2c20 6375 746f 6666  ero(self, cutoff
+0000fe10: 5f64 6973 7461 6e63 652c 2066 6333 3d4e  _distance, fc3=N
+0000fe20: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+0000fe30: 2253 6574 207a 6572 6f20 746f 2066 6333  "Set zero to fc3
+0000fe40: 2065 6c65 6d65 6e74 7320 6f75 7420 6f66   elements out of
+0000fe50: 2063 7574 6f66 6620 6469 7374 616e 6365   cutoff distance
+0000fe60: 2e0a 0a20 2020 2020 2020 204e 6f74 650a  ...        Note.
+0000fe70: 2020 2020 2020 2020 2d2d 2d2d 0a20 2020          ----.   
+0000fe80: 2020 2020 2066 6333 2069 7320 6f76 6572       fc3 is over
+0000fe90: 7772 6974 7465 6e2e 0a0a 2020 2020 2020  written...      
+0000fea0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0000feb0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0000fec0: 2020 2020 2020 2020 6375 746f 6666 5f64          cutoff_d
+0000fed0: 6973 7461 6e63 6520 3a20 666c 6f61 740a  istance : float.
+0000fee0: 2020 2020 2020 2020 2020 2020 4166 7465              Afte
+0000fef0: 7220 6372 6561 7469 6e67 2066 6f72 6365  r creating force
+0000ff00: 2063 6f6e 7374 616e 7473 2c20 6663 2065   constants, fc e
+0000ff10: 6c65 6d65 6e74 7320 7768 6572 6520 616e  lements where an
+0000ff20: 7920 7061 6972 0a20 2020 2020 2020 2020  y pair.         
+0000ff30: 2020 2064 6973 7461 6e63 6520 696e 2061     distance in a
+0000ff40: 746f 6d20 7472 6970 6c65 7473 206c 6172  tom triplets lar
+0000ff50: 6765 7220 7468 616e 2063 7574 6f66 665f  ger than cutoff_
+0000ff60: 6469 7374 616e 6365 2061 7265 2073 6574  distance are set
+0000ff70: 207a 6572 6f2e 0a0a 2020 2020 2020 2020   zero...        
+0000ff80: 2222 220a 2020 2020 2020 2020 6966 2066  """.        if f
+0000ff90: 6333 2069 7320 4e6f 6e65 3a0a 2020 2020  c3 is None:.    
+0000ffa0: 2020 2020 2020 2020 5f66 6333 203d 2073          _fc3 = s
+0000ffb0: 656c 662e 5f66 6333 0a20 2020 2020 2020  elf._fc3.       
+0000ffc0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000ffd0: 2020 205f 6663 3320 3d20 6663 330a 2020     _fc3 = fc3.  
+0000ffe0: 2020 2020 2020 6375 746f 6666 5f66 6333        cutoff_fc3
+0000fff0: 5f62 795f 7a65 726f 280a 2020 2020 2020  _by_zero(.      
+00010000: 2020 2020 2020 5f66 6333 2c0a 2020 2020        _fc3,.    
+00010010: 2020 2020 2020 2020 7365 6c66 2e5f 7375          self._su
+00010020: 7065 7263 656c 6c2c 0a20 2020 2020 2020  percell,.       
+00010030: 2020 2020 2063 7574 6f66 665f 6469 7374       cutoff_dist
+00010040: 616e 6365 2c0a 2020 2020 2020 2020 2020  ance,.          
+00010050: 2020 7032 735f 6d61 703d 7365 6c66 2e5f    p2s_map=self._
+00010060: 7072 696d 6974 6976 652e 7032 735f 6d61  primitive.p2s_ma
+00010070: 702c 0a20 2020 2020 2020 2020 2020 2073  p,.            s
+00010080: 796d 7072 6563 3d73 656c 662e 5f73 796d  ymprec=self._sym
+00010090: 7072 6563 2c0a 2020 2020 2020 2020 290a  prec,.        ).
+000100a0: 0a20 2020 2064 6566 2073 6574 5f70 6572  .    def set_per
+000100b0: 6d75 7461 7469 6f6e 5f73 796d 6d65 7472  mutation_symmetr
+000100c0: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+000100d0: 2022 2222 456e 666f 7263 6520 7065 726d   """Enforce perm
+000100e0: 7574 6174 696f 6e20 7379 6d6d 6574 7279  utation symmetry
+000100f0: 2074 6f20 6663 3220 616e 6420 6663 332e   to fc2 and fc3.
+00010100: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+00010110: 656c 662e 5f66 6332 2069 7320 6e6f 7420  elf._fc2 is not 
+00010120: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00010130: 2020 7365 745f 7065 726d 7574 6174 696f    set_permutatio
+00010140: 6e5f 7379 6d6d 6574 7279 2873 656c 662e  n_symmetry(self.
+00010150: 5f66 6332 290a 2020 2020 2020 2020 6966  _fc2).        if
+00010160: 2073 656c 662e 5f66 6333 2069 7320 6e6f   self._fc3 is no
+00010170: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00010180: 2020 2020 7365 745f 7065 726d 7574 6174      set_permutat
+00010190: 696f 6e5f 7379 6d6d 6574 7279 5f66 6333  ion_symmetry_fc3
+000101a0: 2873 656c 662e 5f66 6333 290a 0a20 2020  (self._fc3)..   
+000101b0: 2064 6566 2073 6574 5f74 7261 6e73 6c61   def set_transla
+000101c0: 7469 6f6e 616c 5f69 6e76 6172 6961 6e63  tional_invarianc
+000101d0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+000101e0: 2022 2222 456e 666f 7263 6520 7472 616e   """Enforce tran
+000101f0: 736c 6174 696f 6e20 696e 7661 7269 616e  slation invarian
+00010200: 6365 2e0a 0a20 2020 2020 2020 2054 6869  ce...        Thi
+00010210: 7320 7375 6274 7261 6374 7320 6472 6966  s subtracts drif
+00010220: 7420 6469 7669 6465 6420 6279 206e 756d  t divided by num
+00010230: 6265 7220 6f66 2065 6c65 6d65 6e74 7320  ber of elements 
+00010240: 696e 2065 6163 6820 726f 7720 616e 640a  in each row and.
+00010250: 2020 2020 2020 2020 636f 6c75 6d6e 2e0a          column..
+00010260: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00010270: 2020 2020 2069 6620 7365 6c66 2e5f 6663       if self._fc
+00010280: 3220 6973 206e 6f74 204e 6f6e 653a 0a20  2 is not None:. 
+00010290: 2020 2020 2020 2020 2020 2073 6574 5f74             set_t
+000102a0: 7261 6e73 6c61 7469 6f6e 616c 5f69 6e76  ranslational_inv
+000102b0: 6172 6961 6e63 6528 7365 6c66 2e5f 6663  ariance(self._fc
+000102c0: 3229 0a20 2020 2020 2020 2069 6620 7365  2).        if se
+000102d0: 6c66 2e5f 6663 3320 6973 206e 6f74 204e  lf._fc3 is not N
+000102e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000102f0: 2073 6574 5f74 7261 6e73 6c61 7469 6f6e   set_translation
+00010300: 616c 5f69 6e76 6172 6961 6e63 655f 6663  al_invariance_fc
+00010310: 3328 7365 6c66 2e5f 6663 3329 0a0a 2020  3(self._fc3)..  
+00010320: 2020 6465 6620 7275 6e5f 696d 6167 5f73    def run_imag_s
+00010330: 656c 665f 656e 6572 6779 280a 2020 2020  elf_energy(.    
+00010340: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00010350: 2020 6772 6964 5f70 6f69 6e74 732c 0a20    grid_points,. 
+00010360: 2020 2020 2020 2074 656d 7065 7261 7475         temperatu
+00010370: 7265 732c 0a20 2020 2020 2020 2066 7265  res,.        fre
+00010380: 7175 656e 6379 5f70 6f69 6e74 733d 4e6f  quency_points=No
+00010390: 6e65 2c0a 2020 2020 2020 2020 6672 6571  ne,.        freq
+000103a0: 7565 6e63 795f 7374 6570 3d4e 6f6e 652c  uency_step=None,
+000103b0: 0a20 2020 2020 2020 206e 756d 5f66 7265  .        num_fre
+000103c0: 7175 656e 6379 5f70 6f69 6e74 733d 4e6f  quency_points=No
+000103d0: 6e65 2c0a 2020 2020 2020 2020 6e75 6d5f  ne,.        num_
+000103e0: 706f 696e 7473 5f69 6e5f 6261 7463 683d  points_in_batch=
+000103f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6672  None,.        fr
+00010400: 6571 7565 6e63 795f 706f 696e 7473 5f61  equency_points_a
+00010410: 745f 6261 6e64 733d 4661 6c73 652c 0a20  t_bands=False,. 
+00010420: 2020 2020 2020 2073 6361 7474 6572 696e         scatterin
+00010430: 675f 6576 656e 745f 636c 6173 733d 4e6f  g_event_class=No
+00010440: 6e65 2c0a 2020 2020 2020 2020 7772 6974  ne,.        writ
+00010450: 655f 7478 743d 4661 6c73 652c 0a20 2020  e_txt=False,.   
+00010460: 2020 2020 2077 7269 7465 5f67 616d 6d61       write_gamma
+00010470: 5f64 6574 6169 6c3d 4661 6c73 652c 0a20  _detail=False,. 
+00010480: 2020 2020 2020 206b 6565 705f 6761 6d6d         keep_gamm
+00010490: 615f 6465 7461 696c 3d46 616c 7365 2c0a  a_detail=False,.
+000104a0: 2020 2020 2020 2020 6f75 7470 7574 5f66          output_f
+000104b0: 696c 656e 616d 653d 4e6f 6e65 2c0a 2020  ilename=None,.  
+000104c0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+000104d0: 4361 6c63 756c 6174 6520 696d 6167 696e  Calculate imagin
+000104e0: 6172 7920 7061 7274 206f 6620 7365 6c66  ary part of self
+000104f0: 2d65 6e65 7267 7920 6f66 2062 7562 626c  -energy of bubbl
+00010500: 6520 6469 6167 7261 6d20 2847 616d 6d61  e diagram (Gamma
+00010510: 292e 0a0a 2020 2020 2020 2020 5069 203d  )...        Pi =
+00010520: 2044 656c 7461 202d 2069 2047 616d 6d61   Delta - i Gamma
+00010530: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00010540: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00010550: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00010560: 2067 7269 645f 706f 696e 7473 203a 2061   grid_points : a
+00010570: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
+00010580: 2020 2020 2020 4772 6964 2d70 6f69 6e74        Grid-point
+00010590: 2069 6e64 6963 6573 2077 6865 7265 2069   indices where i
+000105a0: 6d61 6769 6e61 7279 2070 6172 7420 6f66  maginary part of
+000105b0: 2073 656c 662d 656e 6572 6769 6573 2061   self-energies a
+000105c0: 7265 0a20 2020 2020 2020 2020 2020 2063  re.            c
+000105d0: 6163 6c63 756c 6174 6564 2e0a 2020 2020  aclculated..    
+000105e0: 2020 2020 2020 2020 6474 7970 653d 696e          dtype=in
+000105f0: 742c 2073 6861 7065 3d28 6772 6964 5f70  t, shape=(grid_p
+00010600: 6f69 6e74 732c 290a 2020 2020 2020 2020  oints,).        
+00010610: 7465 6d70 6572 6174 7572 6573 203a 2061  temperatures : a
+00010620: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
+00010630: 2020 2020 2020 5465 6d70 6572 6174 7572        Temperatur
+00010640: 6573 2077 6865 7265 2069 6d61 6769 6e61  es where imagina
+00010650: 7279 2070 6172 7420 6f66 2073 656c 662d  ry part of self-
+00010660: 656e 6572 6769 6573 2061 7265 2063 616c  energies are cal
+00010670: 6375 6c61 7465 642e 0a20 2020 2020 2020  culated..       
+00010680: 2020 2020 2064 7479 7065 3d66 6c6f 6174       dtype=float
+00010690: 2c20 7368 6170 653d 2874 656d 7065 7261  , shape=(tempera
+000106a0: 7475 7265 732c 290a 2020 2020 2020 2020  tures,).        
+000106b0: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
+000106c0: 203a 2061 7272 6179 5f6c 696b 652c 206f   : array_like, o
+000106d0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+000106e0: 2020 2020 4672 6571 7565 6e63 7920 7361      Frequency sa
+000106f0: 6d70 6c69 6e67 2070 6f69 6e74 732e 2044  mpling points. D
+00010700: 6566 6175 6c74 2069 7320 4e6f 6e65 2e20  efault is None. 
+00010710: 5769 7468 0a20 2020 2020 2020 2020 2020  With.           
+00010720: 2066 7265 7175 656e 6379 5f70 6f69 6e74   frequency_point
+00010730: 735f 6174 5f62 616e 6473 3d46 616c 7365  s_at_bands=False
+00010740: 2061 6e64 2066 7265 7175 656e 6379 5f70   and frequency_p
+00010750: 6f69 6e74 7320 6973 204e 6f6e 652c 0a20  oints is None,. 
+00010760: 2020 2020 2020 2020 2020 206e 756d 5f66             num_f
+00010770: 7265 7175 656e 6379 5f70 6f69 6e74 7320  requency_points 
+00010780: 6f72 2066 7265 7175 656e 6379 5f73 7465  or frequency_ste
+00010790: 7020 6973 2075 7365 6420 746f 2067 656e  p is used to gen
+000107a0: 6572 6174 6520 756e 6966 6f72 6d0a 2020  erate uniform.  
+000107b0: 2020 2020 2020 2020 2020 6672 6571 7565            freque
+000107c0: 6e63 7920 7361 6d70 6c69 6e67 2070 6f69  ncy sampling poi
+000107d0: 6e74 732e 0a20 2020 2020 2020 2020 2020  nts..           
+000107e0: 2064 7479 7065 3d66 6c6f 6174 2c20 7368   dtype=float, sh
+000107f0: 6170 653d 2866 7265 7175 656e 6379 5f70  ape=(frequency_p
+00010800: 6f69 6e74 732c 290a 2020 2020 2020 2020  oints,).        
+00010810: 6672 6571 7565 6e63 795f 7374 6570 203a  frequency_step :
+00010820: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00010830: 0a20 2020 2020 2020 2020 2020 2055 6e69  .            Uni
+00010840: 666f 726d 2070 6974 6368 206f 6620 6672  form pitch of fr
+00010850: 6571 7565 6e63 7920 7361 6d70 6c69 6e67  equency sampling
+00010860: 2070 6f69 6e74 732e 2044 6566 6175 6c74   points. Default
+00010870: 2069 7320 4e6f 6e65 2e20 5468 6973 0a20   is None. This. 
+00010880: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00010890: 7473 2069 6e20 7573 696e 6720 6e75 6d5f  ts in using num_
+000108a0: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
+000108b0: 2e0a 2020 2020 2020 2020 6e75 6d5f 6672  ..        num_fr
+000108c0: 6571 7565 6e63 795f 706f 696e 7473 3a20  equency_points: 
+000108d0: 496e 742c 206f 7074 696f 6e61 6c0a 2020  Int, optional.  
+000108e0: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
+000108f0: 206f 6620 7361 6d70 6c69 6e67 2073 616d   of sampling sam
+00010900: 706c 696e 6720 706f 696e 7473 2074 6f20  pling points to 
+00010910: 6265 2075 7365 6420 696e 7374 6561 6420  be used instead 
+00010920: 6f66 0a20 2020 2020 2020 2020 2020 2066  of.            f
+00010930: 7265 7175 656e 6379 5f73 7465 702e 2054  requency_step. T
+00010940: 6869 7320 6e75 6d62 6572 2069 6e63 6c75  his number inclu
+00010950: 6465 7320 656e 6420 706f 696e 7473 2e20  des end points. 
+00010960: 4465 6661 756c 7420 6973 204e 6f6e 652c  Default is None,
+00010970: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+00010980: 6368 2067 6976 6573 2032 3031 2e0a 2020  ch gives 201..  
+00010990: 2020 2020 2020 6e75 6d5f 706f 696e 7473        num_points
+000109a0: 5f69 6e5f 6261 7463 683a 2069 6e74 2c20  _in_batch: int, 
+000109b0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000109c0: 2020 2020 204e 756d 6265 7220 6f66 2073       Number of s
+000109d0: 616d 706c 696e 6720 706f 696e 7473 2069  ampling points i
+000109e0: 6e20 6f6e 6520 6261 7463 682e 2054 6869  n one batch. Thi
+000109f0: 7320 6973 2066 6f72 2074 6865 2066 7265  s is for the fre
+00010a00: 7175 656e 6379 0a20 2020 2020 2020 2020  quency.         
+00010a10: 2020 2073 616d 706c 696e 6720 6d6f 6465     sampling mode
+00010a20: 2061 6e64 2074 6865 2073 616d 706c 696e   and the samplin
+00010a30: 6720 706f 696e 7473 2061 7265 2064 6976  g points are div
+00010a40: 6964 6564 2069 6e74 6f20 6261 7463 6865  ided into batche
+00010a50: 732e 0a20 2020 2020 2020 2020 2020 204c  s..            L
+00010a60: 6167 6572 206e 756d 6265 7220 7072 6f76  ager number prov
+00010a70: 6964 6573 2065 6666 6963 6965 6e74 2075  ides efficient u
+00010a80: 7365 206f 6620 6d75 6c74 692d 636f 7265  se of multi-core
+00010a90: 7320 6275 7420 6d6f 7265 0a20 2020 2020  s but more.     
+00010aa0: 2020 2020 2020 206d 656d 6f72 7920 6465         memory de
+00010ab0: 6d61 6e64 696e 672e 2044 6566 6175 6c74  manding. Default
+00010ac0: 2069 7320 4e6f 6e65 2c20 7768 6963 6820   is None, which 
+00010ad0: 6769 7665 2074 6865 206e 756d 6265 7220  give the number 
+00010ae0: 6f66 2031 302e 0a20 2020 2020 2020 2066  of 10..        f
+00010af0: 7265 7175 656e 6379 5f70 6f69 6e74 735f  requency_points_
+00010b00: 6174 5f62 616e 6473 203a 2062 6f6f 6c2c  at_bands : bool,
+00010b10: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00010b20: 2020 2020 2020 5068 6f6e 6f6e 2062 616e        Phonon ban
+00010b30: 6420 6672 6571 7565 6e63 6965 7320 6172  d frequencies ar
+00010b40: 6520 7573 6564 2061 7320 6672 6571 7565  e used as freque
+00010b50: 6e63 7920 706f 696e 7473 2077 6865 6e20  ncy points when 
+00010b60: 5472 7565 2e0a 2020 2020 2020 2020 2020  True..          
+00010b70: 2020 4465 6661 756c 7420 6973 2046 616c    Default is Fal
+00010b80: 7365 2e0a 2020 2020 2020 2020 7363 6174  se..        scat
+00010b90: 7465 7269 6e67 5f65 7665 6e74 5f63 6c61  tering_event_cla
+00010ba0: 7373 203a 2069 6e74 2c20 6f70 7469 6f6e  ss : int, option
+00010bb0: 616c 0a20 2020 2020 2020 2020 2020 2053  al.            S
+00010bc0: 7065 6369 6669 6320 6368 6f69 6365 206f  pecific choice o
+00010bd0: 6620 7363 6174 7465 7269 6e67 2065 7665  f scattering eve
+00010be0: 6e74 2063 6c61 7373 2c20 3120 6f72 2032  nt class, 1 or 2
+00010bf0: 2074 6861 7420 6973 2073 7065 6369 6669   that is specifi
+00010c00: 6564 0a20 2020 2020 2020 2020 2020 2031  ed.            1
+00010c10: 206f 7220 322c 2072 6573 7065 6374 6976   or 2, respectiv
+00010c20: 656c 792e 2054 6865 2072 6573 756c 7420  ely. The result 
+00010c30: 6973 2073 746f 7265 6420 696e 2067 616d  is stored in gam
+00010c40: 6d61 732e 2054 6865 7265 666f 7265 0a20  mas. Therefore. 
+00010c50: 2020 2020 2020 2020 2020 2075 7375 616c             usual
+00010c60: 2067 616d 6d61 7320 6172 6520 6e6f 7420   gammas are not 
+00010c70: 7374 6f72 6564 2069 6e20 7468 6520 7661  stored in the va
+00010c80: 7269 6162 6c65 2e20 4465 6661 756c 7420  riable. Default 
+00010c90: 6973 204e 6f6e 652c 2077 6869 6368 0a20  is None, which. 
+00010ca0: 2020 2020 2020 2020 2020 2064 6f65 736e             doesn
+00010cb0: 2774 2073 7065 6369 6679 2073 6361 7474  't specify scatt
+00010cc0: 6572 696e 675f 6576 656e 745f 636c 6173  ering_event_clas
+00010cd0: 732e 0a20 2020 2020 2020 2077 7269 7465  s..        write
+00010ce0: 5f74 7874 203a 2062 6f6f 6c2c 206f 7074  _txt : bool, opt
+00010cf0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00010d00: 2020 4672 6571 7565 6e63 7920 706f 696e    Frequency poin
+00010d10: 7473 2061 6e64 2069 6d61 6769 6e61 7279  ts and imaginary
+00010d20: 2070 6172 7420 6f66 2073 656c 662d 656e   part of self-en
+00010d30: 6572 6769 6573 2061 7265 2077 7269 7474  ergies are writt
+00010d40: 656e 0a20 2020 2020 2020 2020 2020 2069  en.            i
+00010d50: 6e74 6f20 7465 7874 2066 696c 6573 2e0a  nto text files..
+00010d60: 2020 2020 2020 2020 7772 6974 655f 6761          write_ga
+00010d70: 6d6d 615f 6465 7461 696c 203a 2062 6f6f  mma_detail : boo
+00010d80: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
+00010d90: 2020 2020 2020 2020 4465 7461 696c 6564          Detailed
+00010da0: 2067 616d 6d61 7320 6172 6520 7772 6974   gammas are writ
+00010db0: 7465 6e20 696e 746f 2061 2066 696c 6520  ten into a file 
+00010dc0: 696e 2068 6466 352e 2044 6566 6175 6c74  in hdf5. Default
+00010dd0: 2069 7320 4661 6c73 652e 0a20 2020 2020   is False..     
+00010de0: 2020 206b 6565 705f 6761 6d6d 615f 6465     keep_gamma_de
+00010df0: 7461 696c 203a 2062 6f6f 6c2c 206f 7074  tail : bool, opt
+00010e00: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00010e10: 2020 5769 7468 2054 7275 652c 2064 6574    With True, det
+00010e20: 6169 6c65 6420 6761 6d6d 6173 2061 7265  ailed gammas are
+00010e30: 2073 746f 7265 642e 2044 6566 6175 6c74   stored. Default
+00010e40: 2069 7320 4661 6c73 652e 0a20 2020 2020   is False..     
+00010e50: 2020 206f 7574 7075 745f 6669 6c65 6e61     output_filena
+00010e60: 6d65 203a 2073 7472 0a20 2020 2020 2020  me : str.       
+00010e70: 2020 2020 2054 6869 7320 7374 7269 6e67       This string
+00010e80: 2069 7320 696e 7365 7274 6564 2069 6e20   is inserted in 
+00010e90: 7468 6520 6f75 7470 7574 2066 696c 6520  the output file 
+00010ea0: 6e61 6d65 732e 0a0a 2020 2020 2020 2020  names...        
+00010eb0: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+00010ec0: 656c 662e 5f69 6e74 6572 6163 7469 6f6e  elf._interaction
+00010ed0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00010ee0: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
+00010ef0: 2020 2020 2020 2020 2020 2020 2020 2250                "P
+00010f00: 686f 6e6f 3370 792e 696e 6974 5f70 6870  hono3py.init_php
+00010f10: 685f 696e 7465 7261 6374 696f 6e20 6861  h_interaction ha
+00010f20: 7320 746f 2062 6520 6361 6c6c 6564 2022  s to be called "
+00010f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010f40: 2022 6265 666f 7265 2072 756e 6e69 6e67   "before running
+00010f50: 2074 6869 7320 6d65 7468 6f64 2e22 0a20   this method.". 
+00010f60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00010f70: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+00010f80: 756e 7469 6d65 4572 726f 7228 6d73 6729  untimeError(msg)
+00010f90: 0a0a 2020 2020 2020 2020 6966 2074 656d  ..        if tem
+00010fa0: 7065 7261 7475 7265 7320 6973 204e 6f6e  peratures is Non
+00010fb0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00010fc0: 656c 662e 5f74 656d 7065 7261 7475 7265  elf._temperature
+00010fd0: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
+00010fe0: 2020 2020 2020 3330 302e 302c 0a20 2020        300.0,.   
+00010ff0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00011000: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00011010: 2020 2020 2073 656c 662e 5f74 656d 7065       self._tempe
+00011020: 7261 7475 7265 7320 3d20 7465 6d70 6572  ratures = temper
+00011030: 6174 7572 6573 0a20 2020 2020 2020 2073  atures.        s
+00011040: 656c 662e 5f67 7269 645f 706f 696e 7473  elf._grid_points
+00011050: 203d 2067 7269 645f 706f 696e 7473 0a20   = grid_points. 
+00011060: 2020 2020 2020 2073 656c 662e 5f73 6361         self._sca
+00011070: 7474 6572 696e 675f 6576 656e 745f 636c  ttering_event_cl
+00011080: 6173 7320 3d20 7363 6174 7465 7269 6e67  ass = scattering
+00011090: 5f65 7665 6e74 5f63 6c61 7373 0a20 2020  _event_class.   
+000110a0: 2020 2020 2076 616c 7320 3d20 6765 745f       vals = get_
+000110b0: 696d 6167 5f73 656c 665f 656e 6572 6779  imag_self_energy
+000110c0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+000110d0: 6c66 2e5f 696e 7465 7261 6374 696f 6e2c  lf._interaction,
+000110e0: 0a20 2020 2020 2020 2020 2020 2067 7269  .            gri
+000110f0: 645f 706f 696e 7473 2c0a 2020 2020 2020  d_points,.      
+00011100: 2020 2020 2020 7465 6d70 6572 6174 7572        temperatur
+00011110: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00011120: 7369 676d 6173 3d73 656c 662e 5f73 6967  sigmas=self._sig
+00011130: 6d61 732c 0a20 2020 2020 2020 2020 2020  mas,.           
+00011140: 2066 7265 7175 656e 6379 5f70 6f69 6e74   frequency_point
+00011150: 733d 6672 6571 7565 6e63 795f 706f 696e  s=frequency_poin
+00011160: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+00011170: 6672 6571 7565 6e63 795f 7374 6570 3d66  frequency_step=f
+00011180: 7265 7175 656e 6379 5f73 7465 702c 0a20  requency_step,. 
+00011190: 2020 2020 2020 2020 2020 2066 7265 7175             frequ
+000111a0: 656e 6379 5f70 6f69 6e74 735f 6174 5f62  ency_points_at_b
+000111b0: 616e 6473 3d66 7265 7175 656e 6379 5f70  ands=frequency_p
+000111c0: 6f69 6e74 735f 6174 5f62 616e 6473 2c0a  oints_at_bands,.
+000111d0: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
+000111e0: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
+000111f0: 3d6e 756d 5f66 7265 7175 656e 6379 5f70  =num_frequency_p
+00011200: 6f69 6e74 732c 0a20 2020 2020 2020 2020  oints,.         
+00011210: 2020 206e 756d 5f70 6f69 6e74 735f 696e     num_points_in
+00011220: 5f62 6174 6368 3d6e 756d 5f70 6f69 6e74  _batch=num_point
+00011230: 735f 696e 5f62 6174 6368 2c0a 2020 2020  s_in_batch,.    
+00011240: 2020 2020 2020 2020 7363 6174 7465 7269          scatteri
+00011250: 6e67 5f65 7665 6e74 5f63 6c61 7373 3d73  ng_event_class=s
+00011260: 6361 7474 6572 696e 675f 6576 656e 745f  cattering_event_
+00011270: 636c 6173 732c 0a20 2020 2020 2020 2020  class,.         
+00011280: 2020 2077 7269 7465 5f67 616d 6d61 5f64     write_gamma_d
+00011290: 6574 6169 6c3d 7772 6974 655f 6761 6d6d  etail=write_gamm
+000112a0: 615f 6465 7461 696c 2c0a 2020 2020 2020  a_detail,.      
+000112b0: 2020 2020 2020 7265 7475 726e 5f67 616d        return_gam
+000112c0: 6d61 5f64 6574 6169 6c3d 6b65 6570 5f67  ma_detail=keep_g
+000112d0: 616d 6d61 5f64 6574 6169 6c2c 0a20 2020  amma_detail,.   
+000112e0: 2020 2020 2020 2020 206f 7574 7075 745f           output_
+000112f0: 6669 6c65 6e61 6d65 3d6f 7574 7075 745f  filename=output_
+00011300: 6669 6c65 6e61 6d65 2c0a 2020 2020 2020  filename,.      
+00011310: 2020 2020 2020 6c6f 675f 6c65 7665 6c3d        log_level=
+00011320: 7365 6c66 2e5f 6c6f 675f 6c65 7665 6c2c  self._log_level,
+00011330: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00011340: 2020 2069 6620 6b65 6570 5f67 616d 6d61     if keep_gamma
+00011350: 5f64 6574 6169 6c3a 0a20 2020 2020 2020  _detail:.       
+00011360: 2020 2020 2028 7365 6c66 2e5f 6672 6571       (self._freq
+00011370: 7565 6e63 795f 706f 696e 7473 2c20 7365  uency_points, se
+00011380: 6c66 2e5f 6761 6d6d 6173 2c20 7365 6c66  lf._gammas, self
+00011390: 2e5f 6465 7461 696c 6564 5f67 616d 6d61  ._detailed_gamma
+000113a0: 7329 203d 2076 616c 730a 2020 2020 2020  s) = vals.      
+000113b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000113c0: 2020 2020 7365 6c66 2e5f 6672 6571 7565      self._freque
+000113d0: 6e63 795f 706f 696e 7473 2c20 7365 6c66  ncy_points, self
+000113e0: 2e5f 6761 6d6d 6173 203d 2076 616c 730a  ._gammas = vals.
+000113f0: 0a20 2020 2020 2020 2069 6620 7772 6974  .        if writ
+00011400: 655f 7478 743a 0a20 2020 2020 2020 2020  e_txt:.         
+00011410: 2020 2073 656c 662e 5f77 7269 7465 5f69     self._write_i
+00011420: 6d61 675f 7365 6c66 5f65 6e65 7267 7928  mag_self_energy(
+00011430: 6f75 7470 7574 5f66 696c 656e 616d 653d  output_filename=
+00011440: 6f75 7470 7574 5f66 696c 656e 616d 6529  output_filename)
+00011450: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00011460: 2076 616c 730a 0a20 2020 2064 6566 2077   vals..    def w
+00011470: 7269 7465 5f69 6d61 675f 7365 6c66 5f65  rite_imag_self_e
+00011480: 6e65 7267 7928 7365 6c66 2c20 6669 6c65  nergy(self, file
+00011490: 6e61 6d65 3d4e 6f6e 6529 3a0a 2020 2020  name=None):.    
+000114a0: 2020 2020 2222 2257 7269 7465 2069 6d61      """Write ima
+000114b0: 6769 6e61 7279 2070 6172 7420 6f66 2073  ginary part of s
+000114c0: 656c 6620 656e 6572 6779 2074 6f20 6120  elf energy to a 
+000114d0: 6669 6c65 2e22 2222 0a20 2020 2020 2020  file.""".       
+000114e0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+000114f0: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
+00011500: 6e6f 3370 792e 7772 6974 655f 696d 6167  no3py.write_imag
+00011510: 5f73 656c 665f 656e 6572 6779 2069 7320  _self_energy is 
+00011520: 6465 7072 6563 6174 6564 2e22 0a20 2020  deprecated.".   
+00011530: 2020 2020 2020 2020 2022 5573 6520 5068           "Use Ph
+00011540: 6f6e 6f33 7079 2e72 756e 5f69 6d61 675f  ono3py.run_imag_
+00011550: 7365 6c66 5f65 6e65 7267 7920 7769 7468  self_energy with
+00011560: 2077 7269 7465 5f74 7874 3d54 7275 652e   write_txt=True.
+00011570: 222c 0a20 2020 2020 2020 2020 2020 2044  ",.            D
+00011580: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
+00011590: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
+000115a0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+000115b0: 5f69 6d61 675f 7365 6c66 5f65 6e65 7267  _imag_self_energ
+000115c0: 7928 6f75 7470 7574 5f66 696c 656e 616d  y(output_filenam
+000115d0: 653d 6669 6c65 6e61 6d65 290a 0a20 2020  e=filename)..   
+000115e0: 2064 6566 205f 7772 6974 655f 696d 6167   def _write_imag
+000115f0: 5f73 656c 665f 656e 6572 6779 2873 656c  _self_energy(sel
+00011600: 662c 206f 7574 7075 745f 6669 6c65 6e61  f, output_filena
+00011610: 6d65 3d4e 6f6e 6529 3a0a 2020 2020 2020  me=None):.      
+00011620: 2020 7772 6974 655f 696d 6167 5f73 656c    write_imag_sel
+00011630: 665f 656e 6572 6779 280a 2020 2020 2020  f_energy(.      
+00011640: 2020 2020 2020 7365 6c66 2e5f 6761 6d6d        self._gamm
+00011650: 6173 2c0a 2020 2020 2020 2020 2020 2020  as,.            
+00011660: 7365 6c66 2e6d 6573 685f 6e75 6d62 6572  self.mesh_number
+00011670: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+00011680: 656c 662e 5f67 7269 645f 706f 696e 7473  elf._grid_points
+00011690: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
+000116a0: 6c66 2e5f 6261 6e64 5f69 6e64 6963 6573  lf._band_indices
+000116b0: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
+000116c0: 6c66 2e5f 6672 6571 7565 6e63 795f 706f  lf._frequency_po
+000116d0: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
+000116e0: 2020 7365 6c66 2e5f 7465 6d70 6572 6174    self._temperat
+000116f0: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
+00011700: 2020 7365 6c66 2e5f 7369 676d 6173 2c0a    self._sigmas,.
+00011710: 2020 2020 2020 2020 2020 2020 7363 6174              scat
+00011720: 7465 7269 6e67 5f65 7665 6e74 5f63 6c61  tering_event_cla
+00011730: 7373 3d73 656c 662e 5f73 6361 7474 6572  ss=self._scatter
+00011740: 696e 675f 6576 656e 745f 636c 6173 732c  ing_event_class,
+00011750: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+00011760: 7075 745f 6669 6c65 6e61 6d65 3d6f 7574  put_filename=out
+00011770: 7075 745f 6669 6c65 6e61 6d65 2c0a 2020  put_filename,.  
+00011780: 2020 2020 2020 2020 2020 6973 5f6d 6573            is_mes
+00011790: 685f 7379 6d6d 6574 7279 3d73 656c 662e  h_symmetry=self.
+000117a0: 5f69 735f 6d65 7368 5f73 796d 6d65 7472  _is_mesh_symmetr
+000117b0: 792c 0a20 2020 2020 2020 2020 2020 206c  y,.            l
+000117c0: 6f67 5f6c 6576 656c 3d73 656c 662e 5f6c  og_level=self._l
+000117d0: 6f67 5f6c 6576 656c 2c0a 2020 2020 2020  og_level,.      
+000117e0: 2020 290a 0a20 2020 2064 6566 2072 756e    )..    def run
+000117f0: 5f72 6561 6c5f 7365 6c66 5f65 6e65 7267  _real_self_energ
+00011800: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
+00011810: 0a20 2020 2020 2020 2067 7269 645f 706f  .        grid_po
+00011820: 696e 7473 2c0a 2020 2020 2020 2020 7465  ints,.        te
+00011830: 6d70 6572 6174 7572 6573 2c0a 2020 2020  mperatures,.    
+00011840: 2020 2020 6672 6571 7565 6e63 795f 706f      frequency_po
+00011850: 696e 7473 5f61 745f 6261 6e64 733d 4661  ints_at_bands=Fa
+00011860: 6c73 652c 0a20 2020 2020 2020 2066 7265  lse,.        fre
+00011870: 7175 656e 6379 5f70 6f69 6e74 733d 4e6f  quency_points=No
+00011880: 6e65 2c0a 2020 2020 2020 2020 6672 6571  ne,.        freq
+00011890: 7565 6e63 795f 7374 6570 3d4e 6f6e 652c  uency_step=None,
+000118a0: 0a20 2020 2020 2020 206e 756d 5f66 7265  .        num_fre
+000118b0: 7175 656e 6379 5f70 6f69 6e74 733d 4e6f  quency_points=No
+000118c0: 6e65 2c0a 2020 2020 2020 2020 6570 7369  ne,.        epsi
+000118d0: 6c6f 6e73 3d4e 6f6e 652c 0a20 2020 2020  lons=None,.     
+000118e0: 2020 2077 7269 7465 5f74 7874 3d46 616c     write_txt=Fal
+000118f0: 7365 2c0a 2020 2020 2020 2020 7772 6974  se,.        writ
+00011900: 655f 6864 6635 3d46 616c 7365 2c0a 2020  e_hdf5=False,.  
+00011910: 2020 2020 2020 6f75 7470 7574 5f66 696c        output_fil
+00011920: 656e 616d 653d 4e6f 6e65 2c0a 2020 2020  ename=None,.    
+00011930: 293a 0a20 2020 2020 2020 2022 2222 4361  ):.        """Ca
+00011940: 6c63 756c 6174 6520 7265 616c 2d70 6172  lculate real-par
+00011950: 7420 6f66 2073 656c 662d 656e 6572 6779  t of self-energy
+00011960: 206f 6620 6275 6262 6c65 2064 6961 6772   of bubble diagr
+00011970: 616d 2028 4465 6c74 6129 2e0a 0a20 2020  am (Delta)...   
+00011980: 2020 2020 2050 6920 3d20 4465 6c74 6120       Pi = Delta 
+00011990: 2d20 6920 4761 6d6d 612e 0a0a 2020 2020  - i Gamma...    
+000119a0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000119b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000119c0: 2d0a 2020 2020 2020 2020 6772 6964 5f70  -.        grid_p
+000119d0: 6f69 6e74 7320 3a20 6172 7261 795f 6c69  oints : array_li
+000119e0: 6b65 0a20 2020 2020 2020 2020 2020 2047  ke.            G
+000119f0: 7269 642d 706f 696e 7420 696e 6469 6365  rid-point indice
+00011a00: 7320 7768 6572 6520 7265 616c 2070 6172  s where real par
+00011a10: 7420 6f66 2073 656c 662d 656e 6572 6769  t of self-energi
+00011a20: 6573 2061 7265 0a20 2020 2020 2020 2020  es are.         
+00011a30: 2020 2063 6163 6c63 756c 6174 6564 2e0a     caclculated..
+00011a40: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00011a50: 653d 696e 742c 2073 6861 7065 3d28 6772  e=int, shape=(gr
+00011a60: 6964 5f70 6f69 6e74 732c 290a 2020 2020  id_points,).    
+00011a70: 2020 2020 7465 6d70 6572 6174 7572 6573      temperatures
+00011a80: 203a 2061 7272 6179 5f6c 696b 650a 2020   : array_like.  
+00011a90: 2020 2020 2020 2020 2020 5465 6d70 6572            Temper
+00011aa0: 6174 7572 6573 2077 6865 7265 2072 6561  atures where rea
+00011ab0: 6c20 7061 7274 206f 6620 7365 6c66 2d65  l part of self-e
+00011ac0: 6e65 7267 6965 7320 2061 7265 2063 616c  nergies  are cal
+00011ad0: 6375 6c61 7465 642e 0a20 2020 2020 2020  culated..       
+00011ae0: 2020 2020 2064 7479 7065 3d66 6c6f 6174       dtype=float
+00011af0: 2c20 7368 6170 653d 2874 656d 7065 7261  , shape=(tempera
+00011b00: 7475 7265 732c 290a 2020 2020 2020 2020  tures,).        
+00011b10: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
+00011b20: 5f61 745f 6261 6e64 7320 3a20 626f 6f6c  _at_bands : bool
+00011b30: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00011b40: 2020 2020 2020 2057 6974 6820 4661 6c73         With Fals
+00011b50: 652c 2066 7265 7175 656e 6379 2073 6869  e, frequency shi
+00011b60: 6674 7320 6172 6520 6361 6c63 756c 6174  fts are calculat
+00011b70: 6564 2061 7420 6672 7175 656e 6379 2073  ed at frquency s
+00011b80: 616d 706c 696e 670a 2020 2020 2020 2020  ampling.        
+00011b90: 2020 2020 706f 696e 7473 2e20 5768 656e      points. When
+00011ba0: 2054 7275 652c 2074 6865 7920 6172 6520   True, they are 
+00011bb0: 646f 6e65 2061 7420 7468 6520 7068 6f6e  done at the phon
+00011bc0: 6f6e 2066 7265 7175 656e 6369 6573 2e0a  on frequencies..
+00011bd0: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+00011be0: 756c 7420 6973 2046 616c 7365 2e0a 2020  ult is False..  
+00011bf0: 2020 2020 2020 6672 6571 7565 6e63 795f        frequency_
+00011c00: 706f 696e 7473 203a 2061 7272 6179 5f6c  points : array_l
+00011c10: 696b 652c 206f 7074 696f 6e61 6c0a 2020  ike, optional.  
+00011c20: 2020 2020 2020 2020 2020 4672 6571 7565            Freque
+00011c30: 6e63 7920 7361 6d70 6c69 6e67 2070 6f69  ncy sampling poi
+00011c40: 6e74 732e 2044 6566 6175 6c74 2069 7320  nts. Default is 
+00011c50: 4e6f 6e65 2e20 496e 2074 6869 7320 6361  None. In this ca
+00011c60: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+00011c70: 6e75 6d5f 6672 6571 7565 6e63 795f 706f  num_frequency_po
+00011c80: 696e 7473 206f 7220 6672 6571 7565 6e63  ints or frequenc
+00011c90: 795f 7374 6570 2069 7320 7573 6564 2074  y_step is used t
+00011ca0: 6f20 6765 6e65 7261 7465 2075 6e69 666f  o generate unifo
+00011cb0: 726d 0a20 2020 2020 2020 2020 2020 2066  rm.            f
+00011cc0: 7265 7175 656e 6379 2073 616d 706c 696e  requency samplin
+00011cd0: 6720 706f 696e 7473 2e0a 2020 2020 2020  g points..      
+00011ce0: 2020 2020 2020 6474 7970 653d 666c 6f61        dtype=floa
+00011cf0: 742c 2073 6861 7065 3d28 6672 6571 7565  t, shape=(freque
+00011d00: 6e63 795f 706f 696e 7473 2c29 0a20 2020  ncy_points,).   
+00011d10: 2020 2020 2066 7265 7175 656e 6379 5f73       frequency_s
+00011d20: 7465 7020 3a20 666c 6f61 742c 206f 7074  tep : float, opt
+00011d30: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00011d40: 2020 556e 6966 6f72 6d20 7069 7463 6820    Uniform pitch 
+00011d50: 6f66 2066 7265 7175 656e 6379 2073 616d  of frequency sam
+00011d60: 706c 696e 6720 706f 696e 7473 2e20 4465  pling points. De
+00011d70: 6661 756c 7420 6973 204e 6f6e 652e 2054  fault is None. T
+00011d80: 6869 730a 2020 2020 2020 2020 2020 2020  his.            
+00011d90: 7265 7375 6c74 7320 696e 2075 7369 6e67  results in using
+00011da0: 206e 756d 5f66 7265 7175 656e 6379 5f70   num_frequency_p
+00011db0: 6f69 6e74 732e 0a20 2020 2020 2020 206e  oints..        n
+00011dc0: 756d 5f66 7265 7175 656e 6379 5f70 6f69  um_frequency_poi
+00011dd0: 6e74 733a 2049 6e74 2c20 6f70 7469 6f6e  nts: Int, option
+00011de0: 616c 0a20 2020 2020 2020 2020 2020 204e  al.            N
+00011df0: 756d 6265 7220 6f66 2073 616d 706c 696e  umber of samplin
+00011e00: 6720 7361 6d70 6c69 6e67 2070 6f69 6e74  g sampling point
+00011e10: 7320 746f 2062 6520 7573 6564 2069 6e73  s to be used ins
+00011e20: 7465 6164 206f 660a 2020 2020 2020 2020  tead of.        
+00011e30: 2020 2020 6672 6571 7565 6e63 795f 7374      frequency_st
+00011e40: 6570 2e20 5468 6973 206e 756d 6265 7220  ep. This number 
+00011e50: 696e 636c 7564 6573 2065 6e64 2070 6f69  includes end poi
+00011e60: 6e74 732e 2044 6566 6175 6c74 2069 7320  nts. Default is 
+00011e70: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00011e80: 2020 7768 6963 6820 6769 7665 7320 3230    which gives 20
+00011e90: 312e 0a20 2020 2020 2020 2065 7073 696c  1..        epsil
+00011ea0: 6f6e 7320 3a20 6172 7261 795f 6c69 6b65  ons : array_like
+00011eb0: 0a20 2020 2020 2020 2020 2020 2053 6d65  .            Sme
+00011ec0: 6172 696e 6720 7769 6474 6873 2074 6f20  aring widths to 
+00011ed0: 636f 6d70 7574 6572 2070 7269 6e63 6970  computer princip
+00011ee0: 616c 2070 6172 742e 2057 6865 6e20 6d75  al part. When mu
+00011ef0: 6c74 6970 6c65 2076 616c 7565 730a 2020  ltiple values.  
+00011f00: 2020 2020 2020 2020 2020 6172 6520 6769            are gi
+00011f10: 7665 6e20 6672 6571 7565 6e63 7920 7368  ven frequency sh
+00011f20: 6966 7473 2066 6f72 2074 686f 7365 2076  ifts for those v
+00011f30: 616c 7565 7320 6172 6520 7265 7475 726e  alues are return
+00011f40: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+00011f50: 6474 7970 653d 666c 6f61 742c 2073 6861  dtype=float, sha
+00011f60: 7065 3d28 6570 7369 6c6f 6e73 2c29 0a20  pe=(epsilons,). 
+00011f70: 2020 2020 2020 2077 7269 7465 5f74 7874         write_txt
+00011f80: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+00011f90: 6c0a 2020 2020 2020 2020 2020 2020 4672  l.            Fr
+00011fa0: 6571 7565 6e63 7920 706f 696e 7473 2061  equency points a
+00011fb0: 6e64 2072 6561 6c20 7061 7274 206f 6620  nd real part of 
+00011fc0: 7365 6c66 2d65 6e65 7267 6965 7320 6172  self-energies ar
+00011fd0: 6520 7772 6974 7465 6e0a 2020 2020 2020  e written.      
+00011fe0: 2020 2020 2020 696e 746f 2074 6578 7420        into text 
+00011ff0: 6669 6c65 732e 0a20 2020 2020 2020 2077  files..        w
+00012000: 7269 7465 5f68 6466 3520 3a20 626f 6f6c  rite_hdf5 : bool
+00012010: 0a20 2020 2020 2020 2020 2020 2052 6573  .            Res
+00012020: 756c 7473 2061 7265 2073 746f 7265 6420  ults are stored 
+00012030: 696e 2068 6466 3520 6669 6c65 7320 696e  in hdf5 files in
+00012040: 6465 7065 6e64 656e 746c 7920 6174 2067  dependently at g
+00012050: 7269 6420 706f 696e 7473 2c0a 2020 2020  rid points,.    
+00012060: 2020 2020 2020 2020 6570 7369 6c6f 6e73          epsilons
+00012070: 2c20 616e 6420 7465 6d70 6572 6174 7572  , and temperatur
+00012080: 6573 2e0a 2020 2020 2020 2020 6f75 7470  es..        outp
+00012090: 7574 5f66 696c 656e 616d 6520 3a20 7374  ut_filename : st
+000120a0: 720a 2020 2020 2020 2020 2020 2020 5468  r.            Th
+000120b0: 6973 2073 7472 696e 6720 6973 2069 6e73  is string is ins
+000120c0: 6572 7465 6420 696e 2074 6865 206f 7574  erted in the out
+000120d0: 7075 7420 6669 6c65 206e 616d 6573 2e0a  put file names..
+000120e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000120f0: 2020 2020 2069 6620 7365 6c66 2e5f 696e       if self._in
+00012100: 7465 7261 6374 696f 6e20 6973 204e 6f6e  teraction is Non
+00012110: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+00012120: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
+00012130: 2020 2020 2020 2022 5068 6f6e 6f33 7079         "Phono3py
+00012140: 2e69 6e69 745f 7068 7068 5f69 6e74 6572  .init_phph_inter
+00012150: 6163 7469 6f6e 2068 6173 2074 6f20 6265  action has to be
+00012160: 2063 616c 6c65 6420 220a 2020 2020 2020   called ".      
+00012170: 2020 2020 2020 2020 2020 2262 6566 6f72            "befor
+00012180: 6520 7275 6e6e 696e 6720 7468 6973 206d  e running this m
+00012190: 6574 686f 642e 220a 2020 2020 2020 2020  ethod.".        
+000121a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000121b0: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
+000121c0: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
+000121d0: 2020 2069 6620 6570 7369 6c6f 6e73 2069     if epsilons i
+000121e0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+000121f0: 2020 2020 2020 2020 5f65 7073 696c 6f6e          _epsilon
+00012200: 7320 3d20 6570 7369 6c6f 6e73 0a20 2020  s = epsilons.   
+00012210: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00012220: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
+00012230: 6c66 2e5f 7369 676d 6173 2920 3d3d 2031  lf._sigmas) == 1
+00012240: 2061 6e64 2073 656c 662e 5f73 6967 6d61   and self._sigma
+00012250: 735b 305d 2069 7320 4e6f 6e65 3a0a 2020  s[0] is None:.  
+00012260: 2020 2020 2020 2020 2020 2020 2020 5f65                _e
+00012270: 7073 696c 6f6e 7320 3d20 4e6f 6e65 0a20  psilons = None. 
+00012280: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00012290: 7365 6c66 2e5f 7369 676d 6173 5b30 5d20  self._sigmas[0] 
+000122a0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000122b0: 2020 2020 2020 2020 205f 6570 7369 6c6f           _epsilo
+000122c0: 6e73 203d 2073 656c 662e 5f73 6967 6d61  ns = self._sigma
+000122d0: 735b 313a 5d0a 2020 2020 2020 2020 2020  s[1:].          
+000122e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000122f0: 2020 2020 2020 2020 5f65 7073 696c 6f6e          _epsilon
+00012300: 7320 3d20 7365 6c66 2e5f 7369 676d 6173  s = self._sigmas
+00012310: 0a0a 2020 2020 2020 2020 2320 2865 7073  ..        # (eps
+00012320: 696c 6f6e 2c20 6772 6964 5f70 6f69 6e74  ilon, grid_point
+00012330: 2c20 7465 6d70 6572 6174 7572 652c 2062  , temperature, b
+00012340: 616e 6429 0a20 2020 2020 2020 2066 7265  and).        fre
+00012350: 7175 656e 6379 5f70 6f69 6e74 732c 2064  quency_points, d
+00012360: 656c 7461 7320 3d20 6765 745f 7265 616c  eltas = get_real
+00012370: 5f73 656c 665f 656e 6572 6779 280a 2020  _self_energy(.  
+00012380: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00012390: 696e 7465 7261 6374 696f 6e2c 0a20 2020  interaction,.   
+000123a0: 2020 2020 2020 2020 2067 7269 645f 706f           grid_po
+000123b0: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
+000123c0: 2020 7465 6d70 6572 6174 7572 6573 2c0a    temperatures,.
+000123d0: 2020 2020 2020 2020 2020 2020 6570 7369              epsi
+000123e0: 6c6f 6e73 3d5f 6570 7369 6c6f 6e73 2c0a  lons=_epsilons,.
+000123f0: 2020 2020 2020 2020 2020 2020 6672 6571              freq
+00012400: 7565 6e63 795f 706f 696e 7473 3d66 7265  uency_points=fre
+00012410: 7175 656e 6379 5f70 6f69 6e74 732c 0a20  quency_points,. 
+00012420: 2020 2020 2020 2020 2020 2066 7265 7175             frequ
+00012430: 656e 6379 5f73 7465 703d 6672 6571 7565  ency_step=freque
+00012440: 6e63 795f 7374 6570 2c0a 2020 2020 2020  ncy_step,.      
+00012450: 2020 2020 2020 6e75 6d5f 6672 6571 7565        num_freque
+00012460: 6e63 795f 706f 696e 7473 3d6e 756d 5f66  ncy_points=num_f
+00012470: 7265 7175 656e 6379 5f70 6f69 6e74 732c  requency_points,
+00012480: 0a20 2020 2020 2020 2020 2020 2066 7265  .            fre
+00012490: 7175 656e 6379 5f70 6f69 6e74 735f 6174  quency_points_at
+000124a0: 5f62 616e 6473 3d66 7265 7175 656e 6379  _bands=frequency
+000124b0: 5f70 6f69 6e74 735f 6174 5f62 616e 6473  _points_at_bands
+000124c0: 2c0a 2020 2020 2020 2020 2020 2020 7772  ,.            wr
+000124d0: 6974 655f 6864 6635 3d77 7269 7465 5f68  ite_hdf5=write_h
+000124e0: 6466 352c 0a20 2020 2020 2020 2020 2020  df5,.           
+000124f0: 206f 7574 7075 745f 6669 6c65 6e61 6d65   output_filename
+00012500: 3d6f 7574 7075 745f 6669 6c65 6e61 6d65  =output_filename
+00012510: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
+00012520: 675f 6c65 7665 6c3d 7365 6c66 2e5f 6c6f  g_level=self._lo
+00012530: 675f 6c65 7665 6c2c 0a20 2020 2020 2020  g_level,.       
+00012540: 2029 0a0a 2020 2020 2020 2020 6966 2077   )..        if w
+00012550: 7269 7465 5f74 7874 3a0a 2020 2020 2020  rite_txt:.      
+00012560: 2020 2020 2020 7772 6974 655f 7265 616c        write_real
+00012570: 5f73 656c 665f 656e 6572 6779 280a 2020  _self_energy(.  
+00012580: 2020 2020 2020 2020 2020 2020 2020 6465                de
+00012590: 6c74 6173 2c0a 2020 2020 2020 2020 2020  ltas,.          
+000125a0: 2020 2020 2020 7365 6c66 2e6d 6573 685f        self.mesh_
+000125b0: 6e75 6d62 6572 732c 0a20 2020 2020 2020  numbers,.       
+000125c0: 2020 2020 2020 2020 2067 7269 645f 706f           grid_po
+000125d0: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
+000125e0: 2020 2020 2020 7365 6c66 2e5f 6261 6e64        self._band
+000125f0: 5f69 6e64 6963 6573 2c0a 2020 2020 2020  _indices,.      
+00012600: 2020 2020 2020 2020 2020 6672 6571 7565            freque
+00012610: 6e63 795f 706f 696e 7473 2c0a 2020 2020  ncy_points,.    
+00012620: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+00012630: 6572 6174 7572 6573 2c0a 2020 2020 2020  eratures,.      
+00012640: 2020 2020 2020 2020 2020 5f65 7073 696c            _epsil
+00012650: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+00012660: 2020 2020 206f 7574 7075 745f 6669 6c65       output_file
+00012670: 6e61 6d65 3d6f 7574 7075 745f 6669 6c65  name=output_file
+00012680: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00012690: 2020 2020 2020 6973 5f6d 6573 685f 7379        is_mesh_sy
+000126a0: 6d6d 6574 7279 3d73 656c 662e 5f69 735f  mmetry=self._is_
+000126b0: 6d65 7368 5f73 796d 6d65 7472 792c 0a20  mesh_symmetry,. 
+000126c0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000126d0: 6f67 5f6c 6576 656c 3d73 656c 662e 5f6c  og_level=self._l
+000126e0: 6f67 5f6c 6576 656c 2c0a 2020 2020 2020  og_level,.      
+000126f0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00012700: 2072 6574 7572 6e20 6672 6571 7565 6e63   return frequenc
+00012710: 795f 706f 696e 7473 2c20 6465 6c74 6173  y_points, deltas
+00012720: 0a0a 2020 2020 6465 6620 7275 6e5f 7370  ..    def run_sp
+00012730: 6563 7472 616c 5f66 756e 6374 696f 6e28  ectral_function(
+00012740: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00012750: 2020 2020 2020 2067 7269 645f 706f 696e         grid_poin
+00012760: 7473 2c0a 2020 2020 2020 2020 7465 6d70  ts,.        temp
+00012770: 6572 6174 7572 6573 2c0a 2020 2020 2020  eratures,.      
+00012780: 2020 6672 6571 7565 6e63 795f 706f 696e    frequency_poin
+00012790: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
+000127a0: 2066 7265 7175 656e 6379 5f73 7465 703d   frequency_step=
+000127b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e75  None,.        nu
+000127c0: 6d5f 6672 6571 7565 6e63 795f 706f 696e  m_frequency_poin
+000127d0: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
+000127e0: 206e 756d 5f70 6f69 6e74 735f 696e 5f62   num_points_in_b
+000127f0: 6174 6368 3d4e 6f6e 652c 0a20 2020 2020  atch=None,.     
+00012800: 2020 2077 7269 7465 5f74 7874 3d46 616c     write_txt=Fal
+00012810: 7365 2c0a 2020 2020 2020 2020 7772 6974  se,.        writ
+00012820: 655f 6864 6635 3d46 616c 7365 2c0a 2020  e_hdf5=False,.  
+00012830: 2020 2020 2020 6f75 7470 7574 5f66 696c        output_fil
+00012840: 656e 616d 653d 4e6f 6e65 2c0a 2020 2020  ename=None,.    
+00012850: 293a 0a20 2020 2020 2020 2022 2222 4672  ):.        """Fr
+00012860: 6571 7565 6e63 7920 7368 6966 7420 6672  equency shift fr
+00012870: 6f6d 206c 6f77 6573 7420 6f72 6465 7220  om lowest order 
+00012880: 6469 6167 7261 6d20 6973 2063 616c 6375  diagram is calcu
+00012890: 6c61 7465 642e 0a0a 2020 2020 2020 2020  lated...        
+000128a0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+000128b0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000128c0: 2020 2020 2020 6772 6964 5f70 6f69 6e74        grid_point
+000128d0: 7320 3a20 6172 7261 795f 6c69 6b65 0a20  s : array_like. 
+000128e0: 2020 2020 2020 2020 2020 2047 7269 642d             Grid-
+000128f0: 706f 696e 7420 696e 6469 6365 7320 7768  point indices wh
+00012900: 6572 6520 696d 6167 2d73 656c 662d 656e  ere imag-self-en
+00012910: 6572 6765 6973 2061 7265 2063 6163 6c63  ergeis are caclc
+00012920: 756c 6174 6564 2e0a 2020 2020 2020 2020  ulated..        
+00012930: 2020 2020 6474 7970 653d 696e 742c 2073      dtype=int, s
+00012940: 6861 7065 3d28 6772 6964 5f70 6f69 6e74  hape=(grid_point
+00012950: 732c 290a 2020 2020 2020 2020 7465 6d70  s,).        temp
+00012960: 6572 6174 7572 6573 203a 2061 7272 6179  eratures : array
+00012970: 5f6c 696b 650a 2020 2020 2020 2020 2020  _like.          
+00012980: 2020 5465 6d70 6572 6174 7572 6573 2077    Temperatures w
+00012990: 6865 7265 2069 6d61 672d 7365 6c66 2d65  here imag-self-e
+000129a0: 6e65 7267 6965 7320 6172 6520 6361 6c63  nergies are calc
+000129b0: 756c 6174 6564 2e0a 2020 2020 2020 2020  ulated..        
+000129c0: 2020 2020 6474 7970 653d 666c 6f61 742c      dtype=float,
+000129d0: 2073 6861 7065 3d28 7465 6d70 6572 6174   shape=(temperat
+000129e0: 7572 6573 2c29 0a20 2020 2020 2020 2066  ures,).        f
+000129f0: 7265 7175 656e 6379 5f70 6f69 6e74 7320  requency_points 
+00012a00: 3a20 6172 7261 795f 6c69 6b65 2c20 6f70  : array_like, op
+00012a10: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00012a20: 2020 2046 7265 7175 656e 6379 2073 616d     Frequency sam
+00012a30: 706c 696e 6720 706f 696e 7473 2e20 4465  pling points. De
+00012a40: 6661 756c 7420 6973 204e 6f6e 652e 2049  fault is None. I
+00012a50: 6e20 7468 6973 2063 6173 652c 0a20 2020  n this case,.   
+00012a60: 2020 2020 2020 2020 206e 756d 5f66 7265           num_fre
+00012a70: 7175 656e 6379 5f70 6f69 6e74 7320 6f72  quency_points or
+00012a80: 2066 7265 7175 656e 6379 5f73 7465 7020   frequency_step 
+00012a90: 6973 2075 7365 6420 746f 2067 656e 6572  is used to gener
+00012aa0: 6174 6520 756e 6966 6f72 6d0a 2020 2020  ate uniform.    
+00012ab0: 2020 2020 2020 2020 6672 6571 7565 6e63          frequenc
+00012ac0: 7920 7361 6d70 6c69 6e67 2070 6f69 6e74  y sampling point
+00012ad0: 732e 0a20 2020 2020 2020 2020 2020 2064  s..            d
+00012ae0: 7479 7065 3d66 6c6f 6174 2c20 7368 6170  type=float, shap
+00012af0: 653d 2866 7265 7175 656e 6379 5f70 6f69  e=(frequency_poi
+00012b00: 6e74 732c 290a 2020 2020 2020 2020 6672  nts,).        fr
+00012b10: 6571 7565 6e63 795f 7374 6570 203a 2066  equency_step : f
+00012b20: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
+00012b30: 2020 2020 2020 2020 2020 2055 6e69 666f             Unifo
+00012b40: 726d 2070 6974 6368 206f 6620 6672 6571  rm pitch of freq
+00012b50: 7565 6e63 7920 7361 6d70 6c69 6e67 2070  uency sampling p
+00012b60: 6f69 6e74 732e 2044 6566 6175 6c74 2069  oints. Default i
+00012b70: 7320 4e6f 6e65 2e20 5468 6973 0a20 2020  s None. This.   
+00012b80: 2020 2020 2020 2020 2072 6573 756c 7473           results
+00012b90: 2069 6e20 7573 696e 6720 6e75 6d5f 6672   in using num_fr
+00012ba0: 6571 7565 6e63 795f 706f 696e 7473 2e0a  equency_points..
+00012bb0: 2020 2020 2020 2020 6e75 6d5f 6672 6571          num_freq
+00012bc0: 7565 6e63 795f 706f 696e 7473 3a20 496e  uency_points: In
+00012bd0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00012be0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+00012bf0: 6620 7361 6d70 6c69 6e67 2073 616d 706c  f sampling sampl
+00012c00: 696e 6720 706f 696e 7473 2074 6f20 6265  ing points to be
+00012c10: 2075 7365 6420 696e 7374 6561 6420 6f66   used instead of
+00012c20: 0a20 2020 2020 2020 2020 2020 2066 7265  .            fre
+00012c30: 7175 656e 6379 5f73 7465 702e 2054 6869  quency_step. Thi
+00012c40: 7320 6e75 6d62 6572 2069 6e63 6c75 6465  s number include
+00012c50: 7320 656e 6420 706f 696e 7473 2e20 4465  s end points. De
+00012c60: 6661 756c 7420 6973 204e 6f6e 652c 0a20  fault is None,. 
+00012c70: 2020 2020 2020 2020 2020 2077 6869 6368             which
+00012c80: 2067 6976 6573 2032 3031 2e0a 2020 2020   gives 201..    
+00012c90: 2020 2020 6e75 6d5f 706f 696e 7473 5f69      num_points_i
+00012ca0: 6e5f 6261 7463 683a 2069 6e74 2c20 6f70  n_batch: int, op
+00012cb0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00012cc0: 2020 204e 756d 6265 7220 6f66 2073 616d     Number of sam
+00012cd0: 706c 696e 6720 706f 696e 7473 2069 6e20  pling points in 
+00012ce0: 6f6e 6520 6261 7463 682e 2054 6869 7320  one batch. This 
+00012cf0: 6973 2066 6f72 2074 6865 2066 7265 7175  is for the frequ
+00012d00: 656e 6379 0a20 2020 2020 2020 2020 2020  ency.           
+00012d10: 2073 616d 706c 696e 6720 6d6f 6465 2061   sampling mode a
+00012d20: 6e64 2074 6865 2073 616d 706c 696e 6720  nd the sampling 
+00012d30: 706f 696e 7473 2061 7265 2064 6976 6964  points are divid
+00012d40: 6564 2069 6e74 6f20 6261 7463 6865 732e  ed into batches.
+00012d50: 0a20 2020 2020 2020 2020 2020 204c 6167  .            Lag
+00012d60: 6572 206e 756d 6265 7220 7072 6f76 6964  er number provid
+00012d70: 6573 2065 6666 6963 6965 6e74 2075 7365  es efficient use
+00012d80: 206f 6620 6d75 6c74 692d 636f 7265 7320   of multi-cores 
+00012d90: 6275 7420 6d6f 7265 0a20 2020 2020 2020  but more.       
+00012da0: 2020 2020 206d 656d 6f72 7920 6465 6d61       memory dema
+00012db0: 6e64 696e 672e 2044 6566 6175 6c74 2069  nding. Default i
+00012dc0: 7320 4e6f 6e65 2c20 7768 6963 6820 6769  s None, which gi
+00012dd0: 7665 2074 6865 206e 756d 6265 7220 6f66  ve the number of
+00012de0: 2031 302e 0a20 2020 2020 2020 2077 7269   10..        wri
+00012df0: 7465 5f74 7874 203a 2062 6f6f 6c2c 206f  te_txt : bool, o
+00012e00: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00012e10: 2020 2020 4672 6571 7565 6e63 7920 706f      Frequency po
+00012e20: 696e 7473 2061 6e64 2073 7065 6374 7261  ints and spectra
+00012e30: 6c20 6675 6e63 7469 6f6e 7320 6172 6520  l functions are 
+00012e40: 7772 6974 7465 6e0a 2020 2020 2020 2020  written.        
+00012e50: 2020 2020 696e 746f 2074 6578 7420 6669      into text fi
+00012e60: 6c65 732e 2044 6566 6175 6c74 2069 7320  les. Default is 
+00012e70: 4661 6c73 652e 0a20 2020 2020 2020 2077  False..        w
+00012e80: 7269 7465 5f68 6466 3520 3a20 626f 6f6c  rite_hdf5 : bool
+00012e90: 0a20 2020 2020 2020 2020 2020 2052 6573  .            Res
+00012ea0: 756c 7473 2061 7265 2073 746f 7265 6420  ults are stored 
+00012eb0: 696e 2068 6466 3520 6669 6c65 7320 696e  in hdf5 files in
+00012ec0: 6465 7065 6e64 656e 746c 7920 6174 2067  dependently at g
+00012ed0: 7269 6420 706f 696e 7473 2c0a 2020 2020  rid points,.    
+00012ee0: 2020 2020 2020 2020 6570 7369 6c6f 6e73          epsilons
+00012ef0: 2e20 4465 6661 756c 7420 6973 2046 616c  . Default is Fal
+00012f00: 7365 2e0a 2020 2020 2020 2020 6f75 7470  se..        outp
+00012f10: 7574 5f66 696c 656e 616d 6520 3a20 7374  ut_filename : st
+00012f20: 720a 2020 2020 2020 2020 2020 2020 5468  r.            Th
+00012f30: 6973 2073 7472 696e 6720 6973 2069 6e73  is string is ins
+00012f40: 6572 7465 6420 696e 2074 6865 206f 7574  erted in the out
+00012f50: 7075 7420 6669 6c65 206e 616d 6573 2e0a  put file names..
+00012f60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00012f70: 2020 2020 2069 6620 7365 6c66 2e5f 696e       if self._in
+00012f80: 7465 7261 6374 696f 6e20 6973 204e 6f6e  teraction is Non
+00012f90: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+00012fa0: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
+00012fb0: 2020 2020 2020 2022 5068 6f6e 6f33 7079         "Phono3py
+00012fc0: 2e69 6e69 745f 7068 7068 5f69 6e74 6572  .init_phph_inter
+00012fd0: 6163 7469 6f6e 2068 6173 2074 6f20 6265  action has to be
+00012fe0: 2063 616c 6c65 6420 220a 2020 2020 2020   called ".      
+00012ff0: 2020 2020 2020 2020 2020 2262 6566 6f72            "befor
+00013000: 6520 7275 6e6e 696e 6720 7468 6973 206d  e running this m
+00013010: 6574 686f 642e 220a 2020 2020 2020 2020  ethod.".        
+00013020: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00013030: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
+00013040: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
+00013050: 2020 2073 656c 662e 5f73 7065 6374 7261     self._spectra
+00013060: 6c5f 6675 6e63 7469 6f6e 203d 2072 756e  l_function = run
+00013070: 5f73 7065 6374 7261 6c5f 6675 6e63 7469  _spectral_functi
+00013080: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00013090: 7365 6c66 2e5f 696e 7465 7261 6374 696f  self._interactio
+000130a0: 6e2c 0a20 2020 2020 2020 2020 2020 2067  n,.            g
+000130b0: 7269 645f 706f 696e 7473 2c0a 2020 2020  rid_points,.    
+000130c0: 2020 2020 2020 2020 7465 6d70 6572 6174          temperat
+000130d0: 7572 6573 3d74 656d 7065 7261 7475 7265  ures=temperature
+000130e0: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+000130f0: 6967 6d61 733d 7365 6c66 2e5f 7369 676d  igmas=self._sigm
+00013100: 6173 2c0a 2020 2020 2020 2020 2020 2020  as,.            
+00013110: 6672 6571 7565 6e63 795f 706f 696e 7473  frequency_points
+00013120: 3d66 7265 7175 656e 6379 5f70 6f69 6e74  =frequency_point
+00013130: 732c 0a20 2020 2020 2020 2020 2020 2066  s,.            f
+00013140: 7265 7175 656e 6379 5f73 7465 703d 6672  requency_step=fr
+00013150: 6571 7565 6e63 795f 7374 6570 2c0a 2020  equency_step,.  
+00013160: 2020 2020 2020 2020 2020 6e75 6d5f 6672            num_fr
+00013170: 6571 7565 6e63 795f 706f 696e 7473 3d6e  equency_points=n
+00013180: 756d 5f66 7265 7175 656e 6379 5f70 6f69  um_frequency_poi
+00013190: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
+000131a0: 206e 756d 5f70 6f69 6e74 735f 696e 5f62   num_points_in_b
+000131b0: 6174 6368 3d6e 756d 5f70 6f69 6e74 735f  atch=num_points_
+000131c0: 696e 5f62 6174 6368 2c0a 2020 2020 2020  in_batch,.      
+000131d0: 2020 2020 2020 6261 6e64 5f69 6e64 6963        band_indic
+000131e0: 6573 3d73 656c 662e 5f62 616e 645f 696e  es=self._band_in
+000131f0: 6469 6365 732c 0a20 2020 2020 2020 2020  dices,.         
+00013200: 2020 2077 7269 7465 5f74 7874 3d77 7269     write_txt=wri
+00013210: 7465 5f74 7874 2c0a 2020 2020 2020 2020  te_txt,.        
+00013220: 2020 2020 7772 6974 655f 6864 6635 3d77      write_hdf5=w
+00013230: 7269 7465 5f68 6466 352c 0a20 2020 2020  rite_hdf5,.     
+00013240: 2020 2020 2020 206f 7574 7075 745f 6669         output_fi
+00013250: 6c65 6e61 6d65 3d6f 7574 7075 745f 6669  lename=output_fi
+00013260: 6c65 6e61 6d65 2c0a 2020 2020 2020 2020  lename,.        
+00013270: 2020 2020 6c6f 675f 6c65 7665 6c3d 7365      log_level=se
+00013280: 6c66 2e5f 6c6f 675f 6c65 7665 6c2c 0a20  lf._log_level,. 
+00013290: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000132a0: 6620 7275 6e5f 7468 6572 6d61 6c5f 636f  f run_thermal_co
+000132b0: 6e64 7563 7469 7669 7479 280a 2020 2020  nductivity(.    
+000132c0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000132d0: 2020 6973 5f4c 4254 453d 4661 6c73 652c    is_LBTE=False,
+000132e0: 0a20 2020 2020 2020 2074 656d 7065 7261  .        tempera
+000132f0: 7475 7265 733d 4e6f 6e65 2c0a 2020 2020  tures=None,.    
+00013300: 2020 2020 6973 5f69 736f 746f 7065 3d46      is_isotope=F
+00013310: 616c 7365 2c0a 2020 2020 2020 2020 6d61  alse,.        ma
+00013320: 7373 5f76 6172 6961 6e63 6573 3d4e 6f6e  ss_variances=Non
+00013330: 652c 0a20 2020 2020 2020 2067 7269 645f  e,.        grid_
+00013340: 706f 696e 7473 3d4e 6f6e 652c 0a20 2020  points=None,.   
+00013350: 2020 2020 2062 6f75 6e64 6172 795f 6d66       boundary_mf
+00013360: 703d 4e6f 6e65 2c20 2023 2069 6e20 6d69  p=None,  # in mi
+00013370: 6372 6f6d 6574 7265 0a20 2020 2020 2020  crometre.       
+00013380: 2073 6f6c 7665 5f63 6f6c 6c65 6374 6976   solve_collectiv
+00013390: 655f 7068 6f6e 6f6e 3d46 616c 7365 2c0a  e_phonon=False,.
+000133a0: 2020 2020 2020 2020 7573 655f 6176 655f          use_ave_
+000133b0: 7070 3d46 616c 7365 2c0a 2020 2020 2020  pp=False,.      
+000133c0: 2020 6973 5f72 6564 7563 6962 6c65 5f63    is_reducible_c
+000133d0: 6f6c 6c69 7369 6f6e 5f6d 6174 7269 783d  ollision_matrix=
+000133e0: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
+000133f0: 735f 6b61 7070 615f 7374 6172 3d54 7275  s_kappa_star=Tru
+00013400: 652c 0a20 2020 2020 2020 2067 765f 6465  e,.        gv_de
+00013410: 6c74 615f 713d 4e6f 6e65 2c20 2023 2066  lta_q=None,  # f
+00013420: 6f72 2067 726f 7570 2076 656c 6f63 6974  or group velocit
+00013430: 790a 2020 2020 2020 2020 6973 5f66 756c  y.        is_ful
+00013440: 6c5f 7070 3d46 616c 7365 2c0a 2020 2020  l_pp=False,.    
+00013450: 2020 2020 7069 6e76 5f63 7574 6f66 663d      pinv_cutoff=
+00013460: 312e 3065 2d38 2c20 2023 2066 6f72 2070  1.0e-8,  # for p
+00013470: 7365 7564 6f2d 696e 7665 7273 696f 6e20  seudo-inversion 
+00013480: 6f66 2063 6f6c 6c69 7369 6f6e 206d 6174  of collision mat
+00013490: 7269 780a 2020 2020 2020 2020 7069 6e76  rix.        pinv
+000134a0: 5f6d 6574 686f 643d 302c 2020 2320 666f  _method=0,  # fo
+000134b0: 7220 7073 6575 646f 2d69 6e76 6572 7369  r pseudo-inversi
+000134c0: 6f6e 206f 6620 636f 6c6c 6973 696f 6e20  on of collision 
+000134d0: 6d61 7472 6978 0a20 2020 2020 2020 2070  matrix.        p
+000134e0: 696e 765f 736f 6c76 6572 3d30 2c20 2023  inv_solver=0,  #
+000134f0: 2073 6f6c 7665 7220 6f66 2070 7365 7564   solver of pseud
+00013500: 6f2d 696e 7665 7273 696f 6e20 6f66 2063  o-inversion of c
+00013510: 6f6c 6c69 7369 6f6e 206d 6174 7269 780a  ollision matrix.
+00013520: 2020 2020 2020 2020 7772 6974 655f 6761          write_ga
+00013530: 6d6d 613d 4661 6c73 652c 0a20 2020 2020  mma=False,.     
+00013540: 2020 2072 6561 645f 6761 6d6d 613d 4661     read_gamma=Fa
+00013550: 6c73 652c 0a20 2020 2020 2020 2069 735f  lse,.        is_
+00013560: 4e5f 553d 4661 6c73 652c 0a20 2020 2020  N_U=False,.     
+00013570: 2020 2063 6f6e 6475 6374 6976 6974 795f     conductivity_
+00013580: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
+00013590: 2020 2077 7269 7465 5f6b 6170 7061 3d46     write_kappa=F
+000135a0: 616c 7365 2c0a 2020 2020 2020 2020 7772  alse,.        wr
+000135b0: 6974 655f 6761 6d6d 615f 6465 7461 696c  ite_gamma_detail
+000135c0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+000135d0: 7772 6974 655f 636f 6c6c 6973 696f 6e3d  write_collision=
+000135e0: 4661 6c73 652c 0a20 2020 2020 2020 2072  False,.        r
+000135f0: 6561 645f 636f 6c6c 6973 696f 6e3d 4661  ead_collision=Fa
+00013600: 6c73 652c 0a20 2020 2020 2020 2077 7269  lse,.        wri
+00013610: 7465 5f70 703d 4661 6c73 652c 0a20 2020  te_pp=False,.   
+00013620: 2020 2020 2072 6561 645f 7070 3d46 616c       read_pp=Fal
+00013630: 7365 2c0a 2020 2020 2020 2020 7772 6974  se,.        writ
+00013640: 655f 4c42 5445 5f73 6f6c 7574 696f 6e3d  e_LBTE_solution=
+00013650: 4661 6c73 652c 0a20 2020 2020 2020 2063  False,.        c
+00013660: 6f6d 7072 6573 7369 6f6e 3d22 677a 6970  ompression="gzip
+00013670: 222c 0a20 2020 2020 2020 2069 6e70 7574  ",.        input
+00013680: 5f66 696c 656e 616d 653d 4e6f 6e65 2c0a  _filename=None,.
+00013690: 2020 2020 2020 2020 6f75 7470 7574 5f66          output_f
+000136a0: 696c 656e 616d 653d 4e6f 6e65 2c0a 2020  ilename=None,.  
+000136b0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+000136c0: 5275 6e20 7468 6572 6d61 6c20 636f 6e64  Run thermal cond
+000136d0: 7563 7469 7669 7479 2063 616c 6375 6c61  uctivity calcula
+000136e0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2050  tion...        P
+000136f0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00013700: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00013710: 2020 2020 2069 735f 4c42 5445 203a 2062       is_LBTE : b
+00013720: 6f6f 6c2c 206f 7074 696f 6e61 6c2c 2064  ool, optional, d
+00013730: 6566 6175 6c74 2069 7320 4661 6c73 650a  efault is False.
+00013740: 2020 2020 2020 2020 2020 2020 5254 4120              RTA 
+00013750: 2846 616c 7365 2920 6f72 2064 6972 6563  (False) or direc
+00013760: 7420 736f 6c75 7469 6f6e 2028 5472 7565  t solution (True
+00013770: 292e 0a20 2020 2020 2020 2074 656d 7065  )..        tempe
+00013780: 7261 7475 7265 7320 3a20 6172 7261 795f  ratures : array_
+00013790: 6c69 6b65 2c20 6f70 7469 6f6e 616c 2c20  like, optional, 
+000137a0: 6465 6661 756c 7420 6973 204e 6f6e 650a  default is None.
+000137b0: 2020 2020 2020 2020 2020 2020 5465 6d70              Temp
+000137c0: 6572 6174 7572 6573 2061 7420 7768 6963  eratures at whic
+000137d0: 6820 7468 6572 6d61 6c20 636f 6e64 7563  h thermal conduc
+000137e0: 7469 7669 7479 2069 7320 6361 6c63 756c  tivity is calcul
+000137f0: 6174 6564 2e0a 2020 2020 2020 2020 2020  ated..          
+00013800: 2020 7368 6170 653d 2874 656d 7065 7261    shape=(tempera
+00013810: 7475 7265 5f70 6f69 6e74 732c 2029 2c20  ture_points, ), 
+00013820: 6474 7970 653d 2764 6f75 626c 6527 2e0a  dtype='double'..
+00013830: 2020 2020 2020 2020 2020 2020 5769 7468              With
+00013840: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00013850: 2020 2020 2020 2060 6973 5f4c 4254 453d         `is_LBTE=
+00013860: 4661 6c73 6560 2067 6976 6573 2074 656d  False` gives tem
+00013870: 7065 7261 7475 7265 733d 5b30 2c20 3130  peratures=[0, 10
+00013880: 2c20 2e2e 2e2c 2031 3030 305d 2e0a 2020  , ..., 1000]..  
+00013890: 2020 2020 2020 2020 2020 2020 2020 6069                `i
+000138a0: 735f 4c42 5445 3d54 7275 6560 2067 6976  s_LBTE=True` giv
+000138b0: 6573 2074 656d 7065 7261 7475 7265 733d  es temperatures=
+000138c0: 5b33 3030 2c20 5d2e 0a20 2020 2020 2020  [300, ]..       
+000138d0: 2069 735f 6973 6f74 6f70 6520 3a20 626f   is_isotope : bo
+000138e0: 6f6c 2c20 6f70 7469 6f6e 616c 2c20 6465  ol, optional, de
+000138f0: 6661 756c 7420 6973 2046 616c 7365 0a20  fault is False. 
+00013900: 2020 2020 2020 2020 2020 2057 6974 6820             With 
+00013910: 6f72 2077 6974 686f 7574 2069 736f 746f  or without isoto
+00013920: 7065 2073 6361 7474 6572 696e 672e 0a20  pe scattering.. 
+00013930: 2020 2020 2020 206d 6173 735f 7661 7269         mass_vari
+00013940: 616e 6365 7320 3a20 6172 7261 795f 6c69  ances : array_li
+00013950: 6b65 2c20 6f70 7469 6f6e 616c 2c20 6465  ke, optional, de
+00013960: 6661 756c 7420 6973 204e 6f6e 650a 2020  fault is None.  
+00013970: 2020 2020 2020 2020 2020 4d61 7373 2076            Mass v
+00013980: 6172 6961 6e63 6573 2066 6f72 2069 736f  ariances for iso
+00013990: 746f 7065 2073 6361 7474 6572 696e 6720  tope scattering 
+000139a0: 6361 6c63 756c 6174 696f 6e2e 2057 6865  calculation. Whe
+000139b0: 6e20 4e6f 6e65 2c0a 2020 2020 2020 2020  n None,.        
+000139c0: 2020 2020 7468 6520 7661 6c75 6573 2073      the values s
+000139d0: 746f 7265 6420 696e 2070 686f 6e6f 3370  tored in phono3p
+000139e0: 7920 6172 6520 7573 6564 2077 6974 6820  y are used with 
+000139f0: 6069 735f 6973 6f74 6f70 653d 5472 7565  `is_isotope=True
+00013a00: 602e 0a20 2020 2020 2020 2020 2020 2073  `..            s
+00013a10: 6861 7065 2861 746f 6d73 5f69 6e5f 7072  hape(atoms_in_pr
+00013a20: 696d 6974 6976 652c 2029 2c20 6474 7970  imitive, ), dtyp
+00013a30: 653d 2764 6f75 626c 6527 2e0a 2020 2020  e='double'..    
+00013a40: 2020 2020 6772 6964 5f70 6f69 6e74 7320      grid_points 
+00013a50: 3a20 6172 7261 795f 6c69 6b65 2c20 6f70  : array_like, op
+00013a60: 7469 6f6e 616c 2c20 6465 6661 756c 7420  tional, default 
+00013a70: 6973 204e 6f6e 650a 2020 2020 2020 2020  is None.        
+00013a80: 2020 2020 4c69 7374 206f 6620 6772 6964      List of grid
+00013a90: 2070 6f69 6e74 2069 6e64 6963 6573 2077   point indices w
+00013aa0: 6865 7265 206d 6f64 6520 7468 6572 6d61  here mode therma
+00013ab0: 6c20 636f 6e64 7563 7469 7669 7469 6573  l conductivities
+00013ac0: 2061 7265 0a20 2020 2020 2020 2020 2020   are.           
+00013ad0: 2063 616c 6375 6c61 7465 642e 2057 6974   calculated. Wit
+00013ae0: 6820 4e6f 6e65 2c20 616c 6c20 7468 6520  h None, all the 
+00013af0: 6772 6964 2070 6f69 6e74 7320 7468 6174  grid points that
+00013b00: 2061 7265 206e 6563 6573 7361 7279 0a20   are necessary. 
+00013b10: 2020 2020 2020 2020 2020 2066 6f72 2074             for t
+00013b20: 6865 726d 616c 2063 6f6e 6475 6374 6976  hermal conductiv
+00013b30: 6974 7920 6172 6520 7365 7420 696e 7465  ity are set inte
+00013b40: 726e 616c 6c79 2e0a 2020 2020 2020 2020  rnally..        
+00013b50: 2020 2020 7368 6170 6528 6e75 6d5f 6772      shape(num_gr
+00013b60: 6964 5f70 6f69 6e74 732c 2029 2c20 6474  id_points, ), dt
+00013b70: 7970 653d 2769 6e74 5f27 2e0a 2020 2020  ype='int_'..    
+00013b80: 2020 2020 626f 756e 6461 7279 5f6d 6670      boundary_mfp
+00013b90: 203a 2066 6c6f 6174 2c20 6f70 7469 6f6e   : float, option
+00013ba0: 612c 2064 6566 6175 6c74 2069 7320 4e6f  a, default is No
+00013bb0: 6e65 0a20 2020 2020 2020 2020 2020 204d  ne.            M
+00013bc0: 6561 6e20 6672 6565 2070 6174 6820 696e  ean free path in
+00013bd0: 206d 6963 726f 6d65 7472 6520 746f 2063   micrometre to c
+00013be0: 616c 6375 6c61 7465 2073 696d 706c 6520  alculate simple 
+00013bf0: 626f 756e 6461 7279 0a20 2020 2020 2020  boundary.       
+00013c00: 2020 2020 2073 6361 7474 6572 696e 6720       scattering 
+00013c10: 636f 6e74 7269 6275 7469 6f6e 2074 6f20  contribution to 
+00013c20: 7468 6572 6d61 6c20 636f 6e64 7563 7469  thermal conducti
+00013c30: 7669 7479 2e0a 2020 2020 2020 2020 2020  vity..          
+00013c40: 2020 4e6f 6e65 2067 6976 6573 2031 206d    None gives 1 m
+00013c50: 6574 7265 2c20 7768 6963 6820 6973 2073  etre, which is s
+00013c60: 7570 706f 7365 6420 6e65 676c 6967 6962  upposed negligib
+00013c70: 6c65 2063 6f6e 7472 6962 7574 696f 6e2c  le contribution,
+00013c80: 0a20 2020 2020 2020 2020 2020 2062 7574  .            but
+00013c90: 2074 6869 7320 7661 6c75 6520 6973 2075   this value is u
+00013ca0: 7365 6420 746f 2061 766f 6964 2064 6976  sed to avoid div
+00013cb0: 6572 6765 6e63 6520 6f66 2070 686f 6e6f  ergence of phono
+00013cc0: 6e20 6c69 6665 7469 6d65 2e0a 2020 2020  n lifetime..    
+00013cd0: 2020 2020 736f 6c76 655f 636f 6c6c 6563      solve_collec
+00013ce0: 7469 7665 5f70 686f 6e6f 6e20 3a20 626f  tive_phonon : bo
+00013cf0: 6f6c 2c20 6f70 7469 6f6e 616c 2c20 6465  ol, optional, de
+00013d00: 6661 756c 7420 6973 2046 616c 7365 0a20  fault is False. 
+00013d10: 2020 2020 2020 2020 2020 2054 6869 7320             This 
+00013d20: 6973 2061 6e20 6f70 7469 6f6e 2066 6f72  is an option for
+00013d30: 2074 6865 2066 6561 7475 7265 2075 6e64   the feature und
+00013d40: 6572 2064 6576 656c 6f70 6d65 6e74 2e0a  er development..
+00013d50: 2020 2020 2020 2020 7573 655f 6176 655f          use_ave_
+00013d60: 7070 203a 2062 6f6f 6c2c 206f 7074 696f  pp : bool, optio
+00013d70: 6e61 6c2c 2064 6566 6175 6c74 2069 7320  nal, default is 
+00013d80: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00013d90: 2020 5254 4120 6f6e 6c79 2028 6069 735f    RTA only (`is_
+00013da0: 4c42 5445 3d46 616c 7365 6029 2e20 4176  LBTE=False`). Av
+00013db0: 6572 6167 6564 2070 686f 6e6f 6e2d 7068  eraged phonon-ph
+00013dc0: 6f6e 6f6e 2069 6e74 6572 6163 7469 6f6e  onon interaction
+00013dd0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00013de0: 656e 6774 6820 6973 2075 7365 6420 746f  ength is used to
+00013df0: 2063 616c 6375 6c61 7465 2070 686f 6e6f   calculate phono
+00013e00: 6e20 6c69 6665 7469 6d65 2e20 5468 6973  n lifetime. This
+00013e10: 2064 6f65 7320 6e6f 740a 2020 2020 2020   does not.      
+00013e20: 2020 2020 2020 7265 6475 6365 2063 6f6d        reduce com
+00013e30: 7075 7461 7469 6f6e 616c 2064 656d 616e  putational deman
+00013e40: 642c 2062 7574 206d 6179 2062 6520 7573  d, but may be us
+00013e50: 6564 2074 6f20 6d6f 6465 6c20 7468 6572  ed to model ther
+00013e60: 6d61 6c0a 2020 2020 2020 2020 2020 2020  mal.            
+00013e70: 636f 6e64 7563 7469 7669 7479 2066 6f72  conductivity for
+00013e80: 2061 6e61 6c79 7a65 2074 6865 2063 616c   analyze the cal
+00013e90: 6375 6c61 7469 6f6e 2072 6573 756c 7473  culation results
+00013ea0: 2e0a 2020 2020 2020 2020 6973 5f72 6564  ..        is_red
+00013eb0: 7563 6962 6c65 5f63 6f6c 6c69 7369 6f6e  ucible_collision
+00013ec0: 5f6d 6174 7269 7820 3a20 626f 6f6c 2c20  _matrix : bool, 
+00013ed0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00013ee0: 7420 6973 2046 616c 7365 0a20 2020 2020  t is False.     
+00013ef0: 2020 2020 2020 2044 6972 6563 7420 736f         Direct so
+00013f00: 6c75 7469 6f6e 206f 6e6c 7920 2860 6973  lution only (`is
+00013f10: 5f4c 4254 453d 5472 7565 6029 2e20 5468  _LBTE=True`). Th
+00013f20: 6973 2069 7320 616e 2065 7870 6572 696d  is is an experim
+00013f30: 656e 7461 6c0a 2020 2020 2020 2020 2020  ental.          
+00013f40: 2020 6f70 7469 6f6e 2e20 5769 7468 2054    option. With T
+00013f50: 7275 652c 2066 756c 6c20 636f 6c6c 6973  rue, full collis
+00013f60: 696f 6e20 6d61 7472 6978 2069 7320 6372  ion matrix is cr
+00013f70: 6561 7465 6420 616e 6420 736f 6c76 6564  eated and solved
+00013f80: 2e0a 2020 2020 2020 2020 6973 5f6b 6170  ..        is_kap
+00013f90: 7061 5f73 7461 7220 3a20 626f 6f6c 2c20  pa_star : bool, 
+00013fa0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00013fb0: 7420 6973 2054 7275 650a 2020 2020 2020  t is True.      
+00013fc0: 2020 2020 2020 5769 7468 2074 7275 652c        With true,
+00013fd0: 2073 796d 6d65 7472 7920 6973 2063 6f6e   symmetry is con
+00013fe0: 7369 6465 7265 6420 7768 656e 2073 616d  sidered when sam
+00013ff0: 706c 696e 6720 6772 6964 2070 6f69 6e74  pling grid point
+00014000: 730a 2020 2020 2020 2020 2020 2020 6174  s.            at
+00014010: 2077 6869 6368 206d 6f64 6520 7468 6572   which mode ther
+00014020: 6d61 6c20 636f 6e64 7563 7469 7669 7469  mal conductiviti
+00014030: 6573 2061 7265 2063 616c 6375 6c61 7465  es are calculate
+00014040: 642e 0a20 2020 2020 2020 2067 765f 6465  d..        gv_de
+00014050: 6c74 615f 7120 3a20 666c 6f61 742c 206f  lta_q : float, o
+00014060: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+00014070: 2069 7320 4e6f 6e65 2c20 2023 2066 6f72   is None,  # for
+00014080: 2067 726f 7570 2076 656c 6f63 6974 790a   group velocity.
+00014090: 2020 2020 2020 2020 2020 2020 5769 7468              With
+000140a0: 206e 6f6e 2d61 6e61 6c79 7469 6361 6c20   non-analytical 
+000140b0: 636f 7272 6563 7469 6f6e 2c20 6772 6f75  correction, grou
+000140c0: 7020 7665 6c6f 6369 7479 2069 7320 6361  p velocity is ca
+000140d0: 6c63 756c 6174 6564 0a20 2020 2020 2020  lculated.       
+000140e0: 2020 2020 2062 7920 6365 6e74 7261 6c20       by central 
+000140f0: 6669 6e69 7465 2064 6966 6665 7265 6e63  finite differenc
+00014100: 6520 6d65 7468 6f64 2e20 5468 6973 2076  e method. This v
+00014110: 616c 7565 2067 6976 6573 2074 6865 2064  alue gives the d
+00014120: 6973 7461 6e63 650a 2020 2020 2020 2020  istance.        
+00014130: 2020 2020 696e 2062 6f74 6820 6469 7265      in both dire
+00014140: 6374 696f 6e73 2069 6e20 312f 416e 6773  ctions in 1/Angs
+00014150: 7472 6f6d 2e20 5468 6520 6465 6661 756c  trom. The defaul
+00014160: 7420 7661 6c75 6520 7769 6c6c 2062 6520  t value will be 
+00014170: 3165 2d35 2e0a 2020 2020 2020 2020 6973  1e-5..        is
+00014180: 5f66 756c 6c5f 7070 203a 2062 6f6f 6c2c  _full_pp : bool,
+00014190: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+000141a0: 6c74 2069 7320 4661 6c73 650a 2020 2020  lt is False.    
+000141b0: 2020 2020 2020 2020 5769 7468 2054 7275          With Tru
+000141c0: 652c 2066 756c 6c20 656c 656d 656e 7473  e, full elements
+000141d0: 206f 6620 7068 6f6e 6f6e 2d70 686f 6e6f   of phonon-phono
+000141e0: 6e20 696e 7465 7261 6374 696f 6e20 7374  n interaction st
+000141f0: 7265 6e67 7468 0a20 2020 2020 2020 2020  rength.         
+00014200: 2020 2061 7265 2063 6f6d 7075 7465 642e     are computed.
+00014210: 2048 6f77 6576 6572 2077 6974 6820 7465   However with te
+00014220: 7472 6168 6564 726f 6e20 6d65 7468 6f64  trahedron method
+00014230: 2c20 7061 7274 206f 6620 7468 656d 2061  , part of them a
+00014240: 7265 0a20 2020 2020 2020 2020 2020 206b  re.            k
+00014250: 6e6f 776e 2074 6f20 6265 207a 6572 6f20  nown to be zero 
+00014260: 616e 6420 756e 6e65 6365 7373 6172 7920  and unnecessary 
+00014270: 746f 2063 616c 6375 6c61 7469 6f6e 2e20  to calculation. 
+00014280: 5769 7468 2046 616c 7365 2c0a 2020 2020  With False,.    
+00014290: 2020 2020 2020 2020 7468 6f73 6520 656c          those el
+000142a0: 656d 656e 7473 2061 7265 206e 6f74 2063  ements are not c
+000142b0: 616c 6375 6c61 7465 642c 2062 7920 7768  alculated, by wh
+000142c0: 6963 6820 636f 6e73 6964 6572 6162 6c65  ich considerable
+000142d0: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+000142e0: 726f 7665 206f 6620 6566 6669 6369 656e  rove of efficien
+000142f0: 6379 2069 7320 6578 7065 6374 6564 2e0a  cy is expected..
+00014300: 2020 2020 2020 2020 2020 2020 5769 7468              With
+00014310: 2073 6d65 6172 696e 6720 6d65 7468 6f64   smearing method
+00014320: 2c20 6576 656e 2069 6620 7468 6973 2069  , even if this i
+00014330: 7320 7365 7420 4661 6c73 652c 2066 756c  s set False, ful
+00014340: 6c20 656c 656d 656e 7473 0a20 2020 2020  l elements.     
+00014350: 2020 2020 2020 2061 7265 2063 6f6d 7075         are compu
+00014360: 7465 6420 756e 6c65 7373 2060 7369 676d  ted unless `sigm
+00014370: 615f 6375 746f 6666 6020 6973 2073 7065  a_cutoff` is spe
+00014380: 6369 6669 6564 2e0a 2020 2020 2020 2020  cified..        
+00014390: 7069 6e76 5f63 7574 6f66 6620 3a20 666c  pinv_cutoff : fl
+000143a0: 6f61 742c 206f 7074 696f 6e61 6c2c 2064  oat, optional, d
+000143b0: 6566 6175 6c74 2069 7320 312e 3065 2d38  efault is 1.0e-8
+000143c0: 0a20 2020 2020 2020 2020 2020 2044 6972  .            Dir
+000143d0: 6563 7420 736f 6c75 7469 6f6e 206f 6e6c  ect solution onl
+000143e0: 7920 2860 6973 5f4c 4254 453d 5472 7565  y (`is_LBTE=True
+000143f0: 6029 2e20 5468 6973 2069 7320 7573 6564  `). This is used
+00014400: 2061 7320 6120 6372 6974 6572 696f 6e0a   as a criterion.
+00014410: 2020 2020 2020 2020 2020 2020 746f 206a              to j
+00014420: 7564 6765 2074 6865 2065 6967 656e 7661  udge the eigenva
+00014430: 6c75 6573 2061 7265 2063 6f6e 7369 6465  lues are conside
+00014440: 7265 6420 6173 207a 6572 6f20 6f72 206e  red as zero or n
+00014450: 6f74 2069 6e0a 2020 2020 2020 2020 2020  ot in.          
+00014460: 2020 7073 6575 646f 2d69 6e76 6572 7369    pseudo-inversi
+00014470: 6f6e 206f 6620 636f 6c6c 6973 696f 6e20  on of collision 
+00014480: 6d61 7472 6978 2e20 5365 6520 616c 736f  matrix. See also
+00014490: 2060 7069 6e76 5f6d 6574 686f 6460 2e0a   `pinv_method`..
+000144a0: 2020 2020 2020 2020 7069 6e76 5f6d 6574          pinv_met
+000144b0: 686f 6420 3a20 696e 742c 206f 7074 696f  hod : int, optio
+000144c0: 6e61 6c2c 2064 6566 6175 6c74 2069 7320  nal, default is 
+000144d0: 302e 0a20 2020 2020 2020 2020 2020 2044  0..            D
+000144e0: 6972 6563 7420 736f 6c75 7469 6f6e 206f  irect solution o
+000144f0: 6e6c 7920 2860 6973 5f4c 4254 453d 5472  nly (`is_LBTE=Tr
+00014500: 7565 6029 2e0a 2020 2020 2020 2020 2020  ue`)..          
+00014510: 2020 2020 2020 302e 2061 6273 2865 6967        0. abs(eig
+00014520: 656e 7661 6c75 6529 203c 2060 7069 6e76  envalue) < `pinv
+00014530: 5f63 7574 6f66 6660 0a20 2020 2020 2020  _cutoff`.       
+00014540: 2020 2020 2020 2020 2031 2e20 6569 6765           1. eige
+00014550: 6e76 616c 7565 203c 2060 7069 6e76 5f63  nvalue < `pinv_c
+00014560: 7574 6f66 6660 0a20 2020 2020 2020 2070  utoff`.        p
+00014570: 696e 765f 736f 6c76 6572 203a 2069 6e74  inv_solver : int
+00014580: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+00014590: 756c 7420 6973 2030 0a20 2020 2020 2020  ult is 0.       
+000145a0: 2020 2020 2044 6972 6563 7420 736f 6c75       Direct solu
+000145b0: 7469 6f6e 206f 6e6c 7920 2860 6973 5f4c  tion only (`is_L
+000145c0: 4254 453d 5472 7565 6029 2e20 4368 6f69  BTE=True`). Choi
+000145d0: 6365 206f 6620 736f 6c76 6572 206f 660a  ce of solver of.
+000145e0: 2020 2020 2020 2020 2020 2020 7073 6575              pseu
+000145f0: 646f 2d69 6e76 6572 7369 6f6e 206f 6620  do-inversion of 
+00014600: 636f 6c6c 6973 696f 6e20 6d61 7472 6978  collision matrix
+00014610: 2e20 3020 6d65 616e 7320 7468 6520 6465  . 0 means the de
+00014620: 6661 756c 7420 6368 6f69 6365 2e0a 2020  fault choice..  
+00014630: 2020 2020 2020 2020 2020 2020 2020 312e                1.
+00014640: 204c 6170 6163 6b65 2064 7379 6576 3a20   Lapacke dsyev: 
+00014650: 536d 616c 6c65 7220 6d65 6d6f 7279 2063  Smaller memory c
+00014660: 6f6e 7375 6d70 7469 6f6e 2074 6861 6e20  onsumption than 
+00014670: 6473 7965 7664 2c20 6275 740a 2020 2020  dsyevd, but.    
+00014680: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00014690: 6c6f 7765 722e 2054 6869 7320 6973 2074  lower. This is t
+000146a0: 6865 2064 6566 6175 6c74 2073 6f6c 7665  he default solve
+000146b0: 7220 7768 656e 204d 4b4c 204c 4150 4143  r when MKL LAPAC
+000146c0: 4b45 2069 730a 2020 2020 2020 2020 2020  KE is.          
+000146d0: 2020 2020 2020 2020 2069 6e74 6567 7261           integra
+000146e0: 7465 6420 6f72 2073 6369 7079 2069 7320  ted or scipy is 
+000146f0: 6e6f 7420 696e 7374 616c 6c65 642e 0a20  not installed.. 
+00014700: 2020 2020 2020 2020 2020 2020 2020 2032                 2
+00014710: 2e20 4c61 7061 636b 6520 6473 7965 7664  . Lapacke dsyevd
+00014720: 3a20 4c61 7267 6572 206d 656d 6f72 7920  : Larger memory 
+00014730: 636f 6e73 756d 7074 696f 6e20 7468 616e  consumption than
+00014740: 2064 7379 6576 2c20 6275 740a 2020 2020   dsyev, but.    
+00014750: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00014760: 6173 7465 722e 2054 6869 7320 6973 206e  aster. This is n
+00014770: 6f74 2072 6563 6f6d 6d65 6e64 6564 2062  ot recommended b
+00014780: 6563 6175 7365 2073 6f6d 6574 696d 6573  ecause sometimes
+00014790: 2061 2077 726f 6e67 0a20 2020 2020 2020   a wrong.       
+000147a0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+000147b0: 6c74 2069 7320 6f62 7461 696e 6564 2e0a  lt is obtained..
+000147c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000147d0: 332e 204e 756d 7079 e280 9973 2064 7379  3. Numpy...s dsy
+000147e0: 6576 6420 286c 696e 616c 672e 6569 6768  evd (linalg.eigh
+000147f0: 292e 2054 6869 7320 6973 206e 6f74 2072  ). This is not r
+00014800: 6563 6f6d 6d65 6e64 6564 0a20 2020 2020  ecommended.     
+00014810: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00014820: 6361 7573 6520 736f 6d65 7469 6d65 7320  cause sometimes 
+00014830: 6120 7772 6f6e 6720 7265 7375 6c74 2069  a wrong result i
+00014840: 7320 6f62 7461 696e 6564 2e0a 2020 2020  s obtained..    
+00014850: 2020 2020 2020 2020 2020 2020 342e 2053              4. S
+00014860: 6369 7079 e280 9973 2064 7379 6576 3a20  cipy...s dsyev: 
+00014870: 5468 6973 2069 7320 7468 6520 6465 6661  This is the defa
+00014880: 756c 7420 736f 6c76 6572 2077 6865 6e20  ult solver when 
+00014890: 7363 6970 7920 6973 0a20 2020 2020 2020  scipy is.       
+000148a0: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+000148b0: 616c 6c65 6420 616e 6420 4d4b 4c20 4c41  alled and MKL LA
+000148c0: 5041 434b 4520 6973 206e 6f74 2069 6e74  PACKE is not int
+000148d0: 6567 7261 7465 642e 0a20 2020 2020 2020  egrated..       
+000148e0: 2020 2020 2020 2020 2035 2e20 5363 6970           5. Scip
+000148f0: 79e2 8099 7320 6473 7965 7664 2e20 5468  y...s dsyevd. Th
+00014900: 6973 2069 7320 6e6f 7420 7265 636f 6d6d  is is not recomm
+00014910: 656e 6465 6420 6265 6361 7573 6520 736f  ended because so
+00014920: 6d65 7469 6d65 730a 2020 2020 2020 2020  metimes.        
+00014930: 2020 2020 2020 2020 2020 2061 2077 726f             a wro
+00014940: 6e67 2072 6573 756c 7420 6973 206f 6274  ng result is obt
+00014950: 6169 6e65 642e 0a20 2020 2020 2020 2020  ained..         
+00014960: 2020 2054 6865 2073 6f6c 7665 7220 6368     The solver ch
+00014970: 6f69 6365 7320 6f74 6865 7220 7468 616e  oices other than
+00014980: 202d 2d70 696e 762d 736f 6c76 6572 3d31   --pinv-solver=1
+00014990: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+000149a0: 202d 2d70 696e 762d 736f 6c76 6572 3d34   --pinv-solver=4
+000149b0: 2061 7265 2064 616e 6765 726f 7573 2061   are dangerous a
+000149c0: 6e64 206e 6f74 2072 6563 6f6d 6d65 6e64  nd not recommend
+000149d0: 2e0a 2020 2020 2020 2020 7772 6974 655f  ..        write_
+000149e0: 6761 6d6d 6120 3a20 626f 6f6c 2c20 6f70  gamma : bool, op
+000149f0: 7469 6f6e 616c 2c20 6465 6661 756c 7420  tional, default 
+00014a00: 6973 2046 616c 7365 0a20 2020 2020 2020  is False.       
+00014a10: 2020 2020 2052 5441 206f 6e6c 7920 2860       RTA only (`
+00014a20: 6973 5f4c 4254 453d 4661 6c73 6560 292e  is_LBTE=False`).
+00014a30: 2057 6974 6820 5472 7565 2c20 5772 6974   With True, Writ
+00014a40: 6520 6d6f 6465 2074 6865 726d 616c 0a20  e mode thermal. 
+00014a50: 2020 2020 2020 2020 2020 2063 6f6e 6475             condu
+00014a60: 6374 6976 6974 7920 7072 6f70 6572 7469  ctivity properti
+00014a70: 6573 2069 6e74 6f20 6669 6c65 7320 6174  es into files at
+00014a80: 2065 6163 6820 6772 6964 2070 6f69 6e74   each grid point
+00014a90: 2e20 5769 7468 0a20 2020 2020 2020 2020  . With.         
+00014aa0: 2020 2060 6261 6e64 5f69 6e64 6963 6573     `band_indices
+00014ab0: 6020 6f72 206d 756c 7469 706c 6520 6073  ` or multiple `s
+00014ac0: 6967 6d61 7360 2069 7320 7370 6563 6966  igmas` is specif
+00014ad0: 6965 642c 2074 6865 2066 696c 6573 0a20  ied, the files. 
+00014ae0: 2020 2020 2020 2020 2020 2061 7265 206d             are m
+00014af0: 6164 6520 666f 7220 6561 6368 206f 6620  ade for each of 
+00014b00: 7468 656d 2c20 746f 6f2e 0a20 2020 2020  them, too..     
+00014b10: 2020 2072 6561 645f 6761 6d6d 6120 3a20     read_gamma : 
+00014b20: 626f 6f6c 2c20 6f70 7469 6f6e 616c 2c20  bool, optional, 
+00014b30: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
+00014b40: 0a20 2020 2020 2020 2020 2020 2052 5441  .            RTA
+00014b50: 206f 6e6c 7920 2860 6973 5f4c 4254 453d   only (`is_LBTE=
+00014b60: 4661 6c73 6560 292e 2057 6974 6820 5472  False`). With Tr
+00014b70: 7565 2c20 6465 6164 2066 696c 6573 2063  ue, dead files c
+00014b80: 7265 6174 6564 2062 790a 2020 2020 2020  reated by.      
+00014b90: 2020 2020 2020 6077 7269 7465 5f67 616d        `write_gam
+00014ba0: 6d61 3d54 7275 6560 2069 6e73 7465 6164  ma=True` instead
+00014bb0: 206f 6620 6361 6c63 756c 6174 696e 6720   of calculating 
+00014bc0: 7068 6f6e 6f6e 2d70 686f 6e6f 6e0a 2020  phonon-phonon.  
+00014bd0: 2020 2020 2020 2020 2020 696e 7465 7261            intera
+00014be0: 6374 696f 6e20 7374 7265 6e67 7468 2061  ction strength a
+00014bf0: 6e64 2069 6d61 6769 6e61 7279 2070 6172  nd imaginary par
+00014c00: 7473 206f 6620 7365 6c66 2d65 6e65 7267  ts of self-energ
+00014c10: 792e 0a20 2020 2020 2020 2069 735f 4e5f  y..        is_N_
+00014c20: 5520 3a20 626f 6f6c 2c20 6f70 7469 6f6e  U : bool, option
+00014c30: 616c 2c20 6465 6661 756c 7420 6973 2046  al, default is F
+00014c40: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00014c50: 2052 5441 206f 6e6c 7920 2860 6973 5f4c   RTA only (`is_L
+00014c60: 4254 453d 4661 6c73 6560 292e 2057 6974  BTE=False`). Wit
+00014c70: 6820 5472 7565 2c20 6361 7465 676f 7269  h True, categori
+00014c80: 7a61 7469 6f6e 206f 6620 6e6f 726d 616c  zation of normal
+00014c90: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00014ca0: 2055 6d6b 6c61 7070 2073 6361 7474 6572   Umklapp scatter
+00014cb0: 696e 6720 6973 206d 6164 6520 616e 6420  ing is made and 
+00014cc0: 696d 6167 696e 6172 7920 7061 7274 7320  imaginary parts 
+00014cd0: 6f66 2073 656c 6620 656e 6572 6779 0a20  of self energy. 
+00014ce0: 2020 2020 2020 2020 2020 2066 6f72 2074             for t
+00014cf0: 6865 6d20 6172 6520 7365 7061 7261 7465  hem are separate
+00014d00: 642e 0a20 2020 2020 2020 2063 6f6e 6475  d..        condu
+00014d10: 6374 6976 6974 795f 7479 7065 203a 2073  ctivity_type : s
+00014d20: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+00014d30: 2020 2020 2020 2020 2022 7769 676e 6572           "wigner
+00014d40: 222c 2022 6b75 626f 222c 206f 7220 4e6f  ", "kubo", or No
+00014d50: 6e65 2e20 4465 6661 756c 7420 6973 204e  ne. Default is N
+00014d60: 6f6e 652e 0a20 2020 2020 2020 2077 7269  one..        wri
+00014d70: 7465 5f6b 6170 7061 203a 2062 6f6f 6c2c  te_kappa : bool,
+00014d80: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+00014d90: 6c74 2069 7320 4661 6c73 650a 2020 2020  lt is False.    
+00014da0: 2020 2020 2020 2020 5769 7468 2054 7275          With Tru
+00014db0: 652c 2074 6865 726d 616c 2063 6f6e 6475  e, thermal condu
+00014dc0: 6374 6976 6974 7920 616e 6420 7265 6c61  ctivity and rela
+00014dd0: 7465 6420 7072 6f70 6572 7469 6573 2061  ted properties a
+00014de0: 7265 0a20 2020 2020 2020 2020 2020 2077  re.            w
+00014df0: 7269 7474 656e 2069 6e74 6f20 6120 6669  ritten into a fi
+00014e00: 6c65 2e20 5769 7468 206d 756c 7469 706c  le. With multipl
+00014e10: 6520 6073 6967 6d61 7360 2c20 7265 7370  e `sigmas`, resp
+00014e20: 6563 7469 7665 2066 696c 6573 0a20 2020  ective files.   
+00014e30: 2020 2020 2020 2020 2061 7265 2063 7265           are cre
+00014e40: 6174 6564 2e0a 2020 2020 2020 2020 7772  ated..        wr
+00014e50: 6974 655f 6761 6d6d 615f 6465 7461 696c  ite_gamma_detail
+00014e60: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+00014e70: 6c2c 2064 6566 6175 6c74 2069 7320 4661  l, default is Fa
+00014e80: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00014e90: 5254 4120 6f6e 6c79 2028 6069 735f 4c42  RTA only (`is_LB
+00014ea0: 5445 3d46 616c 7365 6029 2e20 5769 7468  TE=False`). With
+00014eb0: 2054 7275 652c 2064 6574 6169 6c65 6420   True, detailed 
+00014ec0: 696e 666f 726d 6174 696f 6e20 6f66 0a20  information of. 
+00014ed0: 2020 2020 2020 2020 2020 2069 6d61 6769             imagi
+00014ee0: 6e61 7279 2070 6172 7473 206f 6620 7365  nary parts of se
+00014ef0: 6c66 2065 6e65 7267 7920 6973 2073 746f  lf energy is sto
+00014f00: 7265 6420 696e 746f 2066 696c 6573 2073  red into files s
+00014f10: 7563 6820 6173 0a20 2020 2020 2020 2020  uch as.         
+00014f20: 2020 2074 686f 7365 206d 6164 6520 6279     those made by
+00014f30: 2060 7772 6974 655f 6761 6d6d 6160 2e0a   `write_gamma`..
+00014f40: 2020 2020 2020 2020 7772 6974 655f 636f          write_co
+00014f50: 6c6c 6973 696f 6e20 3a20 626f 6f6c 2c20  llision : bool, 
+00014f60: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00014f70: 7420 6973 2046 616c 7365 0a20 2020 2020  t is False.     
+00014f80: 2020 2020 2020 2044 6972 6563 7420 736f         Direct so
+00014f90: 6c75 7469 6f6e 206f 6e6c 7920 2860 6973  lution only (`is
+00014fa0: 5f4c 4254 453d 5472 7565 6029 2e20 5769  _LBTE=True`). Wi
+00014fb0: 7468 2054 7275 652c 2063 6f6c 6c69 7369  th True, collisi
+00014fc0: 6f6e 206d 6174 7269 780a 2020 2020 2020  on matrix.      
+00014fd0: 2020 2020 2020 6973 2077 7269 7474 656e        is written
+00014fe0: 2069 6e74 6f20 6120 6669 6c65 2e20 5769   into a file. Wi
+00014ff0: 7468 206d 756c 7469 706c 6520 6073 6967  th multiple `sig
+00015000: 6d61 7360 2073 7065 6369 6669 6564 2c0a  mas` specified,.
+00015010: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+00015020: 6563 7469 7665 2066 696c 6573 2061 7265  ective files are
+00015030: 2063 7265 6174 6564 2e20 4265 2063 6172   created. Be car
+00015040: 6566 756c 2074 6861 7420 7468 6973 2066  eful that this f
+00015050: 696c 6520 6361 6e20 6265 0a20 2020 2020  ile can be.     
+00015060: 2020 2020 2020 2068 7567 652e 0a20 2020         huge..   
+00015070: 2020 2020 2072 6561 645f 636f 6c6c 6973       read_collis
+00015080: 696f 6e20 3a20 626f 6f6c 2c20 6f70 7469  ion : bool, opti
+00015090: 6f6e 616c 2c20 6465 6661 756c 7420 6973  onal, default is
+000150a0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+000150b0: 2020 2044 6972 6563 7420 736f 6c75 7469     Direct soluti
+000150c0: 6f6e 206f 6e6c 7920 2860 6973 5f4c 4254  on only (`is_LBT
+000150d0: 453d 5472 7565 6029 2e20 5769 7468 2054  E=True`). With T
+000150e0: 7275 652c 2063 6f6c 6c69 7369 6f6e 206d  rue, collision m
+000150f0: 6174 7269 780a 2020 2020 2020 2020 2020  atrix.          
+00015100: 2020 6973 2072 6561 6420 6672 6f6d 2061    is read from a
+00015110: 2066 696c 652e 0a20 2020 2020 2020 2077   file..        w
+00015120: 7269 7465 5f70 7020 3a20 626f 6f6c 2c20  rite_pp : bool, 
+00015130: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00015140: 7420 6973 2046 616c 7365 0a20 2020 2020  t is False.     
+00015150: 2020 2020 2020 2057 6974 6820 5472 7565         With True
+00015160: 2c20 7068 6f6e 6f6e 2d70 686f 6e6f 6e20  , phonon-phonon 
+00015170: 696e 7465 7261 6374 696f 6e20 7374 7265  interaction stre
+00015180: 6e67 7468 2069 7320 7772 6974 7465 6e20  ngth is written 
+00015190: 696e 746f 0a20 2020 2020 2020 2020 2020  into.           
+000151a0: 2066 696c 6573 2061 7420 6561 6368 2067   files at each g
+000151b0: 7269 6420 706f 696e 742e 2054 6869 7320  rid point. This 
+000151c0: 6f70 7469 6f6e 2061 7373 756d 6573 2073  option assumes s
+000151d0: 696e 676c 6520 7661 6c75 6520 6973 2069  ingle value is i
+000151e0: 6e0a 2020 2020 2020 2020 2020 2020 6073  n.            `s
+000151f0: 6967 6d61 7360 2e0a 2020 2020 2020 2020  igmas`..        
+00015200: 7265 6164 5f70 7020 3a20 626f 6f6c 2c20  read_pp : bool, 
+00015210: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00015220: 7420 6973 2046 616c 7365 0a20 2020 2020  t is False.     
+00015230: 2020 2020 2020 2057 6974 6820 5472 7565         With True
+00015240: 2c20 7068 6f6e 6f6e 2d70 686f 6e6f 6e20  , phonon-phonon 
+00015250: 696e 7465 7261 6374 696f 6e20 7374 7265  interaction stre
+00015260: 6e67 7468 2069 7320 7265 6164 2066 726f  ngth is read fro
+00015270: 6d20 6669 6c65 732e 0a20 2020 2020 2020  m files..       
+00015280: 2077 7269 7465 5f4c 4254 455f 736f 6c75   write_LBTE_solu
+00015290: 7469 6f6e 203a 2062 6f6f 6c2c 206f 7074  tion : bool, opt
+000152a0: 696f 6e61 6c2c 2064 6566 6175 6c74 2069  ional, default i
+000152b0: 7320 4661 6c73 650a 2020 2020 2020 2020  s False.        
+000152c0: 2020 2020 4469 7265 6374 2073 6f6c 7574      Direct solut
+000152d0: 696f 6e20 6f6e 6c79 2028 6069 735f 4c42  ion only (`is_LB
+000152e0: 5445 3d54 7275 6560 292e 2057 6974 6820  TE=True`). With 
+000152f0: 5472 7565 2c20 6569 6765 6e76 6563 746f  True, eigenvecto
+00015300: 7273 206f 660a 2020 2020 2020 2020 2020  rs of.          
+00015310: 2020 636f 6c6c 6973 696f 6e20 6d61 7472    collision matr
+00015320: 6978 2069 7320 7772 6974 7465 6e20 696e  ix is written in
+00015330: 2061 2066 696c 6520 6173 2074 6865 2072   a file as the r
+00015340: 6f77 2076 6563 746f 7273 2065 7863 6570  ow vectors excep
+00015350: 740a 2020 2020 2020 2020 2020 2020 756e  t.            un
+00015360: 6c65 7373 2060 7069 6e76 5f73 6f6c 7665  less `pinv_solve
+00015370: 723d 3360 2028 666f 7220 7468 6973 2c20  r=3` (for this, 
+00015380: 636f 6c75 6d6e 2076 6563 746f 7273 292e  column vectors).
+00015390: 2057 6974 6820 6d75 6c74 6970 6c65 0a20   With multiple. 
+000153a0: 2020 2020 2020 2020 2020 2060 7369 676d             `sigm
+000153b0: 6173 6020 7370 6563 6966 6965 642c 2072  as` specified, r
+000153c0: 6573 7065 6374 6976 6520 6669 6c65 7320  espective files 
+000153d0: 6172 6520 6372 6561 7465 642e 2042 6520  are created. Be 
+000153e0: 6361 7265 6675 6c20 7468 6174 0a20 2020  careful that.   
+000153f0: 2020 2020 2020 2020 2074 6869 7320 6669           this fi
+00015400: 6c65 2063 616e 2062 6520 6875 6765 2e0a  le can be huge..
+00015410: 2020 2020 2020 2020 636f 6d70 7265 7373          compress
+00015420: 696f 6e3a 2073 7472 2c20 6f70 7469 6f6e  ion: str, option
+00015430: 616c 2c20 6465 6661 756c 7420 6973 2022  al, default is "
+00015440: 677a 6970 220a 2020 2020 2020 2020 2020  gzip".          
+00015450: 2020 5768 656e 2077 7269 7469 6e67 2072    When writing r
+00015460: 6573 756c 7473 2069 6e74 6f20 6669 6c65  esults into file
+00015470: 7320 696e 2068 6466 352c 206c 6172 6765  s in hdf5, large
+00015480: 2064 6174 6120 6172 6520 636f 6d70 7265   data are compre
+00015490: 7373 6564 0a20 2020 2020 2020 2020 2020  ssed.           
+000154a0: 2062 7920 7468 6973 206f 7074 696f 6e73   by this options
+000154b0: 2e20 5365 6520 7468 6520 6465 7461 696c  . See the detail
+000154c0: 2061 7420 6835 7079 2064 6f63 756d 656e   at h5py documen
+000154d0: 7461 7469 6f6e 2e0a 2020 2020 2020 2020  tation..        
+000154e0: 696e 7075 745f 6669 6c65 6e61 6d65 203a  input_filename :
+000154f0: 2073 7472 2c20 6f70 7469 6f6e 616c 2c20   str, optional, 
+00015500: 6465 6661 756c 7420 6973 204e 6f6e 650a  default is None.
+00015510: 2020 2020 2020 2020 2020 2020 5768 656e              When
+00015520: 2073 7065 6369 6669 6564 2c20 7468 6520   specified, the 
+00015530: 7374 7269 6e67 2069 7320 696e 7365 7274  string is insert
+00015540: 6564 2062 6566 6f72 6520 6669 6c65 6e61  ed before filena
+00015550: 6d65 2065 7874 656e 7369 6f6e 0a20 2020  me extension.   
+00015560: 2020 2020 2020 2020 2069 6e20 7265 6164           in read
+00015570: 696e 6720 6669 6c65 732e 0a20 2020 2020  ing files..     
+00015580: 2020 206f 7574 7075 745f 6669 6c65 6e61     output_filena
+00015590: 6d65 203a 2073 7472 2c20 6f70 7469 6f6e  me : str, option
+000155a0: 616c 2c20 6465 6661 756c 7420 6973 204e  al, default is N
+000155b0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+000155c0: 5768 656e 2073 7065 6369 6669 6564 2c20  When specified, 
+000155d0: 7468 6520 7374 7269 6e67 2069 7320 696e  the string is in
+000155e0: 7365 7274 6564 2062 6566 6f72 6520 6669  serted before fi
+000155f0: 6c65 6e61 6d65 2065 7874 656e 7369 6f6e  lename extension
+00015600: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+00015610: 7772 6974 696e 6720 6669 6c65 732e 0a0a  writing files...
+00015620: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00015630: 2020 2020 6966 2073 656c 662e 5f69 6e74      if self._int
+00015640: 6572 6163 7469 6f6e 2069 7320 4e6f 6e65  eraction is None
+00015650: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
+00015660: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
+00015670: 2020 2020 2020 2250 686f 6e6f 3370 792e        "Phono3py.
+00015680: 696e 6974 5f70 6870 685f 696e 7465 7261  init_phph_intera
+00015690: 6374 696f 6e20 6861 7320 746f 2062 6520  ction has to be 
+000156a0: 6361 6c6c 6564 2022 0a20 2020 2020 2020  called ".       
+000156b0: 2020 2020 2020 2020 2022 6265 666f 7265           "before
+000156c0: 2072 756e 6e69 6e67 2074 6869 7320 6d65   running this me
+000156d0: 7468 6f64 2e22 0a20 2020 2020 2020 2020  thod.".         
+000156e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000156f0: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
+00015700: 726f 7228 6d73 6729 0a0a 2020 2020 2020  ror(msg)..      
+00015710: 2020 6966 2069 735f 4c42 5445 3a0a 2020    if is_LBTE:.  
+00015720: 2020 2020 2020 2020 2020 6966 2074 656d            if tem
+00015730: 7065 7261 7475 7265 7320 6973 204e 6f6e  peratures is Non
+00015740: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00015750: 2020 205f 7465 6d70 6572 6174 7572 6573     _temperatures
+00015760: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+00015770: 2020 2020 2020 2020 2033 3030 2c0a 2020           300,.  
+00015780: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+00015790: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000157a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000157b0: 2020 5f74 656d 7065 7261 7475 7265 7320    _temperatures 
+000157c0: 3d20 7465 6d70 6572 6174 7572 6573 0a20  = temperatures. 
+000157d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000157e0: 5f74 6865 726d 616c 5f63 6f6e 6475 6374  _thermal_conduct
+000157f0: 6976 6974 7920 3d20 6765 745f 7468 6572  ivity = get_ther
+00015800: 6d61 6c5f 636f 6e64 7563 7469 7669 7479  mal_conductivity
+00015810: 5f4c 4254 4528 0a20 2020 2020 2020 2020  _LBTE(.         
+00015820: 2020 2020 2020 2073 656c 662e 5f69 6e74         self._int
+00015830: 6572 6163 7469 6f6e 2c0a 2020 2020 2020  eraction,.      
+00015840: 2020 2020 2020 2020 2020 7465 6d70 6572            temper
+00015850: 6174 7572 6573 3d5f 7465 6d70 6572 6174  atures=_temperat
+00015860: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
+00015870: 2020 2020 2020 7369 676d 6173 3d73 656c        sigmas=sel
+00015880: 662e 5f73 6967 6d61 732c 0a20 2020 2020  f._sigmas,.     
+00015890: 2020 2020 2020 2020 2020 2073 6967 6d61             sigma
+000158a0: 5f63 7574 6f66 663d 7365 6c66 2e5f 7369  _cutoff=self._si
+000158b0: 676d 615f 6375 746f 6666 2c0a 2020 2020  gma_cutoff,.    
+000158c0: 2020 2020 2020 2020 2020 2020 6973 5f69              is_i
+000158d0: 736f 746f 7065 3d69 735f 6973 6f74 6f70  sotope=is_isotop
+000158e0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000158f0: 2020 206d 6173 735f 7661 7269 616e 6365     mass_variance
+00015900: 733d 6d61 7373 5f76 6172 6961 6e63 6573  s=mass_variances
+00015910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015920: 2020 6772 6964 5f70 6f69 6e74 733d 6772    grid_points=gr
+00015930: 6964 5f70 6f69 6e74 732c 0a20 2020 2020  id_points,.     
+00015940: 2020 2020 2020 2020 2020 2062 6f75 6e64             bound
+00015950: 6172 795f 6d66 703d 626f 756e 6461 7279  ary_mfp=boundary
+00015960: 5f6d 6670 2c0a 2020 2020 2020 2020 2020  _mfp,.          
+00015970: 2020 2020 2020 736f 6c76 655f 636f 6c6c        solve_coll
+00015980: 6563 7469 7665 5f70 686f 6e6f 6e3d 736f  ective_phonon=so
+00015990: 6c76 655f 636f 6c6c 6563 7469 7665 5f70  lve_collective_p
+000159a0: 686f 6e6f 6e2c 0a20 2020 2020 2020 2020  honon,.         
+000159b0: 2020 2020 2020 2069 735f 7265 6475 6369         is_reduci
+000159c0: 626c 655f 636f 6c6c 6973 696f 6e5f 6d61  ble_collision_ma
+000159d0: 7472 6978 3d69 735f 7265 6475 6369 626c  trix=is_reducibl
+000159e0: 655f 636f 6c6c 6973 696f 6e5f 6d61 7472  e_collision_matr
+000159f0: 6978 2c0a 2020 2020 2020 2020 2020 2020  ix,.            
+00015a00: 2020 2020 6973 5f6b 6170 7061 5f73 7461      is_kappa_sta
+00015a10: 723d 6973 5f6b 6170 7061 5f73 7461 722c  r=is_kappa_star,
+00015a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015a30: 2067 765f 6465 6c74 615f 713d 6776 5f64   gv_delta_q=gv_d
+00015a40: 656c 7461 5f71 2c0a 2020 2020 2020 2020  elta_q,.        
+00015a50: 2020 2020 2020 2020 6973 5f66 756c 6c5f          is_full_
+00015a60: 7070 3d69 735f 6675 6c6c 5f70 702c 0a20  pp=is_full_pp,. 
+00015a70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00015a80: 6f6e 6475 6374 6976 6974 795f 7479 7065  onductivity_type
+00015a90: 3d63 6f6e 6475 6374 6976 6974 795f 7479  =conductivity_ty
+00015aa0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00015ab0: 2020 2020 7069 6e76 5f63 7574 6f66 663d      pinv_cutoff=
+00015ac0: 7069 6e76 5f63 7574 6f66 662c 0a20 2020  pinv_cutoff,.   
+00015ad0: 2020 2020 2020 2020 2020 2020 2070 696e               pin
+00015ae0: 765f 736f 6c76 6572 3d70 696e 765f 736f  v_solver=pinv_so
+00015af0: 6c76 6572 2c0a 2020 2020 2020 2020 2020  lver,.          
+00015b00: 2020 2020 2020 7069 6e76 5f6d 6574 686f        pinv_metho
+00015b10: 643d 7069 6e76 5f6d 6574 686f 642c 0a20  d=pinv_method,. 
+00015b20: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00015b30: 7269 7465 5f63 6f6c 6c69 7369 6f6e 3d77  rite_collision=w
+00015b40: 7269 7465 5f63 6f6c 6c69 7369 6f6e 2c0a  rite_collision,.
 00015b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b60: 7465 6d70 6572 6174 7572 6573 3d5f 7465  temperatures=_te
-00015b70: 6d70 6572 6174 7572 6573 2c0a 2020 2020  mperatures,.    
-00015b80: 2020 2020 2020 2020 2020 2020 7369 676d              sigm
-00015b90: 6173 3d73 656c 662e 5f73 6967 6d61 732c  as=self._sigmas,
-00015ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015bb0: 2073 6967 6d61 5f63 7574 6f66 663d 7365   sigma_cutoff=se
-00015bc0: 6c66 2e5f 7369 676d 615f 6375 746f 6666  lf._sigma_cutoff
-00015bd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015be0: 2020 6973 5f69 736f 746f 7065 3d69 735f    is_isotope=is_
-00015bf0: 6973 6f74 6f70 652c 0a20 2020 2020 2020  isotope,.       
-00015c00: 2020 2020 2020 2020 206d 6173 735f 7661           mass_va
-00015c10: 7269 616e 6365 733d 6d61 7373 5f76 6172  riances=mass_var
-00015c20: 6961 6e63 6573 2c0a 2020 2020 2020 2020  iances,.        
-00015c30: 2020 2020 2020 2020 6772 6964 5f70 6f69          grid_poi
-00015c40: 6e74 733d 6772 6964 5f70 6f69 6e74 732c  nts=grid_points,
-00015c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015c60: 2062 6f75 6e64 6172 795f 6d66 703d 626f   boundary_mfp=bo
-00015c70: 756e 6461 7279 5f6d 6670 2c0a 2020 2020  undary_mfp,.    
-00015c80: 2020 2020 2020 2020 2020 2020 7573 655f              use_
-00015c90: 6176 655f 7070 3d75 7365 5f61 7665 5f70  ave_pp=use_ave_p
-00015ca0: 702c 0a20 2020 2020 2020 2020 2020 2020  p,.             
-00015cb0: 2020 2069 735f 6b61 7070 615f 7374 6172     is_kappa_star
-00015cc0: 3d69 735f 6b61 7070 615f 7374 6172 2c0a  =is_kappa_star,.
-00015cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ce0: 6776 5f64 656c 7461 5f71 3d67 765f 6465  gv_delta_q=gv_de
-00015cf0: 6c74 615f 712c 0a20 2020 2020 2020 2020  lta_q,.         
-00015d00: 2020 2020 2020 2069 735f 6675 6c6c 5f70         is_full_p
-00015d10: 703d 6973 5f66 756c 6c5f 7070 2c0a 2020  p=is_full_pp,.  
-00015d20: 2020 2020 2020 2020 2020 2020 2020 6973                is
-00015d30: 5f4e 5f55 3d69 735f 4e5f 552c 0a20 2020  _N_U=is_N_U,.   
-00015d40: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00015d50: 6475 6374 6976 6974 795f 7479 7065 3d63  ductivity_type=c
-00015d60: 6f6e 6475 6374 6976 6974 795f 7479 7065  onductivity_type
-00015d70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015d80: 2020 7772 6974 655f 6761 6d6d 613d 7772    write_gamma=wr
-00015d90: 6974 655f 6761 6d6d 612c 0a20 2020 2020  ite_gamma,.     
-00015da0: 2020 2020 2020 2020 2020 2072 6561 645f             read_
-00015db0: 6761 6d6d 613d 7265 6164 5f67 616d 6d61  gamma=read_gamma
-00015dc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015dd0: 2020 7772 6974 655f 6b61 7070 613d 7772    write_kappa=wr
-00015de0: 6974 655f 6b61 7070 612c 0a20 2020 2020  ite_kappa,.     
-00015df0: 2020 2020 2020 2020 2020 2077 7269 7465             write
-00015e00: 5f70 703d 7772 6974 655f 7070 2c0a 2020  _pp=write_pp,.  
-00015e10: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00015e20: 6164 5f70 703d 7265 6164 5f70 702c 0a20  ad_pp=read_pp,. 
-00015e30: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00015e40: 7269 7465 5f67 616d 6d61 5f64 6574 6169  rite_gamma_detai
-00015e50: 6c3d 7772 6974 655f 6761 6d6d 615f 6465  l=write_gamma_de
-00015e60: 7461 696c 2c0a 2020 2020 2020 2020 2020  tail,.          
-00015e70: 2020 2020 2020 636f 6d70 7265 7373 696f        compressio
-00015e80: 6e3d 636f 6d70 7265 7373 696f 6e2c 0a20  n=compression,. 
-00015e90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00015ea0: 6e70 7574 5f66 696c 656e 616d 653d 696e  nput_filename=in
-00015eb0: 7075 745f 6669 6c65 6e61 6d65 2c0a 2020  put_filename,.  
-00015ec0: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00015ed0: 7470 7574 5f66 696c 656e 616d 653d 6f75  tput_filename=ou
-00015ee0: 7470 7574 5f66 696c 656e 616d 652c 0a20  tput_filename,. 
-00015ef0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00015f00: 6f67 5f6c 6576 656c 3d73 656c 662e 5f6c  og_level=self._l
-00015f10: 6f67 5f6c 6576 656c 2c0a 2020 2020 2020  og_level,.      
-00015f20: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00015f30: 2073 6176 6528 7365 6c66 2c20 6669 6c65   save(self, file
-00015f40: 6e61 6d65 3d22 7068 6f6e 6f33 7079 5f70  name="phono3py_p
-00015f50: 6172 616d 732e 7961 6d6c 222c 2073 6574  arams.yaml", set
-00015f60: 7469 6e67 733d 4e6f 6e65 293a 0a20 2020  tings=None):.   
-00015f70: 2020 2020 2022 2222 5361 7665 2070 6172       """Save par
-00015f80: 616d 6574 6572 7320 696e 2050 686f 6e6f  ameters in Phono
-00015f90: 3370 7920 696e 7374 616e 7473 2069 6e74  3py instants int
-00015fa0: 6f20 6669 6c65 2e0a 0a20 2020 2020 2020  o file...       
-00015fb0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00015fc0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00015fd0: 2020 2020 2020 2066 696c 656e 616d 653a         filename:
-00015fe0: 2073 7472 2c20 6f70 7469 6f6e 616c 0a20   str, optional. 
-00015ff0: 2020 2020 2020 2020 2020 2046 696c 6520             File 
-00016000: 6e61 6d65 2e20 4465 6661 756c 7420 6973  name. Default is
-00016010: 2022 7068 6f6e 6f33 7079 5f70 6172 616d   "phono3py_param
-00016020: 732e 7961 6d6c 220a 2020 2020 2020 2020  s.yaml".        
-00016030: 7365 7474 696e 6773 3a20 6469 6374 2c20  settings: dict, 
-00016040: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00016050: 2020 2020 2049 7420 6973 2064 6573 6372       It is descr
-00016060: 6962 6564 2077 6869 6368 2070 6172 616d  ibed which param
-00016070: 6574 6572 7320 6172 6520 7772 6974 7465  eters are writte
-00016080: 6e20 6f75 742e 204f 6e6c 790a 2020 2020  n out. Only.    
-00016090: 2020 2020 2020 2020 7468 6520 7365 7474          the sett
-000160a0: 696e 6773 2065 7870 6563 7465 6420 746f  ings expected to
-000160b0: 2062 6520 7570 6461 7465 6420 6672 6f6d   be updated from
-000160c0: 2074 6865 2066 6f6c 6c6f 7769 6e67 0a20   the following. 
-000160d0: 2020 2020 2020 2020 2020 2064 6566 6175             defau
-000160e0: 6c74 2073 6574 7469 6e67 7320 6172 6520  lt settings are 
-000160f0: 6e65 6564 6564 2074 6f20 6265 2073 6574  needed to be set
-00016100: 2069 6e20 7468 6520 6469 6374 696f 6e61   in the dictiona
-00016110: 7279 2e0a 2020 2020 2020 2020 2020 2020  ry..            
-00016120: 5468 6520 706f 7373 6962 6c65 2070 6172  The possible par
-00016130: 616d 6574 6572 7320 616e 6420 7468 6569  ameters and thei
-00016140: 7220 6465 6661 756c 7420 7365 7474 696e  r default settin
-00016150: 6773 2061 7265 3a0a 2020 2020 2020 2020  gs are:.        
-00016160: 2020 2020 2020 2020 7b27 666f 7263 655f          {'force_
-00016170: 7365 7473 273a 2046 616c 7365 2c0a 2020  sets': False,.  
-00016180: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00016190: 6469 7370 6c61 6365 6d65 6e74 7327 3a20  displacements': 
-000161a0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-000161b0: 2020 2020 2020 2027 666f 7263 655f 636f         'force_co
-000161c0: 6e73 7461 6e74 7327 3a20 4661 6c73 652c  nstants': False,
-000161d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000161e0: 2020 2762 6f72 6e5f 6566 6665 6374 6976    'born_effectiv
-000161f0: 655f 6368 6172 6765 273a 2054 7275 652c  e_charge': True,
-00016200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016210: 2020 2764 6965 6c65 6374 7269 635f 636f    'dielectric_co
-00016220: 6e73 7461 6e74 273a 2054 7275 657d 0a0a  nstant': True}..
-00016230: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016240: 2020 2020 7068 3370 795f 7961 6d6c 203d      ph3py_yaml =
-00016250: 2050 686f 6e6f 3370 7959 616d 6c28 7365   Phono3pyYaml(se
-00016260: 7474 696e 6773 3d73 6574 7469 6e67 7329  ttings=settings)
-00016270: 0a20 2020 2020 2020 2070 6833 7079 5f79  .        ph3py_y
-00016280: 616d 6c2e 7365 745f 7068 6f6e 6f6e 5f69  aml.set_phonon_i
-00016290: 6e66 6f28 7365 6c66 290a 2020 2020 2020  nfo(self).      
-000162a0: 2020 7769 7468 206f 7065 6e28 6669 6c65    with open(file
-000162b0: 6e61 6d65 2c20 2277 2229 2061 7320 773a  name, "w") as w:
-000162c0: 0a20 2020 2020 2020 2020 2020 2077 2e77  .            w.w
-000162d0: 7269 7465 2873 7472 2870 6833 7079 5f79  rite(str(ph3py_y
-000162e0: 616d 6c29 290a 0a20 2020 2023 2323 2323  aml))..    #####
-000162f0: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
-00016300: 2020 2023 2070 7269 7661 7465 206d 6574     # private met
-00016310: 686f 6473 2023 0a20 2020 2023 2323 2323  hods #.    #####
-00016320: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
-00016330: 2020 2064 6566 205f 7365 6172 6368 5f73     def _search_s
-00016340: 796d 6d65 7472 7928 7365 6c66 293a 0a20  ymmetry(self):. 
-00016350: 2020 2020 2020 2073 656c 662e 5f73 796d         self._sym
-00016360: 6d65 7472 7920 3d20 5379 6d6d 6574 7279  metry = Symmetry
-00016370: 2873 656c 662e 5f73 7570 6572 6365 6c6c  (self._supercell
-00016380: 2c20 7365 6c66 2e5f 7379 6d70 7265 632c  , self._symprec,
-00016390: 2073 656c 662e 5f69 735f 7379 6d6d 6574   self._is_symmet
-000163a0: 7279 290a 0a20 2020 2064 6566 205f 7365  ry)..    def _se
-000163b0: 6172 6368 5f70 7269 6d69 7469 7665 5f73  arch_primitive_s
-000163c0: 796d 6d65 7472 7928 7365 6c66 293a 0a20  ymmetry(self):. 
-000163d0: 2020 2020 2020 2073 656c 662e 5f70 7269         self._pri
-000163e0: 6d69 7469 7665 5f73 796d 6d65 7472 7920  mitive_symmetry 
-000163f0: 3d20 5379 6d6d 6574 7279 280a 2020 2020  = Symmetry(.    
-00016400: 2020 2020 2020 2020 7365 6c66 2e5f 7072          self._pr
-00016410: 696d 6974 6976 652c 2073 656c 662e 5f73  imitive, self._s
-00016420: 796d 7072 6563 2c20 7365 6c66 2e5f 6973  ymprec, self._is
-00016430: 5f73 796d 6d65 7472 790a 2020 2020 2020  _symmetry.      
-00016440: 2020 290a 2020 2020 2020 2020 6966 206c    ).        if l
-00016450: 656e 2873 656c 662e 5f73 796d 6d65 7472  en(self._symmetr
-00016460: 792e 706f 696e 7467 726f 7570 5f6f 7065  y.pointgroup_ope
-00016470: 7261 7469 6f6e 7329 2021 3d20 6c65 6e28  rations) != len(
-00016480: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00016490: 662e 5f70 7269 6d69 7469 7665 5f73 796d  f._primitive_sym
-000164a0: 6d65 7472 792e 706f 696e 7467 726f 7570  metry.pointgroup
-000164b0: 5f6f 7065 7261 7469 6f6e 730a 2020 2020  _operations.    
-000164c0: 2020 2020 293a 2020 2320 6e6f 7161 2045      ):  # noqa E
-000164d0: 3132 390a 2020 2020 2020 2020 2020 2020  129.            
-000164e0: 7072 696e 7428 0a20 2020 2020 2020 2020  print(.         
-000164f0: 2020 2020 2020 2022 5761 726e 696e 673a         "Warning:
-00016500: 2070 6f69 6e74 2067 726f 7570 2073 796d   point group sym
-00016510: 6d65 7472 6965 7320 6f66 2073 7570 6572  metries of super
-00016520: 6365 6c6c 2061 6e64 2070 7269 6d69 7469  cell and primiti
-00016530: 7665 220a 2020 2020 2020 2020 2020 2020  ve".            
-00016540: 2020 2020 2263 656c 6c20 6172 6520 6469      "cell are di
-00016550: 6666 6572 656e 742e 220a 2020 2020 2020  fferent.".      
-00016560: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00016570: 205f 7365 6172 6368 5f70 686f 6e6f 6e5f   _search_phonon_
-00016580: 7375 7065 7263 656c 6c5f 7379 6d6d 6574  supercell_symmet
-00016590: 7279 2873 656c 6629 3a0a 2020 2020 2020  ry(self):.      
-000165a0: 2020 6966 2073 656c 662e 5f70 686f 6e6f    if self._phono
-000165b0: 6e5f 7375 7065 7263 656c 6c5f 6d61 7472  n_supercell_matr
-000165c0: 6978 2069 7320 4e6f 6e65 3a0a 2020 2020  ix is None:.    
-000165d0: 2020 2020 2020 2020 7365 6c66 2e5f 7068          self._ph
-000165e0: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f73  onon_supercell_s
-000165f0: 796d 6d65 7472 7920 3d20 7365 6c66 2e5f  ymmetry = self._
-00016600: 7379 6d6d 6574 7279 0a20 2020 2020 2020  symmetry.       
-00016610: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00016620: 2020 2073 656c 662e 5f70 686f 6e6f 6e5f     self._phonon_
-00016630: 7375 7065 7263 656c 6c5f 7379 6d6d 6574  supercell_symmet
-00016640: 7279 203d 2053 796d 6d65 7472 7928 0a20  ry = Symmetry(. 
-00016650: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00016660: 656c 662e 5f70 686f 6e6f 6e5f 7375 7065  elf._phonon_supe
-00016670: 7263 656c 6c2c 2073 656c 662e 5f73 796d  rcell, self._sym
-00016680: 7072 6563 2c20 7365 6c66 2e5f 6973 5f73  prec, self._is_s
-00016690: 796d 6d65 7472 790a 2020 2020 2020 2020  ymmetry.        
-000166a0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-000166b0: 6275 696c 645f 7375 7065 7263 656c 6c28  build_supercell(
-000166c0: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
-000166d0: 656c 662e 5f73 7570 6572 6365 6c6c 203d  elf._supercell =
-000166e0: 2067 6574 5f73 7570 6572 6365 6c6c 280a   get_supercell(.
-000166f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00016700: 2e5f 756e 6974 6365 6c6c 2c20 7365 6c66  ._unitcell, self
-00016710: 2e5f 7375 7065 7263 656c 6c5f 6d61 7472  ._supercell_matr
-00016720: 6978 2c20 7365 6c66 2e5f 7379 6d70 7265  ix, self._sympre
-00016730: 630a 2020 2020 2020 2020 290a 0a20 2020  c.        )..   
-00016740: 2064 6566 205f 6275 696c 645f 7072 696d   def _build_prim
-00016750: 6974 6976 655f 6365 6c6c 2873 656c 6629  itive_cell(self)
-00016760: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
-00016770: 6174 6520 7072 696d 6974 6976 6520 6365  ate primitive ce
-00016780: 6c6c 2e0a 0a20 2020 2020 2020 2070 7269  ll...        pri
-00016790: 6d69 7469 7665 5f6d 6174 7269 783a 0a20  mitive_matrix:. 
-000167a0: 2020 2020 2020 2020 2052 656c 6174 6976           Relativ
-000167b0: 6520 6178 6573 206f 6620 7072 696d 6974  e axes of primit
-000167c0: 6976 6520 6365 6c6c 2074 6f20 7468 6520  ive cell to the 
-000167d0: 696e 7075 7420 756e 6974 2063 656c 6c2e  input unit cell.
-000167e0: 0a20 2020 2020 2020 2020 2052 656c 6174  .          Relat
-000167f0: 6976 6520 6178 6573 2074 6f20 7468 6520  ive axes to the 
-00016800: 7375 7065 7263 656c 6c20 6973 2063 616c  supercell is cal
-00016810: 6375 6c61 7465 6420 6279 3a0a 2020 2020  culated by:.    
-00016820: 2020 2020 2020 2020 2073 7570 6572 6365           superce
-00016830: 6c6c 5f6d 6174 7269 785e 2d31 202a 2070  ll_matrix^-1 * p
-00016840: 7269 6d69 7469 7665 5f6d 6174 7269 780a  rimitive_matrix.
-00016850: 2020 2020 2020 2020 2020 5468 6572 6566            Theref
-00016860: 6f72 6520 7072 696d 6974 6976 6520 6365  ore primitive ce
-00016870: 6c6c 206c 6174 7469 6365 2069 7320 6669  ll lattice is fi
-00016880: 6e61 6c6c 7920 6361 6c63 756c 6174 6564  nally calculated
-00016890: 2062 793a 0a20 2020 2020 2020 2020 2020   by:.           
-000168a0: 2020 2873 7570 6572 6365 6c6c 5f6c 6174    (supercell_lat
-000168b0: 7469 6365 202a 2028 7375 7065 7263 656c  tice * (supercel
-000168c0: 6c5f 6d61 7472 6978 295e 2d31 202a 2070  l_matrix)^-1 * p
-000168d0: 7269 6d69 7469 7665 5f6d 6174 7269 7829  rimitive_matrix)
-000168e0: 5e54 0a0a 2020 2020 2020 2020 2222 220a  ^T..        """.
-000168f0: 2020 2020 2020 2020 7365 6c66 2e5f 7072          self._pr
-00016900: 696d 6974 6976 6520 3d20 7365 6c66 2e5f  imitive = self._
-00016910: 6765 745f 7072 696d 6974 6976 655f 6365  get_primitive_ce
-00016920: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-00016930: 7365 6c66 2e5f 7375 7065 7263 656c 6c2c  self._supercell,
-00016940: 2073 656c 662e 5f73 7570 6572 6365 6c6c   self._supercell
-00016950: 5f6d 6174 7269 782c 2073 656c 662e 5f70  _matrix, self._p
-00016960: 7269 6d69 7469 7665 5f6d 6174 7269 780a  rimitive_matrix.
-00016970: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00016980: 6566 205f 6275 696c 645f 7068 6f6e 6f6e  ef _build_phonon
-00016990: 5f73 7570 6572 6365 6c6c 2873 656c 6629  _supercell(self)
-000169a0: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
-000169b0: 6174 6520 7068 6f6e 6f6e 2073 7570 6572  ate phonon super
-000169c0: 6365 6c6c 2066 6f72 2066 6332 2e0a 0a20  cell for fc2... 
-000169d0: 2020 2020 2020 2070 686f 6e6f 6e5f 7375         phonon_su
-000169e0: 7065 7263 656c 6c3a 0a20 2020 2020 2020  percell:.       
-000169f0: 2020 2054 6869 7320 7375 7065 7263 656c     This supercel
-00016a00: 6c20 6973 2075 7365 6420 666f 7220 6861  l is used for ha
-00016a10: 726d 6f6e 6963 2070 686f 6e6f 6e73 2028  rmonic phonons (
-00016a20: 6672 6571 7565 6e63 6965 732c 0a20 2020  frequencies,.   
-00016a30: 2020 2020 2020 2065 6967 656e 7665 6374         eigenvect
-00016a40: 6f72 732c 2067 726f 7570 2076 656c 6f63  ors, group veloc
-00016a50: 6974 6965 732c 202e 2e2e 290a 2020 2020  ities, ...).    
-00016a60: 2020 2020 7068 6f6e 6f6e 5f73 7570 6572      phonon_super
-00016a70: 6365 6c6c 5f6d 6174 7269 783a 0a20 2020  cell_matrix:.   
-00016a80: 2020 2020 2020 2044 6966 6665 7265 6e74         Different
-00016a90: 2073 7570 6572 6365 6c6c 2073 697a 6520   supercell size 
-00016aa0: 6361 6e20 6265 2073 7065 6369 6669 6564  can be specified
-00016ab0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00016ac0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00016ad0: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
-00016ae0: 5f6d 6174 7269 7820 6973 204e 6f6e 653a  _matrix is None:
-00016af0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00016b00: 662e 5f70 686f 6e6f 6e5f 7375 7065 7263  f._phonon_superc
-00016b10: 656c 6c20 3d20 7365 6c66 2e5f 7375 7065  ell = self._supe
-00016b20: 7263 656c 6c0a 2020 2020 2020 2020 656c  rcell.        el
-00016b30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00016b40: 7365 6c66 2e5f 7068 6f6e 6f6e 5f73 7570  self._phonon_sup
-00016b50: 6572 6365 6c6c 203d 2067 6574 5f73 7570  ercell = get_sup
-00016b60: 6572 6365 6c6c 280a 2020 2020 2020 2020  ercell(.        
-00016b70: 2020 2020 2020 2020 7365 6c66 2e5f 756e          self._un
-00016b80: 6974 6365 6c6c 2c20 7365 6c66 2e5f 7068  itcell, self._ph
-00016b90: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
-00016ba0: 6174 7269 782c 2073 656c 662e 5f73 796d  atrix, self._sym
-00016bb0: 7072 6563 0a20 2020 2020 2020 2020 2020  prec.           
-00016bc0: 2029 0a0a 2020 2020 6465 6620 5f62 7569   )..    def _bui
-00016bd0: 6c64 5f70 686f 6e6f 6e5f 7072 696d 6974  ld_phonon_primit
-00016be0: 6976 655f 6365 6c6c 2873 656c 6629 3a0a  ive_cell(self):.
-00016bf0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00016c00: 5f70 686f 6e6f 6e5f 7375 7065 7263 656c  _phonon_supercel
-00016c10: 6c5f 6d61 7472 6978 2069 7320 4e6f 6e65  l_matrix is None
-00016c20: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00016c30: 6c66 2e5f 7068 6f6e 6f6e 5f70 7269 6d69  lf._phonon_primi
-00016c40: 7469 7665 203d 2073 656c 662e 5f70 7269  tive = self._pri
-00016c50: 6d69 7469 7665 0a20 2020 2020 2020 2065  mitive.        e
-00016c60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00016c70: 2073 656c 662e 5f70 686f 6e6f 6e5f 7072   self._phonon_pr
-00016c80: 696d 6974 6976 6520 3d20 7365 6c66 2e5f  imitive = self._
-00016c90: 6765 745f 7072 696d 6974 6976 655f 6365  get_primitive_ce
-00016ca0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-00016cb0: 2020 2020 7365 6c66 2e5f 7068 6f6e 6f6e      self._phonon
-00016cc0: 5f73 7570 6572 6365 6c6c 2c0a 2020 2020  _supercell,.    
-00016cd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00016ce0: 2e5f 7068 6f6e 6f6e 5f73 7570 6572 6365  ._phonon_superce
-00016cf0: 6c6c 5f6d 6174 7269 782c 0a20 2020 2020  ll_matrix,.     
-00016d00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00016d10: 5f70 7269 6d69 7469 7665 5f6d 6174 7269  _primitive_matri
-00016d20: 782c 0a20 2020 2020 2020 2020 2020 2029  x,.            )
-00016d30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00016d40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00016d50: 2020 7365 6c66 2e5f 7072 696d 6974 6976    self._primitiv
-00016d60: 6520 6973 206e 6f74 204e 6f6e 650a 2020  e is not None.  
-00016d70: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00016d80: 6420 2873 656c 662e 5f70 7269 6d69 7469  d (self._primiti
-00016d90: 7665 2e6e 756d 6265 7273 2021 3d20 7365  ve.numbers != se
-00016da0: 6c66 2e5f 7068 6f6e 6f6e 5f70 7269 6d69  lf._phonon_primi
-00016db0: 7469 7665 2e6e 756d 6265 7273 292e 616e  tive.numbers).an
-00016dc0: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
-00016dd0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00016de0: 2020 2070 7269 6e74 2822 2050 7269 6d69     print(" Primi
-00016df0: 7469 7665 2063 656c 6c73 2066 6f72 2066  tive cells for f
-00016e00: 6332 2061 6e64 2066 6333 2063 616e 2062  c2 and fc3 can b
-00016e10: 6520 6469 6666 6572 656e 742e 2229 0a20  e different."). 
-00016e20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00016e30: 6169 7365 2052 756e 7469 6d65 4572 726f  aise RuntimeErro
-00016e40: 720a 0a20 2020 2064 6566 205f 6275 696c  r..    def _buil
-00016e50: 645f 7068 6f6e 6f6e 5f73 7570 6572 6365  d_phonon_superce
-00016e60: 6c6c 735f 7769 7468 5f64 6973 706c 6163  lls_with_displac
-00016e70: 656d 656e 7473 280a 2020 2020 2020 2020  ements(.        
-00016e80: 7365 6c66 2c20 7375 7065 7263 656c 6c3a  self, supercell:
-00016e90: 2050 686f 6e6f 7079 4174 6f6d 732c 2064   PhonopyAtoms, d
-00016ea0: 6973 706c 6163 656d 656e 745f 6461 7461  isplacement_data
-00016eb0: 7365 740a 2020 2020 293a 0a20 2020 2020  set.    ):.     
-00016ec0: 2020 2073 7570 6572 6365 6c6c 7320 3d20     supercells = 
-00016ed0: 5b5d 0a20 2020 2020 2020 206d 6167 6d6f  [].        magmo
-00016ee0: 6d73 203d 2073 7570 6572 6365 6c6c 2e6d  ms = supercell.m
-00016ef0: 6167 6e65 7469 635f 6d6f 6d65 6e74 730a  agnetic_moments.
-00016f00: 2020 2020 2020 2020 6d61 7373 6573 203d          masses =
-00016f10: 2073 7570 6572 6365 6c6c 2e6d 6173 7365   supercell.masse
-00016f20: 730a 2020 2020 2020 2020 6e75 6d62 6572  s.        number
-00016f30: 7320 3d20 7375 7065 7263 656c 6c2e 6e75  s = supercell.nu
-00016f40: 6d62 6572 730a 2020 2020 2020 2020 6c61  mbers.        la
-00016f50: 7474 6963 6520 3d20 7375 7065 7263 656c  ttice = supercel
-00016f60: 6c2e 6365 6c6c 0a0a 2020 2020 2020 2020  l.cell..        
-00016f70: 666f 7220 6469 7370 3120 696e 2064 6973  for disp1 in dis
-00016f80: 706c 6163 656d 656e 745f 6461 7461 7365  placement_datase
-00016f90: 745b 2266 6972 7374 5f61 746f 6d73 225d  t["first_atoms"]
-00016fa0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00016fb0: 7370 5f63 6172 7431 203d 2064 6973 7031  sp_cart1 = disp1
-00016fc0: 5b22 6469 7370 6c61 6365 6d65 6e74 225d  ["displacement"]
-00016fd0: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
-00016fe0: 6974 696f 6e73 203d 2073 7570 6572 6365  itions = superce
-00016ff0: 6c6c 2e70 6f73 6974 696f 6e73 0a20 2020  ll.positions.   
-00017000: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
-00017010: 6e73 5b64 6973 7031 5b22 6e75 6d62 6572  ns[disp1["number
-00017020: 225d 5d20 2b3d 2064 6973 705f 6361 7274  "]] += disp_cart
-00017030: 310a 2020 2020 2020 2020 2020 2020 7375  1.            su
-00017040: 7065 7263 656c 6c73 2e61 7070 656e 6428  percells.append(
-00017050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017060: 2050 686f 6e6f 7079 4174 6f6d 7328 0a20   PhonopyAtoms(. 
-00017070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017080: 2020 206e 756d 6265 7273 3d6e 756d 6265     numbers=numbe
-00017090: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-000170a0: 2020 2020 2020 2020 6d61 7373 6573 3d6d          masses=m
-000170b0: 6173 7365 732c 0a20 2020 2020 2020 2020  asses,.         
-000170c0: 2020 2020 2020 2020 2020 206d 6167 6e65             magne
-000170d0: 7469 635f 6d6f 6d65 6e74 733d 6d61 676d  tic_moments=magm
-000170e0: 6f6d 732c 0a20 2020 2020 2020 2020 2020  oms,.           
-000170f0: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
-00017100: 6e73 3d70 6f73 6974 696f 6e73 2c0a 2020  ns=positions,.  
-00017110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017120: 2020 6365 6c6c 3d6c 6174 7469 6365 2c0a    cell=lattice,.
-00017130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017140: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00017150: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00017160: 7375 7065 7263 656c 6c73 0a0a 2020 2020  supercells..    
-00017170: 6465 6620 5f62 7569 6c64 5f73 7570 6572  def _build_super
-00017180: 6365 6c6c 735f 7769 7468 5f64 6973 706c  cells_with_displ
-00017190: 6163 656d 656e 7473 2873 656c 6629 3a0a  acements(self):.
-000171a0: 2020 2020 2020 2020 7375 7065 7263 656c          supercel
-000171b0: 6c73 203d 205b 5d0a 2020 2020 2020 2020  ls = [].        
-000171c0: 6d61 676d 6f6d 7320 3d20 7365 6c66 2e5f  magmoms = self._
-000171d0: 7375 7065 7263 656c 6c2e 6d61 676e 6574  supercell.magnet
-000171e0: 6963 5f6d 6f6d 656e 7473 0a20 2020 2020  ic_moments.     
-000171f0: 2020 206d 6173 7365 7320 3d20 7365 6c66     masses = self
-00017200: 2e5f 7375 7065 7263 656c 6c2e 6d61 7373  ._supercell.mass
-00017210: 6573 0a20 2020 2020 2020 206e 756d 6265  es.        numbe
-00017220: 7273 203d 2073 656c 662e 5f73 7570 6572  rs = self._super
-00017230: 6365 6c6c 2e6e 756d 6265 7273 0a20 2020  cell.numbers.   
-00017240: 2020 2020 206c 6174 7469 6365 203d 2073       lattice = s
-00017250: 656c 662e 5f73 7570 6572 6365 6c6c 2e63  elf._supercell.c
-00017260: 656c 6c0a 0a20 2020 2020 2020 2073 7570  ell..        sup
-00017270: 6572 6365 6c6c 7320 3d20 7365 6c66 2e5f  ercells = self._
-00017280: 6275 696c 645f 7068 6f6e 6f6e 5f73 7570  build_phonon_sup
-00017290: 6572 6365 6c6c 735f 7769 7468 5f64 6973  ercells_with_dis
-000172a0: 706c 6163 656d 656e 7473 280a 2020 2020  placements(.    
-000172b0: 2020 2020 2020 2020 7365 6c66 2e5f 7375          self._su
-000172c0: 7065 7263 656c 6c2c 2073 656c 662e 5f64  percell, self._d
-000172d0: 6174 6173 6574 0a20 2020 2020 2020 2029  ataset.        )
-000172e0: 0a0a 2020 2020 2020 2020 666f 7220 6469  ..        for di
-000172f0: 7370 3120 696e 2073 656c 662e 5f64 6174  sp1 in self._dat
-00017300: 6173 6574 5b22 6669 7273 745f 6174 6f6d  aset["first_atom
-00017310: 7322 5d3a 0a20 2020 2020 2020 2020 2020  s"]:.           
-00017320: 2064 6973 705f 6361 7274 3120 3d20 6469   disp_cart1 = di
-00017330: 7370 315b 2264 6973 706c 6163 656d 656e  sp1["displacemen
-00017340: 7422 5d0a 2020 2020 2020 2020 2020 2020  t"].            
-00017350: 666f 7220 6469 7370 3220 696e 2064 6973  for disp2 in dis
-00017360: 7031 5b22 7365 636f 6e64 5f61 746f 6d73  p1["second_atoms
-00017370: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
-00017380: 2020 2020 6966 2022 696e 636c 7564 6564      if "included
-00017390: 2220 696e 2064 6973 7032 3a0a 2020 2020  " in disp2:.    
+00015b60: 7265 6164 5f63 6f6c 6c69 7369 6f6e 3d72  read_collision=r
+00015b70: 6561 645f 636f 6c6c 6973 696f 6e2c 0a20  ead_collision,. 
+00015b80: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00015b90: 7269 7465 5f6b 6170 7061 3d77 7269 7465  rite_kappa=write
+00015ba0: 5f6b 6170 7061 2c0a 2020 2020 2020 2020  _kappa,.        
+00015bb0: 2020 2020 2020 2020 7772 6974 655f 7070          write_pp
+00015bc0: 3d77 7269 7465 5f70 702c 0a20 2020 2020  =write_pp,.     
+00015bd0: 2020 2020 2020 2020 2020 2072 6561 645f             read_
+00015be0: 7070 3d72 6561 645f 7070 2c0a 2020 2020  pp=read_pp,.    
+00015bf0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
+00015c00: 655f 4c42 5445 5f73 6f6c 7574 696f 6e3d  e_LBTE_solution=
+00015c10: 7772 6974 655f 4c42 5445 5f73 6f6c 7574  write_LBTE_solut
+00015c20: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00015c30: 2020 2020 2063 6f6d 7072 6573 7369 6f6e       compression
+00015c40: 3d63 6f6d 7072 6573 7369 6f6e 2c0a 2020  =compression,.  
+00015c50: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00015c60: 7075 745f 6669 6c65 6e61 6d65 3d69 6e70  put_filename=inp
+00015c70: 7574 5f66 696c 656e 616d 652c 0a20 2020  ut_filename,.   
+00015c80: 2020 2020 2020 2020 2020 2020 206f 7574               out
+00015c90: 7075 745f 6669 6c65 6e61 6d65 3d6f 7574  put_filename=out
+00015ca0: 7075 745f 6669 6c65 6e61 6d65 2c0a 2020  put_filename,.  
+00015cb0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00015cc0: 675f 6c65 7665 6c3d 7365 6c66 2e5f 6c6f  g_level=self._lo
+00015cd0: 675f 6c65 7665 6c2c 0a20 2020 2020 2020  g_level,.       
+00015ce0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00015cf0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00015d00: 2069 6620 7465 6d70 6572 6174 7572 6573   if temperatures
+00015d10: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00015d20: 2020 2020 2020 2020 2020 5f74 656d 7065            _tempe
+00015d30: 7261 7475 7265 7320 3d20 6e70 2e61 7261  ratures = np.ara
+00015d40: 6e67 6528 302c 2031 3030 312c 2031 302c  nge(0, 1001, 10,
+00015d50: 2064 7479 7065 3d22 646f 7562 6c65 2229   dtype="double")
+00015d60: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00015d70: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00015d80: 2020 205f 7465 6d70 6572 6174 7572 6573     _temperatures
+00015d90: 203d 2074 656d 7065 7261 7475 7265 730a   = temperatures.
+00015da0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00015db0: 2e5f 7468 6572 6d61 6c5f 636f 6e64 7563  ._thermal_conduc
+00015dc0: 7469 7669 7479 203d 2067 6574 5f74 6865  tivity = get_the
+00015dd0: 726d 616c 5f63 6f6e 6475 6374 6976 6974  rmal_conductivit
+00015de0: 795f 5254 4128 0a20 2020 2020 2020 2020  y_RTA(.         
+00015df0: 2020 2020 2020 2073 656c 662e 5f69 6e74         self._int
+00015e00: 6572 6163 7469 6f6e 2c0a 2020 2020 2020  eraction,.      
+00015e10: 2020 2020 2020 2020 2020 7465 6d70 6572            temper
+00015e20: 6174 7572 6573 3d5f 7465 6d70 6572 6174  atures=_temperat
+00015e30: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
+00015e40: 2020 2020 2020 7369 676d 6173 3d73 656c        sigmas=sel
+00015e50: 662e 5f73 6967 6d61 732c 0a20 2020 2020  f._sigmas,.     
+00015e60: 2020 2020 2020 2020 2020 2073 6967 6d61             sigma
+00015e70: 5f63 7574 6f66 663d 7365 6c66 2e5f 7369  _cutoff=self._si
+00015e80: 676d 615f 6375 746f 6666 2c0a 2020 2020  gma_cutoff,.    
+00015e90: 2020 2020 2020 2020 2020 2020 6973 5f69              is_i
+00015ea0: 736f 746f 7065 3d69 735f 6973 6f74 6f70  sotope=is_isotop
+00015eb0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00015ec0: 2020 206d 6173 735f 7661 7269 616e 6365     mass_variance
+00015ed0: 733d 6d61 7373 5f76 6172 6961 6e63 6573  s=mass_variances
+00015ee0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015ef0: 2020 6772 6964 5f70 6f69 6e74 733d 6772    grid_points=gr
+00015f00: 6964 5f70 6f69 6e74 732c 0a20 2020 2020  id_points,.     
+00015f10: 2020 2020 2020 2020 2020 2062 6f75 6e64             bound
+00015f20: 6172 795f 6d66 703d 626f 756e 6461 7279  ary_mfp=boundary
+00015f30: 5f6d 6670 2c0a 2020 2020 2020 2020 2020  _mfp,.          
+00015f40: 2020 2020 2020 7573 655f 6176 655f 7070        use_ave_pp
+00015f50: 3d75 7365 5f61 7665 5f70 702c 0a20 2020  =use_ave_pp,.   
+00015f60: 2020 2020 2020 2020 2020 2020 2069 735f               is_
+00015f70: 6b61 7070 615f 7374 6172 3d69 735f 6b61  kappa_star=is_ka
+00015f80: 7070 615f 7374 6172 2c0a 2020 2020 2020  ppa_star,.      
+00015f90: 2020 2020 2020 2020 2020 6776 5f64 656c            gv_del
+00015fa0: 7461 5f71 3d67 765f 6465 6c74 615f 712c  ta_q=gv_delta_q,
+00015fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015fc0: 2069 735f 6675 6c6c 5f70 703d 6973 5f66   is_full_pp=is_f
+00015fd0: 756c 6c5f 7070 2c0a 2020 2020 2020 2020  ull_pp,.        
+00015fe0: 2020 2020 2020 2020 6973 5f4e 5f55 3d69          is_N_U=i
+00015ff0: 735f 4e5f 552c 0a20 2020 2020 2020 2020  s_N_U,.         
+00016000: 2020 2020 2020 2063 6f6e 6475 6374 6976         conductiv
+00016010: 6974 795f 7479 7065 3d63 6f6e 6475 6374  ity_type=conduct
+00016020: 6976 6974 795f 7479 7065 2c0a 2020 2020  ivity_type,.    
+00016030: 2020 2020 2020 2020 2020 2020 7772 6974              writ
+00016040: 655f 6761 6d6d 613d 7772 6974 655f 6761  e_gamma=write_ga
+00016050: 6d6d 612c 0a20 2020 2020 2020 2020 2020  mma,.           
+00016060: 2020 2020 2072 6561 645f 6761 6d6d 613d       read_gamma=
+00016070: 7265 6164 5f67 616d 6d61 2c0a 2020 2020  read_gamma,.    
+00016080: 2020 2020 2020 2020 2020 2020 7772 6974              writ
+00016090: 655f 6b61 7070 613d 7772 6974 655f 6b61  e_kappa=write_ka
+000160a0: 7070 612c 0a20 2020 2020 2020 2020 2020  ppa,.           
+000160b0: 2020 2020 2077 7269 7465 5f70 703d 7772       write_pp=wr
+000160c0: 6974 655f 7070 2c0a 2020 2020 2020 2020  ite_pp,.        
+000160d0: 2020 2020 2020 2020 7265 6164 5f70 703d          read_pp=
+000160e0: 7265 6164 5f70 702c 0a20 2020 2020 2020  read_pp,.       
+000160f0: 2020 2020 2020 2020 2077 7269 7465 5f67           write_g
+00016100: 616d 6d61 5f64 6574 6169 6c3d 7772 6974  amma_detail=writ
+00016110: 655f 6761 6d6d 615f 6465 7461 696c 2c0a  e_gamma_detail,.
+00016120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016130: 636f 6d70 7265 7373 696f 6e3d 636f 6d70  compression=comp
+00016140: 7265 7373 696f 6e2c 0a20 2020 2020 2020  ression,.       
+00016150: 2020 2020 2020 2020 2069 6e70 7574 5f66           input_f
+00016160: 696c 656e 616d 653d 696e 7075 745f 6669  ilename=input_fi
+00016170: 6c65 6e61 6d65 2c0a 2020 2020 2020 2020  lename,.        
+00016180: 2020 2020 2020 2020 6f75 7470 7574 5f66          output_f
+00016190: 696c 656e 616d 653d 6f75 7470 7574 5f66  ilename=output_f
+000161a0: 696c 656e 616d 652c 0a20 2020 2020 2020  ilename,.       
+000161b0: 2020 2020 2020 2020 206c 6f67 5f6c 6576           log_lev
+000161c0: 656c 3d73 656c 662e 5f6c 6f67 5f6c 6576  el=self._log_lev
+000161d0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+000161e0: 290a 0a20 2020 2064 6566 2073 6176 6528  )..    def save(
+000161f0: 7365 6c66 2c20 6669 6c65 6e61 6d65 3d22  self, filename="
+00016200: 7068 6f6e 6f33 7079 5f70 6172 616d 732e  phono3py_params.
+00016210: 7961 6d6c 222c 2073 6574 7469 6e67 733d  yaml", settings=
+00016220: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+00016230: 2222 5361 7665 2070 6172 616d 6574 6572  ""Save parameter
+00016240: 7320 696e 2050 686f 6e6f 3370 7920 696e  s in Phono3py in
+00016250: 7374 616e 7473 2069 6e74 6f20 6669 6c65  stants into file
+00016260: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00016270: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00016280: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00016290: 2066 696c 656e 616d 653a 2073 7472 2c20   filename: str, 
+000162a0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000162b0: 2020 2020 2046 696c 6520 6e61 6d65 2e20       File name. 
+000162c0: 4465 6661 756c 7420 6973 2022 7068 6f6e  Default is "phon
+000162d0: 6f33 7079 5f70 6172 616d 732e 7961 6d6c  o3py_params.yaml
+000162e0: 220a 2020 2020 2020 2020 7365 7474 696e  ".        settin
+000162f0: 6773 3a20 6469 6374 2c20 6f70 7469 6f6e  gs: dict, option
+00016300: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+00016310: 7420 6973 2064 6573 6372 6962 6564 2077  t is described w
+00016320: 6869 6368 2070 6172 616d 6574 6572 7320  hich parameters 
+00016330: 6172 6520 7772 6974 7465 6e20 6f75 742e  are written out.
+00016340: 204f 6e6c 790a 2020 2020 2020 2020 2020   Only.          
+00016350: 2020 7468 6520 7365 7474 696e 6773 2065    the settings e
+00016360: 7870 6563 7465 6420 746f 2062 6520 7570  xpected to be up
+00016370: 6461 7465 6420 6672 6f6d 2074 6865 2066  dated from the f
+00016380: 6f6c 6c6f 7769 6e67 0a20 2020 2020 2020  ollowing.       
+00016390: 2020 2020 2064 6566 6175 6c74 2073 6574       default set
+000163a0: 7469 6e67 7320 6172 6520 6e65 6564 6564  tings are needed
+000163b0: 2074 6f20 6265 2073 6574 2069 6e20 7468   to be set in th
+000163c0: 6520 6469 6374 696f 6e61 7279 2e0a 2020  e dictionary..  
+000163d0: 2020 2020 2020 2020 2020 5468 6520 706f            The po
+000163e0: 7373 6962 6c65 2070 6172 616d 6574 6572  ssible parameter
+000163f0: 7320 616e 6420 7468 6569 7220 6465 6661  s and their defa
+00016400: 756c 7420 7365 7474 696e 6773 2061 7265  ult settings are
+00016410: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016420: 2020 7b27 666f 7263 655f 7365 7473 273a    {'force_sets':
+00016430: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00016440: 2020 2020 2020 2020 2027 6469 7370 6c61           'displa
+00016450: 6365 6d65 6e74 7327 3a20 5472 7565 2c0a  cements': True,.
+00016460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016470: 2027 666f 7263 655f 636f 6e73 7461 6e74   'force_constant
+00016480: 7327 3a20 4661 6c73 652c 0a20 2020 2020  s': False,.     
+00016490: 2020 2020 2020 2020 2020 2020 2762 6f72              'bor
+000164a0: 6e5f 6566 6665 6374 6976 655f 6368 6172  n_effective_char
+000164b0: 6765 273a 2054 7275 652c 0a20 2020 2020  ge': True,.     
+000164c0: 2020 2020 2020 2020 2020 2020 2764 6965              'die
+000164d0: 6c65 6374 7269 635f 636f 6e73 7461 6e74  lectric_constant
+000164e0: 273a 2054 7275 657d 0a0a 2020 2020 2020  ': True}..      
+000164f0: 2020 2222 220a 2020 2020 2020 2020 7068    """.        ph
+00016500: 3370 795f 7961 6d6c 203d 2050 686f 6e6f  3py_yaml = Phono
+00016510: 3370 7959 616d 6c28 7365 7474 696e 6773  3pyYaml(settings
+00016520: 3d73 6574 7469 6e67 7329 0a20 2020 2020  =settings).     
+00016530: 2020 2070 6833 7079 5f79 616d 6c2e 7365     ph3py_yaml.se
+00016540: 745f 7068 6f6e 6f6e 5f69 6e66 6f28 7365  t_phonon_info(se
+00016550: 6c66 290a 2020 2020 2020 2020 7769 7468  lf).        with
+00016560: 206f 7065 6e28 6669 6c65 6e61 6d65 2c20   open(filename, 
+00016570: 2277 2229 2061 7320 773a 0a20 2020 2020  "w") as w:.     
+00016580: 2020 2020 2020 2077 2e77 7269 7465 2873         w.write(s
+00016590: 7472 2870 6833 7079 5f79 616d 6c29 290a  tr(ph3py_yaml)).
+000165a0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+000165b0: 2323 2323 2323 2323 0a20 2020 2023 2070  ########.    # p
+000165c0: 7269 7661 7465 206d 6574 686f 6473 2023  rivate methods #
+000165d0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+000165e0: 2323 2323 2323 2323 0a20 2020 2064 6566  ########.    def
+000165f0: 205f 7365 6172 6368 5f73 796d 6d65 7472   _search_symmetr
+00016600: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+00016610: 2073 656c 662e 5f73 796d 6d65 7472 7920   self._symmetry 
+00016620: 3d20 5379 6d6d 6574 7279 2873 656c 662e  = Symmetry(self.
+00016630: 5f73 7570 6572 6365 6c6c 2c20 7365 6c66  _supercell, self
+00016640: 2e5f 7379 6d70 7265 632c 2073 656c 662e  ._symprec, self.
+00016650: 5f69 735f 7379 6d6d 6574 7279 290a 0a20  _is_symmetry).. 
+00016660: 2020 2064 6566 205f 7365 6172 6368 5f70     def _search_p
+00016670: 7269 6d69 7469 7665 5f73 796d 6d65 7472  rimitive_symmetr
+00016680: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+00016690: 2073 656c 662e 5f70 7269 6d69 7469 7665   self._primitive
+000166a0: 5f73 796d 6d65 7472 7920 3d20 5379 6d6d  _symmetry = Symm
+000166b0: 6574 7279 280a 2020 2020 2020 2020 2020  etry(.          
+000166c0: 2020 7365 6c66 2e5f 7072 696d 6974 6976    self._primitiv
+000166d0: 652c 2073 656c 662e 5f73 796d 7072 6563  e, self._symprec
+000166e0: 2c20 7365 6c66 2e5f 6973 5f73 796d 6d65  , self._is_symme
+000166f0: 7472 790a 2020 2020 2020 2020 290a 2020  try.        ).  
+00016700: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+00016710: 662e 5f73 796d 6d65 7472 792e 706f 696e  f._symmetry.poin
+00016720: 7467 726f 7570 5f6f 7065 7261 7469 6f6e  tgroup_operation
+00016730: 7329 2021 3d20 6c65 6e28 0a20 2020 2020  s) != len(.     
+00016740: 2020 2020 2020 2073 656c 662e 5f70 7269         self._pri
+00016750: 6d69 7469 7665 5f73 796d 6d65 7472 792e  mitive_symmetry.
+00016760: 706f 696e 7467 726f 7570 5f6f 7065 7261  pointgroup_opera
+00016770: 7469 6f6e 730a 2020 2020 2020 2020 293a  tions.        ):
+00016780: 2020 2320 6e6f 7161 2045 3132 390a 2020    # noqa E129.  
+00016790: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000167a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000167b0: 2022 5761 726e 696e 673a 2070 6f69 6e74   "Warning: point
+000167c0: 2067 726f 7570 2073 796d 6d65 7472 6965   group symmetrie
+000167d0: 7320 6f66 2073 7570 6572 6365 6c6c 2061  s of supercell a
+000167e0: 6e64 2070 7269 6d69 7469 7665 220a 2020  nd primitive".  
+000167f0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00016800: 656c 6c20 6172 6520 6469 6666 6572 656e  ell are differen
+00016810: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
+00016820: 290a 0a20 2020 2064 6566 205f 7365 6172  )..    def _sear
+00016830: 6368 5f70 686f 6e6f 6e5f 7375 7065 7263  ch_phonon_superc
+00016840: 656c 6c5f 7379 6d6d 6574 7279 2873 656c  ell_symmetry(sel
+00016850: 6629 3a0a 2020 2020 2020 2020 6966 2073  f):.        if s
+00016860: 656c 662e 5f70 686f 6e6f 6e5f 7375 7065  elf._phonon_supe
+00016870: 7263 656c 6c5f 6d61 7472 6978 2069 7320  rcell_matrix is 
+00016880: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00016890: 2020 7365 6c66 2e5f 7068 6f6e 6f6e 5f73    self._phonon_s
+000168a0: 7570 6572 6365 6c6c 5f73 796d 6d65 7472  upercell_symmetr
+000168b0: 7920 3d20 7365 6c66 2e5f 7379 6d6d 6574  y = self._symmet
+000168c0: 7279 0a20 2020 2020 2020 2065 6c73 653a  ry.        else:
+000168d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000168e0: 662e 5f70 686f 6e6f 6e5f 7375 7065 7263  f._phonon_superc
+000168f0: 656c 6c5f 7379 6d6d 6574 7279 203d 2053  ell_symmetry = S
+00016900: 796d 6d65 7472 7928 0a20 2020 2020 2020  ymmetry(.       
+00016910: 2020 2020 2020 2020 2073 656c 662e 5f70           self._p
+00016920: 686f 6e6f 6e5f 7375 7065 7263 656c 6c2c  honon_supercell,
+00016930: 2073 656c 662e 5f73 796d 7072 6563 2c20   self._symprec, 
+00016940: 7365 6c66 2e5f 6973 5f73 796d 6d65 7472  self._is_symmetr
+00016950: 790a 2020 2020 2020 2020 2020 2020 290a  y.            ).
+00016960: 0a20 2020 2064 6566 205f 6275 696c 645f  .    def _build_
+00016970: 7375 7065 7263 656c 6c28 7365 6c66 293a  supercell(self):
+00016980: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
+00016990: 7570 6572 6365 6c6c 203d 2067 6574 5f73  upercell = get_s
+000169a0: 7570 6572 6365 6c6c 280a 2020 2020 2020  upercell(.      
+000169b0: 2020 2020 2020 7365 6c66 2e5f 756e 6974        self._unit
+000169c0: 6365 6c6c 2c20 7365 6c66 2e5f 7375 7065  cell, self._supe
+000169d0: 7263 656c 6c5f 6d61 7472 6978 2c20 7365  rcell_matrix, se
+000169e0: 6c66 2e5f 7379 6d70 7265 630a 2020 2020  lf._symprec.    
+000169f0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+00016a00: 6275 696c 645f 7072 696d 6974 6976 655f  build_primitive_
+00016a10: 6365 6c6c 2873 656c 6629 3a0a 2020 2020  cell(self):.    
+00016a20: 2020 2020 2222 2243 7265 6174 6520 7072      """Create pr
+00016a30: 696d 6974 6976 6520 6365 6c6c 2e0a 0a20  imitive cell... 
+00016a40: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
+00016a50: 5f6d 6174 7269 783a 0a20 2020 2020 2020  _matrix:.       
+00016a60: 2020 2052 656c 6174 6976 6520 6178 6573     Relative axes
+00016a70: 206f 6620 7072 696d 6974 6976 6520 6365   of primitive ce
+00016a80: 6c6c 2074 6f20 7468 6520 696e 7075 7420  ll to the input 
+00016a90: 756e 6974 2063 656c 6c2e 0a20 2020 2020  unit cell..     
+00016aa0: 2020 2020 2052 656c 6174 6976 6520 6178       Relative ax
+00016ab0: 6573 2074 6f20 7468 6520 7375 7065 7263  es to the superc
+00016ac0: 656c 6c20 6973 2063 616c 6375 6c61 7465  ell is calculate
+00016ad0: 6420 6279 3a0a 2020 2020 2020 2020 2020  d by:.          
+00016ae0: 2020 2073 7570 6572 6365 6c6c 5f6d 6174     supercell_mat
+00016af0: 7269 785e 2d31 202a 2070 7269 6d69 7469  rix^-1 * primiti
+00016b00: 7665 5f6d 6174 7269 780a 2020 2020 2020  ve_matrix.      
+00016b10: 2020 2020 5468 6572 6566 6f72 6520 7072      Therefore pr
+00016b20: 696d 6974 6976 6520 6365 6c6c 206c 6174  imitive cell lat
+00016b30: 7469 6365 2069 7320 6669 6e61 6c6c 7920  tice is finally 
+00016b40: 6361 6c63 756c 6174 6564 2062 793a 0a20  calculated by:. 
+00016b50: 2020 2020 2020 2020 2020 2020 2873 7570              (sup
+00016b60: 6572 6365 6c6c 5f6c 6174 7469 6365 202a  ercell_lattice *
+00016b70: 2028 7375 7065 7263 656c 6c5f 6d61 7472   (supercell_matr
+00016b80: 6978 295e 2d31 202a 2070 7269 6d69 7469  ix)^-1 * primiti
+00016b90: 7665 5f6d 6174 7269 7829 5e54 0a0a 2020  ve_matrix)^T..  
+00016ba0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00016bb0: 2020 7365 6c66 2e5f 7072 696d 6974 6976    self._primitiv
+00016bc0: 6520 3d20 7365 6c66 2e5f 6765 745f 7072  e = self._get_pr
+00016bd0: 696d 6974 6976 655f 6365 6c6c 280a 2020  imitive_cell(.  
+00016be0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00016bf0: 7375 7065 7263 656c 6c2c 2073 656c 662e  supercell, self.
+00016c00: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
+00016c10: 782c 2073 656c 662e 5f70 7269 6d69 7469  x, self._primiti
+00016c20: 7665 5f6d 6174 7269 780a 2020 2020 2020  ve_matrix.      
+00016c30: 2020 290a 0a20 2020 2064 6566 205f 6275    )..    def _bu
+00016c40: 696c 645f 7068 6f6e 6f6e 5f73 7570 6572  ild_phonon_super
+00016c50: 6365 6c6c 2873 656c 6629 3a0a 2020 2020  cell(self):.    
+00016c60: 2020 2020 2222 2243 7265 6174 6520 7068      """Create ph
+00016c70: 6f6e 6f6e 2073 7570 6572 6365 6c6c 2066  onon supercell f
+00016c80: 6f72 2066 6332 2e0a 0a20 2020 2020 2020  or fc2...       
+00016c90: 2070 686f 6e6f 6e5f 7375 7065 7263 656c   phonon_supercel
+00016ca0: 6c3a 0a20 2020 2020 2020 2020 2054 6869  l:.          Thi
+00016cb0: 7320 7375 7065 7263 656c 6c20 6973 2075  s supercell is u
+00016cc0: 7365 6420 666f 7220 6861 726d 6f6e 6963  sed for harmonic
+00016cd0: 2070 686f 6e6f 6e73 2028 6672 6571 7565   phonons (freque
+00016ce0: 6e63 6965 732c 0a20 2020 2020 2020 2020  ncies,.         
+00016cf0: 2065 6967 656e 7665 6374 6f72 732c 2067   eigenvectors, g
+00016d00: 726f 7570 2076 656c 6f63 6974 6965 732c  roup velocities,
+00016d10: 202e 2e2e 290a 2020 2020 2020 2020 7068   ...).        ph
+00016d20: 6f6e 6f6e 5f73 7570 6572 6365 6c6c 5f6d  onon_supercell_m
+00016d30: 6174 7269 783a 0a20 2020 2020 2020 2020  atrix:.         
+00016d40: 2044 6966 6665 7265 6e74 2073 7570 6572   Different super
+00016d50: 6365 6c6c 2073 697a 6520 6361 6e20 6265  cell size can be
+00016d60: 2073 7065 6369 6669 6564 2e0a 0a20 2020   specified...   
+00016d70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016d80: 2069 6620 7365 6c66 2e5f 7068 6f6e 6f6e   if self._phonon
+00016d90: 5f73 7570 6572 6365 6c6c 5f6d 6174 7269  _supercell_matri
+00016da0: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+00016db0: 2020 2020 2020 2073 656c 662e 5f70 686f         self._pho
+00016dc0: 6e6f 6e5f 7375 7065 7263 656c 6c20 3d20  non_supercell = 
+00016dd0: 7365 6c66 2e5f 7375 7065 7263 656c 6c0a  self._supercell.
+00016de0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00016df0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00016e00: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
+00016e10: 203d 2067 6574 5f73 7570 6572 6365 6c6c   = get_supercell
+00016e20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016e30: 2020 7365 6c66 2e5f 756e 6974 6365 6c6c    self._unitcell
+00016e40: 2c20 7365 6c66 2e5f 7068 6f6e 6f6e 5f73  , self._phonon_s
+00016e50: 7570 6572 6365 6c6c 5f6d 6174 7269 782c  upercell_matrix,
+00016e60: 2073 656c 662e 5f73 796d 7072 6563 0a20   self._symprec. 
+00016e70: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00016e80: 2020 6465 6620 5f62 7569 6c64 5f70 686f    def _build_pho
+00016e90: 6e6f 6e5f 7072 696d 6974 6976 655f 6365  non_primitive_ce
+00016ea0: 6c6c 2873 656c 6629 3a0a 2020 2020 2020  ll(self):.      
+00016eb0: 2020 6966 2073 656c 662e 5f70 686f 6e6f    if self._phono
+00016ec0: 6e5f 7375 7065 7263 656c 6c5f 6d61 7472  n_supercell_matr
+00016ed0: 6978 2069 7320 4e6f 6e65 3a0a 2020 2020  ix is None:.    
+00016ee0: 2020 2020 2020 2020 7365 6c66 2e5f 7068          self._ph
+00016ef0: 6f6e 6f6e 5f70 7269 6d69 7469 7665 203d  onon_primitive =
+00016f00: 2073 656c 662e 5f70 7269 6d69 7469 7665   self._primitive
+00016f10: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00016f20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00016f30: 5f70 686f 6e6f 6e5f 7072 696d 6974 6976  _phonon_primitiv
+00016f40: 6520 3d20 7365 6c66 2e5f 6765 745f 7072  e = self._get_pr
+00016f50: 696d 6974 6976 655f 6365 6c6c 280a 2020  imitive_cell(.  
+00016f60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00016f70: 6c66 2e5f 7068 6f6e 6f6e 5f73 7570 6572  lf._phonon_super
+00016f80: 6365 6c6c 2c0a 2020 2020 2020 2020 2020  cell,.          
+00016f90: 2020 2020 2020 7365 6c66 2e5f 7068 6f6e        self._phon
+00016fa0: 6f6e 5f73 7570 6572 6365 6c6c 5f6d 6174  on_supercell_mat
+00016fb0: 7269 782c 0a20 2020 2020 2020 2020 2020  rix,.           
+00016fc0: 2020 2020 2073 656c 662e 5f70 7269 6d69       self._primi
+00016fd0: 7469 7665 5f6d 6174 7269 782c 0a20 2020  tive_matrix,.   
+00016fe0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00016ff0: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
+00017000: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017010: 2e5f 7072 696d 6974 6976 6520 6973 206e  ._primitive is n
+00017020: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
+00017030: 2020 2020 2020 2020 616e 6420 2873 656c          and (sel
+00017040: 662e 5f70 7269 6d69 7469 7665 2e6e 756d  f._primitive.num
+00017050: 6265 7273 2021 3d20 7365 6c66 2e5f 7068  bers != self._ph
+00017060: 6f6e 6f6e 5f70 7269 6d69 7469 7665 2e6e  onon_primitive.n
+00017070: 756d 6265 7273 292e 616e 7928 290a 2020  umbers).any().  
+00017080: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+00017090: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000170a0: 6e74 2822 2050 7269 6d69 7469 7665 2063  nt(" Primitive c
+000170b0: 656c 6c73 2066 6f72 2066 6332 2061 6e64  ells for fc2 and
+000170c0: 2066 6333 2063 616e 2062 6520 6469 6666   fc3 can be diff
+000170d0: 6572 656e 742e 2229 0a20 2020 2020 2020  erent.").       
+000170e0: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+000170f0: 756e 7469 6d65 4572 726f 720a 0a20 2020  untimeError..   
+00017100: 2064 6566 205f 6275 696c 645f 7068 6f6e   def _build_phon
+00017110: 6f6e 5f73 7570 6572 6365 6c6c 735f 7769  on_supercells_wi
+00017120: 7468 5f64 6973 706c 6163 656d 656e 7473  th_displacements
+00017130: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00017140: 7375 7065 7263 656c 6c3a 2050 686f 6e6f  supercell: Phono
+00017150: 7079 4174 6f6d 732c 2064 6973 706c 6163  pyAtoms, displac
+00017160: 656d 656e 745f 6461 7461 7365 740a 2020  ement_dataset.  
+00017170: 2020 293a 0a20 2020 2020 2020 2073 7570    ):.        sup
+00017180: 6572 6365 6c6c 7320 3d20 5b5d 0a20 2020  ercells = [].   
+00017190: 2020 2020 206d 6167 6d6f 6d73 203d 2073       magmoms = s
+000171a0: 7570 6572 6365 6c6c 2e6d 6167 6e65 7469  upercell.magneti
+000171b0: 635f 6d6f 6d65 6e74 730a 2020 2020 2020  c_moments.      
+000171c0: 2020 6d61 7373 6573 203d 2073 7570 6572    masses = super
+000171d0: 6365 6c6c 2e6d 6173 7365 730a 2020 2020  cell.masses.    
+000171e0: 2020 2020 6e75 6d62 6572 7320 3d20 7375      numbers = su
+000171f0: 7065 7263 656c 6c2e 6e75 6d62 6572 730a  percell.numbers.
+00017200: 2020 2020 2020 2020 6c61 7474 6963 6520          lattice 
+00017210: 3d20 7375 7065 7263 656c 6c2e 6365 6c6c  = supercell.cell
+00017220: 0a0a 2020 2020 2020 2020 666f 7220 6469  ..        for di
+00017230: 7370 3120 696e 2064 6973 706c 6163 656d  sp1 in displacem
+00017240: 656e 745f 6461 7461 7365 745b 2266 6972  ent_dataset["fir
+00017250: 7374 5f61 746f 6d73 225d 3a0a 2020 2020  st_atoms"]:.    
+00017260: 2020 2020 2020 2020 6469 7370 5f63 6172          disp_car
+00017270: 7431 203d 2064 6973 7031 5b22 6469 7370  t1 = disp1["disp
+00017280: 6c61 6365 6d65 6e74 225d 0a20 2020 2020  lacement"].     
+00017290: 2020 2020 2020 2070 6f73 6974 696f 6e73         positions
+000172a0: 203d 2073 7570 6572 6365 6c6c 2e70 6f73   = supercell.pos
+000172b0: 6974 696f 6e73 0a20 2020 2020 2020 2020  itions.         
+000172c0: 2020 2070 6f73 6974 696f 6e73 5b64 6973     positions[dis
+000172d0: 7031 5b22 6e75 6d62 6572 225d 5d20 2b3d  p1["number"]] +=
+000172e0: 2064 6973 705f 6361 7274 310a 2020 2020   disp_cart1.    
+000172f0: 2020 2020 2020 2020 7375 7065 7263 656c          supercel
+00017300: 6c73 2e61 7070 656e 6428 0a20 2020 2020  ls.append(.     
+00017310: 2020 2020 2020 2020 2020 2050 686f 6e6f             Phono
+00017320: 7079 4174 6f6d 7328 0a20 2020 2020 2020  pyAtoms(.       
+00017330: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00017340: 6265 7273 3d6e 756d 6265 7273 2c0a 2020  bers=numbers,.  
+00017350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017360: 2020 6d61 7373 6573 3d6d 6173 7365 732c    masses=masses,
+00017370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017380: 2020 2020 206d 6167 6e65 7469 635f 6d6f       magnetic_mo
+00017390: 6d65 6e74 733d 6d61 676d 6f6d 732c 0a20  ments=magmoms,. 
 000173a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173b0: 696e 636c 7564 6564 203d 2064 6973 7032  included = disp2
-000173c0: 5b22 696e 636c 7564 6564 225d 0a20 2020  ["included"].   
-000173d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000173e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000173f0: 2020 2020 2020 2069 6e63 6c75 6465 6420         included 
-00017400: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-00017410: 2020 2020 2020 2069 6620 696e 636c 7564         if includ
-00017420: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-00017430: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
-00017440: 7320 3d20 7365 6c66 2e5f 7375 7065 7263  s = self._superc
-00017450: 656c 6c2e 706f 7369 7469 6f6e 730a 2020  ell.positions.  
-00017460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017470: 2020 706f 7369 7469 6f6e 735b 6469 7370    positions[disp
-00017480: 315b 226e 756d 6265 7222 5d5d 202b 3d20  1["number"]] += 
-00017490: 6469 7370 5f63 6172 7431 0a20 2020 2020  disp_cart1.     
-000174a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000174b0: 6f73 6974 696f 6e73 5b64 6973 7032 5b22  ositions[disp2["
-000174c0: 6e75 6d62 6572 225d 5d20 2b3d 2064 6973  number"]] += dis
-000174d0: 7032 5b22 6469 7370 6c61 6365 6d65 6e74  p2["displacement
-000174e0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-000174f0: 2020 2020 2020 2073 7570 6572 6365 6c6c         supercell
-00017500: 732e 6170 7065 6e64 280a 2020 2020 2020  s.append(.      
-00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017520: 2020 5068 6f6e 6f70 7941 746f 6d73 280a    PhonopyAtoms(.
-00017530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017540: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00017550: 6572 733d 6e75 6d62 6572 732c 0a20 2020  ers=numbers,.   
-00017560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017570: 2020 2020 2020 2020 206d 6173 7365 733d           masses=
-00017580: 6d61 7373 6573 2c0a 2020 2020 2020 2020  masses,.        
-00017590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175a0: 2020 2020 6d61 676e 6574 6963 5f6d 6f6d      magnetic_mom
-000175b0: 656e 7473 3d6d 6167 6d6f 6d73 2c0a 2020  ents=magmoms,.  
-000175c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175d0: 2020 2020 2020 2020 2020 706f 7369 7469            positi
-000175e0: 6f6e 733d 706f 7369 7469 6f6e 732c 0a20  ons=positions,. 
-000175f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017600: 2020 2020 2020 2020 2020 2063 656c 6c3d             cell=
-00017610: 6c61 7474 6963 652c 0a20 2020 2020 2020  lattice,.       
-00017620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017630: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00017640: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00017650: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00017660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017670: 2020 2073 7570 6572 6365 6c6c 732e 6170     supercells.ap
-00017680: 7065 6e64 284e 6f6e 6529 0a0a 2020 2020  pend(None)..    
-00017690: 2020 2020 7365 6c66 2e5f 7375 7065 7263      self._superc
-000176a0: 656c 6c73 5f77 6974 685f 6469 7370 6c61  ells_with_displa
-000176b0: 6365 6d65 6e74 7320 3d20 7375 7065 7263  cements = superc
-000176c0: 656c 6c73 0a0a 2020 2020 6465 6620 5f67  ells..    def _g
-000176d0: 6574 5f70 7269 6d69 7469 7665 5f63 656c  et_primitive_cel
-000176e0: 6c28 7365 6c66 2c20 7375 7065 7263 656c  l(self, supercel
-000176f0: 6c2c 2073 7570 6572 6365 6c6c 5f6d 6174  l, supercell_mat
-00017700: 7269 782c 2070 7269 6d69 7469 7665 5f6d  rix, primitive_m
-00017710: 6174 7269 7829 3a0a 2020 2020 2020 2020  atrix):.        
-00017720: 696e 765f 7375 7065 7263 656c 6c5f 6d61  inv_supercell_ma
-00017730: 7472 6978 203d 206e 702e 6c69 6e61 6c67  trix = np.linalg
-00017740: 2e69 6e76 2873 7570 6572 6365 6c6c 5f6d  .inv(supercell_m
-00017750: 6174 7269 7829 0a20 2020 2020 2020 2069  atrix).        i
-00017760: 6620 7072 696d 6974 6976 655f 6d61 7472  f primitive_matr
-00017770: 6978 2069 7320 4e6f 6e65 3a0a 2020 2020  ix is None:.    
-00017780: 2020 2020 2020 2020 745f 6d61 7420 3d20          t_mat = 
-00017790: 696e 765f 7375 7065 7263 656c 6c5f 6d61  inv_supercell_ma
-000177a0: 7472 6978 0a20 2020 2020 2020 2065 6c73  trix.        els
-000177b0: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
-000177c0: 5f6d 6174 203d 206e 702e 646f 7428 696e  _mat = np.dot(in
-000177d0: 765f 7375 7065 7263 656c 6c5f 6d61 7472  v_supercell_matr
-000177e0: 6978 2c20 7072 696d 6974 6976 655f 6d61  ix, primitive_ma
-000177f0: 7472 6978 290a 0a20 2020 2020 2020 2072  trix)..        r
-00017800: 6574 7572 6e20 6765 745f 7072 696d 6974  eturn get_primit
-00017810: 6976 6528 0a20 2020 2020 2020 2020 2020  ive(.           
-00017820: 2073 7570 6572 6365 6c6c 2c20 745f 6d61   supercell, t_ma
-00017830: 742c 2073 656c 662e 5f73 796d 7072 6563  t, self._symprec
-00017840: 2c20 7374 6f72 655f 6465 6e73 655f 7376  , store_dense_sv
-00017850: 6563 733d 7365 6c66 2e5f 7374 6f72 655f  ecs=self._store_
-00017860: 6465 6e73 655f 7376 6563 730a 2020 2020  dense_svecs.    
-00017870: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-00017880: 6465 7465 726d 696e 655f 7072 696d 6974  determine_primit
-00017890: 6976 655f 6d61 7472 6978 2873 656c 662c  ive_matrix(self,
-000178a0: 2070 7269 6d69 7469 7665 5f6d 6174 7269   primitive_matri
-000178b0: 7829 3a0a 2020 2020 2020 2020 706d 6174  x):.        pmat
-000178c0: 203d 2067 6574 5f70 7269 6d69 7469 7665   = get_primitive
-000178d0: 5f6d 6174 7269 7828 7072 696d 6974 6976  _matrix(primitiv
-000178e0: 655f 6d61 7472 6978 2c20 7379 6d70 7265  e_matrix, sympre
-000178f0: 633d 7365 6c66 2e5f 7379 6d70 7265 6329  c=self._symprec)
-00017900: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00017910: 7374 616e 6365 2870 6d61 742c 2073 7472  stance(pmat, str
-00017920: 2920 616e 6420 706d 6174 203d 3d20 2261  ) and pmat == "a
-00017930: 7574 6f22 3a0a 2020 2020 2020 2020 2020  uto":.          
-00017940: 2020 7265 7475 726e 2067 7565 7373 5f70    return guess_p
-00017950: 7269 6d69 7469 7665 5f6d 6174 7269 7828  rimitive_matrix(
-00017960: 7365 6c66 2e5f 756e 6974 6365 6c6c 2c20  self._unitcell, 
-00017970: 7379 6d70 7265 633d 7365 6c66 2e5f 7379  symprec=self._sy
-00017980: 6d70 7265 6329 0a20 2020 2020 2020 2065  mprec).        e
-00017990: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000179a0: 2072 6574 7572 6e20 706d 6174 0a0a 2020   return pmat..  
-000179b0: 2020 6465 6620 5f73 6574 5f6d 6573 685f    def _set_mesh_
-000179c0: 6e75 6d62 6572 7328 7365 6c66 2c20 6d65  numbers(self, me
-000179d0: 7368 293a 0a20 2020 2020 2020 2023 2069  sh):.        # i
-000179e0: 6e69 7469 616c 697a 6174 696f 6e20 7265  nitialization re
-000179f0: 6c61 7465 6420 746f 206d 6573 680a 2020  lated to mesh.  
-00017a00: 2020 2020 2020 7365 6c66 2e5f 696e 7465        self._inte
-00017a10: 7261 6374 696f 6e20 3d20 4e6f 6e65 0a0a  raction = None..
-00017a20: 2020 2020 2020 2020 7365 6c66 2e5f 627a          self._bz
-00017a30: 5f67 7269 6420 3d20 425a 4772 6964 280a  _grid = BZGrid(.
-00017a40: 2020 2020 2020 2020 2020 2020 6d65 7368              mesh
-00017a50: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
-00017a60: 7474 6963 653d 7365 6c66 2e5f 7072 696d  ttice=self._prim
-00017a70: 6974 6976 652e 6365 6c6c 2c0a 2020 2020  itive.cell,.    
-00017a80: 2020 2020 2020 2020 7379 6d6d 6574 7279          symmetry
-00017a90: 5f64 6174 6173 6574 3d73 656c 662e 5f70  _dataset=self._p
-00017aa0: 7269 6d69 7469 7665 5f73 796d 6d65 7472  rimitive_symmetr
-00017ab0: 792e 6461 7461 7365 742c 0a20 2020 2020  y.dataset,.     
-00017ac0: 2020 2020 2020 2069 735f 7469 6d65 5f72         is_time_r
-00017ad0: 6576 6572 7361 6c3d 7365 6c66 2e5f 6973  eversal=self._is
-00017ae0: 5f73 796d 6d65 7472 792c 0a20 2020 2020  _symmetry,.     
-00017af0: 2020 2020 2020 2075 7365 5f67 7267 3d73         use_grg=s
-00017b00: 656c 662e 5f75 7365 5f67 7267 2c0a 2020  elf._use_grg,.  
-00017b10: 2020 2020 2020 2020 2020 666f 7263 655f            force_
-00017b20: 534e 463d 4661 6c73 652c 0a20 2020 2020  SNF=False,.     
-00017b30: 2020 2020 2020 2053 4e46 5f63 6f6f 7264         SNF_coord
-00017b40: 696e 6174 6573 3d73 656c 662e 5f53 4e46  inates=self._SNF
-00017b50: 5f63 6f6f 7264 696e 6174 6573 2c0a 2020  _coordinates,.  
-00017b60: 2020 2020 2020 2020 2020 7374 6f72 655f            store_
-00017b70: 6465 6e73 655f 6770 5f6d 6170 3d73 656c  dense_gp_map=sel
-00017b80: 662e 5f73 746f 7265 5f64 656e 7365 5f67  f._store_dense_g
-00017b90: 705f 6d61 702c 0a20 2020 2020 2020 2029  p_map,.        )
-00017ba0: 0a0a 2020 2020 6465 6620 5f69 6e69 745f  ..    def _init_
-00017bb0: 6479 6e61 6d69 6361 6c5f 6d61 7472 6978  dynamical_matrix
-00017bc0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00017bd0: 6966 2073 656c 662e 5f69 6e74 6572 6163  if self._interac
-00017be0: 7469 6f6e 2069 7320 4e6f 6e65 3a0a 2020  tion is None:.  
-00017bf0: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
-00017c00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00017c10: 2020 2250 686f 6e6f 3370 792e 696e 6974    "Phono3py.init
-00017c20: 5f70 6870 685f 696e 7465 7261 6374 696f  _phph_interactio
-00017c30: 6e20 6861 7320 746f 2062 6520 6361 6c6c  n has to be call
-00017c40: 6564 2022 0a20 2020 2020 2020 2020 2020  ed ".           
-00017c50: 2020 2020 2022 6265 666f 7265 2072 756e       "before run
-00017c60: 6e69 6e67 2074 6869 7320 6d65 7468 6f64  ning this method
-00017c70: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-00017c80: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00017c90: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
-00017ca0: 6d73 6729 0a0a 2020 2020 2020 2020 7365  msg)..        se
-00017cb0: 6c66 2e5f 696e 7465 7261 6374 696f 6e2e  lf._interaction.
-00017cc0: 696e 6974 5f64 796e 616d 6963 616c 5f6d  init_dynamical_m
-00017cd0: 6174 7269 7828 0a20 2020 2020 2020 2020  atrix(.         
-00017ce0: 2020 2073 656c 662e 5f66 6332 2c0a 2020     self._fc2,.  
-00017cf0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00017d00: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
-00017d10: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-00017d20: 6c66 2e5f 7068 6f6e 6f6e 5f70 7269 6d69  lf._phonon_primi
-00017d30: 7469 7665 2c0a 2020 2020 2020 2020 2020  tive,.          
-00017d40: 2020 6e61 635f 7061 7261 6d73 3d73 656c    nac_params=sel
-00017d50: 662e 5f6e 6163 5f70 6172 616d 732c 0a20  f._nac_params,. 
-00017d60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00017d70: 2066 7265 7173 2c20 5f2c 205f 203d 2073   freqs, _, _ = s
-00017d80: 656c 662e 6765 745f 7068 6f6e 6f6e 5f64  elf.get_phonon_d
-00017d90: 6174 6128 290a 2020 2020 2020 2020 6770  ata().        gp
-00017da0: 5f47 616d 6d61 203d 2073 656c 662e 5f62  _Gamma = self._b
-00017db0: 7a5f 6772 6964 2e67 705f 4761 6d6d 610a  z_grid.gp_Gamma.
-00017dc0: 2020 2020 2020 2020 6966 206e 702e 7375          if np.su
-00017dd0: 6d28 6672 6571 735b 6770 5f47 616d 6d61  m(freqs[gp_Gamma
-00017de0: 5d20 3c20 7365 6c66 2e5f 6375 746f 6666  ] < self._cutoff
-00017df0: 5f66 7265 7175 656e 6379 2920 3c20 333a  _frequency) < 3:
-00017e00: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00017e10: 2069 2c20 6620 696e 2065 6e75 6d65 7261   i, f in enumera
-00017e20: 7465 2866 7265 7173 5b67 705f 4761 6d6d  te(freqs[gp_Gamm
-00017e30: 612c 203a 335d 293a 0a20 2020 2020 2020  a, :3]):.       
-00017e40: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00017e50: 2866 203c 2073 656c 662e 5f63 7574 6f66  (f < self._cutof
-00017e60: 665f 6672 6571 7565 6e63 7929 3a0a 2020  f_frequency):.  
-00017e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e80: 2020 6672 6571 735b 6770 5f47 616d 6d61    freqs[gp_Gamma
-00017e90: 2c20 695d 203d 2030 0a20 2020 2020 2020  , i] = 0.       
-00017ea0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00017eb0: 6e74 2822 3d22 202a 2032 3620 2b20 2220  nt("=" * 26 + " 
-00017ec0: 5761 726e 696e 6720 2220 2b20 223d 2220  Warning " + "=" 
-00017ed0: 2a20 3236 290a 2020 2020 2020 2020 2020  * 26).          
-00017ee0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00017ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017f00: 2020 2020 2020 2020 2022 2050 686f 6e6f           " Phono
-00017f10: 6e20 6672 6571 7565 6e63 7920 6f66 2062  n frequency of b
-00017f20: 616e 6420 696e 6465 7820 2564 2061 7420  and index %d at 
-00017f30: 4761 6d6d 6120 220a 2020 2020 2020 2020  Gamma ".        
-00017f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f50: 2269 7320 6361 6c63 756c 6174 6564 2074  "is calculated t
-00017f60: 6f20 6265 2025 662e 2220 2520 2869 202b  o be %f." % (i +
-00017f70: 2031 2c20 6629 0a20 2020 2020 2020 2020   1, f).         
-00017f80: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00017f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fa0: 2070 7269 6e74 2822 2042 7574 2074 6869   print(" But thi
-00017fb0: 7320 6672 6571 7565 6e63 7920 6973 2066  s frequency is f
-00017fc0: 6f72 6365 6420 746f 2062 6520 7a65 726f  orced to be zero
-00017fd0: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-00017fe0: 2020 2020 2020 2020 7072 696e 7428 223d          print("=
-00017ff0: 2220 2a20 3631 290a 0a20 2020 2064 6566  " * 61)..    def
-00018000: 205f 6578 7472 6163 745f 6663 325f 6663   _extract_fc2_fc
-00018010: 335f 6361 6c63 756c 6174 6f72 7328 7365  3_calculators(se
-00018020: 6c66 2c20 6663 5f63 616c 6375 6c61 746f  lf, fc_calculato
-00018030: 722c 2066 635f 6361 6c63 756c 6174 6f72  r, fc_calculator
-00018040: 5f6f 7074 696f 6e73 2c20 6f72 6465 7229  _options, order)
-00018050: 3a0a 2020 2020 2020 2020 2222 2245 7874  :.        """Ext
-00018060: 7261 6374 2066 635f 6361 6c63 756c 6174  ract fc_calculat
-00018070: 6f72 2061 6e64 2066 635f 6361 6c63 756c  or and fc_calcul
-00018080: 6174 6f72 5f6f 7074 696f 6e73 2066 6f72  ator_options for
-00018090: 2066 6332 2061 6e64 2066 6333 2e0a 0a20   fc2 and fc3... 
-000180a0: 2020 2020 2020 2066 635f 6361 6c63 756c         fc_calcul
-000180b0: 6174 6f72 203a 2073 7472 0a20 2020 2020  ator : str.     
-000180c0: 2020 2020 2020 2046 4320 6361 6c63 756c         FC calcul
-000180d0: 6174 6f72 2e20 227c 2220 7365 7061 7261  ator. "|" separa
-000180e0: 7465 7320 6663 3220 616e 6420 6663 332e  tes fc2 and fc3.
-000180f0: 2046 6972 7374 2061 6e64 206c 6173 740a   First and last.
-00018100: 2020 2020 2020 2020 2020 2020 7061 7274              part
-00018110: 7320 7365 7061 7261 7465 6420 636f 7272  s separated corr
-00018120: 6573 706f 6e64 2074 6f20 6663 3220 616e  espond to fc2 an
-00018130: 6420 6663 3320 6361 6c63 756c 6174 6f72  d fc3 calculator
-00018140: 732c 2072 6573 7065 6374 6976 656c 792e  s, respectively.
-00018150: 0a20 2020 2020 2020 2066 635f 6361 6c63  .        fc_calc
-00018160: 756c 6174 6f72 5f6f 7074 696f 6e73 203a  ulator_options :
-00018170: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
-00018180: 2046 4320 6361 6c63 756c 6174 6f72 206f   FC calculator o
-00018190: 7074 696f 6e73 2e20 227c 2220 7365 7061  ptions. "|" sepa
-000181a0: 7261 7465 7320 6663 3220 616e 6420 6663  rates fc2 and fc
-000181b0: 332e 2046 6972 7374 2061 6e64 206c 6173  3. First and las
-000181c0: 740a 2020 2020 2020 2020 2020 2020 7061  t.            pa
-000181d0: 7274 7320 7365 7061 7261 7465 6420 636f  rts separated co
-000181e0: 7272 6573 706f 6e64 2074 6f20 6663 3220  rrespond to fc2 
-000181f0: 616e 6420 6663 3320 6f70 7469 6f6e 732c  and fc3 options,
-00018200: 2072 6573 7065 6374 6976 656c 792e 0a20   respectively.. 
-00018210: 2020 2020 2020 206f 7264 6572 203a 2069         order : i
-00018220: 6e74 203d 2032 206f 7220 330a 2020 2020  nt = 2 or 3.    
-00018230: 2020 2020 2020 2020 3220 616e 6420 3320          2 and 3 
-00018240: 696e 6469 6361 7465 2066 6332 2061 6e64  indicate fc2 and
-00018250: 2066 6333 2c20 7265 7370 6563 7469 7665   fc3, respective
-00018260: 6c79 2e0a 0a20 2020 2020 2020 2022 2222  ly...        """
-00018270: 0a20 2020 2020 2020 2069 6620 6663 5f63  .        if fc_c
-00018280: 616c 6375 6c61 746f 7220 6973 206e 6f74  alculator is not
-00018290: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000182a0: 2020 2069 6620 227c 2220 696e 2066 635f     if "|" in fc_
-000182b0: 6361 6c63 756c 6174 6f72 3a0a 2020 2020  calculator:.    
-000182c0: 2020 2020 2020 2020 2020 2020 5f66 635f              _fc_
-000182d0: 6361 6c63 756c 6174 6f72 203d 2066 635f  calculator = fc_
-000182e0: 6361 6c63 756c 6174 6f72 2e73 706c 6974  calculator.split
-000182f0: 2822 7c22 295b 6f72 6465 7220 2d20 325d  ("|")[order - 2]
-00018300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018310: 2069 6620 5f66 635f 6361 6c63 756c 6174   if _fc_calculat
-00018320: 6f72 203d 3d20 2222 3a0a 2020 2020 2020  or == "":.      
-00018330: 2020 2020 2020 2020 2020 2020 2020 5f66                _f
-00018340: 635f 6361 6c63 756c 6174 6f72 203d 204e  c_calculator = N
-00018350: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00018360: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00018370: 2020 2020 2020 5f66 635f 6361 6c63 756c        _fc_calcul
-00018380: 6174 6f72 203d 2066 635f 6361 6c63 756c  ator = fc_calcul
-00018390: 6174 6f72 0a20 2020 2020 2020 2065 6c73  ator.        els
-000183a0: 653a 0a20 2020 2020 2020 2020 2020 205f  e:.            _
-000183b0: 6663 5f63 616c 6375 6c61 746f 7220 3d20  fc_calculator = 
-000183c0: 4e6f 6e65 0a0a 2020 2020 2020 2020 6966  None..        if
-000183d0: 2066 635f 6361 6c63 756c 6174 6f72 5f6f   fc_calculator_o
-000183e0: 7074 696f 6e73 2069 7320 6e6f 7420 4e6f  ptions is not No
-000183f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018400: 6966 2022 7c22 2069 6e20 6663 5f63 616c  if "|" in fc_cal
-00018410: 6375 6c61 746f 725f 6f70 7469 6f6e 733a  culator_options:
-00018420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018430: 205f 6663 5f63 616c 6375 6c61 746f 725f   _fc_calculator_
-00018440: 6f70 7469 6f6e 7320 3d20 6663 5f63 616c  options = fc_cal
-00018450: 6375 6c61 746f 725f 6f70 7469 6f6e 732e  culator_options.
-00018460: 7370 6c69 7428 227c 2229 5b6f 7264 6572  split("|")[order
-00018470: 202d 2032 5d0a 2020 2020 2020 2020 2020   - 2].          
-00018480: 2020 2020 2020 6966 205f 6663 5f63 616c        if _fc_cal
-00018490: 6375 6c61 746f 725f 6f70 7469 6f6e 7320  culator_options 
-000184a0: 3d3d 2022 223a 0a20 2020 2020 2020 2020  == "":.         
-000184b0: 2020 2020 2020 2020 2020 205f 6663 5f63             _fc_c
-000184c0: 616c 6375 6c61 746f 725f 6f70 7469 6f6e  alculator_option
-000184d0: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
-000184e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000184f0: 2020 2020 2020 2020 2020 205f 6663 5f63             _fc_c
-00018500: 616c 6375 6c61 746f 725f 6f70 7469 6f6e  alculator_option
-00018510: 7320 3d20 6663 5f63 616c 6375 6c61 746f  s = fc_calculato
-00018520: 725f 6f70 7469 6f6e 730a 2020 2020 2020  r_options.      
-00018530: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00018540: 2020 2020 5f66 635f 6361 6c63 756c 6174      _fc_calculat
-00018550: 6f72 5f6f 7074 696f 6e73 203d 204e 6f6e  or_options = Non
-00018560: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-00018570: 6e20 5f66 635f 6361 6c63 756c 6174 6f72  n _fc_calculator
-00018580: 2c20 5f66 635f 6361 6c63 756c 6174 6f72  , _fc_calculator
-00018590: 5f6f 7074 696f 6e73 0a                   _options.
+000173b0: 2020 2070 6f73 6974 696f 6e73 3d70 6f73     positions=pos
+000173c0: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
+000173d0: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+000173e0: 3d6c 6174 7469 6365 2c0a 2020 2020 2020  =lattice,.      
+000173f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00017400: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00017410: 2020 2072 6574 7572 6e20 7375 7065 7263     return superc
+00017420: 656c 6c73 0a0a 2020 2020 6465 6620 5f62  ells..    def _b
+00017430: 7569 6c64 5f73 7570 6572 6365 6c6c 735f  uild_supercells_
+00017440: 7769 7468 5f64 6973 706c 6163 656d 656e  with_displacemen
+00017450: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
+00017460: 2020 7375 7065 7263 656c 6c73 203d 205b    supercells = [
+00017470: 5d0a 2020 2020 2020 2020 6d61 676d 6f6d  ].        magmom
+00017480: 7320 3d20 7365 6c66 2e5f 7375 7065 7263  s = self._superc
+00017490: 656c 6c2e 6d61 676e 6574 6963 5f6d 6f6d  ell.magnetic_mom
+000174a0: 656e 7473 0a20 2020 2020 2020 206d 6173  ents.        mas
+000174b0: 7365 7320 3d20 7365 6c66 2e5f 7375 7065  ses = self._supe
+000174c0: 7263 656c 6c2e 6d61 7373 6573 0a20 2020  rcell.masses.   
+000174d0: 2020 2020 206e 756d 6265 7273 203d 2073       numbers = s
+000174e0: 656c 662e 5f73 7570 6572 6365 6c6c 2e6e  elf._supercell.n
+000174f0: 756d 6265 7273 0a20 2020 2020 2020 206c  umbers.        l
+00017500: 6174 7469 6365 203d 2073 656c 662e 5f73  attice = self._s
+00017510: 7570 6572 6365 6c6c 2e63 656c 6c0a 0a20  upercell.cell.. 
+00017520: 2020 2020 2020 2073 7570 6572 6365 6c6c         supercell
+00017530: 7320 3d20 7365 6c66 2e5f 6275 696c 645f  s = self._build_
+00017540: 7068 6f6e 6f6e 5f73 7570 6572 6365 6c6c  phonon_supercell
+00017550: 735f 7769 7468 5f64 6973 706c 6163 656d  s_with_displacem
+00017560: 656e 7473 280a 2020 2020 2020 2020 2020  ents(.          
+00017570: 2020 7365 6c66 2e5f 7375 7065 7263 656c    self._supercel
+00017580: 6c2c 2073 656c 662e 5f64 6174 6173 6574  l, self._dataset
+00017590: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000175a0: 2020 2020 666f 7220 6469 7370 3120 696e      for disp1 in
+000175b0: 2073 656c 662e 5f64 6174 6173 6574 5b22   self._dataset["
+000175c0: 6669 7273 745f 6174 6f6d 7322 5d3a 0a20  first_atoms"]:. 
+000175d0: 2020 2020 2020 2020 2020 2064 6973 705f             disp_
+000175e0: 6361 7274 3120 3d20 6469 7370 315b 2264  cart1 = disp1["d
+000175f0: 6973 706c 6163 656d 656e 7422 5d0a 2020  isplacement"].  
+00017600: 2020 2020 2020 2020 2020 666f 7220 6469            for di
+00017610: 7370 3220 696e 2064 6973 7031 5b22 7365  sp2 in disp1["se
+00017620: 636f 6e64 5f61 746f 6d73 225d 3a0a 2020  cond_atoms"]:.  
+00017630: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00017640: 2022 696e 636c 7564 6564 2220 696e 2064   "included" in d
+00017650: 6973 7032 3a0a 2020 2020 2020 2020 2020  isp2:.          
+00017660: 2020 2020 2020 2020 2020 696e 636c 7564            includ
+00017670: 6564 203d 2064 6973 7032 5b22 696e 636c  ed = disp2["incl
+00017680: 7564 6564 225d 0a20 2020 2020 2020 2020  uded"].         
+00017690: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000176a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176b0: 2069 6e63 6c75 6465 6420 3d20 5472 7565   included = True
+000176c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000176d0: 2069 6620 696e 636c 7564 6564 3a0a 2020   if included:.  
+000176e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176f0: 2020 706f 7369 7469 6f6e 7320 3d20 7365    positions = se
+00017700: 6c66 2e5f 7375 7065 7263 656c 6c2e 706f  lf._supercell.po
+00017710: 7369 7469 6f6e 730a 2020 2020 2020 2020  sitions.        
+00017720: 2020 2020 2020 2020 2020 2020 706f 7369              posi
+00017730: 7469 6f6e 735b 6469 7370 315b 226e 756d  tions[disp1["num
+00017740: 6265 7222 5d5d 202b 3d20 6469 7370 5f63  ber"]] += disp_c
+00017750: 6172 7431 0a20 2020 2020 2020 2020 2020  art1.           
+00017760: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
+00017770: 6e73 5b64 6973 7032 5b22 6e75 6d62 6572  ns[disp2["number
+00017780: 225d 5d20 2b3d 2064 6973 7032 5b22 6469  "]] += disp2["di
+00017790: 7370 6c61 6365 6d65 6e74 225d 0a20 2020  splacement"].   
+000177a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177b0: 2073 7570 6572 6365 6c6c 732e 6170 7065   supercells.appe
+000177c0: 6e64 280a 2020 2020 2020 2020 2020 2020  nd(.            
+000177d0: 2020 2020 2020 2020 2020 2020 5068 6f6e              Phon
+000177e0: 6f70 7941 746f 6d73 280a 2020 2020 2020  opyAtoms(.      
+000177f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017800: 2020 2020 2020 6e75 6d62 6572 733d 6e75        numbers=nu
+00017810: 6d62 6572 732c 0a20 2020 2020 2020 2020  mbers,.         
+00017820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017830: 2020 206d 6173 7365 733d 6d61 7373 6573     masses=masses
+00017840: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017850: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00017860: 676e 6574 6963 5f6d 6f6d 656e 7473 3d6d  gnetic_moments=m
+00017870: 6167 6d6f 6d73 2c0a 2020 2020 2020 2020  agmoms,.        
+00017880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017890: 2020 2020 706f 7369 7469 6f6e 733d 706f      positions=po
+000178a0: 7369 7469 6f6e 732c 0a20 2020 2020 2020  sitions,.       
+000178b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178c0: 2020 2020 2063 656c 6c3d 6c61 7474 6963       cell=lattic
+000178d0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000178e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000178f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017900: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00017910: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00017920: 2020 2020 2020 2020 2020 2020 2073 7570               sup
+00017930: 6572 6365 6c6c 732e 6170 7065 6e64 284e  ercells.append(N
+00017940: 6f6e 6529 0a0a 2020 2020 2020 2020 7365  one)..        se
+00017950: 6c66 2e5f 7375 7065 7263 656c 6c73 5f77  lf._supercells_w
+00017960: 6974 685f 6469 7370 6c61 6365 6d65 6e74  ith_displacement
+00017970: 7320 3d20 7375 7065 7263 656c 6c73 0a0a  s = supercells..
+00017980: 2020 2020 6465 6620 5f67 6574 5f70 7269      def _get_pri
+00017990: 6d69 7469 7665 5f63 656c 6c28 7365 6c66  mitive_cell(self
+000179a0: 2c20 7375 7065 7263 656c 6c2c 2073 7570  , supercell, sup
+000179b0: 6572 6365 6c6c 5f6d 6174 7269 782c 2070  ercell_matrix, p
+000179c0: 7269 6d69 7469 7665 5f6d 6174 7269 7829  rimitive_matrix)
+000179d0: 3a0a 2020 2020 2020 2020 696e 765f 7375  :.        inv_su
+000179e0: 7065 7263 656c 6c5f 6d61 7472 6978 203d  percell_matrix =
+000179f0: 206e 702e 6c69 6e61 6c67 2e69 6e76 2873   np.linalg.inv(s
+00017a00: 7570 6572 6365 6c6c 5f6d 6174 7269 7829  upercell_matrix)
+00017a10: 0a20 2020 2020 2020 2069 6620 7072 696d  .        if prim
+00017a20: 6974 6976 655f 6d61 7472 6978 2069 7320  itive_matrix is 
+00017a30: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00017a40: 2020 745f 6d61 7420 3d20 696e 765f 7375    t_mat = inv_su
+00017a50: 7065 7263 656c 6c5f 6d61 7472 6978 0a20  percell_matrix. 
+00017a60: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00017a70: 2020 2020 2020 2020 2074 5f6d 6174 203d           t_mat =
+00017a80: 206e 702e 646f 7428 696e 765f 7375 7065   np.dot(inv_supe
+00017a90: 7263 656c 6c5f 6d61 7472 6978 2c20 7072  rcell_matrix, pr
+00017aa0: 696d 6974 6976 655f 6d61 7472 6978 290a  imitive_matrix).
+00017ab0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00017ac0: 6765 745f 7072 696d 6974 6976 6528 0a20  get_primitive(. 
+00017ad0: 2020 2020 2020 2020 2020 2073 7570 6572             super
+00017ae0: 6365 6c6c 2c20 745f 6d61 742c 2073 656c  cell, t_mat, sel
+00017af0: 662e 5f73 796d 7072 6563 2c20 7374 6f72  f._symprec, stor
+00017b00: 655f 6465 6e73 655f 7376 6563 733d 7365  e_dense_svecs=se
+00017b10: 6c66 2e5f 7374 6f72 655f 6465 6e73 655f  lf._store_dense_
+00017b20: 7376 6563 730a 2020 2020 2020 2020 290a  svecs.        ).
+00017b30: 0a20 2020 2064 6566 205f 6465 7465 726d  .    def _determ
+00017b40: 696e 655f 7072 696d 6974 6976 655f 6d61  ine_primitive_ma
+00017b50: 7472 6978 2873 656c 662c 2070 7269 6d69  trix(self, primi
+00017b60: 7469 7665 5f6d 6174 7269 7829 3a0a 2020  tive_matrix):.  
+00017b70: 2020 2020 2020 706d 6174 203d 2067 6574        pmat = get
+00017b80: 5f70 7269 6d69 7469 7665 5f6d 6174 7269  _primitive_matri
+00017b90: 7828 7072 696d 6974 6976 655f 6d61 7472  x(primitive_matr
+00017ba0: 6978 2c20 7379 6d70 7265 633d 7365 6c66  ix, symprec=self
+00017bb0: 2e5f 7379 6d70 7265 6329 0a20 2020 2020  ._symprec).     
+00017bc0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00017bd0: 2870 6d61 742c 2073 7472 2920 616e 6420  (pmat, str) and 
+00017be0: 706d 6174 203d 3d20 2261 7574 6f22 3a0a  pmat == "auto":.
+00017bf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00017c00: 726e 2067 7565 7373 5f70 7269 6d69 7469  rn guess_primiti
+00017c10: 7665 5f6d 6174 7269 7828 7365 6c66 2e5f  ve_matrix(self._
+00017c20: 756e 6974 6365 6c6c 2c20 7379 6d70 7265  unitcell, sympre
+00017c30: 633d 7365 6c66 2e5f 7379 6d70 7265 6329  c=self._symprec)
+00017c40: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00017c50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00017c60: 6e20 706d 6174 0a0a 2020 2020 6465 6620  n pmat..    def 
+00017c70: 5f73 6574 5f6d 6573 685f 6e75 6d62 6572  _set_mesh_number
+00017c80: 7328 7365 6c66 2c20 6d65 7368 293a 0a20  s(self, mesh):. 
+00017c90: 2020 2020 2020 2023 2069 6e69 7469 616c         # initial
+00017ca0: 697a 6174 696f 6e20 7265 6c61 7465 6420  ization related 
+00017cb0: 746f 206d 6573 680a 2020 2020 2020 2020  to mesh.        
+00017cc0: 7365 6c66 2e5f 696e 7465 7261 6374 696f  self._interactio
+00017cd0: 6e20 3d20 4e6f 6e65 0a0a 2020 2020 2020  n = None..      
+00017ce0: 2020 7365 6c66 2e5f 627a 5f67 7269 6420    self._bz_grid 
+00017cf0: 3d20 425a 4772 6964 280a 2020 2020 2020  = BZGrid(.      
+00017d00: 2020 2020 2020 6d65 7368 2c0a 2020 2020        mesh,.    
+00017d10: 2020 2020 2020 2020 6c61 7474 6963 653d          lattice=
+00017d20: 7365 6c66 2e5f 7072 696d 6974 6976 652e  self._primitive.
+00017d30: 6365 6c6c 2c0a 2020 2020 2020 2020 2020  cell,.          
+00017d40: 2020 7379 6d6d 6574 7279 5f64 6174 6173    symmetry_datas
+00017d50: 6574 3d73 656c 662e 5f70 7269 6d69 7469  et=self._primiti
+00017d60: 7665 5f73 796d 6d65 7472 792e 6461 7461  ve_symmetry.data
+00017d70: 7365 742c 0a20 2020 2020 2020 2020 2020  set,.           
+00017d80: 2069 735f 7469 6d65 5f72 6576 6572 7361   is_time_reversa
+00017d90: 6c3d 7365 6c66 2e5f 6973 5f73 796d 6d65  l=self._is_symme
+00017da0: 7472 792c 0a20 2020 2020 2020 2020 2020  try,.           
+00017db0: 2075 7365 5f67 7267 3d73 656c 662e 5f75   use_grg=self._u
+00017dc0: 7365 5f67 7267 2c0a 2020 2020 2020 2020  se_grg,.        
+00017dd0: 2020 2020 666f 7263 655f 534e 463d 4661      force_SNF=Fa
+00017de0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00017df0: 2053 4e46 5f63 6f6f 7264 696e 6174 6573   SNF_coordinates
+00017e00: 3d73 656c 662e 5f53 4e46 5f63 6f6f 7264  =self._SNF_coord
+00017e10: 696e 6174 6573 2c0a 2020 2020 2020 2020  inates,.        
+00017e20: 2020 2020 7374 6f72 655f 6465 6e73 655f      store_dense_
+00017e30: 6770 5f6d 6170 3d73 656c 662e 5f73 746f  gp_map=self._sto
+00017e40: 7265 5f64 656e 7365 5f67 705f 6d61 702c  re_dense_gp_map,
+00017e50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00017e60: 6465 6620 5f69 6e69 745f 6479 6e61 6d69  def _init_dynami
+00017e70: 6361 6c5f 6d61 7472 6978 2873 656c 6629  cal_matrix(self)
+00017e80: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+00017e90: 662e 5f69 6e74 6572 6163 7469 6f6e 2069  f._interaction i
+00017ea0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00017eb0: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
+00017ec0: 2020 2020 2020 2020 2020 2020 2250 686f              "Pho
+00017ed0: 6e6f 3370 792e 696e 6974 5f70 6870 685f  no3py.init_phph_
+00017ee0: 696e 7465 7261 6374 696f 6e20 6861 7320  interaction has 
+00017ef0: 746f 2062 6520 6361 6c6c 6564 2022 0a20  to be called ". 
+00017f00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00017f10: 6265 666f 7265 2072 756e 6e69 6e67 2074  before running t
+00017f20: 6869 7320 6d65 7468 6f64 2e22 0a20 2020  his method.".   
+00017f30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00017f40: 2020 2020 2020 2072 6169 7365 2052 756e         raise Run
+00017f50: 7469 6d65 4572 726f 7228 6d73 6729 0a0a  timeError(msg)..
+00017f60: 2020 2020 2020 2020 7365 6c66 2e5f 696e          self._in
+00017f70: 7465 7261 6374 696f 6e2e 696e 6974 5f64  teraction.init_d
+00017f80: 796e 616d 6963 616c 5f6d 6174 7269 7828  ynamical_matrix(
+00017f90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00017fa0: 662e 5f66 6332 2c0a 2020 2020 2020 2020  f._fc2,.        
+00017fb0: 2020 2020 7365 6c66 2e5f 7068 6f6e 6f6e      self._phonon
+00017fc0: 5f73 7570 6572 6365 6c6c 2c0a 2020 2020  _supercell,.    
+00017fd0: 2020 2020 2020 2020 7365 6c66 2e5f 7068          self._ph
+00017fe0: 6f6e 6f6e 5f70 7269 6d69 7469 7665 2c0a  onon_primitive,.
+00017ff0: 2020 2020 2020 2020 2020 2020 6e61 635f              nac_
+00018000: 7061 7261 6d73 3d73 656c 662e 5f6e 6163  params=self._nac
+00018010: 5f70 6172 616d 732c 0a20 2020 2020 2020  _params,.       
+00018020: 2029 0a20 2020 2020 2020 2066 7265 7173   ).        freqs
+00018030: 2c20 5f2c 205f 203d 2073 656c 662e 6765  , _, _ = self.ge
+00018040: 745f 7068 6f6e 6f6e 5f64 6174 6128 290a  t_phonon_data().
+00018050: 2020 2020 2020 2020 6770 5f47 616d 6d61          gp_Gamma
+00018060: 203d 2073 656c 662e 5f62 7a5f 6772 6964   = self._bz_grid
+00018070: 2e67 705f 4761 6d6d 610a 2020 2020 2020  .gp_Gamma.      
+00018080: 2020 6966 206e 702e 7375 6d28 6672 6571    if np.sum(freq
+00018090: 735b 6770 5f47 616d 6d61 5d20 3c20 7365  s[gp_Gamma] < se
+000180a0: 6c66 2e5f 6375 746f 6666 5f66 7265 7175  lf._cutoff_frequ
+000180b0: 656e 6379 2920 3c20 333a 0a20 2020 2020  ency) < 3:.     
+000180c0: 2020 2020 2020 2066 6f72 2069 2c20 6620         for i, f 
+000180d0: 696e 2065 6e75 6d65 7261 7465 2866 7265  in enumerate(fre
+000180e0: 7173 5b67 705f 4761 6d6d 612c 203a 335d  qs[gp_Gamma, :3]
+000180f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00018100: 2020 2069 6620 6e6f 7420 2866 203c 2073     if not (f < s
+00018110: 656c 662e 5f63 7574 6f66 665f 6672 6571  elf._cutoff_freq
+00018120: 7565 6e63 7929 3a0a 2020 2020 2020 2020  uency):.        
+00018130: 2020 2020 2020 2020 2020 2020 6672 6571              freq
+00018140: 735b 6770 5f47 616d 6d61 2c20 695d 203d  s[gp_Gamma, i] =
+00018150: 2030 0a20 2020 2020 2020 2020 2020 2020   0.             
+00018160: 2020 2020 2020 2070 7269 6e74 2822 3d22         print("="
+00018170: 202a 2032 3620 2b20 2220 5761 726e 696e   * 26 + " Warnin
+00018180: 6720 2220 2b20 223d 2220 2a20 3236 290a  g " + "=" * 26).
+00018190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181a0: 2020 2020 7072 696e 7428 0a20 2020 2020      print(.     
+000181b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181c0: 2020 2022 2050 686f 6e6f 6e20 6672 6571     " Phonon freq
+000181d0: 7565 6e63 7920 6f66 2062 616e 6420 696e  uency of band in
+000181e0: 6465 7820 2564 2061 7420 4761 6d6d 6120  dex %d at Gamma 
+000181f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00018200: 2020 2020 2020 2020 2020 2269 7320 6361            "is ca
+00018210: 6c63 756c 6174 6564 2074 6f20 6265 2025  lculated to be %
+00018220: 662e 2220 2520 2869 202b 2031 2c20 6629  f." % (i + 1, f)
+00018230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018240: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00018250: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00018260: 2822 2042 7574 2074 6869 7320 6672 6571  (" But this freq
+00018270: 7565 6e63 7920 6973 2066 6f72 6365 6420  uency is forced 
+00018280: 746f 2062 6520 7a65 726f 2e22 290a 2020  to be zero.").  
+00018290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182a0: 2020 7072 696e 7428 223d 2220 2a20 3631    print("=" * 61
+000182b0: 290a 0a20 2020 2064 6566 205f 6578 7472  )..    def _extr
+000182c0: 6163 745f 6663 325f 6663 335f 6361 6c63  act_fc2_fc3_calc
+000182d0: 756c 6174 6f72 7328 7365 6c66 2c20 6663  ulators(self, fc
+000182e0: 5f63 616c 6375 6c61 746f 722c 2066 635f  _calculator, fc_
+000182f0: 6361 6c63 756c 6174 6f72 5f6f 7074 696f  calculator_optio
+00018300: 6e73 2c20 6f72 6465 7229 3a0a 2020 2020  ns, order):.    
+00018310: 2020 2020 2222 2245 7874 7261 6374 2066      """Extract f
+00018320: 635f 6361 6c63 756c 6174 6f72 2061 6e64  c_calculator and
+00018330: 2066 635f 6361 6c63 756c 6174 6f72 5f6f   fc_calculator_o
+00018340: 7074 696f 6e73 2066 6f72 2066 6332 2061  ptions for fc2 a
+00018350: 6e64 2066 6333 2e0a 0a20 2020 2020 2020  nd fc3...       
+00018360: 2066 635f 6361 6c63 756c 6174 6f72 203a   fc_calculator :
+00018370: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
+00018380: 2046 4320 6361 6c63 756c 6174 6f72 2e20   FC calculator. 
+00018390: 227c 2220 7365 7061 7261 7465 7320 6663  "|" separates fc
+000183a0: 3220 616e 6420 6663 332e 2046 6972 7374  2 and fc3. First
+000183b0: 2061 6e64 206c 6173 740a 2020 2020 2020   and last.      
+000183c0: 2020 2020 2020 7061 7274 7320 7365 7061        parts sepa
+000183d0: 7261 7465 6420 636f 7272 6573 706f 6e64  rated correspond
+000183e0: 2074 6f20 6663 3220 616e 6420 6663 3320   to fc2 and fc3 
+000183f0: 6361 6c63 756c 6174 6f72 732c 2072 6573  calculators, res
+00018400: 7065 6374 6976 656c 792e 0a20 2020 2020  pectively..     
+00018410: 2020 2066 635f 6361 6c63 756c 6174 6f72     fc_calculator
+00018420: 5f6f 7074 696f 6e73 203a 2073 7472 0a20  _options : str. 
+00018430: 2020 2020 2020 2020 2020 2046 4320 6361             FC ca
+00018440: 6c63 756c 6174 6f72 206f 7074 696f 6e73  lculator options
+00018450: 2e20 227c 2220 7365 7061 7261 7465 7320  . "|" separates 
+00018460: 6663 3220 616e 6420 6663 332e 2046 6972  fc2 and fc3. Fir
+00018470: 7374 2061 6e64 206c 6173 740a 2020 2020  st and last.    
+00018480: 2020 2020 2020 2020 7061 7274 7320 7365          parts se
+00018490: 7061 7261 7465 6420 636f 7272 6573 706f  parated correspo
+000184a0: 6e64 2074 6f20 6663 3220 616e 6420 6663  nd to fc2 and fc
+000184b0: 3320 6f70 7469 6f6e 732c 2072 6573 7065  3 options, respe
+000184c0: 6374 6976 656c 792e 0a20 2020 2020 2020  ctively..       
+000184d0: 206f 7264 6572 203a 2069 6e74 203d 2032   order : int = 2
+000184e0: 206f 7220 330a 2020 2020 2020 2020 2020   or 3.          
+000184f0: 2020 3220 616e 6420 3320 696e 6469 6361    2 and 3 indica
+00018500: 7465 2066 6332 2061 6e64 2066 6333 2c20  te fc2 and fc3, 
+00018510: 7265 7370 6563 7469 7665 6c79 2e0a 0a20  respectively... 
+00018520: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00018530: 2020 2069 6620 6663 5f63 616c 6375 6c61     if fc_calcula
+00018540: 746f 7220 6973 206e 6f74 204e 6f6e 653a  tor is not None:
+00018550: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00018560: 227c 2220 696e 2066 635f 6361 6c63 756c  "|" in fc_calcul
+00018570: 6174 6f72 3a0a 2020 2020 2020 2020 2020  ator:.          
+00018580: 2020 2020 2020 5f66 635f 6361 6c63 756c        _fc_calcul
+00018590: 6174 6f72 203d 2066 635f 6361 6c63 756c  ator = fc_calcul
+000185a0: 6174 6f72 2e73 706c 6974 2822 7c22 295b  ator.split("|")[
+000185b0: 6f72 6465 7220 2d20 325d 0a20 2020 2020  order - 2].     
+000185c0: 2020 2020 2020 2020 2020 2069 6620 5f66             if _f
+000185d0: 635f 6361 6c63 756c 6174 6f72 203d 3d20  c_calculator == 
+000185e0: 2222 3a0a 2020 2020 2020 2020 2020 2020  "":.            
+000185f0: 2020 2020 2020 2020 5f66 635f 6361 6c63          _fc_calc
+00018600: 756c 6174 6f72 203d 204e 6f6e 650a 2020  ulator = None.  
+00018610: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00018620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018630: 5f66 635f 6361 6c63 756c 6174 6f72 203d  _fc_calculator =
+00018640: 2066 635f 6361 6c63 756c 6174 6f72 0a20   fc_calculator. 
+00018650: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00018660: 2020 2020 2020 2020 205f 6663 5f63 616c           _fc_cal
+00018670: 6375 6c61 746f 7220 3d20 4e6f 6e65 0a0a  culator = None..
+00018680: 2020 2020 2020 2020 6966 2066 635f 6361          if fc_ca
+00018690: 6c63 756c 6174 6f72 5f6f 7074 696f 6e73  lculator_options
+000186a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000186b0: 2020 2020 2020 2020 2020 6966 2022 7c22            if "|"
+000186c0: 2069 6e20 6663 5f63 616c 6375 6c61 746f   in fc_calculato
+000186d0: 725f 6f70 7469 6f6e 733a 0a20 2020 2020  r_options:.     
+000186e0: 2020 2020 2020 2020 2020 205f 6663 5f63             _fc_c
+000186f0: 616c 6375 6c61 746f 725f 6f70 7469 6f6e  alculator_option
+00018700: 7320 3d20 6663 5f63 616c 6375 6c61 746f  s = fc_calculato
+00018710: 725f 6f70 7469 6f6e 732e 7370 6c69 7428  r_options.split(
+00018720: 227c 2229 5b6f 7264 6572 202d 2032 5d0a  "|")[order - 2].
+00018730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018740: 6966 205f 6663 5f63 616c 6375 6c61 746f  if _fc_calculato
+00018750: 725f 6f70 7469 6f6e 7320 3d3d 2022 223a  r_options == "":
+00018760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018770: 2020 2020 205f 6663 5f63 616c 6375 6c61       _fc_calcula
+00018780: 746f 725f 6f70 7469 6f6e 7320 3d20 4e6f  tor_options = No
+00018790: 6e65 0a20 2020 2020 2020 2020 2020 2065  ne.            e
+000187a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000187b0: 2020 2020 205f 6663 5f63 616c 6375 6c61       _fc_calcula
+000187c0: 746f 725f 6f70 7469 6f6e 7320 3d20 6663  tor_options = fc
+000187d0: 5f63 616c 6375 6c61 746f 725f 6f70 7469  _calculator_opti
+000187e0: 6f6e 730a 2020 2020 2020 2020 656c 7365  ons.        else
+000187f0: 3a0a 2020 2020 2020 2020 2020 2020 5f66  :.            _f
+00018800: 635f 6361 6c63 756c 6174 6f72 5f6f 7074  c_calculator_opt
+00018810: 696f 6e73 203d 204e 6f6e 650a 0a20 2020  ions = None..   
+00018820: 2020 2020 2072 6574 7572 6e20 5f66 635f       return _fc_
+00018830: 6361 6c63 756c 6174 6f72 2c20 5f66 635f  calculator, _fc_
+00018840: 6361 6c63 756c 6174 6f72 5f6f 7074 696f  calculator_optio
+00018850: 6e73 0a                                  ns.
```

### Comparing `phono3py-2.6.0/phono3py/conductivity/base.py` & `phono3py-2.7.0/phono3py/conductivity/base.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/conductivity/direct_solution.py` & `phono3py-2.7.0/phono3py/conductivity/direct_solution.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/conductivity/kubo.py` & `phono3py-2.7.0/phono3py/conductivity/kubo.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/conductivity/rta.py` & `phono3py-2.7.0/phono3py/conductivity/rta.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/conductivity/utils.py` & `phono3py-2.7.0/phono3py/conductivity/utils.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/conductivity/wigner.py` & `phono3py-2.7.0/phono3py/conductivity/wigner.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/cui/create_force_constants.py` & `phono3py-2.7.0/phono3py/cui/create_force_constants.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/cui/create_supercells.py` & `phono3py-2.7.0/phono3py/cui/create_supercells.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/cui/kaccum_script.py` & `phono3py-2.7.0/phono3py/cui/kaccum_script.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/cui/load.py` & `phono3py-2.7.0/phono3py/cui/load.py`

 * *Files 6% similar despite different names*

```diff
@@ -28,17 +28,19 @@
 # INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 # BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 # LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 # CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 # LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 # ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
+from __future__ import annotations
 
 import os
-from typing import Optional
+from collections.abc import Sequence
+from typing import Optional, Union
 
 import numpy as np
 import phonopy.cui.load_helper as load_helper
 from phonopy.harmonic.force_constants import show_drift_force_constants
 from phonopy.interface.calculator import get_default_physical_units
 from phonopy.structure.cells import determinant
 
@@ -58,16 +60,16 @@
     calculator=None,
     unitcell=None,
     supercell=None,
     nac_params=None,
     unitcell_filename=None,
     supercell_filename=None,
     born_filename=None,
-    forces_fc3_filename=None,
-    forces_fc2_filename=None,
+    forces_fc3_filename: Optional[Union[os.PathLike, Sequence]] = None,
+    forces_fc2_filename: Optional[Union[os.PathLike, Sequence]] = None,
     fc3_filename=None,
     fc2_filename=None,
     fc_calculator=None,
     fc_calculator_options=None,
     factor=None,
     produce_fc=True,
     is_symmetry=True,
@@ -177,36 +179,36 @@
         Parameters required for non-analytical term correction. Default is
         None.
         {'born': Born effective charges
                  (array_like, shape=(primitive cell atoms, 3, 3), dtype=float),
          'dielectric': Dielectric constant matrix
                        (array_like, shape=(3, 3), dtype=float),
          'factor': unit conversion facotr (float)}
-    unitcell_filename : str, optional
+    unitcell_filename : os.PathLike, optional
         Input unit cell filename. Default is None.
-    supercell_filename : str, optional
+    supercell_filename : os.PathLike, optional
         Input supercell filename. When this is specified, supercell_matrix is
         ignored. Default is None.
-    born_filename : str, optional
+    born_filename : os.PathLike, optional
         Filename corresponding to 'BORN', a file contains non-analytical term
         correction parameters.
-    forces_fc3_filename : sequence or str, optional
+    forces_fc3_filename : sequence or os.PathLike, optional
         A two-elemental sequence of filenames corresponding to
         ('FORCES_FC3', 'disp_fc3.yaml') in the type-1 format or a filename
-        (str) corresponding to 'FORCES_FC3' in the type-2 format.
+        (os.PathLike) corresponding to 'FORCES_FC3' in the type-2 format.
         Default is None.
-    forces_fc2_filename : str or tuple, optional
+    forces_fc2_filename : os.PathLike or sequence, optional
         A two-elemental sequence of filenames corresponding to
         ('FORCES_FC2', 'disp_fc2.yaml') in the type-1 format or a filename
-        (str) corresponding to 'FORCES_FC2' in the type-2 format.
+        (os.PathLike) corresponding to 'FORCES_FC2' in the type-2 format.
         Default is None.
-    fc3_filename : str, optional
+    fc3_filename : os.PathLike, optional
         Filename of a file corresponding to 'fc3.hdf5', a file contains
         third-order force constants. Default is None.
-    fc2_filename : str, optional
+    fc2_filename : os.PathLike, optional
         Filename of a file corresponding to 'fc2.hdf5', a file contains
         second-order force constants. Default is None.
     fc_calculator : str, optional
         Force constants calculator. Currently only 'alm'. Default is None.
     fc_calculator_options : str, optional
         Optional parameters that are passed to the external fc-calculator.
         This is given as one text string. How to parse this depends on the
@@ -234,17 +236,17 @@
         and for fc2
             True: (primitive, supecell, 3, 3)
             False: (supercell, supecell, 3, 3)
         where 'supercell' and 'primitive' indicate number of atoms in these
         cells. Default is False.
     use_grg : bool, optional
         Use generalized regular grid when True. Default is False.
-    store_dense_gp_map : bool, optional
+    store_dense_gp_map : bool, optional, Deprecated
         Use new format of BZ grid system. Default is True.
-    store_dense_svecs : bool, optional
+    store_dense_svecs : bool, optional, Deprecated
         Shortest vectors are stored in the dense array format. This is
         expected to be always True. Setting False is for rough
         compatibility with v1.x. Default is True.
     symprec : float, optional
         Tolerance used to find crystal symmetry. Default is 1e-5.
     log_level : int, optional
         Verbosity control. Default is 0.
@@ -335,300 +337,311 @@
         ph3py,
         ph3py_yaml,
         fc3_filename=fc3_filename,
         fc2_filename=fc2_filename,
         forces_fc3_filename=forces_fc3_filename,
         forces_fc2_filename=forces_fc2_filename,
         phono3py_yaml_filename=phono3py_yaml,
-        fc_calculator=fc_calculator,
-        fc_calculator_options=fc_calculator_options,
-        produce_fc=produce_fc,
-        symmetrize_fc=symmetrize_fc,
-        is_compact_fc=is_compact_fc,
         log_level=log_level,
     )
 
+    if produce_fc:
+        compute_force_constants_from_datasets(
+            ph3py=ph3py,
+            fc_calculator=fc_calculator,
+            fc_calculator_options=fc_calculator_options,
+            symmetrize_fc=symmetrize_fc,
+            is_compact_fc=is_compact_fc,
+            log_level=log_level,
+        )
+
+    if log_level and ph3py.fc3 is not None:
+        show_drift_fc3(ph3py.fc3, primitive=ph3py.primitive)
+    if log_level and ph3py.fc2 is not None:
+        show_drift_force_constants(
+            ph3py.fc2, primitive=ph3py.phonon_primitive, name="fc2"
+        )
+
     return ph3py
 
 
 def set_dataset_and_force_constants(
     ph3py: Phono3py,
     ph3py_yaml: Optional[Phono3pyYaml] = None,
-    fc3_filename=None,
-    fc2_filename=None,
-    forces_fc3_filename=None,
-    forces_fc2_filename=None,
-    phono3py_yaml_filename=None,
-    fc_calculator=None,
-    fc_calculator_options=None,
-    produce_fc=True,
-    symmetrize_fc=True,
-    is_compact_fc=False,
-    cutoff_pair_distance=None,
-    log_level=0,
+    fc3_filename: Optional[os.PathLike] = None,
+    fc2_filename: Optional[os.PathLike] = None,
+    forces_fc3_filename: Optional[Union[os.PathLike, Sequence]] = None,
+    forces_fc2_filename: Optional[Union[os.PathLike, Sequence]] = None,
+    phono3py_yaml_filename: Optional[os.PathLike] = None,
+    cutoff_pair_distance: Optional[float] = None,
+    log_level: int = 0,
 ):
     """Set displacements, forces, and create force constants."""
     read_fc = {"fc2": False, "fc3": False}
+    read_fc["fc3"] = _set_dataset_or_fc3(
+        ph3py,
+        ph3py_yaml=ph3py_yaml,
+        fc3_filename=fc3_filename,
+        forces_fc3_filename=forces_fc3_filename,
+        phono3py_yaml_filename=phono3py_yaml_filename,
+        cutoff_pair_distance=cutoff_pair_distance,
+        log_level=log_level,
+    )
+    read_fc["fc2"] = _set_dataset_phonon_dataset_or_fc2(
+        ph3py,
+        ph3py_yaml=ph3py_yaml,
+        fc2_filename=fc2_filename,
+        forces_fc2_filename=forces_fc2_filename,
+        log_level=log_level,
+    )
+
+    # Cases that dataset is in phono3py.yaml but not forces.
+    if ph3py.dataset is None:
+        if ph3py_yaml is not None and ph3py_yaml.dataset is not None:
+            ph3py.dataset = ph3py_yaml.dataset
+        if ph3py_yaml is not None and ph3py_yaml.phonon_dataset is not None:
+            ph3py.phonon_dataset = ph3py_yaml.phonon_dataset
+
+    return read_fc
+
+
+def compute_force_constants_from_datasets(
+    ph3py: Phono3py,
+    fc_calculator: Optional[str] = None,
+    fc_calculator_options: Optional[dict] = None,
+    symmetrize_fc: bool = True,
+    is_compact_fc: bool = True,
+    log_level: int = 0,
+):
+    """Compute force constants from datasets."""
+    if ph3py.dataset:
+        ph3py.produce_fc3(
+            symmetrize_fc3r=symmetrize_fc,
+            is_compact_fc=is_compact_fc,
+            fc_calculator=fc_calculator,
+            fc_calculator_options=fc_calculator_options,
+        )
+        if log_level and symmetrize_fc:
+            print("fc3 was symmetrized.")
+
+    if ph3py.dataset or ph3py.phonon_dataset:
+        if (
+            ph3py.phonon_supercell_matrix is None
+            and fc_calculator == "alm"
+            and ph3py.fc2 is not None
+        ):
+            if log_level:
+                print("fc2 that was fit simultaneously with fc3 by ALM is used.")
+        else:
+            ph3py.produce_fc2(
+                symmetrize_fc2=symmetrize_fc,
+                is_compact_fc=is_compact_fc,
+                fc_calculator=fc_calculator,
+                fc_calculator_options=fc_calculator_options,
+            )
+            if log_level and symmetrize_fc:
+                print("fc2 was symmetrized.")
+
+
+def _set_dataset_or_fc3(
+    ph3py: Phono3py,
+    ph3py_yaml: Optional[Phono3pyYaml] = None,
+    fc3_filename: Optional[os.PathLike] = None,
+    forces_fc3_filename: Optional[Union[os.PathLike, Sequence]] = None,
+    phono3py_yaml_filename: Optional[os.PathLike] = None,
+    cutoff_pair_distance: Optional[float] = None,
+    log_level: int = 0,
+) -> bool:
     p2s_map = ph3py.primitive.p2s_map
-    phonon_p2s_map = ph3py.phonon_primitive.p2s_map
+    read_fc3 = False
     if fc3_filename is not None:
         fc3 = read_fc3_from_hdf5(filename=fc3_filename, p2s_map=p2s_map)
         _check_fc3_shape(ph3py, fc3, filename=fc3_filename)
         ph3py.fc3 = fc3
-        read_fc["fc3"] = True
+        read_fc3 = True
         if log_level:
             print('fc3 was read from "%s".' % fc3_filename)
     elif forces_fc3_filename is not None:
-        if type(forces_fc3_filename) is str:
+        if isinstance(forces_fc3_filename, os.PathLike):
             force_filename = forces_fc3_filename
             disp_filename = None
         else:
             force_filename, disp_filename = forces_fc3_filename
-        _set_forces_fc3(
+        _set_dataset_for_fc3(
             ph3py,
             ph3py_yaml,
             force_filename,
             disp_filename,
             phono3py_yaml_filename,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             cutoff_pair_distance,
             log_level,
         )
     elif os.path.isfile("fc3.hdf5"):
         fc3 = read_fc3_from_hdf5(filename="fc3.hdf5", p2s_map=p2s_map)
         _check_fc3_shape(ph3py, fc3)
         ph3py.fc3 = fc3
-        read_fc["fc3"] = True
+        read_fc3 = True
         if log_level:
             print('fc3 was read from "fc3.hdf5".')
     elif os.path.isfile("FORCES_FC3"):
         disp_filename = None
         if os.path.isfile("disp_fc3.yaml"):
             if ph3py_yaml is None:
                 disp_filename = "disp_fc3.yaml"
             elif ph3py_yaml.dataset is None:
                 disp_filename = "disp_fc3.yaml"
-        _set_forces_fc3(
+        _set_dataset_for_fc3(
             ph3py,
             ph3py_yaml,
             "FORCES_FC3",
             disp_filename,
             phono3py_yaml_filename,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             cutoff_pair_distance,
             log_level,
         )
     elif (
         ph3py_yaml is not None
         and ph3py_yaml.dataset is not None
         and forces_in_dataset(ph3py_yaml.dataset)
     ):
-        _set_forces_fc3(
+        _set_dataset_for_fc3(
             ph3py,
             ph3py_yaml,
             None,
             None,
             phono3py_yaml_filename,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             cutoff_pair_distance,
             log_level,
         )
+    return read_fc3
 
-    if log_level and ph3py.fc3 is not None:
-        show_drift_fc3(ph3py.fc3, primitive=ph3py.primitive)
 
+def _set_dataset_phonon_dataset_or_fc2(
+    ph3py: Phono3py,
+    ph3py_yaml: Optional[Phono3pyYaml] = None,
+    fc2_filename: Optional[os.PathLike] = None,
+    forces_fc2_filename: Optional[Union[os.PathLike, Sequence]] = None,
+    log_level: int = 0,
+) -> bool:
+    phonon_p2s_map = ph3py.phonon_primitive.p2s_map
+    read_fc2 = False
     if fc2_filename is not None:
         fc2 = read_fc2_from_hdf5(filename=fc2_filename, p2s_map=phonon_p2s_map)
         _check_fc2_shape(ph3py, fc2, filename=fc2_filename)
         ph3py.fc2 = fc2
-        read_fc["fc2"] = True
+        read_fc2 = True
         if log_level:
             print('fc2 was read from "%s".' % fc2_filename)
     elif forces_fc2_filename is not None:
-        if type(forces_fc2_filename) is str:
+        if isinstance(forces_fc2_filename, os.PathLike):
             force_filename = forces_fc2_filename
             disp_filename = None
         else:
             force_filename, disp_filename = forces_fc2_filename
-        _set_forces_fc2(
+        _set_dataset_for_fc2(
             ph3py,
             ph3py_yaml,
             force_filename,
             disp_filename,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             "phonon_fc2",
             log_level,
         )
     elif os.path.isfile("fc2.hdf5"):
         fc2 = read_fc2_from_hdf5(filename="fc2.hdf5", p2s_map=phonon_p2s_map)
         _check_fc2_shape(ph3py, fc2)
         ph3py.fc2 = fc2
-        read_fc["fc2"] = True
+        read_fc2 = True
         if log_level:
             print('fc2 was read from "fc2.hdf5".')
     elif os.path.isfile("FORCES_FC2"):
         disp_filename = None
         if os.path.isfile("disp_fc2.yaml"):
             if ph3py_yaml is None:
                 disp_filename = "disp_fc2.yaml"
             elif ph3py_yaml.phonon_dataset is None:
                 disp_filename = "disp_fc2.yaml"
-        _set_forces_fc2(
+        _set_dataset_for_fc2(
             ph3py,
             ph3py_yaml,
             "FORCES_FC2",
             disp_filename,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             "phonon_fc2",
             log_level,
         )
     elif (
-        ph3py.phonon_supercell_matrix is None
-        and fc_calculator == "alm"
-        and ph3py.fc2 is not None
-    ):
-        if log_level:
-            print("fc2 that was fit simultaneously with fc3 by ALM is used.")
-    elif (
         ph3py_yaml is not None
         and ph3py_yaml.phonon_dataset is not None
         and forces_in_dataset(ph3py_yaml.phonon_dataset)
     ):
-        _set_forces_fc2(
+        _set_dataset_for_fc2(
             ph3py,
             ph3py_yaml,
             None,
             None,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             "phonon_fc2",
             log_level,
         )
     elif (
         ph3py_yaml is not None
         and ph3py_yaml.dataset is not None
         and forces_in_dataset(ph3py_yaml.dataset)
     ):
-        _set_forces_fc2(
+        _set_dataset_for_fc2(
             ph3py,
             ph3py_yaml,
             None,
             None,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             "fc2",
             log_level,
         )
     elif os.path.isfile("FORCES_FC3"):
         # suppose fc3.hdf5 is read but fc2.hdf5 doesn't exist.
         disp_filename = None
         if os.path.isfile("disp_fc3.yaml"):
             if ph3py_yaml is None:
                 disp_filename = "disp_fc3.yaml"
             elif ph3py_yaml.dataset is None:
                 disp_filename = "disp_fc3.yaml"
-        _set_forces_fc2(
+        _set_dataset_for_fc2(
             ph3py,
             ph3py_yaml,
             "FORCES_FC3",
             disp_filename,
-            produce_fc,
-            symmetrize_fc,
-            is_compact_fc,
-            fc_calculator,
-            fc_calculator_options,
             "fc2",
             log_level,
         )
-    if log_level and ph3py.fc2 is not None:
-        show_drift_force_constants(
-            ph3py.fc2, primitive=ph3py.phonon_primitive, name="fc2"
-        )
+    return read_fc2
 
-    # Cases that dataset is in phono3py.yaml but not forces.
-    if ph3py.dataset is None:
-        if ph3py_yaml is not None and ph3py_yaml.dataset is not None:
-            ph3py.dataset = ph3py_yaml.dataset
-        if ph3py_yaml is not None and ph3py_yaml.phonon_dataset is not None:
-            ph3py.phonon_dataset = ph3py_yaml.phonon_dataset
 
-    return read_fc
-
-
-def _set_forces_fc3(
+def _set_dataset_for_fc3(
     ph3py: Phono3py,
     ph3py_yaml: Optional[Phono3pyYaml],
     force_filename,
     disp_filename,
     phono3py_yaml_filename,
-    produce_fc,
-    symmetrize_fc,
-    is_compact_fc,
-    fc_calculator,
-    fc_calculator_options,
     cutoff_pair_distance,
     log_level,
 ):
     ph3py.dataset = parse_forces(
         ph3py,
         ph3py_yaml=ph3py_yaml,
         cutoff_pair_distance=cutoff_pair_distance,
         force_filename=force_filename,
         disp_filename=disp_filename,
         phono3py_yaml_filename=phono3py_yaml_filename,
         fc_type="fc3",
         log_level=log_level,
     )
-    if produce_fc:
-        ph3py.produce_fc3(
-            symmetrize_fc3r=symmetrize_fc,
-            is_compact_fc=is_compact_fc,
-            fc_calculator=fc_calculator,
-            fc_calculator_options=fc_calculator_options,
-        )
-        if log_level and symmetrize_fc:
-            print("fc3 was symmetrized.")
 
 
-def _set_forces_fc2(
+def _set_dataset_for_fc2(
     ph3py: Phono3py,
     ph3py_yaml: Optional[Phono3pyYaml],
     force_filename,
     disp_filename,
-    produce_fc,
-    symmetrize_fc,
-    is_compact_fc,
-    fc_calculator,
-    fc_calculator_options,
     fc_type,
     log_level,
 ):
     dataset = parse_forces(
         ph3py,
         ph3py_yaml=ph3py_yaml,
         force_filename=force_filename,
@@ -637,24 +650,14 @@
         log_level=log_level,
     )
     if fc_type == "phonon_fc2":
         ph3py.phonon_dataset = dataset
     else:
         ph3py.dataset = dataset
 
-    if produce_fc:
-        ph3py.produce_fc2(
-            symmetrize_fc2=symmetrize_fc,
-            is_compact_fc=is_compact_fc,
-            fc_calculator=fc_calculator,
-            fc_calculator_options=fc_calculator_options,
-        )
-        if log_level and symmetrize_fc:
-            print("fc2 was symmetrized.")
-
 
 def _check_fc2_shape(ph3py: Phono3py, fc2, filename="fc2.hdf5"):
     if ph3py.phonon_supercell_matrix is None:
         smat = ph3py.supercell_matrix
     else:
         smat = ph3py.phonon_supercell_matrix
     _check_fc_shape(ph3py, fc2, smat, filename)
```

### Comparing `phono3py-2.6.0/phono3py/cui/phono3py_argparse.py` & `phono3py-2.7.0/phono3py/cui/phono3py_argparse.py`

 * *Files 0% similar despite different names*

```diff
@@ -248,16 +248,16 @@
             "--dim-fc2",
             nargs="+",
             dest="phonon_supercell_dimension",
             default=None,
             help="Supercell dimension for extra fc2",
         )
     parser.add_argument(
-        "--emulate-v1",
-        dest="emulate_v1",
+        "--emulate-v2",
+        dest="emulate_v2",
         action="store_true",
         default=False,
         help="Emulate v1.x grid system and shortest vectors.",
     )
     parser.add_argument(
         "--factor",
         dest="frequency_conversion_factor",
```

### Comparing `phono3py-2.6.0/phono3py/cui/phono3py_script.py` & `phono3py-2.7.0/phono3py/cui/phono3py_script.py`

 * *Files 2% similar despite different names*

```diff
@@ -50,27 +50,32 @@
     print_end,
     print_error,
     print_error_message,
     print_version,
     set_magnetic_moments,
     store_nac_params,
 )
+from phonopy.exception import ForceCalculatorRequiredError
 from phonopy.file_IO import is_file_phonopy_yaml, parse_FORCE_SETS, write_FORCE_SETS
+from phonopy.harmonic.force_constants import show_drift_force_constants
 from phonopy.interface.calculator import get_default_physical_units, get_force_sets
 from phonopy.phonon.band_structure import get_band_qpoints
 from phonopy.structure.cells import isclose as cells_isclose
 from phonopy.units import Bohr, Hartree, VaspToTHz
 
 from phono3py import Phono3py, Phono3pyIsotope, Phono3pyJointDos
 from phono3py.cui.create_force_constants import (
     create_phono3py_force_constants,
     get_fc_calculator_params,
 )
 from phono3py.cui.create_supercells import create_phono3py_supercells
-from phono3py.cui.load import set_dataset_and_force_constants
+from phono3py.cui.load import (
+    compute_force_constants_from_datasets,
+    set_dataset_and_force_constants,
+)
 from phono3py.cui.phono3py_argparse import get_parser
 from phono3py.cui.settings import Phono3pyConfParser
 from phono3py.cui.show_log import (
     show_general_settings,
     show_phono3py_cells,
     show_phono3py_settings,
 )
@@ -87,14 +92,15 @@
     write_FORCES_FC3,
     write_phonon_to_hdf5,
 )
 from phono3py.interface.phono3py_yaml import (
     Phono3pyYaml,
     displacements_yaml_lines_type1,
 )
+from phono3py.phonon3.fc3 import show_drift_fc3
 from phono3py.phonon3.gruneisen import run_gruneisen_parameters
 from phono3py.phonon.grid import get_grid_point_from_address, get_ir_grid_points
 from phono3py.version import __version__
 
 # import logging
 # logging.basicConfig()
 # logging.getLogger("phono3py.phonon3.fc3").setLevel(level=logging.DEBUG)
@@ -731,16 +737,14 @@
         primitive_matrix=cell_info["primitive_matrix"],
         phonon_supercell_matrix=cell_info["phonon_supercell_matrix"],
         cutoff_frequency=updated_settings["cutoff_frequency"],
         frequency_factor_to_THz=updated_settings["frequency_factor_to_THz"],
         is_symmetry=settings.is_symmetry,
         is_mesh_symmetry=settings.is_mesh_symmetry,
         use_grg=settings.use_grg,
-        store_dense_gp_map=(not settings.emulate_v1),
-        store_dense_svecs=(not settings.emulate_v1),
         symprec=symprec,
         calculator=interface_mode,
         log_level=log_level,
     )
     phono3py.masses = settings.masses
     phono3py.band_indices = settings.band_indices
     phono3py.sigmas = updated_settings["sigmas"]
@@ -787,27 +791,49 @@
 
         (fc_calculator, fc_calculator_options) = get_fc_calculator_params(settings)
 
         read_fc = set_dataset_and_force_constants(
             phono3py,
             ph3py_yaml=ph3py_yaml,
             phono3py_yaml_filename=phono3py_yaml_filename,
-            fc_calculator=fc_calculator,
-            fc_calculator_options=fc_calculator_options,
-            symmetrize_fc=settings.fc_symmetry,
-            is_compact_fc=settings.is_compact_fc,
             cutoff_pair_distance=settings.cutoff_pair_distance,
             log_level=log_level,
         )
 
+        try:
+            compute_force_constants_from_datasets(
+                ph3py=phono3py,
+                fc_calculator=fc_calculator,
+                fc_calculator_options=fc_calculator_options,
+                symmetrize_fc=settings.fc_symmetry,
+                is_compact_fc=settings.is_compact_fc,
+                log_level=log_level,
+            )
+        except ForceCalculatorRequiredError:
+            if log_level:
+                print("")
+                print(
+                    "Built-in force constants calculator doesn't support the "
+                    "dispalcements-forces dataset. "
+                    "An external force calculator, e.g., ALM (--alm), has to be used "
+                    "to compute force constants."
+                )
+
         if log_level:
             if phono3py.fc3 is None:
                 print("fc3 could not be obtained.")
+            else:
+                show_drift_fc3(phono3py.fc3, primitive=phono3py.primitive)
             if phono3py.fc2 is None:
                 print("fc2 could not be obtained.")
+            else:
+                show_drift_force_constants(
+                    phono3py.fc2, primitive=phono3py.phonon_primitive, name="fc2"
+                )
+
         if phono3py.fc3 is None or phono3py.fc2 is None:
             print_error()
             sys.exit(1)
 
         cutoff_distance = settings.cutoff_fc3_distance
         if cutoff_distance is not None and cutoff_distance > 0:
             if log_level:
@@ -914,15 +940,14 @@
         num_frequency_points=updated_settings["num_frequency_points"],
         num_points_in_batch=updated_settings["num_points_in_batch"],
         temperatures=updated_settings["temperature_points"],
         frequency_factor_to_THz=updated_settings["frequency_factor_to_THz"],
         frequency_scale_factor=updated_settings["frequency_scale_factor"],
         use_grg=settings.use_grg,
         is_mesh_symmetry=settings.is_mesh_symmetry,
-        store_dense_gp_map=(not settings.emulate_v1),
         symprec=phono3py.symmetry.tolerance,
         output_filename=output_filename,
         log_level=log_level,
     )
 
     if log_level > 0:
         dm = joint_dos.dynamical_matrix
@@ -948,15 +973,14 @@
         settings.mesh_numbers,
         phono3py.phonon_primitive,
         mass_variances=mass_variances,
         band_indices=band_indices,
         sigmas=updated_settings["sigmas"],
         frequency_factor_to_THz=updated_settings["frequency_factor_to_THz"],
         use_grg=settings.use_grg,
-        store_dense_gp_map=(not settings.emulate_v1),
         symprec=phono3py.symmetry.tolerance,
         cutoff_frequency=settings.cutoff_frequency,
         lapack_zheev_uplo=settings.lapack_zheev_uplo,
     )
     iso.init_dynamical_matrix(
         phono3py.fc2,
         phono3py.phonon_supercell,
@@ -1071,15 +1095,19 @@
 def main(**argparse_control):
     """Phono3py main part of command line interface."""
     # import warnings
 
     # warnings.simplefilter("error")
     load_phono3py_yaml = argparse_control.get("load_phono3py_yaml", False)
 
-    args, log_level = start_phono3py(**argparse_control)
+    if "args" in argparse_control:  # For pytest
+        args = argparse_control["args"]
+        log_level = args.log_level
+    else:
+        args, log_level = start_phono3py(**argparse_control)
 
     if load_phono3py_yaml:
         input_filename = None
         output_filename = None
         output_yaml_filename = args.output_yaml_filename
     else:
         (input_filename, output_filename) = get_input_output_filenames_from_args(args)
```

### Comparing `phono3py-2.6.0/phono3py/cui/settings.py` & `phono3py-2.7.0/phono3py/cui/settings.py`

 * *Files 0% similar despite different names*

```diff
@@ -87,15 +87,15 @@
         "pinv_cutoff": 1.0e-8,
         "pinv_solver": 0,
         "pinv_method": 0,
         "pp_conversion_factor": None,
         "scattering_event_class": None,  # scattering event class 1 or 2
         "sigma_cutoff_width": None,
         "solve_collective_phonon": False,
-        "emulate_v1": False,
+        "emulate_v2": False,
         "subtract_forces": None,
         "temperatures": None,
         "use_ave_pp": False,
         "use_grg": False,
         "write_collision": False,
         "write_gamma_detail": False,
         "write_gamma": False,
@@ -143,17 +143,17 @@
         """Set cutoff_fc3_distance."""
         self._v["cutoff_fc3_distance"] = val
 
     def set_cutoff_pair_distance(self, val):
         """Set cutoff_pair_distance."""
         self._v["cutoff_pair_distance"] = val
 
-    def set_emulate_v1(self, val):
-        """Set emulate_v1."""
-        self._v["emulate_v1"] = val
+    def set_emulate_v2(self, val):
+        """Set emulate_v2."""
+        self._v["emulate_v2"] = val
 
     def set_grid_addresses(self, val):
         """Set grid_addresses."""
         self._v["grid_addresses"] = val
 
     def set_grid_points(self, val):
         """Set grid_points."""
@@ -433,17 +433,17 @@
             if self._args.is_bterta:
                 self._confs["bterta"] = ".true."
 
         if "is_compact_fc" in self._args:
             if self._args.is_compact_fc:
                 self._confs["compact_fc"] = ".true."
 
-        if "emulate_v1" in self._args:
-            if self._args.emulate_v1:
-                self._confs["emulate_v1"] = ".true."
+        if "emulate_v2" in self._args:
+            if self._args.emulate_v2:
+                self._confs["emulate_v2"] = ".true."
 
         if "is_gruneisen" in self._args:
             if self._args.is_gruneisen:
                 self._confs["gruneisen"] = ".true."
 
         if "is_fc3_r0_average" in self._args:
             if self._args.is_fc3_r0_average:
@@ -651,15 +651,15 @@
                 "write_phonon",
                 "write_pp",
                 "write_LBTE_solution",
                 "full_pp",
                 "ion_clamped",
                 "bterta",
                 "compact_fc",
-                "emulate_v1",
+                "emulate_v2",
                 "fc3_r0_average",
                 "real_self_energy",
                 "gruneisen",
                 "imag_self_energy",
                 "isotope",
                 "joint_dos",
                 "lbte",
@@ -829,16 +829,16 @@
 
         # Cutoff distance between pairs of displaced atoms used for supercell
         # creation with displacements and making third-order force constants
         if "cutoff_pair_distance" in params:
             self._settings.set_cutoff_pair_distance(params["cutoff_pair_distance"])
 
         # Emulate v1.x grid system and shortest vectors.
-        if "emulate_v1" in params:
-            self._settings.set_emulate_v1(params["emulate_v1"])
+        if "emulate_v2" in params:
+            self._settings.set_emulate_v2(params["emulate_v2"])
 
         # Grid addresses (sets of three integer values)
         if "grid_addresses" in params:
             self._settings.set_grid_addresses(params["grid_addresses"])
 
         # Grid points
         if "grid_points" in params:
```

### Comparing `phono3py-2.6.0/phono3py/cui/show_log.py` & `phono3py-2.7.0/phono3py/cui/show_log.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/cui/triplets_info.py` & `phono3py-2.7.0/phono3py/cui/triplets_info.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/file_IO.py` & `phono3py-2.7.0/phono3py/file_IO.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/interface/alm.py` & `phono3py-2.7.0/phono3py/interface/alm.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/interface/calculator.py` & `phono3py-2.7.0/phono3py/interface/calculator.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/interface/fc_calculator.py` & `phono3py-2.7.0/phono3py/interface/fc_calculator.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/interface/phono3py_yaml.py` & `phono3py-2.7.0/phono3py/interface/phono3py_yaml.py`

 * *Files 1% similar despite different names*

```diff
@@ -101,14 +101,15 @@
             physical_units=physical_units,
         )
 
     def parse(self):
         """Yaml dict is parsed. See docstring of this class."""
         super().parse()
         self._parse_fc3_dataset()
+        return self
 
     def _parse_all_cells(self):
         """Parse all cells.
 
         This method override PhonopyYaml._parse_all_cells.
 
         """
@@ -259,18 +260,26 @@
         data1["second_atoms"] += disps
         return disp2_id
 
 
 class Phono3pyYamlDumper(PhonopyYamlDumper):
     """Phono3pyYaml dumper."""
 
-    def __init__(self, data: Phono3pyYamlData, dumper_settings):
+    _default_dumper_settings = {
+        "force_sets": False,
+        "displacements": True,
+        "force_constants": False,
+        "born_effective_charge": True,
+        "dielectric_constant": True,
+    }
+
+    def __init__(self, data: Phono3pyYamlData, dumper_settings=None):
         """Init method."""
         self._data = data
-        self._dumper_settings = dumper_settings
+        self._init_dumper_settings(dumper_settings)
 
     def _cell_info_yaml_lines(self):
         """Get YAML lines for information of cells.
 
         This method override PhonopyYaml._cell_info_yaml_lines.
 
         """
@@ -366,21 +375,14 @@
     4. Save stored data in Phono3pyYaml instance into a text file in yaml.
         with open(filename, 'w') as w:
             w.write(str(ph3py_yaml))
 
     """
 
     default_filenames = ("phono3py_disp.yaml", "phono3py.yaml")
-    _default_dumper_settings = {
-        "force_sets": False,
-        "displacements": True,
-        "force_constants": False,
-        "born_effective_charge": True,
-        "dielectric_constant": True,
-    }
     command_name = "phono3py"
 
     configuration = phonopy_yaml_property_factory("configuration")
     calculator = phonopy_yaml_property_factory("calculator")
     physical_units = phonopy_yaml_property_factory("physical_units")
     unitcell = phonopy_yaml_property_factory("unitcell")
     primitive = phonopy_yaml_property_factory("primitive")
@@ -406,29 +408,32 @@
     ):
         """Init method."""
         self._data = Phono3pyYamlData(
             configuration=configuration,
             calculator=calculator,
             physical_units=physical_units,
         )
-        self._init_dumper_settings(settings)
+        self._dumper_settings = settings
 
     def __str__(self):
         """Return string text of yaml output."""
-        ph3yml_dumper = Phono3pyYamlDumper(self._data, self._dumper_settings)
+        ph3yml_dumper = Phono3pyYamlDumper(
+            self._data, dumper_settings=self._dumper_settings
+        )
         return "\n".join(ph3yml_dumper.get_yaml_lines())
 
     def read(self, filename):
         """Read Phono3pyYaml file."""
         self._data = read_phono3py_yaml(
             filename,
             configuration=self._data.configuration,
             calculator=self._data.calculator,
             physical_units=self._data.physical_units,
         )
+        return self
 
     def set_phonon_info(self, phono3py: "Phono3py"):
         """Store data in Phono3py instance in this instance."""
         super().set_phonon_info(phono3py)
         self._data.phonon_supercell_matrix = phono3py.phonon_supercell_matrix
         self._data.phonon_dataset = phono3py.phonon_dataset
         self._data.phonon_primitive = phono3py.phonon_primitive
```

### Comparing `phono3py-2.6.0/phono3py/other/isotope.py` & `phono3py-2.7.0/phono3py/other/isotope.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/other/kaccum.py` & `phono3py-2.7.0/phono3py/other/kaccum.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/other/tetrahedron_method.py` & `phono3py-2.7.0/phono3py/other/tetrahedron_method.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon/func.py` & `phono3py-2.7.0/phono3py/phonon/func.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon/grid.py` & `phono3py-2.7.0/phono3py/phonon/grid.py`

 * *Files 6% similar despite different names*

```diff
@@ -32,14 +32,15 @@
 # LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 # ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
 from __future__ import annotations
 
 import warnings
+from collections.abc import Sequence
 from typing import Optional, Union
 
 import numpy as np
 from phonopy.structure.cells import (
     determinant,
     estimate_supercell_matrix,
     get_reduced_bases,
@@ -128,19 +129,19 @@
     microzone_lattice : ndarray
     gp_Gamma : int
 
     """
 
     def __init__(
         self,
-        mesh,
+        mesh: Union[int, float, Sequence, np.ndarray],
         reciprocal_lattice=None,
         lattice=None,
         symmetry_dataset: Optional[dict] = None,
-        transformation_matrix: Optional[Union[list, np.ndarray]] = None,
+        transformation_matrix: Optional[Union[Sequence, np.ndarray]] = None,
         is_shift: Optional[Union[list, np.ndarray]] = None,
         is_time_reversal: bool = True,
         use_grg: bool = False,
         force_SNF: bool = False,
         SNF_coordinates: str = "reciprocal",
         store_dense_gp_map: bool = True,
     ):
@@ -154,17 +155,17 @@
         lattice : array_like
             Direct primitive basis vectors given as row vectors shape=(3, 3),
             dtype='double', order='C'
         symmetry_dataset : dict, optional
             Symmetry dataset (Symmetry.dataset) searched for the primitive cell
             corresponding to ``reciprocal_lattice`` or ``lattice``.
         transformation_matrix : array_like, optional
-            Transformation matrix equivalent to ``transformation_matrix`` or
-            spglib-dataset. This is only used when ``use_grg=True``. Default is
-            None.
+            Transformation matrix equivalent to ``transformation_matrix`` in
+            spglib-dataset. This is only used when ``use_grg=True`` and
+            ``symmetry_dataset`` is unspecified. Default is None.
         is_shift : array_like or None, optional
             [0, 0, 0] (or [False, False, False]) gives Gamma center mesh and
             value 1 (or True) gives half mesh shift along the basis vectors.
             Default is None. dtype='int_', shape=(3,)
         is_time_reveral : bool, optional
             Inversion symmetry is included in reciprocal point group. Default is
             True.
@@ -522,16 +523,16 @@
     Q : ndarray
     grid_matrix : ndarray
 
     """
 
     def __init__(
         self,
-        mesh,
-        lattice,
+        mesh: Union[int, float, Sequence, np.ndarray],
+        lattice: Union[Sequence, np.ndarray],
         symmetry_dataset: Optional[dict] = None,
         transformation_matrix: Optional[Union[list, np.ndarray]] = None,
         use_grg: bool = True,
         force_SNF: bool = False,
         SNF_coordinates: str = "reciprocal",
     ) -> None:
         """Init method.
@@ -545,17 +546,17 @@
         lattice : array_like
             Primitive basis vectors in direct space given as row vectors.
             shape=(3, 3), dtype='double', order='C'
         symmetry_dataset : dict, optional
             Symmetry dataset of spglib (Symmetry.dataset) of primitive cell that
             has `lattice`. Default is None.
         transformation_matrix : array_like, optional
-            Transformation matrix equivalent to ``transformation_matrix`` or
-            spglib-dataset. This is only used when ``use_grg=True``. Default is
-            None.
+            Transformation matrix equivalent to ``transformation_matrix`` in
+            spglib-dataset. This is only used when ``use_grg=True`` and
+            ``symmetry_dataset`` is unspecified. Default is None.
         use_grg : bool, optional
             Use generalized regular grid. Default is False.
         force_SNF : bool, optional
             Enforce Smith normal form even when grid lattice of GR-grid is the
             same as the traditional grid lattice. Default is False.
         SNF_coordinates : str, optional
             `reciprocal` or `direct`. Space of coordinates to generate grid
@@ -619,23 +620,25 @@
         shape=(3, 3), dtype='int_', order='C'.
 
         """
         return self._Q
 
     def _set_mesh_numbers(
         self,
-        mesh,
-        use_grg=False,
-        symmetry_dataset=None,
-        transformation_matrix=None,
+        mesh: Union[int, float, Sequence, np.ndarray],
+        use_grg: bool = False,
+        symmetry_dataset: Optional[dict] = None,
+        transformation_matrix: Optional[Union[list, np.ndarray]] = None,
         force_SNF=False,
         coordinates="reciprocal",
-    ):
+    ) -> None:
         """Set mesh numbers from array or float value.
 
+        self._grid_matrix and self._D_diag can be set.
+
         Four cases:
         1) Three integers are given.
             Use these numbers as regular grid.
         2) One number is given with no symmetry provided.
             Regular grid is computed from this value. Grid is generated so that
             distances in reciprocal space between neighboring grid points become
             similar.
@@ -649,88 +652,116 @@
             of SNF and P and Q are set as identity matrices. Otherwise
             D, P, Q matrices are computed using SNF. Grid is generated so that
             basis vectors of supercell in direct space corresponding to this grid
             have similar lengths.
 
         """
         num_values = len(np.ravel(mesh))
-        if num_values == 1 or num_values == 9:
-            if num_values == 1:
-                length = float(mesh)
-                grid_matrix = None
-                _use_grg = use_grg
-            else:
-                length = None
-                grid_matrix = mesh
-                _use_grg = True
-            fall_back = True
-            if _use_grg:
-                if symmetry_dataset is None and transformation_matrix is None:
-                    msg = (
-                        "symmetry_dataset or transformation_matrix "
-                        "have to be specified."
-                    )
-                    raise RuntimeError(msg)
+        if num_values == 1:
+            length = float(mesh)
+            if use_grg:
+                found_grg = self._run_grg(
+                    symmetry_dataset,
+                    transformation_matrix,
+                    length,
+                    None,
+                    force_SNF,
+                    coordinates,
+                )
+            if not use_grg or not found_grg:
                 if symmetry_dataset is None:
-                    tmat_inv = np.linalg.inv(transformation_matrix)
-                    tmat_inv_int = np.rint(tmat_inv).astype(int)
-                    if (tmat_inv - tmat_inv_int > 1e-8).all():
-                        msg = (
-                            "Inverse of transformation matrix has to be an "
-                            "integer matrix."
-                        )
-                        raise RuntimeError(msg)
-                    if determinant(tmat_inv_int) < 0:
-                        msg = "Determinant of transformation matrix has to be positive."
-                        raise RuntimeError(msg)
-                    if determinant(tmat_inv_int) < 1:
-                        msg = (
-                            "Determinant of inverse of transformation matrix has to "
-                            "be equal to or larger than 1."
-                        )
-                        raise RuntimeError(msg)
-                    sym_dataset = {
-                        "rotations": np.eye(3, dtype="intc", order="C").reshape(
-                            1, 3, 3
-                        ),
-                        "transformation_matrix": transformation_matrix,
-                        "std_lattice": self._lattice,
-                        "std_types": np.array([1], dtype="intc"),
-                        "number": 1,
-                    }
-                else:
-                    sym_dataset = symmetry_dataset
-                if is_primitive_cell(sym_dataset["rotations"]):
-                    self._set_SNF(
-                        sym_dataset,
-                        length=length,
-                        grid_matrix=grid_matrix,
-                        force_SNF=force_SNF,
-                        coordinates=coordinates,
-                    )
-                    fall_back = False
+                    self._D_diag = length2mesh(length, self._lattice)
                 else:
-                    warnings.warn(
-                        "Non primitive cell input. Unable to use GR-grid.",
-                        RuntimeWarning,
+                    self._D_diag = length2mesh(
+                        length, self._lattice, rotations=symmetry_dataset["rotations"]
                     )
-            if fall_back:
-                self._D_diag = length2mesh(length, self._lattice)
-        elif num_values == 3:
+        if num_values == 9:
+            self._run_grg(
+                symmetry_dataset,
+                transformation_matrix,
+                None,
+                mesh,
+                force_SNF,
+                coordinates,
+            )
+        if num_values == 3:
             self._D_diag = np.array(mesh, dtype="int_")
 
-    def _set_SNF(
+    def _run_grg(
+        self,
+        symmetry_dataset,
+        transformation_matrix,
+        length,
+        grid_matrix,
+        force_SNF,
+        coordinates,
+    ) -> bool:
+        if symmetry_dataset is None and transformation_matrix is None:
+            msg = "symmetry_dataset or transformation_matrix has to be specified."
+            raise RuntimeError(msg)
+        if symmetry_dataset is not None:
+            sym_dataset = symmetry_dataset
+        else:  # transformation_matrix is not None
+            sym_dataset = self._get_mock_symmetry_dataset(transformation_matrix)
+        if is_primitive_cell(sym_dataset["rotations"]):
+            self._set_GRG_mesh(
+                sym_dataset,
+                length=length,
+                grid_matrix=grid_matrix,
+                force_SNF=force_SNF,
+                coordinates=coordinates,
+            )
+            return True
+
+        warnings.warn(
+            "Non primitive cell input. Unable to use GR-grid.",
+            RuntimeWarning,
+        )
+        return False
+
+    def _get_mock_symmetry_dataset(self, transformation_matrix) -> dict:
+        """Return mock symmetry_dataset containing transformation matrix.
+
+        Assuming self._lattice as standardized cell, and inverse of
+        trahsformation_matrix indicates original primitive lattice with respect
+        to self._lattice.
+
+        """
+        tmat_inv = np.linalg.inv(transformation_matrix)
+        tmat_inv_int = np.rint(tmat_inv).astype(int)
+        if (tmat_inv - tmat_inv_int > 1e-8).all():
+            msg = "Inverse of transformation matrix has to be an " "integer matrix."
+            raise RuntimeError(msg)
+        if determinant(tmat_inv_int) < 0:
+            msg = "Determinant of transformation matrix has to be positive."
+            raise RuntimeError(msg)
+        if determinant(tmat_inv_int) < 1:
+            msg = (
+                "Determinant of inverse of transformation matrix has to "
+                "be equal to or larger than 1."
+            )
+            raise RuntimeError(msg)
+        sym_dataset = {
+            "rotations": np.eye(3, dtype="intc", order="C").reshape(1, 3, 3),
+            "transformation_matrix": transformation_matrix,
+            "std_lattice": self._lattice,
+            "std_types": np.array([1], dtype="intc"),
+            "number": 1,
+        }
+        return sym_dataset
+
+    def _set_GRG_mesh(
         self,
         sym_dataset: dict,
         length: Optional[float] = None,
         grid_matrix=None,
         force_SNF=False,
         coordinates="reciprocal",
     ):
-        """Calculate Smith normal form.
+        """Set grid_matrix or D_diag with generalized regular grid.
 
         Microzone is defined as the regular grid of a conventional
         unit cell. To find the conventional unit cell, symmetry
         information is used.
 
         """
         if length is not None:
@@ -773,15 +804,16 @@
         coordinates : str, optional
             `reciprocal` (default) or `direct`.
 
         """
         tmat = sym_dataset["transformation_matrix"]
         conv_lat = np.dot(np.linalg.inv(tmat).T, self._lattice)
 
-        if can_use_std_lattice(
+        # GRG is wanted to be generated with respect to std_lattice if possible.
+        if _can_use_std_lattice(
             conv_lat,
             tmat,
             sym_dataset["std_lattice"],
             sym_dataset["rotations"],
         ):
             conv_lat = sym_dataset["std_lattice"]
             tmat = np.dot(self._lattice, np.linalg.inv(conv_lat)).T
@@ -802,33 +834,14 @@
         assert (np.abs(inv_tmat - inv_tmat_int) < 1e-5).all()
         grid_matrix = np.array(
             (inv_tmat_int * conv_mesh_numbers).T, dtype="int_", order="C"
         )
         return grid_matrix
 
 
-def can_use_std_lattice(conv_lat, tmat, std_lattice, rotations, symprec=1e-5):
-    """Inspect if std_lattice can be used as conv_lat.
-
-    r_s is the rotation matrix of conv_lat.
-    Return if conv_lat rotated by det(r_s)*r_s and std_lattice are equivalent.
-    det(r_s) is necessary to make improper rotation to proper rotation.
-
-    """
-    for r in rotations:
-        r_s = similarity_transformation(tmat, r)
-        if np.allclose(
-            np.linalg.det(r_s) * np.dot(np.transpose(conv_lat), r_s),
-            np.transpose(std_lattice),
-            atol=symprec,
-        ):
-            return True
-    return False
-
-
 def get_grid_point_from_address_py(addresses, D_diag):
     """Return GR-grid point index from addresses.
 
     Python version of get_grid_point_from_address.
     X runs first in XYZ
     In grid.c, Z first is possible with MACRO setting.
 
@@ -1183,7 +1196,26 @@
         np.array(grg_rotations, dtype="int_", order="C"),
     )
 
     if num_ir > 0:
         return ir_grid_map
     else:
         raise RuntimeError("_get_ir_grid_map failed to find ir-grid-points.")
+
+
+def _can_use_std_lattice(conv_lat, tmat, std_lattice, rotations, symprec=1e-5):
+    """Inspect if std_lattice can be used as conv_lat.
+
+    r_s is the rotation matrix of conv_lat.
+    Return if conv_lat rotated by det(r_s)*r_s and std_lattice are equivalent.
+    det(r_s) is necessary to make improper rotation to proper rotation.
+
+    """
+    for r in rotations:
+        r_s = similarity_transformation(tmat, r)
+        if np.allclose(
+            np.linalg.det(r_s) * np.dot(np.transpose(conv_lat), r_s),
+            np.transpose(std_lattice),
+            atol=symprec,
+        ):
+            return True
+    return False
```

### Comparing `phono3py-2.6.0/phono3py/phonon/group_velocity_matrix.py` & `phono3py-2.7.0/phono3py/phonon/group_velocity_matrix.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon/heat_capacity_matrix.py` & `phono3py-2.7.0/phono3py/phonon/heat_capacity_matrix.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon/solver.py` & `phono3py-2.7.0/phono3py/phonon/solver.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon/velocity_operator.py` & `phono3py-2.7.0/phono3py/phonon/velocity_operator.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/collision_matrix.py` & `phono3py-2.7.0/phono3py/phonon3/collision_matrix.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/dataset.py` & `phono3py-2.7.0/phono3py/phonon3/dataset.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/displacement_fc3.py` & `phono3py-2.7.0/phono3py/phonon3/displacement_fc3.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/fc3.py` & `phono3py-2.7.0/phono3py/phonon3/fc3.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/gruneisen.py` & `phono3py-2.7.0/phono3py/phonon3/gruneisen.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/imag_self_energy.py` & `phono3py-2.7.0/phono3py/phonon3/imag_self_energy.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/interaction.py` & `phono3py-2.7.0/phono3py/phonon3/interaction.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/joint_dos.py` & `phono3py-2.7.0/phono3py/phonon3/joint_dos.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/real_self_energy.py` & `phono3py-2.7.0/phono3py/phonon3/real_self_energy.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/real_to_reciprocal.py` & `phono3py-2.7.0/phono3py/phonon3/real_to_reciprocal.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/reciprocal_to_normal.py` & `phono3py-2.7.0/phono3py/phonon3/reciprocal_to_normal.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/spectral_function.py` & `phono3py-2.7.0/phono3py/phonon3/spectral_function.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/phonon3/triplets.py` & `phono3py-2.7.0/phono3py/phonon3/triplets.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/sscha/sscha.py` & `phono3py-2.7.0/phono3py/sscha/sscha.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/phono3py/version.py` & `phono3py-2.7.0/phono3py/version.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,8 +29,8 @@
 # BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 # LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 # CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 # LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 # ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 
-__version__ = "2.6.0"
+__version__ = "2.7.0"
```

### Comparing `phono3py-2.6.0/phono3py.egg-info/SOURCES.txt` & `phono3py-2.7.0/phono3py.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -117,14 +117,16 @@
 example/AlN-LDA/BORN
 example/AlN-LDA/FORCES_FC2
 example/AlN-LDA/FORCES_FC3.lzma
 example/AlN-LDA/POSCAR-unitcell
 example/AlN-LDA/README.md
 example/AlN-LDA/phono3py_disp.yaml
 example/AlN-LDA/phono3py_disp_dimfc2.yaml
+example/NaCl-alm/README.md
+example/NaCl-alm/phono3py_params_NaCl222.yaml.xz
 example/Si-CRYSTAL/FORCES_FC2
 example/Si-CRYSTAL/FORCES_FC3
 example/Si-CRYSTAL/README
 example/Si-CRYSTAL/TEMPLATE
 example/Si-CRYSTAL/TEMPLATE3
 example/Si-CRYSTAL/crystal.o
 example/Si-CRYSTAL/outputs.tar.gz
@@ -182,28 +184,32 @@
 scripts/phono3py-kdeplot
 scripts/phono3py-load
 test/AgNO2_cell.yaml
 test/BORN_NaCl
 test/FORCES_FC3_si_pbesol
 test/FORCE_SETS_NaCl
 test/conftest.py
+test/phono3py_params-Si111-rd.yaml.xz
 test/phono3py_params_AlN332.yaml.xz
 test/phono3py_params_NaCl111.yaml
 test/phono3py_params_NaCl222.yaml.xz
 test/phono3py_params_Si-111-222.yaml
 test/phono3py_params_Si111.yaml
 test/phono3py_si_pbesol.yaml
 test/phonopy_disp_NaCl.yaml
 test/phonopy_params-Si111-iterha.yaml.gz
 test/phonopy_params_Si.yaml
+test/api/test_api_phono3py.py
 test/conductivity/__init__.py
 test/conductivity/test_kappa_LBTE.py
 test/conductivity/test_kappa_LBTE_Wigner.py
 test/conductivity/test_kappa_RTA.py
 test/conductivity/test_kappa_RTA_Wigner.py
+test/cui/test_phono3py_load_script.py
+test/interface/test_phono3py_yaml.py
 test/other/__init__.py
 test/other/test_isotope.py
 test/other/test_kaccum.py
 test/phonon/__init__.py
 test/phonon/test_grid.py
 test/phonon/test_velocity_operator.py
 test/phonon3/__init__.py
```

### Comparing `phono3py-2.6.0/scripts/phono3py` & `phono3py-2.7.0/scripts/phono3py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/scripts/phono3py-coleigplot` & `phono3py-2.7.0/scripts/phono3py-coleigplot`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/scripts/phono3py-kaccum` & `phono3py-2.7.0/scripts/phono3py-kaccum`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/scripts/phono3py-kdeplot` & `phono3py-2.7.0/scripts/phono3py-kdeplot`

 * *Files 1% similar despite different names*

```diff
@@ -23,16 +23,16 @@
         _tau = np.extract(condition, tau)
         _freq = np.extract(condition, freq)
 
         if max_freq is None:
             freqs += list(_freq) * w
             mode_prop += list(_tau) * w
         else:
-            freqs += list(np.extract(freq < max_freq, freq))
-            mode_prop += list(np.extract(freq < max_freq, tau))
+            freqs += list(np.extract(freq < max_freq, freq)) * w
+            mode_prop += list(np.extract(freq < max_freq, tau)) * w
 
     x = np.array(freqs)
     y = np.array(mode_prop)
 
     return x, y
```

### Comparing `phono3py-2.6.0/scripts/phono3py-load` & `phono3py-2.7.0/scripts/phono3py-load`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/setup.py` & `phono3py-2.7.0/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -307,23 +307,23 @@
         name="phono3py",
         version=version,
         description="This is the phono3py module.",
         author="Atsushi Togo",
         author_email="atz.togo@gmail.com",
         url="http://phonopy.github.io/phono3py/",
         packages=packages_phono3py,
-        python_requires=">=3.7",
+        python_requires=">=3.8",
         install_requires=[
-            "numpy>=1.15.0",
+            "numpy>=1.17.0",
             "scipy",
-            "PyYAML",
+            "PyYAML>=5.3",
             "matplotlib>=2.2.2",
-            "h5py",
-            "spglib",
-            "phonopy>=2.18,<2.19",
+            "h5py>=3.0",
+            "spglib>=2.0",
+            "phonopy>=2.20,<2.21",
         ],
         provides=["phono3py"],
         scripts=scripts_phono3py,
         ext_modules=_get_extensions(build_dir),
     )
     _clean_cmake(build_dir)
```

### Comparing `phono3py-2.6.0/test/AgNO2_cell.yaml` & `phono3py-2.7.0/test/AgNO2_cell.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/FORCES_FC3_si_pbesol` & `phono3py-2.7.0/test/FORCES_FC3_si_pbesol`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/FORCE_SETS_NaCl` & `phono3py-2.7.0/test/FORCE_SETS_NaCl`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/conductivity/test_kappa_LBTE.py` & `phono3py-2.7.0/test/conductivity/test_kappa_LBTE.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/conductivity/test_kappa_LBTE_Wigner.py` & `phono3py-2.7.0/test/conductivity/test_kappa_LBTE_Wigner.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/conductivity/test_kappa_RTA.py` & `phono3py-2.7.0/test/conductivity/test_kappa_RTA.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/conductivity/test_kappa_RTA_Wigner.py` & `phono3py-2.7.0/test/conductivity/test_kappa_RTA_Wigner.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/conftest.py` & `phono3py-2.7.0/test/conftest.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,20 +1,21 @@
 """Pytest conftest.py."""
-import os
+from pathlib import Path
 
 import numpy as np
 import phonopy
 import pytest
 from phonopy import Phonopy
 from phonopy.interface.phonopy_yaml import read_cell_yaml
 from phonopy.structure.atoms import PhonopyAtoms
 
 import phono3py
+from phono3py import Phono3py
 
-current_dir = os.path.dirname(os.path.abspath(__file__))
+cwd = Path(__file__).parent
 store_dense_gp_map = True
 
 
 def pytest_addoption(parser):
     """Activate v1 emulation  with --v1 option."""
     parser.addoption(
         "--v1",
@@ -23,15 +24,15 @@
         help="Run with phono3py v1.x emulation.",
     )
 
 
 @pytest.fixture(scope="session")
 def agno2_cell() -> PhonopyAtoms:
     """Return AgNO2 cell (Imm2)."""
-    cell = read_cell_yaml(os.path.join(current_dir, "AgNO2_cell.yaml"))
+    cell = read_cell_yaml(cwd / "AgNO2_cell.yaml")
     return cell
 
 
 @pytest.fixture(scope="session")
 def aln_cell() -> PhonopyAtoms:
     """Return AlN cell (P6_3mc)."""
     a = 3.111
@@ -45,374 +46,374 @@
         [2.0 / 3, 1.0 / 3, 0.1190511800000000],
     ]
     cell = PhonopyAtoms(cell=lattice, symbols=symbols, scaled_positions=positions)
     return cell
 
 
 @pytest.fixture(scope="session")
-def si_pbesol(request):
+def si_pbesol(request) -> Phono3py:
     """Return Phono3py instance of Si 2x2x2.
 
     * with symmetry
     * full fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_si_pbesol.yaml")
-    forces_fc3_filename = os.path.join(current_dir, "FORCES_FC3_si_pbesol")
+    yaml_filename = cwd / "phono3py_si_pbesol.yaml"
+    forces_fc3_filename = cwd / "FORCES_FC3_si_pbesol"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         forces_fc3_filename=forces_fc3_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_grg(request):
+def si_pbesol_grg(request) -> Phono3py:
     """Return Phono3py instance of Si 2x2x2.
 
     * with symmetry
     * full fc
     * GR-grid
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_si_pbesol.yaml")
-    forces_fc3_filename = os.path.join(current_dir, "FORCES_FC3_si_pbesol")
+    yaml_filename = cwd / "phono3py_si_pbesol.yaml"
+    forces_fc3_filename = cwd / "FORCES_FC3_si_pbesol"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         forces_fc3_filename=forces_fc3_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         use_grg=True,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_nosym(request):
+def si_pbesol_nosym(request) -> Phono3py:
     """Return Phono3py instance of Si 2x2x2.
 
     * without symmetry
     * no fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_si_pbesol.yaml")
-    forces_fc3_filename = os.path.join(current_dir, "FORCES_FC3_si_pbesol")
+    yaml_filename = cwd / "phono3py_si_pbesol.yaml"
+    forces_fc3_filename = cwd / "FORCES_FC3_si_pbesol"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         forces_fc3_filename=forces_fc3_filename,
         is_symmetry=False,
         produce_fc=False,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_nomeshsym(request):
+def si_pbesol_nomeshsym(request) -> Phono3py:
     """Return Phono3py instance of Si 2x2x2.
 
     * without mesh-symmetry
     * no fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_si_pbesol.yaml")
-    forces_fc3_filename = os.path.join(current_dir, "FORCES_FC3_si_pbesol")
+    yaml_filename = cwd / "phono3py_si_pbesol.yaml"
+    forces_fc3_filename = cwd / "FORCES_FC3_si_pbesol"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         forces_fc3_filename=forces_fc3_filename,
         is_mesh_symmetry=False,
         produce_fc=False,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_compact_fc(request):
+def si_pbesol_compact_fc(request) -> Phono3py:
     """Return Phono3py instance of Si 2x2x2.
 
     * with symmetry
     * compact fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_si_pbesol.yaml")
-    forces_fc3_filename = os.path.join(current_dir, "FORCES_FC3_si_pbesol")
+    yaml_filename = cwd / "phono3py_si_pbesol.yaml"
+    forces_fc3_filename = cwd / "FORCES_FC3_si_pbesol"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         forces_fc3_filename=forces_fc3_filename,
         is_compact_fc=True,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111(request):
+def si_pbesol_111(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si111.yaml")
+    yaml_filename = cwd / "phono3py_params_Si111.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_alm(request):
+def si_pbesol_111_alm(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm if available on test side
 
     """
     pytest.importorskip("alm")
 
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si111.yaml")
+    yaml_filename = cwd / "phono3py_params_Si111.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         fc_calculator="alm",
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_iterha_111():
+def si_pbesol_iterha_111() -> Phonopy:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * no fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phonopy_params-Si111-iterha.yaml.gz")
+    yaml_filename = cwd / "phonopy_params-Si111-iterha.yaml.gz"
     return phonopy.load(yaml_filename, log_level=1, produce_fc=False)
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_222_fd(request):
+def si_pbesol_111_222_fd(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm if available on test side
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si-111-222.yaml")
+    yaml_filename = cwd / "phono3py_params_Si-111-222.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_222_alm(request):
+def si_pbesol_111_222_alm(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm if available on test side
 
     """
     pytest.importorskip("alm")
 
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si-111-222.yaml")
+    yaml_filename = cwd / "phono3py_params_Si-111-222.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         fc_calculator="alm",
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_222_alm_fd(request):
+def si_pbesol_111_222_alm_fd(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm for fc2 if available on test side
 
     """
     pytest.importorskip("alm")
 
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si-111-222.yaml")
+    yaml_filename = cwd / "phono3py_params_Si-111-222.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         fc_calculator="alm|",
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_222_fd_alm(request):
+def si_pbesol_111_222_fd_alm(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm for fc3 if available on test side
 
     """
     pytest.importorskip("alm")
 
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si-111-222.yaml")
+    yaml_filename = cwd / "phono3py_params_Si-111-222.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         fc_calculator="|alm",
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_222_alm_cutoff(request):
+def si_pbesol_111_222_alm_cutoff(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm if available on test side
     * cutoff=3
 
     """
     pytest.importorskip("alm")
 
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si-111-222.yaml")
+    yaml_filename = cwd / "phono3py_params_Si-111-222.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         fc_calculator="alm",
         fc_calculator_options="cutoff = 3",
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_222_alm_cutoff_fc2(request):
+def si_pbesol_111_222_alm_cutoff_fc2(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm if available on test side
     * cutoff=3 only for fc2
 
     """
     pytest.importorskip("alm")
 
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si-111-222.yaml")
+    yaml_filename = cwd / "phono3py_params_Si-111-222.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         fc_calculator="alm",
         fc_calculator_options="cutoff = 3|",
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def si_pbesol_111_222_alm_cutoff_fc3(request):
+def si_pbesol_111_222_alm_cutoff_fc3(request) -> Phono3py:
     """Return Phono3py instance of Si 1x1x1.
 
     * with symmetry
     * full fc
     * use alm if available on test side
     * cutoff=3 only for fc3
 
     """
     pytest.importorskip("alm")
 
-    yaml_filename = os.path.join(current_dir, "phono3py_params_Si-111-222.yaml")
+    yaml_filename = cwd / "phono3py_params_Si-111-222.yaml"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         fc_calculator="alm",
         fc_calculator_options="|cutoff = 3",
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def nacl_pbe(request):
+def nacl_pbe(request) -> Phono3py:
     """Return Phono3py instance of NaCl 2x2x2.
 
     * with symmetry
     * full fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_NaCl222.yaml.xz")
+    yaml_filename = cwd / "phono3py_params_NaCl222.yaml.xz"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def nacl_pbe_compact_fc(request):
+def nacl_pbe_compact_fc(request) -> Phono3py:
     """Return Phono3py instance of NaCl 2x2x2.
 
     * with symmetry
     * compact fc
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_NaCl222.yaml.xz")
+    yaml_filename = cwd / "phono3py_params_NaCl222.yaml.xz"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         is_compact_fc=True,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
-def nacl_pbe_cutoff_fc3(request):
+def nacl_pbe_cutoff_fc3(request) -> Phono3py:
     """Return Phono3py instance of NaCl 2x2x2 with cutoff-pair-distance.
 
     * cutoff pair with 5
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_NaCl222.yaml.xz")
+    yaml_filename = cwd / "phono3py_params_NaCl222.yaml.xz"
     enable_v2 = request.config.getoption("--v1")
     ph3 = phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         produce_fc=False,
         log_level=1,
@@ -431,22 +432,22 @@
     ph3.dataset = dataset
     ph3.produce_fc3()
     # ph3.produce_fc3(symmetrize_fc3r=True)
     return ph3
 
 
 @pytest.fixture(scope="session")
-def nacl_pbe_cutoff_fc3_all_forces(request):
+def nacl_pbe_cutoff_fc3_all_forces(request) -> Phono3py:
     """Return Phono3py instance of NaCl 2x2x2 with cutoff-pair-distance.
 
     * cutoff pair with 5
     * All forces are set.
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_NaCl222.yaml.xz")
+    yaml_filename = cwd / "phono3py_params_NaCl222.yaml.xz"
     enable_v2 = request.config.getoption("--v1")
     ph3 = phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         produce_fc=False,
         log_level=1,
@@ -455,23 +456,23 @@
     ph3.generate_displacements(cutoff_pair_distance=5)
     ph3.forces = forces
     ph3.produce_fc3()
     return ph3
 
 
 @pytest.fixture(scope="session")
-def nacl_pbe_cutoff_fc3_compact_fc(request):
+def nacl_pbe_cutoff_fc3_compact_fc(request) -> Phono3py:
     """Return Phono3py instance of NaCl 2x2x2 with cutoff-pair-distance.
 
     * cutoff pair with 5
     * All forces are set.
     * Compact FC
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_NaCl222.yaml.xz")
+    yaml_filename = cwd / "phono3py_params_NaCl222.yaml.xz"
     enable_v2 = request.config.getoption("--v1")
     ph3 = phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         produce_fc=False,
         log_level=1,
@@ -480,50 +481,50 @@
     ph3.generate_displacements(cutoff_pair_distance=5)
     ph3.forces = forces
     ph3.produce_fc3(is_compact_fc=True)
     return ph3
 
 
 @pytest.fixture(scope="session")
-def aln_lda(request):
+def aln_lda(request) -> Phono3py:
     """Return Phono3py instance of AlN 3x3x2.
 
     * with symmetry
     * full fc.
 
     """
-    yaml_filename = os.path.join(current_dir, "phono3py_params_AlN332.yaml.xz")
+    yaml_filename = cwd / "phono3py_params_AlN332.yaml.xz"
     enable_v2 = request.config.getoption("--v1")
     return phono3py.load(
         yaml_filename,
         store_dense_gp_map=enable_v2,
         store_dense_svecs=enable_v2,
         log_level=1,
     )
 
 
 @pytest.fixture(scope="session")
 def ph_nacl() -> Phonopy:
     """Return Phonopy class instance of NaCl 2x2x2."""
-    yaml_filename = os.path.join(current_dir, "phonopy_disp_NaCl.yaml")
-    force_sets_filename = os.path.join(current_dir, "FORCE_SETS_NaCl")
-    born_filename = os.path.join(current_dir, "BORN_NaCl")
+    yaml_filename = cwd / "phonopy_disp_NaCl.yaml"
+    force_sets_filename = cwd / "FORCE_SETS_NaCl"
+    born_filename = cwd / "BORN_NaCl"
     return phonopy.load(
         yaml_filename,
         force_sets_filename=force_sets_filename,
         born_filename=born_filename,
         is_compact_fc=False,
         log_level=1,
         produce_fc=True,
     )
 
 
 @pytest.fixture(scope="session")
 def ph_si() -> Phonopy:
     """Return Phonopy class instance of Si-prim 2x2x2."""
-    yaml_filename = os.path.join(current_dir, "phonopy_params_Si.yaml")
+    yaml_filename = cwd / "phonopy_params_Si.yaml"
     return phonopy.load(
         yaml_filename,
         is_compact_fc=False,
         log_level=1,
         produce_fc=True,
     )
```

### Comparing `phono3py-2.6.0/test/other/test_isotope.py` & `phono3py-2.7.0/test/other/test_isotope.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/other/test_kaccum.py` & `phono3py-2.7.0/test/other/test_kaccum.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phono3py_params_AlN332.yaml.xz` & `phono3py-2.7.0/test/phono3py_params_AlN332.yaml.xz`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phono3py_params_NaCl111.yaml` & `phono3py-2.7.0/test/phono3py_params_NaCl111.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phono3py_params_NaCl222.yaml.xz` & `phono3py-2.7.0/test/phono3py_params_NaCl222.yaml.xz`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phono3py_params_Si-111-222.yaml` & `phono3py-2.7.0/test/phono3py_params_Si-111-222.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phono3py_params_Si111.yaml` & `phono3py-2.7.0/test/phono3py_params_Si111.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phono3py_si_pbesol.yaml` & `phono3py-2.7.0/test/phono3py_si_pbesol.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon/test_grid.py` & `phono3py-2.7.0/test/phonon/test_grid.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,19 +7,20 @@
 from phonopy.structure.atoms import PhonopyAtoms
 from phonopy.structure.symmetry import Symmetry
 
 from phono3py import Phono3py
 from phono3py.other.tetrahedron_method import get_tetrahedra_relative_grid_address
 from phono3py.phonon.grid import (
     BZGrid,
+    GridMatrix,
+    _can_use_std_lattice,
     _get_grid_points_by_bz_rotations_c,
     _get_grid_points_by_bz_rotations_py,
     _get_grid_points_by_rotations,
     _relocate_BZ_grid_address,
-    can_use_std_lattice,
     get_grid_point_from_address,
     get_grid_point_from_address_py,
     get_ir_grid_points,
 )
 
 
 def _get_qpoints(adrs, bzgrid):
@@ -830,15 +831,15 @@
         mesh,
         lattice=lat,
         symmetry_dataset=aln_lda.primitive_symmetry.dataset,
         use_grg=True,
         force_SNF=True,
         SNF_coordinates="direct",
     )
-    np.testing.assert_equal(bzgrid.D_diag, [1, 6, 30])
+    np.testing.assert_equal(bzgrid.D_diag, [1, 7, 28])
 
 
 def test_BZGrid_SNF_nonprimitive(si_pbesol_111):
     """Test of SNF in BZGrid."""
     lat = si_pbesol_111.supercell.cell
     mesh = 20
     with pytest.warns(
@@ -865,15 +866,15 @@
     coordinates.
 
     """
     lat = aln_lda.primitive.cell
     mesh = 25
 
     for snf_coordinates, d_diag in zip(
-        ("direct", "reciprocal"), ([2, 8, 24], [1, 9, 45])
+        ("direct", "reciprocal"), ([1, 9, 45], [1, 9, 45])
     ):
         bzgrid = BZGrid(
             mesh,
             lattice=lat,
             symmetry_dataset=aln_lda.primitive_symmetry.dataset,
             use_grg=True,
             force_SNF=True,
@@ -1256,15 +1257,15 @@
         [[1, 0, 0], [0, 0, 1], [0, 1, 0]],
         [[0, 0, 1], [1, 0, 0], [0, 1, 0]],
         [[-1, -1, -1], [0, 1, 0], [0, 0, 1]],
         [[1, 0, 0], [0, 0, 1], [-1, -1, -1]],
         [[0, 1, 0], [-1, -1, -1], [1, 0, 0]],
     ]
 
-    assert can_use_std_lattice(conv_lat, tmat, std_lattice, rotations)
+    assert _can_use_std_lattice(conv_lat, tmat, std_lattice, rotations)
 
 
 def test_aln_BZGrid_with_shift(aln_cell: PhonopyAtoms):
     """Test BZGrid with shift using AlN."""
     mesh = [5, 5, 4]
     symmetry = Symmetry(aln_cell)
 
@@ -2380,7 +2381,107 @@
 #             [1, 1, 0],
 #             [1, 1, 1],
 #         ]
 #     )
 #     print(np.dot(bzgrid.P, shifts.T).T)
 
 #     return bzgrid
+
+
+def test_GridMatrix_without_symmetry(ph_nacl: Phonopy):
+    """Test of GridMatrix without symmetry."""
+    mesh = [4, 4, 4]
+    gm = GridMatrix(mesh, ph_nacl.primitive.cell)
+    assert gm.grid_matrix is None
+    np.testing.assert_array_equal(gm.D_diag, mesh)
+
+
+def test_GridMatrix_with_symmetry(ph_nacl: Phonopy):
+    """Test of GridMatrix with symmetry."""
+    mesh = 50.0
+    gm = GridMatrix(
+        mesh,
+        ph_nacl.primitive.cell,
+        symmetry_dataset=ph_nacl.primitive_symmetry.dataset,
+    )
+    np.testing.assert_array_equal(
+        gm.grid_matrix, np.array([[-1, 1, 1], [1, -1, 1], [1, 1, -1]]) * 9
+    )
+    np.testing.assert_array_equal(gm.D_diag, [9, 18, 18])
+
+
+def test_GridMatrix_with_grid_matrix(ph_nacl: Phonopy):
+    """Test of GridMatrix with grid_matrix.
+
+    This case has to be used with symmetry_dataset or transformation_matrix.
+
+    """
+    mesh = np.array([[-1, 1, 1], [1, -1, 1], [1, 1, -1]]) * 9
+    gm = GridMatrix(
+        mesh,
+        ph_nacl.primitive.cell,
+        symmetry_dataset=ph_nacl.primitive_symmetry.dataset,
+    )
+    np.testing.assert_array_equal(gm.grid_matrix, mesh)
+    np.testing.assert_array_equal(gm.D_diag, [9, 18, 18])
+
+    tmat = ph_nacl.primitive_symmetry.dataset["transformation_matrix"]
+    gm = GridMatrix(mesh, ph_nacl.primitive.cell, transformation_matrix=tmat)
+    np.testing.assert_array_equal(gm.grid_matrix, mesh)
+    np.testing.assert_array_equal(gm.D_diag, [9, 18, 18])
+
+
+def test_GridMatrix_with_transformation_matrix(ph_nacl: Phonopy):
+    """Test of GridMatrix with transformation matrix.
+
+    Only length is used to determine grid matrix, i.e., point group information
+    is not used.
+
+    """
+    mesh = 50.0
+    tmat = ph_nacl.primitive_symmetry.dataset["transformation_matrix"]
+    gm = GridMatrix(
+        mesh,
+        ph_nacl.primitive.cell,
+        transformation_matrix=tmat,
+    )
+    np.testing.assert_array_equal(
+        gm.grid_matrix, np.array([[-1, 1, 1], [1, -1, 1], [1, 1, -1]]) * 9
+    )
+    np.testing.assert_array_equal(gm.D_diag, [9, 18, 18])
+
+
+def test_GridMatrix_with_supercell_symmetry(ph_nacl: Phonopy):
+    """Test of GridMatrix with supercell symmetry.
+
+    Generalized regular grid can not be used for non-primitive lattice.
+    Therefore, fallback to length2mesh. With grg=True, warning is emitted.
+
+    """
+    mesh = 50.0
+    with pytest.warns(RuntimeWarning):
+        gm = GridMatrix(
+            mesh,
+            ph_nacl.supercell.cell,
+            use_grg=True,
+            symmetry_dataset=ph_nacl.symmetry.dataset,
+        )
+    assert gm.grid_matrix is None
+    np.testing.assert_array_equal(gm.D_diag, [4, 4, 4])
+
+
+@pytest.mark.filterwarnings("error")
+def test_GridMatrix_with_supercell_symmetry_grg_false(ph_nacl: Phonopy):
+    """Test of GridMatrix with supercell symmetry.
+
+    With grg=False, simply length2mesh is used and warning is not emitted.
+
+    """
+    mesh = 50.0
+    gm = GridMatrix(
+        mesh,
+        ph_nacl.supercell.cell,
+        use_grg=False,
+        symmetry_dataset=ph_nacl.symmetry.dataset,
+    )
+    assert gm.grid_matrix is None
+    np.testing.assert_array_equal(gm.D_diag, [4, 4, 4])
```

### Comparing `phono3py-2.6.0/test/phonon/test_velocity_operator.py` & `phono3py-2.7.0/test/phonon/test_velocity_operator.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon3/test_displacements.py` & `phono3py-2.7.0/test/phonon3/test_displacements.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon3/test_fc3.py` & `phono3py-2.7.0/test/phonon3/test_fc3.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon3/test_imag_self_energy.py` & `phono3py-2.7.0/test/phonon3/test_imag_self_energy.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon3/test_interaction.py` & `phono3py-2.7.0/test/phonon3/test_interaction.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon3/test_joint_dos.py` & `phono3py-2.7.0/test/phonon3/test_joint_dos.py`

 * *Files 1% similar despite different names*

```diff
@@ -201,15 +201,15 @@
     0.0000000,
     0.3079461,
     0.0000000,
     0.0213677,
 ]
 
 
-@pytest.mark.parametrize("gp,store_dense_gp_map", [(103, False), (105, True)])
+@pytest.mark.parametrize("gp,store_dense_gp_map", [(105, True)])
 def test_jdos_si(si_pbesol: Phono3py, gp: int, store_dense_gp_map: bool):
     """Test joint-DOS by Si.
 
     store_dense_gp_map=False : 103
     store_dense_gp_map=True : 105
 
     """
@@ -229,15 +229,15 @@
     np.testing.assert_allclose(si_freq_points, jdos.frequency_points, atol=1e-5)
     # print(", ".join(["%.7f" % jd for jd in jdos.joint_dos.ravel()]))
     np.testing.assert_allclose(
         si_jdos_12[2:], jdos.joint_dos.ravel()[2:], rtol=1e-2, atol=1e-5
     )
 
 
-@pytest.mark.parametrize("gp,store_dense_gp_map", [(103, False), (105, True)])
+@pytest.mark.parametrize("gp,store_dense_gp_map", [(105, True)])
 def test_jdso_si_nomeshsym(si_pbesol: Phono3py, gp: int, store_dense_gp_map: bool):
     """Test joint-DOS without considering mesh symmetry by Si."""
     si_pbesol.mesh_numbers = [9, 9, 9]
     jdos = Phono3pyJointDos(
         si_pbesol.phonon_supercell,
         si_pbesol.phonon_primitive,
         si_pbesol.fc2,
@@ -252,15 +252,15 @@
     np.testing.assert_allclose(si_freq_points, jdos.frequency_points, atol=1e-5)
     # print(", ".join(["%.7f" % jd for jd in jdos.joint_dos.ravel()]))
     np.testing.assert_allclose(
         si_jdos_nomeshsym_12[2:], jdos.joint_dos.ravel()[2:], rtol=1e-2, atol=1e-5
     )
 
 
-@pytest.mark.parametrize("gp,store_dense_gp_map", [(103, False), (105, True)])
+@pytest.mark.parametrize("gp,store_dense_gp_map", [(105, True)])
 def test_jdos_nacl(nacl_pbe: Phono3py, gp: int, store_dense_gp_map: bool):
     """Test joint-DOS by NaCl."""
     nacl_pbe.mesh_numbers = [9, 9, 9]
     jdos = Phono3pyJointDos(
         nacl_pbe.phonon_supercell,
         nacl_pbe.phonon_primitive,
         nacl_pbe.fc2,
@@ -275,15 +275,15 @@
     np.testing.assert_allclose(nacl_freq_points, jdos.frequency_points, atol=1e-5)
     # print(", ".join(["%.7f" % jd for jd in jdos.joint_dos.ravel()]))
     np.testing.assert_allclose(
         nacl_jdos_12[2:], jdos.joint_dos.ravel()[2:], rtol=1e-2, atol=1e-5
     )
 
 
-@pytest.mark.parametrize("gp,store_dense_gp_map", [(0, False), (0, True)])
+@pytest.mark.parametrize("gp,store_dense_gp_map", [(0, True)])
 def test_jdos_nacl_gamma(nacl_pbe: Phono3py, gp: int, store_dense_gp_map: bool):
     """Test joint-DOS at Gamma-point by NaCl."""
     nacl_pbe.mesh_numbers = [9, 9, 9]
     jdos = Phono3pyJointDos(
         nacl_pbe.phonon_supercell,
         nacl_pbe.phonon_primitive,
         nacl_pbe.fc2,
@@ -299,15 +299,15 @@
     np.testing.assert_allclose(nacl_freq_points_gamma, jdos.frequency_points, atol=1e-5)
     # print(", ".join(["%.7f" % jd for jd in jdos.joint_dos.ravel()]))
     np.testing.assert_allclose(
         nacl_jdos_12_gamma[2:], jdos.joint_dos.ravel()[2:], rtol=1e-2, atol=1e-5
     )
 
 
-@pytest.mark.parametrize("gp,store_dense_gp_map", [(103, False), (105, True)])
+@pytest.mark.parametrize("gp,store_dense_gp_map", [(105, True)])
 def test_jdos_nacl_at_300K(nacl_pbe: Phono3py, gp: int, store_dense_gp_map: bool):
     """Test joint-DOS at 300K by NaCl."""
     nacl_pbe.mesh_numbers = [9, 9, 9]
     jdos = Phono3pyJointDos(
         nacl_pbe.phonon_supercell,
         nacl_pbe.phonon_primitive,
         nacl_pbe.fc2,
```

### Comparing `phono3py-2.6.0/test/phonon3/test_real_self_energy.py` & `phono3py-2.7.0/test/phonon3/test_real_self_energy.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon3/test_spectral_function.py` & `phono3py-2.7.0/test/phonon3/test_spectral_function.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonon3/test_triplets.py` & `phono3py-2.7.0/test/phonon3/test_triplets.py`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonopy_disp_NaCl.yaml` & `phono3py-2.7.0/test/phonopy_disp_NaCl.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonopy_params-Si111-iterha.yaml.gz` & `phono3py-2.7.0/test/phonopy_params-Si111-iterha.yaml.gz`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/phonopy_params_Si.yaml` & `phono3py-2.7.0/test/phonopy_params_Si.yaml`

 * *Files identical despite different names*

### Comparing `phono3py-2.6.0/test/sscha/test_sscha.py` & `phono3py-2.7.0/test/sscha/test_sscha.py`

 * *Files identical despite different names*

