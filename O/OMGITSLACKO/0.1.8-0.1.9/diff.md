# Comparing `tmp/OMGITSLACKO-0.1.8.tar.gz` & `tmp/OMGITSLACKO-0.1.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "OMGITSLACKO-0.1.8.tar", last modified: Tue Jun  6 10:21:23 2023, max compression
+gzip compressed data, was "OMGITSLACKO-0.1.9.tar", last modified: Tue Jun  6 10:38:27 2023, max compression
```

## Comparing `OMGITSLACKO-0.1.8.tar` & `OMGITSLACKO-0.1.9.tar`

### file list

```diff
@@ -1,16 +1,16 @@
-drwxrwxrwx   0        0        0        0 2023-06-06 10:21:23.472983 OMGITSLACKO-0.1.8/
-drwxrwxrwx   0        0        0        0 2023-06-06 10:21:23.463959 OMGITSLACKO-0.1.8/OMGITSLACKO/
--rw-rw-rw-   0        0        0      487 2023-06-06 10:20:28.000000 OMGITSLACKO-0.1.8/OMGITSLACKO/__init__.py
--rw-rw-rw-   0        0        0    24428 2023-06-06 10:11:30.000000 OMGITSLACKO-0.1.8/OMGITSLACKO/functions.py
--rw-rw-rw-   0        0        0     5850 2023-04-27 16:27:01.000000 OMGITSLACKO-0.1.8/OMGITSLACKO/tozsdefunctions.py
-drwxrwxrwx   0        0        0        0 2023-06-06 10:21:23.469975 OMGITSLACKO-0.1.8/OMGITSLACKO.egg-info/
--rw-rw-rw-   0        0        0      235 2023-06-06 10:21:23.000000 OMGITSLACKO-0.1.8/OMGITSLACKO.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      306 2023-06-06 10:21:23.000000 OMGITSLACKO-0.1.8/OMGITSLACKO.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-06-06 10:21:23.000000 OMGITSLACKO-0.1.8/OMGITSLACKO.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-04-21 11:06:38.000000 OMGITSLACKO-0.1.8/OMGITSLACKO.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       13 2023-06-06 10:21:23.000000 OMGITSLACKO-0.1.8/OMGITSLACKO.egg-info/requires.txt
--rw-rw-rw-   0        0        0       12 2023-06-06 10:21:23.000000 OMGITSLACKO-0.1.8/OMGITSLACKO.egg-info/top_level.txt
--rw-rw-rw-   0        0        0      235 2023-06-06 10:21:23.470977 OMGITSLACKO-0.1.8/PKG-INFO
--rw-rw-rw-   0        0        0      293 2023-04-21 12:10:35.000000 OMGITSLACKO-0.1.8/README.md
--rw-rw-rw-   0        0        0       42 2023-06-06 10:21:23.472983 OMGITSLACKO-0.1.8/setup.cfg
--rw-rw-rw-   0        0        0      399 2023-06-06 10:21:15.000000 OMGITSLACKO-0.1.8/setup.py
+drwxrwxrwx   0        0        0        0 2023-06-06 10:38:27.193084 OMGITSLACKO-0.1.9/
+drwxrwxrwx   0        0        0        0 2023-06-06 10:38:27.185236 OMGITSLACKO-0.1.9/OMGITSLACKO/
+-rw-rw-rw-   0        0        0      487 2023-06-06 10:20:28.000000 OMGITSLACKO-0.1.9/OMGITSLACKO/__init__.py
+-rw-rw-rw-   0        0        0    24540 2023-06-06 10:37:46.000000 OMGITSLACKO-0.1.9/OMGITSLACKO/functions.py
+-rw-rw-rw-   0        0        0     5850 2023-04-27 16:27:01.000000 OMGITSLACKO-0.1.9/OMGITSLACKO/tozsdefunctions.py
+drwxrwxrwx   0        0        0        0 2023-06-06 10:38:27.191217 OMGITSLACKO-0.1.9/OMGITSLACKO.egg-info/
+-rw-rw-rw-   0        0        0      235 2023-06-06 10:38:26.000000 OMGITSLACKO-0.1.9/OMGITSLACKO.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      306 2023-06-06 10:38:27.000000 OMGITSLACKO-0.1.9/OMGITSLACKO.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-06-06 10:38:26.000000 OMGITSLACKO-0.1.9/OMGITSLACKO.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-04-21 11:06:38.000000 OMGITSLACKO-0.1.9/OMGITSLACKO.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       13 2023-06-06 10:38:26.000000 OMGITSLACKO-0.1.9/OMGITSLACKO.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       12 2023-06-06 10:38:26.000000 OMGITSLACKO-0.1.9/OMGITSLACKO.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      235 2023-06-06 10:38:27.192218 OMGITSLACKO-0.1.9/PKG-INFO
+-rw-rw-rw-   0        0        0      293 2023-04-21 12:10:35.000000 OMGITSLACKO-0.1.9/README.md
+-rw-rw-rw-   0        0        0       42 2023-06-06 10:38:27.193221 OMGITSLACKO-0.1.9/setup.cfg
+-rw-rw-rw-   0        0        0      399 2023-06-06 10:37:55.000000 OMGITSLACKO-0.1.9/setup.py
```

### Comparing `OMGITSLACKO-0.1.8/OMGITSLACKO/functions.py` & `OMGITSLACKO-0.1.9/OMGITSLACKO/functions.py`

 * *Files 2% similar despite different names*

```diff
@@ -70,1458 +70,1465 @@
 00000450: 653d 226d 6178 2d68 6569 6768 743a 3330  e="max-height:30
 00000460: 3070 783b 206f 7665 7266 6c6f 772d 793a  0px; overflow-y:
 00000470: 6175 746f 3b22 3e7b 7d3c 2f64 6976 3e27  auto;">{}</div>'
 00000480: 2e66 6f72 6d61 7428 6874 6d6c 5f74 6162  .format(html_tab
 00000490: 6c65 2929 0d0a 0d0a 6465 6620 706c 6f74  le))....def plot
 000004a0: 5f73 6964 655f 6279 5f73 6964 6528 6461  _side_by_side(da
 000004b0: 7461 2c20 636f 6c75 6d6e 7329 3a0d 0a20  ta, columns):.. 
-000004c0: 2020 2066 6967 2c20 6178 7320 3d20 706c     fig, axs = pl
-000004d0: 742e 7375 6270 6c6f 7473 286c 656e 2863  t.subplots(len(c
-000004e0: 6f6c 756d 6e73 292c 2032 2c20 6669 6773  olumns), 2, figs
-000004f0: 697a 653d 2831 322c 206c 656e 2863 6f6c  ize=(12, len(col
-00000500: 756d 6e73 2920 2a20 3429 290d 0a0d 0a20  umns) * 4)).... 
-00000510: 2020 2066 6f72 2069 2c20 636f 6c20 696e     for i, col in
-00000520: 2065 6e75 6d65 7261 7465 2863 6f6c 756d   enumerate(colum
-00000530: 6e73 293a 0d0a 2020 2020 2020 2020 6178  ns):..        ax
-00000540: 735b 692c 2030 5d2e 706c 6f74 2864 6174  s[i, 0].plot(dat
-00000550: 615b 636f 6c5d 2e76 616c 7565 7329 0d0a  a[col].values)..
-00000560: 2020 2020 2020 2020 6178 735b 692c 2030          axs[i, 0
-00000570: 5d2e 7365 745f 7469 746c 6528 6622 7b63  ].set_title(f"{c
-00000580: 6f6c 7d20 2d20 5469 6d65 2053 6572 6965  ol} - Time Serie
-00000590: 7322 290d 0a20 2020 2020 2020 2061 7873  s")..        axs
-000005a0: 5b69 2c20 305d 2e73 6574 5f78 6c61 6265  [i, 0].set_xlabe
-000005b0: 6c28 2249 6e64 6578 2229 0d0a 2020 2020  l("Index")..    
-000005c0: 2020 2020 6178 735b 692c 2030 5d2e 7365      axs[i, 0].se
-000005d0: 745f 796c 6162 656c 2822 5661 6c75 6522  t_ylabel("Value"
-000005e0: 290d 0a0d 0a20 2020 2020 2020 2061 7873  )....        axs
-000005f0: 5b69 2c20 315d 2e68 6973 7428 6461 7461  [i, 1].hist(data
-00000600: 5b63 6f6c 5d2c 2062 696e 733d 3230 290d  [col], bins=20).
-00000610: 0a20 2020 2020 2020 2061 7873 5b69 2c20  .        axs[i, 
-00000620: 315d 2e73 6574 5f74 6974 6c65 2866 227b  1].set_title(f"{
-00000630: 636f 6c7d 202d 2048 6973 746f 6772 616d  col} - Histogram
-00000640: 2229 0d0a 2020 2020 2020 2020 6178 735b  ")..        axs[
-00000650: 692c 2031 5d2e 7365 745f 786c 6162 656c  i, 1].set_xlabel
-00000660: 2822 5661 6c75 6522 290d 0a20 2020 2020  ("Value")..     
-00000670: 2020 2061 7873 5b69 2c20 315d 2e73 6574     axs[i, 1].set
-00000680: 5f79 6c61 6265 6c28 2246 7265 7175 656e  _ylabel("Frequen
-00000690: 6379 2229 0d0a 0d0a 2020 2020 706c 742e  cy")....    plt.
-000006a0: 7469 6768 745f 6c61 796f 7574 2829 0d0a  tight_layout()..
-000006b0: 0d0a 2020 2020 706c 742e 6669 6775 7265  ..    plt.figure
-000006c0: 2866 6967 7369 7a65 3d28 3132 2c20 3629  (figsize=(12, 6)
-000006d0: 290d 0a20 2020 2066 6f72 2063 6f6c 2069  )..    for col i
-000006e0: 6e20 636f 6c75 6d6e 733a 0d0a 2020 2020  n columns:..    
-000006f0: 2020 2020 706c 742e 706c 6f74 2864 6174      plt.plot(dat
-00000700: 615b 636f 6c5d 2e76 616c 7565 732c 206c  a[col].values, l
-00000710: 6162 656c 3d63 6f6c 290d 0a20 2020 2070  abel=col)..    p
-00000720: 6c74 2e74 6974 6c65 2822 5469 6d65 2053  lt.title("Time S
-00000730: 6572 6965 7320 436f 6d70 6172 6973 6f6e  eries Comparison
-00000740: 2229 0d0a 2020 2020 706c 742e 786c 6162  ")..    plt.xlab
-00000750: 656c 2822 496e 6465 7822 290d 0a20 2020  el("Index")..   
-00000760: 2070 6c74 2e79 6c61 6265 6c28 2256 616c   plt.ylabel("Val
-00000770: 7565 2229 0d0a 2020 2020 706c 742e 6c65  ue")..    plt.le
-00000780: 6765 6e64 2829 0d0a 0d0a 2020 2020 706c  gend()....    pl
-00000790: 742e 7368 6f77 2829 0d0a 0d0a 0d0a 0d0a  t.show()........
-000007a0: 0d0a 6465 6620 706c 6f74 5f74 6172 6765  ..def plot_targe
-000007b0: 745f 7673 5f6f 7468 6572 7328 6461 7461  t_vs_others(data
-000007c0: 2c20 7461 7267 6574 5f76 6172 6961 626c  , target_variabl
-000007d0: 6529 3a0d 0a20 2020 2069 6d70 6f72 7420  e):..    import 
-000007e0: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
-000007f0: 7420 6173 2070 6c74 0d0a 2020 2020 7461  t as plt..    ta
-00000800: 7267 6574 203d 2064 6174 615b 7461 7267  rget = data[targ
-00000810: 6574 5f76 6172 6961 626c 655d 0d0a 2020  et_variable]..  
-00000820: 2020 6f74 6865 725f 7661 7269 6162 6c65    other_variable
-00000830: 7320 3d20 6461 7461 2e64 726f 7028 636f  s = data.drop(co
-00000840: 6c75 6d6e 733d 7461 7267 6574 5f76 6172  lumns=target_var
-00000850: 6961 626c 6529 2e63 6f6c 756d 6e73 0d0a  iable).columns..
-00000860: 2020 2020 0d0a 2020 2020 706c 742e 6669      ..    plt.fi
-00000870: 6775 7265 2866 6967 7369 7a65 3d28 3132  gure(figsize=(12
-00000880: 2c20 3629 290d 0a20 2020 2070 6c74 2e70  , 6))..    plt.p
-00000890: 6c6f 7428 7261 6e67 6528 6c65 6e28 7461  lot(range(len(ta
-000008a0: 7267 6574 2929 2c20 7461 7267 6574 2c20  rget)), target, 
-000008b0: 6c61 6265 6c3d 7461 7267 6574 5f76 6172  label=target_var
-000008c0: 6961 626c 6529 0d0a 2020 2020 706c 742e  iable)..    plt.
-000008d0: 7469 746c 6528 6622 7b74 6172 6765 745f  title(f"{target_
-000008e0: 7661 7269 6162 6c65 7d20 2d20 5469 6d65  variable} - Time
-000008f0: 2053 6572 6965 7322 290d 0a20 2020 2070   Series")..    p
-00000900: 6c74 2e78 6c61 6265 6c28 2244 6174 6120  lt.xlabel("Data 
-00000910: 506f 696e 7422 290d 0a20 2020 2070 6c74  Point")..    plt
-00000920: 2e79 6c61 6265 6c28 2256 616c 7565 2229  .ylabel("Value")
-00000930: 0d0a 2020 2020 706c 742e 6c65 6765 6e64  ..    plt.legend
-00000940: 2829 0d0a 2020 2020 706c 742e 7368 6f77  ()..    plt.show
-00000950: 2829 0d0a 2020 2020 0d0a 2020 2020 666f  ()..    ..    fo
-00000960: 7220 7661 7269 6162 6c65 2069 6e20 6f74  r variable in ot
-00000970: 6865 725f 7661 7269 6162 6c65 733a 0d0a  her_variables:..
-00000980: 2020 2020 2020 2020 706c 742e 6669 6775          plt.figu
-00000990: 7265 2866 6967 7369 7a65 3d28 3132 2c20  re(figsize=(12, 
-000009a0: 3629 290d 0a20 2020 2020 2020 2070 6c74  6))..        plt
-000009b0: 2e70 6c6f 7428 7261 6e67 6528 6c65 6e28  .plot(range(len(
-000009c0: 7461 7267 6574 2929 2c20 7461 7267 6574  target)), target
-000009d0: 2c20 6c61 6265 6c3d 7461 7267 6574 5f76  , label=target_v
-000009e0: 6172 6961 626c 6529 0d0a 2020 2020 2020  ariable)..      
-000009f0: 2020 706c 742e 706c 6f74 2872 616e 6765    plt.plot(range
-00000a00: 286c 656e 2864 6174 615b 7661 7269 6162  (len(data[variab
-00000a10: 6c65 5d29 292c 2064 6174 615b 7661 7269  le])), data[vari
-00000a20: 6162 6c65 5d2c 206c 6162 656c 3d76 6172  able], label=var
-00000a30: 6961 626c 6529 0d0a 2020 2020 2020 2020  iable)..        
-00000a40: 706c 742e 7469 746c 6528 6622 7b74 6172  plt.title(f"{tar
-00000a50: 6765 745f 7661 7269 6162 6c65 7d20 7673  get_variable} vs
-00000a60: 207b 7661 7269 6162 6c65 7d20 2d20 5469   {variable} - Ti
-00000a70: 6d65 2053 6572 6965 7322 290d 0a20 2020  me Series")..   
-00000a80: 2020 2020 2070 6c74 2e78 6c61 6265 6c28       plt.xlabel(
-00000a90: 2244 6174 6120 506f 696e 7422 290d 0a20  "Data Point").. 
-00000aa0: 2020 2020 2020 2070 6c74 2e79 6c61 6265         plt.ylabe
-00000ab0: 6c28 2256 616c 7565 2229 0d0a 2020 2020  l("Value")..    
-00000ac0: 2020 2020 706c 742e 6c65 6765 6e64 2829      plt.legend()
-00000ad0: 0d0a 2020 2020 2020 2020 706c 742e 7368  ..        plt.sh
-00000ae0: 6f77 2829 0d0a 0d0a 0d0a 6465 6620 706c  ow()......def pl
-00000af0: 6f74 5f74 6172 6765 745f 7673 5f6f 7468  ot_target_vs_oth
-00000b00: 6572 735f 6e6f 726d 616c 697a 6564 2864  ers_normalized(d
-00000b10: 6174 612c 2074 6172 6765 745f 7661 7269  ata, target_vari
-00000b20: 6162 6c65 293a 0d0a 2020 2020 696d 706f  able):..    impo
-00000b30: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
-00000b40: 706c 6f74 2061 7320 706c 740d 0a20 2020  plot as plt..   
-00000b50: 2066 726f 6d20 736b 6c65 6172 6e2e 7072   from sklearn.pr
-00000b60: 6570 726f 6365 7373 696e 6720 696d 706f  eprocessing impo
-00000b70: 7274 204d 696e 4d61 7853 6361 6c65 720d  rt MinMaxScaler.
-00000b80: 0a20 2020 2074 6172 6765 7420 3d20 6461  .    target = da
-00000b90: 7461 5b74 6172 6765 745f 7661 7269 6162  ta[target_variab
-00000ba0: 6c65 5d0d 0a20 2020 206f 7468 6572 5f76  le]..    other_v
-00000bb0: 6172 6961 626c 6573 203d 2064 6174 612e  ariables = data.
-00000bc0: 6472 6f70 2863 6f6c 756d 6e73 3d74 6172  drop(columns=tar
-00000bd0: 6765 745f 7661 7269 6162 6c65 292e 636f  get_variable).co
-00000be0: 6c75 6d6e 730d 0a20 2020 200d 0a20 2020  lumns..    ..   
-00000bf0: 2064 6174 615f 7769 7468 6f75 745f 7461   data_without_ta
-00000c00: 7267 6574 203d 2064 6174 612e 6472 6f70  rget = data.drop
-00000c10: 2863 6f6c 756d 6e73 3d74 6172 6765 745f  (columns=target_
-00000c20: 7661 7269 6162 6c65 290d 0a20 2020 200d  variable)..    .
-00000c30: 0a20 2020 2073 6361 6c65 7220 3d20 4d69  .    scaler = Mi
-00000c40: 6e4d 6178 5363 616c 6572 2829 0d0a 2020  nMaxScaler()..  
-00000c50: 2020 6e6f 726d 616c 697a 6564 5f64 6174    normalized_dat
-00000c60: 6120 3d20 7363 616c 6572 2e66 6974 5f74  a = scaler.fit_t
-00000c70: 7261 6e73 666f 726d 2864 6174 615f 7769  ransform(data_wi
-00000c80: 7468 6f75 745f 7461 7267 6574 290d 0a20  thout_target).. 
-00000c90: 2020 200d 0a20 2020 2074 6172 6765 745f     ..    target_
-00000ca0: 7363 616c 6572 203d 204d 696e 4d61 7853  scaler = MinMaxS
-00000cb0: 6361 6c65 7228 290d 0a20 2020 206e 6f72  caler()..    nor
-00000cc0: 6d61 6c69 7a65 645f 7461 7267 6574 203d  malized_target =
-00000cd0: 2074 6172 6765 745f 7363 616c 6572 2e66   target_scaler.f
-00000ce0: 6974 5f74 7261 6e73 666f 726d 2874 6172  it_transform(tar
-00000cf0: 6765 742e 7661 6c75 6573 2e72 6573 6861  get.values.resha
-00000d00: 7065 282d 312c 2031 2929 0d0a 2020 2020  pe(-1, 1))..    
-00000d10: 0d0a 2020 2020 706c 742e 6669 6775 7265  ..    plt.figure
-00000d20: 2866 6967 7369 7a65 3d28 3132 2c20 3629  (figsize=(12, 6)
-00000d30: 290d 0a20 2020 2070 6c74 2e70 6c6f 7428  )..    plt.plot(
-00000d40: 7261 6e67 6528 6c65 6e28 6e6f 726d 616c  range(len(normal
-00000d50: 697a 6564 5f74 6172 6765 7429 292c 206e  ized_target)), n
-00000d60: 6f72 6d61 6c69 7a65 645f 7461 7267 6574  ormalized_target
-00000d70: 2c20 6c61 6265 6c3d 7461 7267 6574 5f76  , label=target_v
-00000d80: 6172 6961 626c 6529 0d0a 2020 2020 706c  ariable)..    pl
-00000d90: 742e 7469 746c 6528 6622 7b74 6172 6765  t.title(f"{targe
-00000da0: 745f 7661 7269 6162 6c65 7d20 2d20 5469  t_variable} - Ti
-00000db0: 6d65 2053 6572 6965 7320 284e 6f72 6d61  me Series (Norma
-00000dc0: 6c69 7a65 6429 2229 0d0a 2020 2020 706c  lized)")..    pl
-00000dd0: 742e 786c 6162 656c 2822 4461 7461 2050  t.xlabel("Data P
-00000de0: 6f69 6e74 2229 0d0a 2020 2020 706c 742e  oint")..    plt.
-00000df0: 796c 6162 656c 2822 4e6f 726d 616c 697a  ylabel("Normaliz
-00000e00: 6564 2056 616c 7565 2229 0d0a 2020 2020  ed Value")..    
-00000e10: 706c 742e 6c65 6765 6e64 2829 0d0a 2020  plt.legend()..  
-00000e20: 2020 706c 742e 7368 6f77 2829 0d0a 2020    plt.show()..  
-00000e30: 2020 0d0a 2020 2020 666f 7220 7661 7269    ..    for vari
-00000e40: 6162 6c65 2069 6e20 6f74 6865 725f 7661  able in other_va
-00000e50: 7269 6162 6c65 733a 0d0a 2020 2020 2020  riables:..      
-00000e60: 2020 7661 7269 6162 6c65 5f69 6e64 6578    variable_index
-00000e70: 203d 2064 6174 612e 636f 6c75 6d6e 732e   = data.columns.
-00000e80: 6765 745f 6c6f 6328 7661 7269 6162 6c65  get_loc(variable
-00000e90: 290d 0a20 2020 2020 2020 206e 6f72 6d61  )..        norma
-00000ea0: 6c69 7a65 645f 7661 7269 6162 6c65 203d  lized_variable =
-00000eb0: 206e 6f72 6d61 6c69 7a65 645f 6461 7461   normalized_data
-00000ec0: 5b3a 2c20 7661 7269 6162 6c65 5f69 6e64  [:, variable_ind
-00000ed0: 6578 5d0d 0a20 2020 2020 2020 200d 0a20  ex]..        .. 
-00000ee0: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
-00000ef0: 6528 6669 6773 697a 653d 2831 322c 2036  e(figsize=(12, 6
-00000f00: 2929 0d0a 2020 2020 2020 2020 706c 742e  ))..        plt.
-00000f10: 706c 6f74 2872 616e 6765 286c 656e 286e  plot(range(len(n
-00000f20: 6f72 6d61 6c69 7a65 645f 7461 7267 6574  ormalized_target
-00000f30: 2929 2c20 6e6f 726d 616c 697a 6564 5f74  )), normalized_t
-00000f40: 6172 6765 742c 206c 6162 656c 3d74 6172  arget, label=tar
-00000f50: 6765 745f 7661 7269 6162 6c65 290d 0a20  get_variable).. 
-00000f60: 2020 2020 2020 2070 6c74 2e70 6c6f 7428         plt.plot(
-00000f70: 7261 6e67 6528 6c65 6e28 6461 7461 2929  range(len(data))
-00000f80: 2c20 6e6f 726d 616c 697a 6564 5f76 6172  , normalized_var
-00000f90: 6961 626c 652c 206c 6162 656c 3d76 6172  iable, label=var
-00000fa0: 6961 626c 6529 0d0a 2020 2020 2020 2020  iable)..        
-00000fb0: 706c 742e 7469 746c 6528 6622 7b74 6172  plt.title(f"{tar
-00000fc0: 6765 745f 7661 7269 6162 6c65 7d20 7673  get_variable} vs
-00000fd0: 207b 7661 7269 6162 6c65 7d20 2d20 5469   {variable} - Ti
-00000fe0: 6d65 2053 6572 6965 7320 284e 6f72 6d61  me Series (Norma
-00000ff0: 6c69 7a65 6429 2229 0d0a 2020 2020 2020  lized)")..      
-00001000: 2020 706c 742e 786c 6162 656c 2822 4461    plt.xlabel("Da
-00001010: 7461 2050 6f69 6e74 2229 0d0a 2020 2020  ta Point")..    
-00001020: 2020 2020 706c 742e 796c 6162 656c 2822      plt.ylabel("
-00001030: 4e6f 726d 616c 697a 6564 2056 616c 7565  Normalized Value
-00001040: 2229 0d0a 2020 2020 2020 2020 706c 742e  ")..        plt.
-00001050: 6c65 6765 6e64 2829 0d0a 2020 2020 2020  legend()..      
-00001060: 2020 706c 742e 7368 6f77 2829 0d0a 0d0a    plt.show()....
-00001070: 0d0a 2020 2020 0d0a 6465 6620 6669 6e64  ..    ..def find
-00001080: 5f62 6573 745f 6d6f 6465 6c5f 636c 6173  _best_model_clas
-00001090: 7369 6669 6361 7469 6f6e 2864 665f 585f  sification(df_X_
-000010a0: 7472 6169 6e2c 2064 665f 585f 7465 7374  train, df_X_test
-000010b0: 2c20 6466 5f79 5f74 7261 696e 2c20 6466  , df_y_train, df
-000010c0: 5f79 5f74 6573 7429 3a0d 0a20 2020 200d  _y_test):..    .
-000010d0: 0a20 2020 2069 6d70 6f72 7420 6e75 6d70  .    import nump
-000010e0: 7920 6173 206e 700d 0a20 2020 2069 6d70  y as np..    imp
-000010f0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
-00001100: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
-00001110: 726e 2e6c 696e 6561 725f 6d6f 6465 6c20  rn.linear_model 
-00001120: 696d 706f 7274 204c 6f67 6973 7469 6352  import LogisticR
-00001130: 6567 7265 7373 696f 6e2c 2052 6964 6765  egression, Ridge
-00001140: 436c 6173 7369 6669 6572 2c20 5061 7373  Classifier, Pass
-00001150: 6976 6541 6767 7265 7373 6976 6543 6c61  iveAggressiveCla
-00001160: 7373 6966 6965 722c 2050 6572 6365 7074  ssifier, Percept
-00001170: 726f 6e0d 0a20 2020 2066 726f 6d20 736b  ron..    from sk
-00001180: 6c65 6172 6e2e 7472 6565 2069 6d70 6f72  learn.tree impor
-00001190: 7420 4465 6369 7369 6f6e 5472 6565 436c  t DecisionTreeCl
-000011a0: 6173 7369 6669 6572 0d0a 2020 2020 6672  assifier..    fr
-000011b0: 6f6d 2073 6b6c 6561 726e 2e65 6e73 656d  om sklearn.ensem
-000011c0: 626c 6520 696d 706f 7274 2052 616e 646f  ble import Rando
-000011d0: 6d46 6f72 6573 7443 6c61 7373 6966 6965  mForestClassifie
-000011e0: 722c 2047 7261 6469 656e 7442 6f6f 7374  r, GradientBoost
-000011f0: 696e 6743 6c61 7373 6966 6965 722c 2041  ingClassifier, A
-00001200: 6461 426f 6f73 7443 6c61 7373 6966 6965  daBoostClassifie
-00001210: 722c 2045 7874 7261 5472 6565 7343 6c61  r, ExtraTreesCla
-00001220: 7373 6966 6965 722c 2042 6167 6769 6e67  ssifier, Bagging
-00001230: 436c 6173 7369 6669 6572 2c20 4973 6f6c  Classifier, Isol
-00001240: 6174 696f 6e46 6f72 6573 742c 2053 7461  ationForest, Sta
-00001250: 636b 696e 6743 6c61 7373 6966 6965 720d  ckingClassifier.
-00001260: 0a20 2020 2066 726f 6d20 736b 6c65 6172  .    from sklear
-00001270: 6e2e 7376 6d20 696d 706f 7274 2053 5643  n.svm import SVC
-00001280: 2c20 4f6e 6543 6c61 7373 5356 4d0d 0a20  , OneClassSVM.. 
-00001290: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-000012a0: 6e65 6967 6862 6f72 7320 696d 706f 7274  neighbors import
-000012b0: 204b 4e65 6967 6862 6f72 7343 6c61 7373   KNeighborsClass
-000012c0: 6966 6965 722c 204e 6561 7265 7374 4365  ifier, NearestCe
-000012d0: 6e74 726f 6964 0d0a 2020 2020 6672 6f6d  ntroid..    from
-000012e0: 2073 6b6c 6561 726e 2e6e 6169 7665 5f62   sklearn.naive_b
-000012f0: 6179 6573 2069 6d70 6f72 7420 4761 7573  ayes import Gaus
-00001300: 7369 616e 4e42 2c20 4265 726e 6f75 6c6c  sianNB, Bernoull
-00001310: 694e 420d 0a20 2020 2066 726f 6d20 736b  iNB..    from sk
-00001320: 6c65 6172 6e2e 6e65 7572 616c 5f6e 6574  learn.neural_net
-00001330: 776f 726b 2069 6d70 6f72 7420 4d4c 5043  work import MLPC
-00001340: 6c61 7373 6966 6965 720d 0a20 2020 2066  lassifier..    f
-00001350: 726f 6d20 736b 6c65 6172 6e2e 6469 7363  rom sklearn.disc
-00001360: 7269 6d69 6e61 6e74 5f61 6e61 6c79 7369  riminant_analysi
-00001370: 7320 696d 706f 7274 2051 7561 6472 6174  s import Quadrat
-00001380: 6963 4469 7363 7269 6d69 6e61 6e74 416e  icDiscriminantAn
-00001390: 616c 7973 6973 2c20 4c69 6e65 6172 4469  alysis, LinearDi
-000013a0: 7363 7269 6d69 6e61 6e74 416e 616c 7973  scriminantAnalys
-000013b0: 6973 0d0a 2020 2020 6672 6f6d 2073 6b6c  is..    from skl
-000013c0: 6561 726e 2e63 6c75 7374 6572 2069 6d70  earn.cluster imp
-000013d0: 6f72 7420 4b4d 6561 6e73 0d0a 2020 2020  ort KMeans..    
-000013e0: 6672 6f6d 2078 6762 6f6f 7374 2069 6d70  from xgboost imp
-000013f0: 6f72 7420 5847 4243 6c61 7373 6966 6965  ort XGBClassifie
-00001400: 720d 0a20 2020 2066 726f 6d20 6c69 6768  r..    from ligh
-00001410: 7467 626d 2069 6d70 6f72 7420 4c47 424d  tgbm import LGBM
-00001420: 436c 6173 7369 6669 6572 0d0a 2020 2020  Classifier..    
-00001430: 6672 6f6d 2063 6174 626f 6f73 7420 696d  from catboost im
-00001440: 706f 7274 2043 6174 426f 6f73 7443 6c61  port CatBoostCla
-00001450: 7373 6966 6965 720d 0a20 2020 2066 726f  ssifier..    fro
-00001460: 6d20 696d 626c 6561 726e 2e65 6e73 656d  m imblearn.ensem
-00001470: 626c 6520 696d 706f 7274 2042 616c 616e  ble import Balan
-00001480: 6365 6452 616e 646f 6d46 6f72 6573 7443  cedRandomForestC
-00001490: 6c61 7373 6966 6965 720d 0a20 2020 2066  lassifier..    f
-000014a0: 726f 6d20 736b 6c65 6172 6e20 696d 706f  rom sklearn impo
-000014b0: 7274 206d 6574 7269 6373 0d0a 2020 2020  rt metrics..    
-000014c0: 0d0a 2020 2020 6d6f 6465 6c73 203d 205b  ..    models = [
-000014d0: 0d0a 2020 2020 2020 2020 2822 4c6f 6769  ..        ("Logi
-000014e0: 7374 6963 2052 6567 7265 7373 696f 6e22  stic Regression"
-000014f0: 2c20 4c6f 6769 7374 6963 5265 6772 6573  , LogisticRegres
-00001500: 7369 6f6e 286d 6178 5f69 7465 723d 3130  sion(max_iter=10
-00001510: 3030 2929 2c0d 0a20 2020 2020 2020 2028  00)),..        (
-00001520: 2244 6563 6973 696f 6e20 5472 6565 222c  "Decision Tree",
-00001530: 2044 6563 6973 696f 6e54 7265 6543 6c61   DecisionTreeCla
-00001540: 7373 6966 6965 7228 2929 2c0d 0a20 2020  ssifier()),..   
-00001550: 2020 2020 2028 2252 616e 646f 6d20 466f       ("Random Fo
-00001560: 7265 7374 222c 2052 616e 646f 6d46 6f72  rest", RandomFor
-00001570: 6573 7443 6c61 7373 6966 6965 7228 2929  estClassifier())
-00001580: 2c0d 0a20 2020 2020 2020 2028 2247 7261  ,..        ("Gra
-00001590: 6469 656e 7420 426f 6f73 7469 6e67 222c  dient Boosting",
-000015a0: 2047 7261 6469 656e 7442 6f6f 7374 696e   GradientBoostin
-000015b0: 6743 6c61 7373 6966 6965 7228 2929 2c0d  gClassifier()),.
-000015c0: 0a20 2020 2020 2020 2028 2258 4742 6f6f  .        ("XGBoo
-000015d0: 7374 222c 2058 4742 436c 6173 7369 6669  st", XGBClassifi
-000015e0: 6572 2865 7661 6c5f 6d65 7472 6963 3d22  er(eval_metric="
-000015f0: 6c6f 676c 6f73 7322 2929 2c0d 0a20 2020  logloss")),..   
-00001600: 2020 2020 2028 224c 6967 6874 4742 4d22       ("LightGBM"
-00001610: 2c20 4c47 424d 436c 6173 7369 6669 6572  , LGBMClassifier
-00001620: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
-00001630: 5375 7070 6f72 7420 5665 6374 6f72 204d  Support Vector M
-00001640: 6163 6869 6e65 222c 2053 5643 2829 292c  achine", SVC()),
-00001650: 0d0a 2020 2020 2020 2020 2822 4b2d 4e65  ..        ("K-Ne
-00001660: 6172 6573 7420 4e65 6967 6862 6f72 7322  arest Neighbors"
-00001670: 2c20 4b4e 6569 6768 626f 7273 436c 6173  , KNeighborsClas
-00001680: 7369 6669 6572 2829 292c 0d0a 2020 2020  sifier()),..    
-00001690: 2020 2020 2822 4e61 6976 6520 4261 7965      ("Naive Baye
-000016a0: 7322 2c20 4761 7573 7369 616e 4e42 2829  s", GaussianNB()
-000016b0: 292c 0d0a 2020 2020 2020 2020 2822 4d75  ),..        ("Mu
-000016c0: 6c74 692d 6c61 7965 7220 5065 7263 6570  lti-layer Percep
-000016d0: 7472 6f6e 222c 204d 4c50 436c 6173 7369  tron", MLPClassi
-000016e0: 6669 6572 286d 6178 5f69 7465 723d 3130  fier(max_iter=10
-000016f0: 3030 2929 2c0d 0a20 2020 2020 2020 2028  00)),..        (
-00001700: 2241 6461 426f 6f73 7422 2c20 4164 6142  "AdaBoost", AdaB
-00001710: 6f6f 7374 436c 6173 7369 6669 6572 2829  oostClassifier()
-00001720: 292c 0d0a 2020 2020 2020 2020 2822 4578  ),..        ("Ex
-00001730: 7472 6120 5472 6565 7322 2c20 4578 7472  tra Trees", Extr
-00001740: 6154 7265 6573 436c 6173 7369 6669 6572  aTreesClassifier
-00001750: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
-00001760: 5269 6467 6520 436c 6173 7369 6669 6572  Ridge Classifier
-00001770: 222c 2052 6964 6765 436c 6173 7369 6669  ", RidgeClassifi
-00001780: 6572 2829 292c 0d0a 2020 2020 2020 2020  er()),..        
-00001790: 2822 5175 6164 7261 7469 6320 4469 7363  ("Quadratic Disc
-000017a0: 7269 6d69 6e61 6e74 2041 6e61 6c79 7369  riminant Analysi
-000017b0: 7322 2c20 5175 6164 7261 7469 6344 6973  s", QuadraticDis
-000017c0: 6372 696d 696e 616e 7441 6e61 6c79 7369  criminantAnalysi
-000017d0: 7328 2929 2c0d 0a20 2020 2020 2020 2028  s()),..        (
-000017e0: 2243 6174 426f 6f73 7422 2c20 4361 7442  "CatBoost", CatB
-000017f0: 6f6f 7374 436c 6173 7369 6669 6572 2876  oostClassifier(v
-00001800: 6572 626f 7365 3d30 2c20 7261 6e64 6f6d  erbose=0, random
-00001810: 5f73 6565 643d 3432 2929 2c0d 0a20 2020  _seed=42)),..   
-00001820: 2020 2020 2028 2242 616c 616e 6365 6420       ("Balanced 
-00001830: 5261 6e64 6f6d 2046 6f72 6573 7422 2c20  Random Forest", 
-00001840: 4261 6c61 6e63 6564 5261 6e64 6f6d 466f  BalancedRandomFo
-00001850: 7265 7374 436c 6173 7369 6669 6572 2829  restClassifier()
-00001860: 292c 0d0a 2020 2020 2020 2020 2822 4c69  ),..        ("Li
-00001870: 6e65 6172 2044 6973 6372 696d 696e 616e  near Discriminan
-00001880: 7420 416e 616c 7973 6973 222c 204c 696e  t Analysis", Lin
-00001890: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
-000018a0: 6e61 6c79 7369 7328 2929 2c0d 0a20 2020  nalysis()),..   
-000018b0: 2020 2020 2028 224e 6561 7265 7374 2043       ("Nearest C
-000018c0: 656e 7472 6f69 6420 436c 6173 7369 6669  entroid Classifi
-000018d0: 6572 222c 204e 6561 7265 7374 4365 6e74  er", NearestCent
-000018e0: 726f 6964 2829 292c 0d0a 2020 2020 2020  roid()),..      
-000018f0: 2020 2822 5061 7373 6976 6520 4167 6772    ("Passive Aggr
-00001900: 6573 7369 7665 2043 6c61 7373 6966 6965  essive Classifie
-00001910: 7222 2c20 5061 7373 6976 6541 6767 7265  r", PassiveAggre
-00001920: 7373 6976 6543 6c61 7373 6966 6965 7228  ssiveClassifier(
-00001930: 2929 2c0d 0a20 2020 2020 2020 2028 2250  )),..        ("P
-00001940: 6572 6365 7074 726f 6e22 2c20 5065 7263  erceptron", Perc
-00001950: 6570 7472 6f6e 2829 292c 0d0a 2020 2020  eptron()),..    
-00001960: 2020 2020 2822 4265 726e 6f75 6c6c 6920      ("Bernoulli 
-00001970: 4e61 6976 6520 4261 7965 7322 2c20 4265  Naive Bayes", Be
-00001980: 726e 6f75 6c6c 694e 4228 2929 2c0d 0a20  rnoulliNB()),.. 
-00001990: 2020 2020 2020 2028 2242 6167 6769 6e67         ("Bagging
-000019a0: 2043 6c61 7373 6966 6965 7222 2c20 4261   Classifier", Ba
-000019b0: 6767 696e 6743 6c61 7373 6966 6965 7228  ggingClassifier(
-000019c0: 2929 2c0d 0a20 2020 2020 2020 2023 2041  )),..        # A
-000019d0: 6464 2061 2062 6173 6520 6573 7469 6d61  dd a base estima
-000019e0: 746f 7220 666f 7220 5374 6163 6b69 6e67  tor for Stacking
-000019f0: 436c 6173 7369 6669 6572 0d0a 2020 2020  Classifier..    
-00001a00: 2020 2020 2822 5374 6163 6b69 6e67 2043      ("Stacking C
-00001a10: 6c61 7373 6966 6965 7222 2c20 5374 6163  lassifier", Stac
-00001a20: 6b69 6e67 436c 6173 7369 6669 6572 2865  kingClassifier(e
-00001a30: 7374 696d 6174 6f72 733d 5b28 276c 7227  stimators=[('lr'
-00001a40: 2c20 4c6f 6769 7374 6963 5265 6772 6573  , LogisticRegres
-00001a50: 7369 6f6e 2829 292c 2028 2764 7427 2c20  sion()), ('dt', 
-00001a60: 4465 6369 7369 6f6e 5472 6565 436c 6173  DecisionTreeClas
-00001a70: 7369 6669 6572 2829 295d 2929 2c0d 0a20  sifier())])),.. 
-00001a80: 2020 205d 0d0a 0d0a 0d0a 2020 2020 6265     ]......    be
-00001a90: 7374 5f6d 6f64 656c 203d 204e 6f6e 650d  st_model = None.
-00001aa0: 0a20 2020 2062 6573 745f 6163 6375 7261  .    best_accura
-00001ab0: 6379 203d 202d 310d 0a20 2020 2062 6573  cy = -1..    bes
-00001ac0: 745f 6d6f 6465 6c5f 696e 7374 616e 6365  t_model_instance
-00001ad0: 203d 204e 6f6e 650d 0a0d 0a20 2020 2066   = None....    f
-00001ae0: 6f72 206e 616d 652c 206d 6f64 656c 2069  or name, model i
-00001af0: 6e20 6d6f 6465 6c73 3a0d 0a20 2020 2020  n models:..     
-00001b00: 2020 206d 6f64 656c 2e66 6974 2864 665f     model.fit(df_
-00001b10: 585f 7472 6169 6e2c 2064 665f 795f 7472  X_train, df_y_tr
-00001b20: 6169 6e29 0d0a 2020 2020 2020 2020 795f  ain)..        y_
-00001b30: 7072 6564 5f62 696e 6172 7920 3d20 6d6f  pred_binary = mo
-00001b40: 6465 6c2e 7072 6564 6963 7428 6466 5f58  del.predict(df_X
-00001b50: 5f74 6573 7429 0d0a 0d0a 2020 2020 2020  _test)....      
-00001b60: 2020 6966 206e 616d 6520 696e 205b 2249    if name in ["I
-00001b70: 736f 6c61 7469 6f6e 2046 6f72 6573 7422  solation Forest"
-00001b80: 2c20 224f 6e65 2d43 6c61 7373 2053 564d  , "One-Class SVM
-00001b90: 222c 2022 4b2d 4d65 616e 7322 5d3a 0d0a  ", "K-Means"]:..
-00001ba0: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
-00001bb0: 6564 5f62 696e 6172 7920 3d20 6e70 2e77  ed_binary = np.w
-00001bc0: 6865 7265 2879 5f70 7265 645f 6269 6e61  here(y_pred_bina
-00001bd0: 7279 203d 3d20 2d31 2c20 302c 2079 5f70  ry == -1, 0, y_p
-00001be0: 7265 645f 6269 6e61 7279 290d 0a0d 0a20  red_binary).... 
-00001bf0: 2020 2020 2020 2070 7269 6e74 286e 616d         print(nam
-00001c00: 6520 2b20 2220 4d6f 6465 6c3a 2229 0d0a  e + " Model:")..
-00001c10: 2020 2020 2020 2020 636f 6e66 7573 696f          confusio
-00001c20: 6e5f 6d61 7472 6978 203d 206d 6574 7269  n_matrix = metri
-00001c30: 6373 2e63 6f6e 6675 7369 6f6e 5f6d 6174  cs.confusion_mat
-00001c40: 7269 7828 6466 5f79 5f74 6573 742c 2079  rix(df_y_test, y
-00001c50: 5f70 7265 645f 6269 6e61 7279 290d 0a20  _pred_binary).. 
-00001c60: 2020 2020 2020 2070 7269 6e74 2822 436f         print("Co
-00001c70: 6e66 7573 696f 6e20 4d61 7472 6978 3a22  nfusion Matrix:"
-00001c80: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-00001c90: 2863 6f6e 6675 7369 6f6e 5f6d 6174 7269  (confusion_matri
-00001ca0: 7829 0d0a 0d0a 2020 2020 2020 2020 6163  x)....        ac
-00001cb0: 6375 7261 6379 203d 206d 6574 7269 6373  curacy = metrics
-00001cc0: 2e61 6363 7572 6163 795f 7363 6f72 6528  .accuracy_score(
-00001cd0: 6466 5f79 5f74 6573 742c 2079 5f70 7265  df_y_test, y_pre
-00001ce0: 645f 6269 6e61 7279 290d 0a20 2020 2020  d_binary)..     
-00001cf0: 2020 2070 7265 6369 7369 6f6e 203d 206d     precision = m
-00001d00: 6574 7269 6373 2e70 7265 6369 7369 6f6e  etrics.precision
-00001d10: 5f73 636f 7265 2864 665f 795f 7465 7374  _score(df_y_test
-00001d20: 2c20 795f 7072 6564 5f62 696e 6172 7929  , y_pred_binary)
-00001d30: 0d0a 2020 2020 2020 2020 7265 6361 6c6c  ..        recall
-00001d40: 203d 206d 6574 7269 6373 2e72 6563 616c   = metrics.recal
-00001d50: 6c5f 7363 6f72 6528 6466 5f79 5f74 6573  l_score(df_y_tes
-00001d60: 742c 2079 5f70 7265 645f 6269 6e61 7279  t, y_pred_binary
-00001d70: 290d 0a20 2020 2020 2020 2063 6c61 7373  )..        class
-00001d80: 6966 6963 6174 696f 6e5f 7265 706f 7274  ification_report
-00001d90: 203d 206d 6574 7269 6373 2e63 6c61 7373   = metrics.class
-00001da0: 6966 6963 6174 696f 6e5f 7265 706f 7274  ification_report
-00001db0: 2864 665f 795f 7465 7374 2c20 795f 7072  (df_y_test, y_pr
-00001dc0: 6564 5f62 696e 6172 7929 0d0a 0d0a 2020  ed_binary)....  
-00001dd0: 2020 2020 2020 7072 696e 7428 2241 6363        print("Acc
-00001de0: 7572 6163 793a 222c 2061 6363 7572 6163  uracy:", accurac
-00001df0: 7929 0d0a 2020 2020 2020 2020 7072 696e  y)..        prin
-00001e00: 7428 2250 7265 6369 7369 6f6e 3a22 2c20  t("Precision:", 
-00001e10: 7072 6563 6973 696f 6e29 0d0a 2020 2020  precision)..    
-00001e20: 2020 2020 7072 696e 7428 2252 6563 616c      print("Recal
-00001e30: 6c3a 222c 2072 6563 616c 6c29 0d0a 2020  l:", recall)..  
-00001e40: 2020 2020 2020 7072 696e 7428 636c 6173        print(clas
-00001e50: 7369 6669 6361 7469 6f6e 5f72 6570 6f72  sification_repor
-00001e60: 7429 0d0a 0d0a 2020 2020 2020 2020 6966  t)....        if
-00001e70: 2061 6363 7572 6163 7920 3e20 6265 7374   accuracy > best
-00001e80: 5f61 6363 7572 6163 793a 0d0a 2020 2020  _accuracy:..    
-00001e90: 2020 2020 2020 2020 6265 7374 5f61 6363          best_acc
-00001ea0: 7572 6163 7920 3d20 6163 6375 7261 6379  uracy = accuracy
-00001eb0: 0d0a 2020 2020 2020 2020 2020 2020 6265  ..            be
-00001ec0: 7374 5f6d 6f64 656c 203d 206e 616d 650d  st_model = name.
-00001ed0: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
-00001ee0: 745f 6d6f 6465 6c5f 696e 7374 616e 6365  t_model_instance
-00001ef0: 203d 206d 6f64 656c 0d0a 0d0a 2020 2020   = model....    
-00001f00: 7072 696e 7428 2254 6865 2062 6573 7420  print("The best 
-00001f10: 6d6f 6465 6c20 6973 3a22 2c20 6265 7374  model is:", best
-00001f20: 5f6d 6f64 656c 2c20 2277 6974 6820 616e  _model, "with an
-00001f30: 2061 6363 7572 6163 7920 6f66 222c 2062   accuracy of", b
-00001f40: 6573 745f 6163 6375 7261 6379 290d 0a0d  est_accuracy)...
-00001f50: 0a20 2020 2023 2050 7269 6e74 2074 6865  .    # Print the
-00001f60: 2063 6f6e 6675 7369 6f6e 206d 6174 7269   confusion matri
-00001f70: 7820 666f 7220 7468 6520 6265 7374 206d  x for the best m
-00001f80: 6f64 656c 0d0a 2020 2020 795f 7072 6564  odel..    y_pred
-00001f90: 5f62 6573 7420 3d20 6265 7374 5f6d 6f64  _best = best_mod
-00001fa0: 656c 5f69 6e73 7461 6e63 652e 7072 6564  el_instance.pred
-00001fb0: 6963 7428 6466 5f58 5f74 6573 7429 0d0a  ict(df_X_test)..
-00001fc0: 2020 2020 6966 2062 6573 745f 6d6f 6465      if best_mode
-00001fd0: 6c20 696e 205b 2249 736f 6c61 7469 6f6e  l in ["Isolation
-00001fe0: 2046 6f72 6573 7422 2c20 224f 6e65 2d43   Forest", "One-C
-00001ff0: 6c61 7373 2053 564d 222c 2022 4b2d 4d65  lass SVM", "K-Me
-00002000: 616e 7322 5d3a 0d0a 2020 2020 2020 2020  ans"]:..        
-00002010: 795f 7072 6564 5f62 6573 7420 3d20 6e70  y_pred_best = np
-00002020: 2e77 6865 7265 2879 5f70 7265 645f 6265  .where(y_pred_be
-00002030: 7374 203d 3d20 2d31 2c20 302c 2079 5f70  st == -1, 0, y_p
-00002040: 7265 645f 6265 7374 290d 0a20 2020 2070  red_best)..    p
-00002050: 7269 6e74 2822 436f 6e66 7573 696f 6e20  rint("Confusion 
-00002060: 4d61 7472 6978 206f 6620 7468 6520 6265  Matrix of the be
-00002070: 7374 206d 6f64 656c 3a22 290d 0a20 2020  st model:")..   
-00002080: 2070 7269 6e74 286d 6574 7269 6373 2e63   print(metrics.c
-00002090: 6f6e 6675 7369 6f6e 5f6d 6174 7269 7828  onfusion_matrix(
-000020a0: 6466 5f79 5f74 6573 742c 2079 5f70 7265  df_y_test, y_pre
-000020b0: 645f 6265 7374 2929 0d0a 2020 2020 0d0a  d_best))..    ..
-000020c0: 2020 2020 0d0a 6465 6620 6669 6e64 5f62      ..def find_b
-000020d0: 6573 745f 6d6f 6465 6c5f 7265 6772 6573  est_model_regres
-000020e0: 7369 6f6e 2864 665f 585f 7472 6169 6e2c  sion(df_X_train,
-000020f0: 2064 665f 585f 7465 7374 2c20 6466 5f79   df_X_test, df_y
-00002100: 5f74 7261 696e 2c20 6466 5f79 5f74 6573  _train, df_y_tes
-00002110: 7429 3a0d 0a20 2020 200d 0a20 2020 2069  t):..    ..    i
-00002120: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
-00002130: 700d 0a20 2020 2069 6d70 6f72 7420 7061  p..    import pa
-00002140: 6e64 6173 2061 7320 7064 0d0a 2020 2020  ndas as pd..    
-00002150: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
-00002160: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
-00002170: 204c 696e 6561 7252 6567 7265 7373 696f   LinearRegressio
-00002180: 6e2c 2052 6964 6765 2c20 4c61 7373 6f2c  n, Ridge, Lasso,
-00002190: 2045 6c61 7374 6963 4e65 742c 2042 6179   ElasticNet, Bay
-000021a0: 6573 6961 6e52 6964 6765 2c20 5347 4452  esianRidge, SGDR
-000021b0: 6567 7265 7373 6f72 0d0a 2020 2020 6672  egressor..    fr
-000021c0: 6f6d 2073 6b6c 6561 726e 2e74 7265 6520  om sklearn.tree 
-000021d0: 696d 706f 7274 2044 6563 6973 696f 6e54  import DecisionT
-000021e0: 7265 6552 6567 7265 7373 6f72 0d0a 2020  reeRegressor..  
-000021f0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e65    from sklearn.e
-00002200: 6e73 656d 626c 6520 696d 706f 7274 2052  nsemble import R
-00002210: 616e 646f 6d46 6f72 6573 7452 6567 7265  andomForestRegre
-00002220: 7373 6f72 2c20 4772 6164 6965 6e74 426f  ssor, GradientBo
-00002230: 6f73 7469 6e67 5265 6772 6573 736f 722c  ostingRegressor,
-00002240: 2041 6461 426f 6f73 7452 6567 7265 7373   AdaBoostRegress
-00002250: 6f72 2c20 4578 7472 6154 7265 6573 5265  or, ExtraTreesRe
-00002260: 6772 6573 736f 722c 2042 6167 6769 6e67  gressor, Bagging
-00002270: 5265 6772 6573 736f 720d 0a20 2020 2066  Regressor..    f
-00002280: 726f 6d20 736b 6c65 6172 6e2e 7376 6d20  rom sklearn.svm 
-00002290: 696d 706f 7274 2053 5652 0d0a 2020 2020  import SVR..    
-000022a0: 6672 6f6d 2073 6b6c 6561 726e 2e6e 6569  from sklearn.nei
-000022b0: 6768 626f 7273 2069 6d70 6f72 7420 4b4e  ghbors import KN
-000022c0: 6569 6768 626f 7273 5265 6772 6573 736f  eighborsRegresso
-000022d0: 720d 0a20 2020 2066 726f 6d20 736b 6c65  r..    from skle
-000022e0: 6172 6e2e 6e65 7572 616c 5f6e 6574 776f  arn.neural_netwo
-000022f0: 726b 2069 6d70 6f72 7420 4d4c 5052 6567  rk import MLPReg
-00002300: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
-00002310: 2078 6762 6f6f 7374 2069 6d70 6f72 7420   xgboost import 
-00002320: 5847 4252 6567 7265 7373 6f72 0d0a 2020  XGBRegressor..  
-00002330: 2020 6672 6f6d 206c 6967 6874 6762 6d20    from lightgbm 
-00002340: 696d 706f 7274 204c 4742 4d52 6567 7265  import LGBMRegre
-00002350: 7373 6f72 0d0a 2020 2020 6672 6f6d 2063  ssor..    from c
-00002360: 6174 626f 6f73 7420 696d 706f 7274 2043  atboost import C
-00002370: 6174 426f 6f73 7452 6567 7265 7373 6f72  atBoostRegressor
-00002380: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
-00002390: 726e 2069 6d70 6f72 7420 6d65 7472 6963  rn import metric
-000023a0: 730d 0a0d 0a20 2020 206d 6f64 656c 7320  s....    models 
-000023b0: 3d20 5b0d 0a20 2020 2020 2020 2028 224c  = [..        ("L
-000023c0: 696e 6561 7220 5265 6772 6573 7369 6f6e  inear Regression
-000023d0: 222c 204c 696e 6561 7252 6567 7265 7373  ", LinearRegress
-000023e0: 696f 6e28 2929 2c0d 0a20 2020 2020 2020  ion()),..       
-000023f0: 2028 2252 6964 6765 2052 6567 7265 7373   ("Ridge Regress
-00002400: 696f 6e22 2c20 5269 6467 6528 2929 2c0d  ion", Ridge()),.
-00002410: 0a20 2020 2020 2020 2028 224c 6173 736f  .        ("Lasso
-00002420: 2052 6567 7265 7373 696f 6e22 2c20 4c61   Regression", La
-00002430: 7373 6f28 2929 2c0d 0a20 2020 2020 2020  sso()),..       
-00002440: 2028 2245 6c61 7374 6963 4e65 7420 5265   ("ElasticNet Re
-00002450: 6772 6573 7369 6f6e 222c 2045 6c61 7374  gression", Elast
-00002460: 6963 4e65 7428 2929 2c0d 0a20 2020 2020  icNet()),..     
-00002470: 2020 2028 2242 6179 6573 6961 6e20 5269     ("Bayesian Ri
-00002480: 6467 6520 5265 6772 6573 7369 6f6e 222c  dge Regression",
-00002490: 2042 6179 6573 6961 6e52 6964 6765 2829   BayesianRidge()
-000024a0: 292c 0d0a 2020 2020 2020 2020 2822 4465  ),..        ("De
-000024b0: 6369 7369 6f6e 2054 7265 6520 5265 6772  cision Tree Regr
-000024c0: 6573 736f 7222 2c20 4465 6369 7369 6f6e  essor", Decision
-000024d0: 5472 6565 5265 6772 6573 736f 7228 2929  TreeRegressor())
-000024e0: 2c0d 0a20 2020 2020 2020 2028 2252 616e  ,..        ("Ran
-000024f0: 646f 6d20 466f 7265 7374 2052 6567 7265  dom Forest Regre
-00002500: 7373 6f72 222c 2052 616e 646f 6d46 6f72  ssor", RandomFor
-00002510: 6573 7452 6567 7265 7373 6f72 2829 292c  estRegressor()),
-00002520: 0d0a 2020 2020 2020 2020 2822 4772 6164  ..        ("Grad
-00002530: 6965 6e74 2042 6f6f 7374 696e 6720 5265  ient Boosting Re
-00002540: 6772 6573 736f 7222 2c20 4772 6164 6965  gressor", Gradie
-00002550: 6e74 426f 6f73 7469 6e67 5265 6772 6573  ntBoostingRegres
-00002560: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
-00002570: 2028 2258 4742 6f6f 7374 2052 6567 7265   ("XGBoost Regre
-00002580: 7373 6f72 222c 2058 4742 5265 6772 6573  ssor", XGBRegres
-00002590: 736f 7228 6576 616c 5f6d 6574 7269 633d  sor(eval_metric=
-000025a0: 2272 6d73 6522 2929 2c0d 0a20 2020 2020  "rmse")),..     
-000025b0: 2020 2028 224c 6967 6874 4742 4d20 5265     ("LightGBM Re
-000025c0: 6772 6573 736f 7222 2c20 4c47 424d 5265  gressor", LGBMRe
-000025d0: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
-000025e0: 2020 2020 2028 2253 7570 706f 7274 2056       ("Support V
-000025f0: 6563 746f 7220 5265 6772 6573 736f 7222  ector Regressor"
-00002600: 2c20 5356 5228 2929 2c0d 0a20 2020 2020  , SVR()),..     
-00002610: 2020 2028 224b 2d4e 6561 7265 7374 204e     ("K-Nearest N
-00002620: 6569 6768 626f 7273 2052 6567 7265 7373  eighbors Regress
-00002630: 6f72 222c 204b 4e65 6967 6862 6f72 7352  or", KNeighborsR
-00002640: 6567 7265 7373 6f72 2829 292c 0d0a 2020  egressor()),..  
-00002650: 2020 2020 2020 2822 4d75 6c74 692d 6c61        ("Multi-la
-00002660: 7965 7220 5065 7263 6570 7472 6f6e 2052  yer Perceptron R
-00002670: 6567 7265 7373 6f72 222c 204d 4c50 5265  egressor", MLPRe
-00002680: 6772 6573 736f 7228 6d61 785f 6974 6572  gressor(max_iter
-00002690: 3d31 3030 3029 292c 0d0a 2020 2020 2020  =1000)),..      
-000026a0: 2020 2822 4164 6142 6f6f 7374 2052 6567    ("AdaBoost Reg
-000026b0: 7265 7373 6f72 222c 2041 6461 426f 6f73  ressor", AdaBoos
-000026c0: 7452 6567 7265 7373 6f72 2829 292c 0d0a  tRegressor()),..
-000026d0: 2020 2020 2020 2020 2822 4578 7472 6120          ("Extra 
-000026e0: 5472 6565 7320 5265 6772 6573 736f 7222  Trees Regressor"
-000026f0: 2c20 4578 7472 6154 7265 6573 5265 6772  , ExtraTreesRegr
-00002700: 6573 736f 7228 2929 2c0d 0a20 2020 2020  essor()),..     
-00002710: 2020 2028 2253 746f 6368 6173 7469 6320     ("Stochastic 
-00002720: 4772 6164 6965 6e74 2044 6573 6365 6e74  Gradient Descent
-00002730: 2052 6567 7265 7373 6f72 222c 2053 4744   Regressor", SGD
-00002740: 5265 6772 6573 736f 7228 2929 2c0d 0a20  Regressor()),.. 
-00002750: 2020 2020 2020 2028 2242 6167 6769 6e67         ("Bagging
-00002760: 2052 6567 7265 7373 6f72 222c 2042 6167   Regressor", Bag
-00002770: 6769 6e67 5265 6772 6573 736f 7228 2929  gingRegressor())
-00002780: 2c0d 0a20 2020 2020 2020 2028 2243 6174  ,..        ("Cat
-00002790: 426f 6f73 7420 5265 6772 6573 736f 7222  Boost Regressor"
-000027a0: 2c20 4361 7442 6f6f 7374 5265 6772 6573  , CatBoostRegres
-000027b0: 736f 7228 7665 7262 6f73 653d 302c 2072  sor(verbose=0, r
-000027c0: 616e 646f 6d5f 7365 6564 3d34 3229 292c  andom_seed=42)),
-000027d0: 0d0a 2020 2020 5d0d 0a0d 0a20 2020 2062  ..    ]....    b
-000027e0: 6573 745f 6d6f 6465 6c20 3d20 4e6f 6e65  est_model = None
-000027f0: 0d0a 2020 2020 6265 7374 5f6d 7365 203d  ..    best_mse =
-00002800: 2066 6c6f 6174 2822 696e 6622 290d 0a20   float("inf").. 
-00002810: 2020 2062 6573 745f 6d6f 6465 6c5f 696e     best_model_in
-00002820: 7374 616e 6365 203d 204e 6f6e 650d 0a0d  stance = None...
-00002830: 0a20 2020 2066 6f72 206e 616d 652c 206d  .    for name, m
-00002840: 6f64 656c 2069 6e20 6d6f 6465 6c73 3a0d  odel in models:.
-00002850: 0a20 2020 2020 2020 206d 6f64 656c 2e66  .        model.f
-00002860: 6974 2864 665f 585f 7472 6169 6e2c 2064  it(df_X_train, d
-00002870: 665f 795f 7472 6169 6e29 0d0a 2020 2020  f_y_train)..    
-00002880: 2020 2020 795f 7072 6564 203d 206d 6f64      y_pred = mod
-00002890: 656c 2e70 7265 6469 6374 2864 665f 585f  el.predict(df_X_
-000028a0: 7465 7374 290d 0a0d 0a20 2020 2020 2020  test)....       
-000028b0: 2070 7269 6e74 286e 616d 6520 2b20 2220   print(name + " 
-000028c0: 4d6f 6465 6c3a 2229 0d0a 2020 2020 2020  Model:")..      
-000028d0: 2020 6d73 6520 3d20 6d65 7472 6963 732e    mse = metrics.
-000028e0: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
-000028f0: 6f72 2864 665f 795f 7465 7374 2c20 795f  or(df_y_test, y_
-00002900: 7072 6564 290d 0a20 2020 2020 2020 2072  pred)..        r
-00002910: 6d73 6520 3d20 6e70 2e73 7172 7428 6d73  mse = np.sqrt(ms
-00002920: 6529 0d0a 2020 2020 2020 2020 7232 203d  e)..        r2 =
-00002930: 206d 6574 7269 6373 2e72 325f 7363 6f72   metrics.r2_scor
-00002940: 6528 6466 5f79 5f74 6573 742c 2079 5f70  e(df_y_test, y_p
-00002950: 7265 6429 0d0a 0d0a 2020 2020 2020 2020  red)....        
-00002960: 7072 696e 7428 224d 6561 6e20 5371 7561  print("Mean Squa
-00002970: 7265 6420 4572 726f 723a 222c 206d 7365  red Error:", mse
-00002980: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-00002990: 2822 526f 6f74 204d 6561 6e20 5371 7561  ("Root Mean Squa
-000029a0: 7265 6420 4572 726f 723a 222c 2072 6d73  red Error:", rms
-000029b0: 6529 0d0a 2020 2020 2020 2020 7072 696e  e)..        prin
-000029c0: 7428 2252 2d73 7175 6172 6564 3a22 2c20  t("R-squared:", 
-000029d0: 7232 290d 0a20 2020 2020 2020 2070 7269  r2)..        pri
-000029e0: 6e74 2829 0d0a 0d0a 2020 2020 2020 2020  nt()....        
-000029f0: 6966 206d 7365 203c 2062 6573 745f 6d73  if mse < best_ms
-00002a00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00002a10: 6265 7374 5f6d 7365 203d 206d 7365 0d0a  best_mse = mse..
-00002a20: 2020 2020 2020 2020 2020 2020 6265 7374              best
-00002a30: 5f6d 6f64 656c 203d 206e 616d 650d 0a20  _model = name.. 
-00002a40: 2020 2020 2020 2020 2020 2062 6573 745f             best_
-00002a50: 6d6f 6465 6c5f 696e 7374 616e 6365 203d  model_instance =
-00002a60: 206d 6f64 656c 0d0a 0d0a 2020 2020 7072   model....    pr
-00002a70: 696e 7428 2254 6865 2062 6573 7420 6d6f  int("The best mo
-00002a80: 6465 6c20 6973 3a22 2c20 6265 7374 5f6d  del is:", best_m
-00002a90: 6f64 656c 2c20 2277 6974 6820 6120 4d65  odel, "with a Me
-00002aa0: 616e 2053 7175 6172 6564 2045 7272 6f72  an Squared Error
-00002ab0: 206f 6622 2c20 6265 7374 5f6d 7365 290d   of", best_mse).
-00002ac0: 0a0d 0a20 2020 2023 2050 7269 6e74 2074  ...    # Print t
-00002ad0: 6865 206d 6574 7269 6373 2066 6f72 2074  he metrics for t
-00002ae0: 6865 2062 6573 7420 6d6f 6465 6c0d 0a20  he best model.. 
-00002af0: 2020 2079 5f70 7265 645f 6265 7374 203d     y_pred_best =
-00002b00: 2062 6573 745f 6d6f 6465 6c5f 696e 7374   best_model_inst
-00002b10: 616e 6365 2e70 7265 6469 6374 2864 665f  ance.predict(df_
-00002b20: 585f 7465 7374 290d 0a20 2020 2062 6573  X_test)..    bes
-00002b30: 745f 726d 7365 203d 206e 702e 7371 7274  t_rmse = np.sqrt
-00002b40: 2862 6573 745f 6d73 6529 0d0a 2020 2020  (best_mse)..    
-00002b50: 6265 7374 5f72 3220 3d20 6d65 7472 6963  best_r2 = metric
-00002b60: 732e 7232 5f73 636f 7265 2864 665f 795f  s.r2_score(df_y_
-00002b70: 7465 7374 2c20 795f 7072 6564 5f62 6573  test, y_pred_bes
-00002b80: 7429 0d0a 2020 2020 7072 696e 7428 224d  t)..    print("M
-00002b90: 6574 7269 6373 206f 6620 7468 6520 6265  etrics of the be
-00002ba0: 7374 206d 6f64 656c 3a22 290d 0a20 2020  st model:")..   
-00002bb0: 2070 7269 6e74 2822 4d65 616e 2053 7175   print("Mean Squ
-00002bc0: 6172 6564 2045 7272 6f72 3a22 2c20 6265  ared Error:", be
-00002bd0: 7374 5f6d 7365 290d 0a20 2020 2070 7269  st_mse)..    pri
-00002be0: 6e74 2822 526f 6f74 204d 6561 6e20 5371  nt("Root Mean Sq
-00002bf0: 7561 7265 6420 4572 726f 723a 222c 2062  uared Error:", b
-00002c00: 6573 745f 726d 7365 290d 0a20 2020 2070  est_rmse)..    p
-00002c10: 7269 6e74 2822 522d 7371 7561 7265 643a  rint("R-squared:
-00002c20: 222c 2062 6573 745f 7232 290d 0a0d 0a0d  ", best_r2).....
-00002c30: 0a0d 0a64 6566 2066 696e 645f 6265 7374  ...def find_best
-00002c40: 5f63 6c75 7374 6572 696e 675f 616c 676f  _clustering_algo
-00002c50: 7269 7468 6d28 6461 7461 2c20 7363 616c  rithm(data, scal
-00002c60: 696e 673d 5472 7565 2c20 6e5f 636c 7573  ing=True, n_clus
-00002c70: 7465 7273 3d4e 6f6e 652c 2076 6973 7561  ters=None, visua
-00002c80: 6c69 7a65 3d54 7275 652c 2074 6573 745f  lize=True, test_
-00002c90: 6665 6174 7572 655f 636f 6d62 696e 6174  feature_combinat
-00002ca0: 696f 6e73 3d46 616c 7365 293a 0d0a 2020  ions=False):..  
-00002cb0: 2020 696d 706f 7274 206e 756d 7079 2061    import numpy a
-00002cc0: 7320 6e70 0d0a 2020 2020 696d 706f 7274  s np..    import
-00002cd0: 2069 7465 7274 6f6f 6c73 0d0a 2020 2020   itertools..    
-00002ce0: 6672 6f6d 2073 6b6c 6561 726e 2e70 7265  from sklearn.pre
-00002cf0: 7072 6f63 6573 7369 6e67 2069 6d70 6f72  processing impor
-00002d00: 7420 5374 616e 6461 7264 5363 616c 6572  t StandardScaler
-00002d10: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
-00002d20: 726e 2e63 6c75 7374 6572 2069 6d70 6f72  rn.cluster impor
-00002d30: 7420 4b4d 6561 6e73 2c20 4d69 6e69 4261  t KMeans, MiniBa
-00002d40: 7463 684b 4d65 616e 732c 2041 6666 696e  tchKMeans, Affin
-00002d50: 6974 7950 726f 7061 6761 7469 6f6e 2c20  ityPropagation, 
-00002d60: 4d65 616e 5368 6966 742c 2065 7374 696d  MeanShift, estim
-00002d70: 6174 655f 6261 6e64 7769 6474 680d 0a20  ate_bandwidth.. 
-00002d80: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-00002d90: 636c 7573 7465 7220 696d 706f 7274 2053  cluster import S
-00002da0: 7065 6374 7261 6c43 6c75 7374 6572 696e  pectralClusterin
-00002db0: 672c 2041 6767 6c6f 6d65 7261 7469 7665  g, Agglomerative
-00002dc0: 436c 7573 7465 7269 6e67 2c20 4442 5343  Clustering, DBSC
-00002dd0: 414e 2c20 4f50 5449 4353 2c20 4269 7263  AN, OPTICS, Birc
-00002de0: 680d 0a20 2020 2066 726f 6d20 736b 6c65  h..    from skle
-00002df0: 6172 6e2e 6d69 7874 7572 6520 696d 706f  arn.mixture impo
-00002e00: 7274 2047 6175 7373 6961 6e4d 6978 7475  rt GaussianMixtu
-00002e10: 7265 0d0a 2020 2020 6672 6f6d 2073 6b6c  re..    from skl
-00002e20: 6561 726e 2e64 6563 6f6d 706f 7369 7469  earn.decompositi
-00002e30: 6f6e 2069 6d70 6f72 7420 5043 410d 0a20  on import PCA.. 
-00002e40: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-00002e50: 6d65 7472 6963 7320 696d 706f 7274 2073  metrics import s
-00002e60: 696c 686f 7565 7474 655f 7363 6f72 650d  ilhouette_score.
-00002e70: 0a20 2020 2069 6d70 6f72 7420 6d61 7470  .    import matp
-00002e80: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
-00002e90: 2070 6c74 0d0a 0d0a 2020 2020 6966 2073   plt....    if s
-00002ea0: 6361 6c69 6e67 3a0d 0a20 2020 2020 2020  caling:..       
-00002eb0: 2073 6361 6c65 7220 3d20 5374 616e 6461   scaler = Standa
-00002ec0: 7264 5363 616c 6572 2829 0d0a 2020 2020  rdScaler()..    
-00002ed0: 2020 2020 6461 7461 203d 2073 6361 6c65      data = scale
-00002ee0: 722e 6669 745f 7472 616e 7366 6f72 6d28  r.fit_transform(
-00002ef0: 6461 7461 290d 0a0d 0a20 2020 2069 6620  data)....    if 
-00002f00: 7465 7374 5f66 6561 7475 7265 5f63 6f6d  test_feature_com
-00002f10: 6269 6e61 7469 6f6e 733a 0d0a 2020 2020  binations:..    
-00002f20: 2020 2020 7072 696e 7428 225c 6e54 6573      print("\nTes
-00002f30: 7469 6e67 2064 6966 6665 7265 6e74 2066  ting different f
-00002f40: 6561 7475 7265 2063 6f6d 6269 6e61 7469  eature combinati
-00002f50: 6f6e 733a 2229 0d0a 2020 2020 2020 2020  ons:")..        
-00002f60: 666f 7220 6e75 6d5f 6665 6174 7572 6573  for num_features
-00002f70: 2069 6e20 7261 6e67 6528 312c 2064 6174   in range(1, dat
-00002f80: 612e 7368 6170 655b 315d 202b 2031 293a  a.shape[1] + 1):
-00002f90: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00002fa0: 7220 6665 6174 7572 655f 636f 6d62 696e  r feature_combin
-00002fb0: 6174 696f 6e20 696e 2069 7465 7274 6f6f  ation in itertoo
-00002fc0: 6c73 2e63 6f6d 6269 6e61 7469 6f6e 7328  ls.combinations(
-00002fd0: 7261 6e67 6528 6461 7461 2e73 6861 7065  range(data.shape
-00002fe0: 5b31 5d29 2c20 6e75 6d5f 6665 6174 7572  [1]), num_featur
-00002ff0: 6573 293a 0d0a 2020 2020 2020 2020 2020  es):..          
-00003000: 2020 2020 2020 7265 6475 6365 645f 6461        reduced_da
-00003010: 7461 203d 2064 6174 615b 3a2c 2066 6561  ta = data[:, fea
-00003020: 7475 7265 5f63 6f6d 6269 6e61 7469 6f6e  ture_combination
-00003030: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00003040: 2020 205f 2c20 5f2c 2073 636f 7265 203d     _, _, score =
-00003050: 2066 696e 645f 6265 7374 5f63 6c75 7374   find_best_clust
-00003060: 6572 696e 675f 616c 676f 7269 7468 6d28  ering_algorithm(
-00003070: 7265 6475 6365 645f 6461 7461 2c20 7363  reduced_data, sc
-00003080: 616c 696e 673d 4661 6c73 652c 206e 5f63  aling=False, n_c
-00003090: 6c75 7374 6572 733d 6e5f 636c 7573 7465  lusters=n_cluste
-000030a0: 7273 2c20 7669 7375 616c 697a 653d 4661  rs, visualize=Fa
-000030b0: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
-000030c0: 2020 2020 2020 7072 696e 7428 6622 5369        print(f"Si
-000030d0: 6c68 6f75 6574 7465 2073 636f 7265 2066  lhouette score f
-000030e0: 6f72 2066 6561 7475 7265 7320 7b66 6561  or features {fea
-000030f0: 7475 7265 5f63 6f6d 6269 6e61 7469 6f6e  ture_combination
-00003100: 7d3a 207b 7363 6f72 657d 2229 0d0a 0d0a  }: {score}")....
-00003110: 2020 2020 636c 7573 7465 7269 6e67 5f61      clustering_a
-00003120: 6c67 6f72 6974 686d 7320 3d20 5b0d 0a20  lgorithms = [.. 
-00003130: 2020 2020 2020 2028 224b 4d65 616e 7322         ("KMeans"
-00003140: 2c20 4b4d 6561 6e73 286e 5f63 6c75 7374  , KMeans(n_clust
-00003150: 6572 733d 6e5f 636c 7573 7465 7273 2920  ers=n_clusters) 
-00003160: 6966 206e 5f63 6c75 7374 6572 7320 656c  if n_clusters el
-00003170: 7365 204b 4d65 616e 7328 2929 2c0d 0a20  se KMeans()),.. 
-00003180: 2020 2020 2020 2028 224d 696e 6942 6174         ("MiniBat
-00003190: 6368 4b4d 6561 6e73 222c 204d 696e 6942  chKMeans", MiniB
-000031a0: 6174 6368 4b4d 6561 6e73 286e 5f63 6c75  atchKMeans(n_clu
-000031b0: 7374 6572 733d 6e5f 636c 7573 7465 7273  sters=n_clusters
-000031c0: 2920 6966 206e 5f63 6c75 7374 6572 7320  ) if n_clusters 
-000031d0: 656c 7365 204d 696e 6942 6174 6368 4b4d  else MiniBatchKM
-000031e0: 6561 6e73 2829 292c 0d0a 2020 2020 2020  eans()),..      
-000031f0: 2020 2822 4166 6669 6e69 7479 5072 6f70    ("AffinityProp
-00003200: 6167 6174 696f 6e22 2c20 4166 6669 6e69  agation", Affini
-00003210: 7479 5072 6f70 6167 6174 696f 6e28 2929  tyPropagation())
-00003220: 2c0d 0a20 2020 2020 2020 2028 224d 6561  ,..        ("Mea
-00003230: 6e53 6869 6674 222c 204d 6561 6e53 6869  nShift", MeanShi
-00003240: 6674 2862 616e 6477 6964 7468 3d65 7374  ft(bandwidth=est
-00003250: 696d 6174 655f 6261 6e64 7769 6474 6828  imate_bandwidth(
-00003260: 6461 7461 2c20 6e5f 7361 6d70 6c65 733d  data, n_samples=
-00003270: 6e5f 636c 7573 7465 7273 2929 2069 6620  n_clusters)) if 
-00003280: 6e5f 636c 7573 7465 7273 2065 6c73 6520  n_clusters else 
-00003290: 4d65 616e 5368 6966 7428 2929 2c0d 0a20  MeanShift()),.. 
-000032a0: 2020 2020 2020 2028 2253 7065 6374 7261         ("Spectra
-000032b0: 6c43 6c75 7374 6572 696e 6722 2c20 5370  lClustering", Sp
-000032c0: 6563 7472 616c 436c 7573 7465 7269 6e67  ectralClustering
-000032d0: 286e 5f63 6c75 7374 6572 733d 6e5f 636c  (n_clusters=n_cl
-000032e0: 7573 7465 7273 2920 6966 206e 5f63 6c75  usters) if n_clu
-000032f0: 7374 6572 7320 656c 7365 2053 7065 6374  sters else Spect
-00003300: 7261 6c43 6c75 7374 6572 696e 6728 2929  ralClustering())
-00003310: 2c0d 0a20 2020 2020 2020 2028 2241 6767  ,..        ("Agg
-00003320: 6c6f 6d65 7261 7469 7665 436c 7573 7465  lomerativeCluste
-00003330: 7269 6e67 222c 2041 6767 6c6f 6d65 7261  ring", Agglomera
-00003340: 7469 7665 436c 7573 7465 7269 6e67 286e  tiveClustering(n
-00003350: 5f63 6c75 7374 6572 733d 6e5f 636c 7573  _clusters=n_clus
-00003360: 7465 7273 2920 6966 206e 5f63 6c75 7374  ters) if n_clust
-00003370: 6572 7320 656c 7365 2041 6767 6c6f 6d65  ers else Agglome
-00003380: 7261 7469 7665 436c 7573 7465 7269 6e67  rativeClustering
-00003390: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
-000033a0: 4442 5343 414e 222c 2044 4253 4341 4e28  DBSCAN", DBSCAN(
-000033b0: 2929 2c0d 0a20 2020 2020 2020 2028 224f  )),..        ("O
-000033c0: 5054 4943 5322 2c20 4f50 5449 4353 2829  PTICS", OPTICS()
-000033d0: 292c 0d0a 2020 2020 2020 2020 2822 4269  ),..        ("Bi
-000033e0: 7263 6822 2c20 4269 7263 6828 6e5f 636c  rch", Birch(n_cl
-000033f0: 7573 7465 7273 3d6e 5f63 6c75 7374 6572  usters=n_cluster
-00003400: 7329 2069 6620 6e5f 636c 7573 7465 7273  s) if n_clusters
-00003410: 2065 6c73 6520 4269 7263 6828 2929 2c0d   else Birch()),.
-00003420: 0a20 2020 2020 2020 2028 2247 6175 7373  .        ("Gauss
-00003430: 6961 6e4d 6978 7475 7265 222c 2047 6175  ianMixture", Gau
-00003440: 7373 6961 6e4d 6978 7475 7265 286e 5f63  ssianMixture(n_c
-00003450: 6f6d 706f 6e65 6e74 733d 6e5f 636c 7573  omponents=n_clus
-00003460: 7465 7273 2920 6966 206e 5f63 6c75 7374  ters) if n_clust
-00003470: 6572 7320 656c 7365 2047 6175 7373 6961  ers else Gaussia
-00003480: 6e4d 6978 7475 7265 2829 290d 0a20 2020  nMixture())..   
-00003490: 205d 0d0a 0d0a 2020 2020 6265 7374 5f61   ]....    best_a
-000034a0: 6c67 6f72 6974 686d 203d 204e 6f6e 650d  lgorithm = None.
-000034b0: 0a20 2020 2062 6573 745f 616c 676f 7269  .    best_algori
-000034c0: 7468 6d5f 6e61 6d65 203d 2022 220d 0a20  thm_name = "".. 
-000034d0: 2020 2062 6573 745f 7363 6f72 6520 3d20     best_score = 
-000034e0: 2d6e 702e 696e 660d 0a0d 0a20 2020 2066  -np.inf....    f
-000034f0: 6f72 206e 616d 652c 2061 6c67 6f72 6974  or name, algorit
-00003500: 686d 2069 6e20 636c 7573 7465 7269 6e67  hm in clustering
-00003510: 5f61 6c67 6f72 6974 686d 733a 0d0a 2020  _algorithms:..  
-00003520: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00003530: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00003540: 7461 6e63 6528 616c 676f 7269 7468 6d2c  tance(algorithm,
-00003550: 2047 6175 7373 6961 6e4d 6978 7475 7265   GaussianMixture
-00003560: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00003570: 2020 2020 616c 676f 7269 7468 6d2e 6669      algorithm.fi
-00003580: 7428 6461 7461 290d 0a20 2020 2020 2020  t(data)..       
-00003590: 2020 2020 2020 2020 206c 6162 656c 7320           labels 
-000035a0: 3d20 616c 676f 7269 7468 6d2e 7072 6564  = algorithm.pred
-000035b0: 6963 7428 6461 7461 290d 0a20 2020 2020  ict(data)..     
-000035c0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000035d0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-000035e0: 6265 6c73 203d 2061 6c67 6f72 6974 686d  bels = algorithm
-000035f0: 2e66 6974 5f70 7265 6469 6374 2864 6174  .fit_predict(dat
-00003600: 6129 0d0a 0d0a 2020 2020 2020 2020 2020  a)....          
-00003610: 2020 6966 206c 656e 286e 702e 756e 6971    if len(np.uniq
-00003620: 7565 286c 6162 656c 7329 2920 3e20 313a  ue(labels)) > 1:
-00003630: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003640: 2020 7363 6f72 6520 3d20 7369 6c68 6f75    score = silhou
-00003650: 6574 7465 5f73 636f 7265 2864 6174 612c  ette_score(data,
-00003660: 206c 6162 656c 7329 0d0a 2020 2020 2020   labels)..      
-00003670: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00003680: 6622 7b6e 616d 657d 2041 6c67 6f72 6974  f"{name} Algorit
-00003690: 686d 3a22 290d 0a20 2020 2020 2020 2020  hm:")..         
-000036a0: 2020 2020 2020 2070 7269 6e74 2822 5369         print("Si
-000036b0: 6c68 6f75 6574 7465 2053 636f 7265 3a22  lhouette Score:"
-000036c0: 2c20 7363 6f72 6529 0d0a 2020 2020 2020  , score)..      
-000036d0: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
-000036e0: 7265 203e 2062 6573 745f 7363 6f72 653a  re > best_score:
-000036f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003700: 2020 2020 2020 6265 7374 5f73 636f 7265        best_score
-00003710: 203d 2073 636f 7265 0d0a 2020 2020 2020   = score..      
-00003720: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00003730: 7374 5f61 6c67 6f72 6974 686d 203d 2061  st_algorithm = a
-00003740: 6c67 6f72 6974 686d 0d0a 2020 2020 2020  lgorithm..      
-00003750: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00003760: 7374 5f61 6c67 6f72 6974 686d 5f6e 616d  st_algorithm_nam
-00003770: 6520 3d20 6e61 6d65 0d0a 2020 2020 2020  e = name..      
-00003780: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00003790: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
-000037a0: 2020 2020 2020 7072 696e 7428 6622 416e        print(f"An
-000037b0: 2065 7272 6f72 206f 6363 7572 7265 6420   error occurred 
-000037c0: 7768 696c 6520 7072 6f63 6573 7369 6e67  while processing
-000037d0: 207b 6e61 6d65 7d3a 207b 657d 2229 0d0a   {name}: {e}")..
-000037e0: 0d0a 2020 2020 7072 696e 7428 2254 6865  ..    print("The
-000037f0: 2062 6573 7420 636c 7573 7465 7269 6e67   best clustering
-00003800: 2061 6c67 6f72 6974 686d 2069 733a 222c   algorithm is:",
-00003810: 2062 6573 745f 616c 676f 7269 7468 6d5f   best_algorithm_
-00003820: 6e61 6d65 2c20 2277 6974 6820 6120 7369  name, "with a si
-00003830: 6c68 6f75 6574 7465 2073 636f 7265 206f  lhouette score o
-00003840: 6622 2c20 6265 7374 5f73 636f 7265 290d  f", best_score).
-00003850: 0a20 2020 2070 6361 203d 2050 4341 286e  .    pca = PCA(n
-00003860: 5f63 6f6d 706f 6e65 6e74 733d 3229 0d0a  _components=2)..
-00003870: 2020 2020 585f 7063 6120 3d20 7063 612e      X_pca = pca.
-00003880: 6669 745f 7472 616e 7366 6f72 6d28 6461  fit_transform(da
-00003890: 7461 290d 0a0d 0a20 2020 2069 6620 6973  ta)....    if is
-000038a0: 696e 7374 616e 6365 2862 6573 745f 616c  instance(best_al
-000038b0: 676f 7269 7468 6d2c 2047 6175 7373 6961  gorithm, Gaussia
-000038c0: 6e4d 6978 7475 7265 293a 0d0a 2020 2020  nMixture):..    
-000038d0: 2020 2020 6265 7374 5f61 6c67 6f72 6974      best_algorit
-000038e0: 686d 2e66 6974 2864 6174 6129 0d0a 2020  hm.fit(data)..  
-000038f0: 2020 2020 2020 636c 7573 7465 725f 6c61        cluster_la
-00003900: 6265 6c73 203d 2062 6573 745f 616c 676f  bels = best_algo
-00003910: 7269 7468 6d2e 7072 6564 6963 7428 6461  rithm.predict(da
-00003920: 7461 290d 0a20 2020 2065 6c73 653a 0d0a  ta)..    else:..
-00003930: 2020 2020 2020 2020 636c 7573 7465 725f          cluster_
-00003940: 6c61 6265 6c73 203d 2062 6573 745f 616c  labels = best_al
-00003950: 676f 7269 7468 6d2e 6669 745f 7072 6564  gorithm.fit_pred
-00003960: 6963 7428 6461 7461 290d 0a0d 0a20 2020  ict(data)....   
-00003970: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
-00003980: 697a 653d 2831 302c 2036 2929 0d0a 2020  ize=(10, 6))..  
-00003990: 2020 706c 742e 7363 6174 7465 7228 585f    plt.scatter(X_
-000039a0: 7063 615b 3a2c 2030 5d2c 2058 5f70 6361  pca[:, 0], X_pca
-000039b0: 5b3a 2c20 315d 2c20 633d 636c 7573 7465  [:, 1], c=cluste
-000039c0: 725f 6c61 6265 6c73 2c20 636d 6170 3d27  r_labels, cmap='
-000039d0: 7669 7269 6469 7327 2c20 6564 6765 636f  viridis', edgeco
-000039e0: 6c6f 7273 3d27 6b27 2c20 733d 3530 290d  lors='k', s=50).
-000039f0: 0a20 2020 200d 0a20 2020 2070 6c74 2e74  .    ..    plt.t
-00003a00: 6974 6c65 2827 5363 6174 7465 7220 506c  itle('Scatter Pl
-00003a10: 6f74 2066 6f72 2074 6865 2042 6573 7420  ot for the Best 
-00003a20: 436c 7573 7465 7269 6e67 204d 6f64 656c  Clustering Model
-00003a30: 3a20 2720 2b20 6265 7374 5f61 6c67 6f72  : ' + best_algor
-00003a40: 6974 686d 5f6e 616d 6529 0d0a 2020 2020  ithm_name)..    
-00003a50: 706c 742e 786c 6162 656c 2827 5072 696e  plt.xlabel('Prin
-00003a60: 6369 7061 6c20 436f 6d70 6f6e 656e 7420  cipal Component 
-00003a70: 3127 290d 0a20 2020 2070 6c74 2e79 6c61  1')..    plt.yla
-00003a80: 6265 6c28 2750 7269 6e63 6970 616c 2043  bel('Principal C
-00003a90: 6f6d 706f 6e65 6e74 2032 2729 0d0a 2020  omponent 2')..  
-00003aa0: 2020 706c 742e 7368 6f77 2829 0d0a 2020    plt.show()..  
-00003ab0: 2020 7265 7475 726e 2062 6573 745f 616c    return best_al
-00003ac0: 676f 7269 7468 6d5f 6e61 6d65 2c20 6265  gorithm_name, be
-00003ad0: 7374 5f61 6c67 6f72 6974 686d 2c20 6265  st_algorithm, be
-00003ae0: 7374 5f73 636f 7265 0d0a 0d0a 0d0a 6465  st_score......de
-00003af0: 6620 6669 6e64 5f62 6573 745f 6d6f 6465  f find_best_mode
-00003b00: 6c5f 7265 6772 6573 7369 6f6e 5f32 2858  l_regression_2(X
-00003b10: 2c20 792c 2074 6573 745f 7369 7a65 3d30  , y, test_size=0
-00003b20: 2e32 2c20 7261 6e64 6f6d 5f73 7461 7465  .2, random_state
-00003b30: 3d34 322c 2063 763d 3529 3a0d 0a20 2020  =42, cv=5):..   
-00003b40: 200d 0a20 2020 2069 6d70 6f72 7420 6e75   ..    import nu
-00003b50: 6d70 7920 6173 206e 700d 0a20 2020 2069  mpy as np..    i
-00003b60: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
-00003b70: 7064 0d0a 2020 2020 6672 6f6d 2073 6b6c  pd..    from skl
-00003b80: 6561 726e 2e6c 696e 6561 725f 6d6f 6465  earn.linear_mode
-00003b90: 6c20 696d 706f 7274 204c 696e 6561 7252  l import LinearR
-00003ba0: 6567 7265 7373 696f 6e2c 2052 6964 6765  egression, Ridge
-00003bb0: 2c20 4c61 7373 6f2c 2045 6c61 7374 6963  , Lasso, Elastic
-00003bc0: 4e65 742c 2042 6179 6573 6961 6e52 6964  Net, BayesianRid
-00003bd0: 6765 2c20 5347 4452 6567 7265 7373 6f72  ge, SGDRegressor
-00003be0: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
-00003bf0: 726e 2e74 7265 6520 696d 706f 7274 2044  rn.tree import D
-00003c00: 6563 6973 696f 6e54 7265 6552 6567 7265  ecisionTreeRegre
-00003c10: 7373 6f72 0d0a 2020 2020 6672 6f6d 2073  ssor..    from s
-00003c20: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
-00003c30: 696d 706f 7274 2052 616e 646f 6d46 6f72  import RandomFor
-00003c40: 6573 7452 6567 7265 7373 6f72 2c20 4772  estRegressor, Gr
-00003c50: 6164 6965 6e74 426f 6f73 7469 6e67 5265  adientBoostingRe
-00003c60: 6772 6573 736f 722c 2041 6461 426f 6f73  gressor, AdaBoos
-00003c70: 7452 6567 7265 7373 6f72 2c20 4578 7472  tRegressor, Extr
-00003c80: 6154 7265 6573 5265 6772 6573 736f 722c  aTreesRegressor,
-00003c90: 2042 6167 6769 6e67 5265 6772 6573 736f   BaggingRegresso
-00003ca0: 720d 0a20 2020 2066 726f 6d20 736b 6c65  r..    from skle
-00003cb0: 6172 6e2e 7376 6d20 696d 706f 7274 2053  arn.svm import S
-00003cc0: 5652 0d0a 2020 2020 6672 6f6d 2073 6b6c  VR..    from skl
-00003cd0: 6561 726e 2e6e 6569 6768 626f 7273 2069  earn.neighbors i
-00003ce0: 6d70 6f72 7420 4b4e 6569 6768 626f 7273  mport KNeighbors
-00003cf0: 5265 6772 6573 736f 720d 0a20 2020 2066  Regressor..    f
-00003d00: 726f 6d20 736b 6c65 6172 6e2e 6e65 7572  rom sklearn.neur
-00003d10: 616c 5f6e 6574 776f 726b 2069 6d70 6f72  al_network impor
-00003d20: 7420 4d4c 5052 6567 7265 7373 6f72 0d0a  t MLPRegressor..
-00003d30: 2020 2020 6672 6f6d 2078 6762 6f6f 7374      from xgboost
-00003d40: 2069 6d70 6f72 7420 5847 4252 6567 7265   import XGBRegre
-00003d50: 7373 6f72 0d0a 2020 2020 6672 6f6d 206c  ssor..    from l
-00003d60: 6967 6874 6762 6d20 696d 706f 7274 204c  ightgbm import L
-00003d70: 4742 4d52 6567 7265 7373 6f72 0d0a 2020  GBMRegressor..  
-00003d80: 2020 6672 6f6d 2063 6174 626f 6f73 7420    from catboost 
-00003d90: 696d 706f 7274 2043 6174 426f 6f73 7452  import CatBoostR
-00003da0: 6567 7265 7373 6f72 0d0a 2020 2020 6672  egressor..    fr
-00003db0: 6f6d 2073 6b6c 6561 726e 2069 6d70 6f72  om sklearn impor
-00003dc0: 7420 6d65 7472 6963 730d 0a20 2020 2066  t metrics..    f
-00003dd0: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
-00003de0: 6963 7320 696d 706f 7274 206d 6561 6e5f  ics import mean_
-00003df0: 7371 7561 7265 645f 6572 726f 722c 2072  squared_error, r
-00003e00: 325f 7363 6f72 650d 0a20 2020 2066 726f  2_score..    fro
-00003e10: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
-00003e20: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
-00003e30: 2074 7261 696e 5f74 6573 745f 7370 6c69   train_test_spli
-00003e40: 742c 2063 726f 7373 5f76 616c 5f73 636f  t, cross_val_sco
-00003e50: 7265 2c20 6c65 6172 6e69 6e67 5f63 7572  re, learning_cur
-00003e60: 7665 0d0a 2020 2020 696d 706f 7274 206d  ve..    import m
-00003e70: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
-00003e80: 2061 7320 706c 740d 0a0d 0a20 2020 206d   as plt....    m
-00003e90: 6f64 656c 7320 3d20 5b0d 0a20 2020 2020  odels = [..     
-00003ea0: 2020 2028 224c 696e 6561 7220 5265 6772     ("Linear Regr
-00003eb0: 6573 7369 6f6e 222c 204c 696e 6561 7252  ession", LinearR
-00003ec0: 6567 7265 7373 696f 6e28 2929 2c0d 0a20  egression()),.. 
-00003ed0: 2020 2020 2020 2028 2252 6964 6765 2052         ("Ridge R
-00003ee0: 6567 7265 7373 696f 6e22 2c20 5269 6467  egression", Ridg
-00003ef0: 6528 2929 2c0d 0a20 2020 2020 2020 2028  e()),..        (
-00003f00: 224c 6173 736f 2052 6567 7265 7373 696f  "Lasso Regressio
-00003f10: 6e22 2c20 4c61 7373 6f28 2929 2c0d 0a20  n", Lasso()),.. 
-00003f20: 2020 2020 2020 2028 2245 6c61 7374 6963         ("Elastic
-00003f30: 4e65 7420 5265 6772 6573 7369 6f6e 222c  Net Regression",
-00003f40: 2045 6c61 7374 6963 4e65 7428 2929 2c0d   ElasticNet()),.
-00003f50: 0a20 2020 2020 2020 2028 2242 6179 6573  .        ("Bayes
-00003f60: 6961 6e20 5269 6467 6520 5265 6772 6573  ian Ridge Regres
-00003f70: 7369 6f6e 222c 2042 6179 6573 6961 6e52  sion", BayesianR
-00003f80: 6964 6765 2829 292c 0d0a 2020 2020 2020  idge()),..      
-00003f90: 2020 2822 4465 6369 7369 6f6e 2054 7265    ("Decision Tre
-00003fa0: 6520 5265 6772 6573 736f 7222 2c20 4465  e Regressor", De
-00003fb0: 6369 7369 6f6e 5472 6565 5265 6772 6573  cisionTreeRegres
-00003fc0: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
-00003fd0: 2028 2252 616e 646f 6d20 466f 7265 7374   ("Random Forest
-00003fe0: 2052 6567 7265 7373 6f72 222c 2052 616e   Regressor", Ran
-00003ff0: 646f 6d46 6f72 6573 7452 6567 7265 7373  domForestRegress
-00004000: 6f72 2829 292c 0d0a 2020 2020 2020 2020  or()),..        
-00004010: 2822 4772 6164 6965 6e74 2042 6f6f 7374  ("Gradient Boost
-00004020: 696e 6720 5265 6772 6573 736f 7222 2c20  ing Regressor", 
-00004030: 4772 6164 6965 6e74 426f 6f73 7469 6e67  GradientBoosting
-00004040: 5265 6772 6573 736f 7228 2929 2c0d 0a20  Regressor()),.. 
-00004050: 2020 2020 2020 2028 2258 4742 6f6f 7374         ("XGBoost
-00004060: 2052 6567 7265 7373 6f72 222c 2058 4742   Regressor", XGB
-00004070: 5265 6772 6573 736f 7228 6576 616c 5f6d  Regressor(eval_m
-00004080: 6574 7269 633d 2272 6d73 6522 2929 2c0d  etric="rmse")),.
-00004090: 0a20 2020 2020 2020 2028 224c 6967 6874  .        ("Light
-000040a0: 4742 4d20 5265 6772 6573 736f 7222 2c20  GBM Regressor", 
-000040b0: 4c47 424d 5265 6772 6573 736f 7228 2929  LGBMRegressor())
-000040c0: 2c0d 0a20 2020 2020 2020 2028 2253 7570  ,..        ("Sup
-000040d0: 706f 7274 2056 6563 746f 7220 5265 6772  port Vector Regr
-000040e0: 6573 736f 7222 2c20 5356 5228 2929 2c0d  essor", SVR()),.
-000040f0: 0a20 2020 2020 2020 2028 224b 2d4e 6561  .        ("K-Nea
-00004100: 7265 7374 204e 6569 6768 626f 7273 2052  rest Neighbors R
-00004110: 6567 7265 7373 6f72 222c 204b 4e65 6967  egressor", KNeig
-00004120: 6862 6f72 7352 6567 7265 7373 6f72 2829  hborsRegressor()
-00004130: 292c 0d0a 2020 2020 2020 2020 2822 4d75  ),..        ("Mu
-00004140: 6c74 692d 6c61 7965 7220 5065 7263 6570  lti-layer Percep
-00004150: 7472 6f6e 2052 6567 7265 7373 6f72 222c  tron Regressor",
-00004160: 204d 4c50 5265 6772 6573 736f 7228 6d61   MLPRegressor(ma
-00004170: 785f 6974 6572 3d31 3030 3029 292c 0d0a  x_iter=1000)),..
-00004180: 2020 2020 2020 2020 2822 4164 6142 6f6f          ("AdaBoo
-00004190: 7374 2052 6567 7265 7373 6f72 222c 2041  st Regressor", A
-000041a0: 6461 426f 6f73 7452 6567 7265 7373 6f72  daBoostRegressor
-000041b0: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
-000041c0: 4578 7472 6120 5472 6565 7320 5265 6772  Extra Trees Regr
-000041d0: 6573 736f 7222 2c20 4578 7472 6154 7265  essor", ExtraTre
-000041e0: 6573 5265 6772 6573 736f 7228 2929 2c0d  esRegressor()),.
-000041f0: 0a20 2020 2020 2020 2028 2253 746f 6368  .        ("Stoch
-00004200: 6173 7469 6320 4772 6164 6965 6e74 2044  astic Gradient D
-00004210: 6573 6365 6e74 2052 6567 7265 7373 6f72  escent Regressor
-00004220: 222c 2053 4744 5265 6772 6573 736f 7228  ", SGDRegressor(
-00004230: 2929 2c0d 0a20 2020 2020 2020 2028 2242  )),..        ("B
-00004240: 6167 6769 6e67 2052 6567 7265 7373 6f72  agging Regressor
-00004250: 222c 2042 6167 6769 6e67 5265 6772 6573  ", BaggingRegres
-00004260: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
-00004270: 2028 2243 6174 426f 6f73 7420 5265 6772   ("CatBoost Regr
-00004280: 6573 736f 7222 2c20 4361 7442 6f6f 7374  essor", CatBoost
-00004290: 5265 6772 6573 736f 7228 7665 7262 6f73  Regressor(verbos
-000042a0: 653d 302c 2072 616e 646f 6d5f 7365 6564  e=0, random_seed
-000042b0: 3d34 3229 292c 0d0a 2020 2020 5d0d 0a0d  =42)),..    ]...
-000042c0: 0a20 2020 206e 5f73 616d 706c 6573 203d  .    n_samples =
-000042d0: 2058 2e73 6861 7065 5b30 5d0d 0a20 2020   X.shape[0]..   
-000042e0: 2061 646a 7573 7465 645f 7465 7374 5f73   adjusted_test_s
-000042f0: 697a 6520 3d20 696e 7428 7465 7374 5f73  ize = int(test_s
-00004300: 697a 6520 2a20 6e5f 7361 6d70 6c65 7329  ize * n_samples)
-00004310: 0d0a 0d0a 2020 2020 6265 7374 5f6d 6f64  ....    best_mod
-00004320: 656c 203d 204e 6f6e 650d 0a20 2020 2062  el = None..    b
-00004330: 6573 745f 6d73 6520 3d20 666c 6f61 7428  est_mse = float(
-00004340: 2269 6e66 2229 0d0a 2020 2020 6265 7374  "inf")..    best
-00004350: 5f6d 6f64 656c 5f69 6e73 7461 6e63 6520  _model_instance 
-00004360: 3d20 4e6f 6e65 0d0a 0d0a 2020 2020 666f  = None....    fo
-00004370: 7220 6e61 6d65 2c20 6d6f 6465 6c20 696e  r name, model in
-00004380: 206d 6f64 656c 733a 0d0a 2020 2020 2020   models:..      
-00004390: 2020 585f 7472 6169 6e2c 2058 5f74 6573    X_train, X_tes
-000043a0: 742c 2079 5f74 7261 696e 2c20 795f 7465  t, y_train, y_te
-000043b0: 7374 203d 2074 7261 696e 5f74 6573 745f  st = train_test_
-000043c0: 7370 6c69 7428 582c 2079 2c20 7465 7374  split(X, y, test
-000043d0: 5f73 697a 653d 7465 7374 5f73 697a 652c  _size=test_size,
-000043e0: 2072 616e 646f 6d5f 7374 6174 653d 7261   random_state=ra
-000043f0: 6e64 6f6d 5f73 7461 7465 290d 0a20 2020  ndom_state)..   
-00004400: 2020 2020 2058 5f74 7261 696e 2c20 585f       X_train, X_
-00004410: 7661 6c2c 2079 5f74 7261 696e 2c20 795f  val, y_train, y_
-00004420: 7661 6c20 3d20 7472 6169 6e5f 7465 7374  val = train_test
-00004430: 5f73 706c 6974 2858 5f74 7261 696e 2c20  _split(X_train, 
-00004440: 795f 7472 6169 6e2c 2074 6573 745f 7369  y_train, test_si
-00004450: 7a65 3d74 6573 745f 7369 7a65 2c20 7261  ze=test_size, ra
-00004460: 6e64 6f6d 5f73 7461 7465 3d72 616e 646f  ndom_state=rando
-00004470: 6d5f 7374 6174 6529 0d0a 2020 2020 2020  m_state)..      
-00004480: 2020 6d6f 6465 6c2e 6669 7428 585f 7472    model.fit(X_tr
-00004490: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
-000044a0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000044b0: 2070 7269 6e74 286e 616d 6520 2b20 2220   print(name + " 
-000044c0: 4d6f 6465 6c3a 2229 0d0a 2020 2020 2020  Model:")..      
-000044d0: 2020 6576 616c 7561 7465 5f6d 6f64 656c    evaluate_model
-000044e0: 286d 6f64 656c 2c20 582c 2079 2c20 7465  (model, X, y, te
-000044f0: 7374 5f73 697a 653d 6164 6a75 7374 6564  st_size=adjusted
-00004500: 5f74 6573 745f 7369 7a65 2c20 7261 6e64  _test_size, rand
-00004510: 6f6d 5f73 7461 7465 3d72 616e 646f 6d5f  om_state=random_
-00004520: 7374 6174 652c 2063 763d 6376 290d 0a20  state, cv=cv).. 
-00004530: 2020 2020 2020 2070 7269 6e74 2829 0d0a         print()..
-00004540: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
-00004550: 203d 206d 6f64 656c 2e70 7265 6469 6374   = model.predict
-00004560: 2858 5f74 6573 7429 0d0a 2020 2020 2020  (X_test)..      
-00004570: 2020 6d73 6520 3d20 6d65 616e 5f73 7175    mse = mean_squ
-00004580: 6172 6564 5f65 7272 6f72 2879 5f74 6573  ared_error(y_tes
-00004590: 742c 2079 5f70 7265 6429 0d0a 2020 2020  t, y_pred)..    
-000045a0: 2020 2020 726d 7365 203d 206e 702e 7371      rmse = np.sq
-000045b0: 7274 286d 7365 290d 0a20 2020 2020 2020  rt(mse)..       
-000045c0: 2072 3220 3d20 7232 5f73 636f 7265 2879   r2 = r2_score(y
-000045d0: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
-000045e0: 0d0a 2020 2020 2020 2020 6966 206d 7365  ..        if mse
-000045f0: 203c 2062 6573 745f 6d73 653a 0d0a 2020   < best_mse:..  
-00004600: 2020 2020 2020 2020 2020 6265 7374 5f6d            best_m
-00004610: 7365 203d 206d 7365 0d0a 2020 2020 2020  se = mse..      
-00004620: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
-00004630: 203d 206e 616d 650d 0a20 2020 2020 2020   = name..       
-00004640: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
-00004650: 696e 7374 616e 6365 203d 206d 6f64 656c  instance = model
-00004660: 0d0a 0d0a 2020 2020 7072 696e 7428 2254  ....    print("T
-00004670: 6865 2062 6573 7420 6d6f 6465 6c20 6973  he best model is
-00004680: 3a22 2c20 6265 7374 5f6d 6f64 656c 2c20  :", best_model, 
-00004690: 2277 6974 6820 6120 4d65 616e 2053 7175  "with a Mean Squ
-000046a0: 6172 6564 2045 7272 6f72 206f 6622 2c20  ared Error of", 
-000046b0: 6265 7374 5f6d 7365 290d 0a0d 0a20 2020  best_mse)....   
-000046c0: 2023 2050 7269 6e74 2074 6865 206d 6574   # Print the met
-000046d0: 7269 6373 2066 6f72 2074 6865 2062 6573  rics for the bes
-000046e0: 7420 6d6f 6465 6c0d 0a20 2020 2058 5f74  t model..    X_t
-000046f0: 7261 696e 2c20 585f 7465 7374 2c20 795f  rain, X_test, y_
-00004700: 7472 6169 6e2c 2079 5f74 6573 7420 3d20  train, y_test = 
-00004710: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
-00004720: 2858 2c20 792c 2074 6573 745f 7369 7a65  (X, y, test_size
-00004730: 3d74 6573 745f 7369 7a65 2c20 7261 6e64  =test_size, rand
-00004740: 6f6d 5f73 7461 7465 3d72 616e 646f 6d5f  om_state=random_
-00004750: 7374 6174 6529 0d0a 2020 2020 585f 7472  state)..    X_tr
-00004760: 6169 6e2c 2058 5f76 616c 2c20 795f 7472  ain, X_val, y_tr
-00004770: 6169 6e2c 2079 5f76 616c 203d 2074 7261  ain, y_val = tra
-00004780: 696e 5f74 6573 745f 7370 6c69 7428 585f  in_test_split(X_
-00004790: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
-000047a0: 7465 7374 5f73 697a 653d 7465 7374 5f73  test_size=test_s
-000047b0: 697a 652c 2072 616e 646f 6d5f 7374 6174  ize, random_stat
-000047c0: 653d 7261 6e64 6f6d 5f73 7461 7465 290d  e=random_state).
-000047d0: 0a20 2020 2023 2046 6974 2074 6865 2062  .    # Fit the b
-000047e0: 6573 7420 6d6f 6465 6c20 6f6e 2074 6865  est model on the
-000047f0: 2074 7261 696e 696e 6720 6461 7461 0d0a   training data..
-00004800: 2020 2020 6265 7374 5f6d 6f64 656c 5f69      best_model_i
-00004810: 6e73 7461 6e63 652e 6669 7428 585f 7472  nstance.fit(X_tr
-00004820: 6169 6e2c 2079 5f74 7261 696e 290d 0a0d  ain, y_train)...
-00004830: 0a20 2020 2023 2050 7265 6469 6374 696f  .    # Predictio
-00004840: 6e73 0d0a 2020 2020 795f 7072 6564 5f62  ns..    y_pred_b
-00004850: 6573 7420 3d20 6265 7374 5f6d 6f64 656c  est = best_model
-00004860: 5f69 6e73 7461 6e63 652e 7072 6564 6963  _instance.predic
-00004870: 7428 585f 7465 7374 290d 0a20 2020 2062  t(X_test)..    b
-00004880: 6573 745f 726d 7365 203d 206e 702e 7371  est_rmse = np.sq
-00004890: 7274 2862 6573 745f 6d73 6529 0d0a 2020  rt(best_mse)..  
-000048a0: 2020 6265 7374 5f72 3220 3d20 7232 5f73    best_r2 = r2_s
-000048b0: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
-000048c0: 7265 645f 6265 7374 290d 0a0d 0a20 2020  red_best)....   
-000048d0: 2070 7269 6e74 2822 4d65 7472 6963 7320   print("Metrics 
-000048e0: 6f66 2074 6865 2062 6573 7420 6d6f 6465  of the best mode
-000048f0: 6c3a 2229 0d0a 2020 2020 7072 696e 7428  l:")..    print(
-00004900: 224d 6561 6e20 5371 7561 7265 6420 4572  "Mean Squared Er
-00004910: 726f 723a 222c 2062 6573 745f 6d73 6529  ror:", best_mse)
-00004920: 0d0a 2020 2020 7072 696e 7428 2252 6f6f  ..    print("Roo
-00004930: 7420 4d65 616e 2053 7175 6172 6564 2045  t Mean Squared E
-00004940: 7272 6f72 3a22 2c20 6265 7374 5f72 6d73  rror:", best_rms
-00004950: 6529 0d0a 2020 2020 7072 696e 7428 2252  e)..    print("R
-00004960: 2d73 7175 6172 6564 3a22 2c20 6265 7374  -squared:", best
-00004970: 5f72 3229 0d0a 0d0a 2020 2020 2320 4c65  _r2)....    # Le
-00004980: 6172 6e69 6e67 2063 7572 7665 2066 6f72  arning curve for
-00004990: 2074 6865 2062 6573 7420 6d6f 6465 6c0d   the best model.
-000049a0: 0a20 2020 2074 7261 696e 5f73 697a 6573  .    train_sizes
-000049b0: 2c20 7472 6169 6e5f 7363 6f72 6573 2c20  , train_scores, 
-000049c0: 7661 6c5f 7363 6f72 6573 203d 206c 6561  val_scores = lea
-000049d0: 726e 696e 675f 6375 7276 6528 6265 7374  rning_curve(best
-000049e0: 5f6d 6f64 656c 5f69 6e73 7461 6e63 652c  _model_instance,
-000049f0: 2058 5f74 7261 696e 2c20 795f 7472 6169   X_train, y_trai
-00004a00: 6e2c 2063 763d 6376 2c20 7363 6f72 696e  n, cv=cv, scorin
-00004a10: 673d 276e 6567 5f6d 6561 6e5f 7371 7561  g='neg_mean_squa
-00004a20: 7265 645f 6572 726f 7227 290d 0a20 2020  red_error')..   
-00004a30: 2074 7261 696e 5f73 636f 7265 7320 3d20   train_scores = 
-00004a40: 6e70 2e73 7172 7428 2d74 7261 696e 5f73  np.sqrt(-train_s
-00004a50: 636f 7265 7329 2e6d 6561 6e28 6178 6973  cores).mean(axis
-00004a60: 3d31 290d 0a20 2020 2076 616c 5f73 636f  =1)..    val_sco
-00004a70: 7265 7320 3d20 6e70 2e73 7172 7428 2d76  res = np.sqrt(-v
-00004a80: 616c 5f73 636f 7265 7329 2e6d 6561 6e28  al_scores).mean(
-00004a90: 6178 6973 3d31 290d 0a0d 0a20 2020 2070  axis=1)....    p
-00004aa0: 6c74 2e70 6c6f 7428 7472 6169 6e5f 7369  lt.plot(train_si
-00004ab0: 7a65 732c 2074 7261 696e 5f73 636f 7265  zes, train_score
-00004ac0: 732c 2027 6f2d 272c 206c 6162 656c 3d22  s, 'o-', label="
-00004ad0: 5472 6169 6e69 6e67 2073 636f 7265 2229  Training score")
-00004ae0: 0d0a 2020 2020 706c 742e 706c 6f74 2874  ..    plt.plot(t
-00004af0: 7261 696e 5f73 697a 6573 2c20 7661 6c5f  rain_sizes, val_
-00004b00: 7363 6f72 6573 2c20 276f 2d27 2c20 6c61  scores, 'o-', la
-00004b10: 6265 6c3d 2256 616c 6964 6174 696f 6e20  bel="Validation 
-00004b20: 7363 6f72 6522 290d 0a20 2020 2070 6c74  score")..    plt
-00004b30: 2e78 6c61 6265 6c28 2254 7261 696e 696e  .xlabel("Trainin
-00004b40: 6720 7365 7420 7369 7a65 2229 0d0a 2020  g set size")..  
-00004b50: 2020 706c 742e 796c 6162 656c 2822 524d    plt.ylabel("RM
-00004b60: 5345 2229 0d0a 2020 2020 706c 742e 6c65  SE")..    plt.le
-00004b70: 6765 6e64 2829 0d0a 2020 2020 706c 742e  gend()..    plt.
-00004b80: 7368 6f77 2829 0d0a 0d0a 2020 2020 7265  show()....    re
-00004b90: 7475 726e 2062 6573 745f 6d6f 6465 6c5f  turn best_model_
-00004ba0: 696e 7374 616e 6365 0d0a 0d0a 0d0a 0d0a  instance........
-00004bb0: 0d0a 6465 6620 7475 6e65 5f4d 4c50 635f  ..def tune_MLPc_
-00004bc0: 7061 7261 6d65 7465 7273 2858 5f74 7261  parameters(X_tra
-00004bd0: 696e 2c20 585f 7465 7374 2c20 795f 7472  in, X_test, y_tr
-00004be0: 6169 6e2c 2079 5f74 6573 742c 2070 6172  ain, y_test, par
-00004bf0: 616d 735f 746f 5f74 7279 3d4e 6f6e 652c  ams_to_try=None,
-00004c00: 206e 756d 5f63 6f6d 6269 6e61 7469 6f6e   num_combination
-00004c10: 733d 4e6f 6e65 2c20 7261 6e64 6f6d 5f73  s=None, random_s
-00004c20: 7461 7465 3d31 2c20 6f70 7469 6d69 7a61  tate=1, optimiza
-00004c30: 7469 6f6e 5f74 6172 6765 743d 2761 6363  tion_target='acc
-00004c40: 7572 6163 7927 293a 0d0a 2020 2020 6672  uracy'):..    fr
-00004c50: 6f6d 2073 6b6c 6561 726e 2e6e 6575 7261  om sklearn.neura
-00004c60: 6c5f 6e65 7477 6f72 6b20 696d 706f 7274  l_network import
-00004c70: 204d 4c50 436c 6173 7369 6669 6572 0d0a   MLPClassifier..
-00004c80: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
-00004c90: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
-00004ca0: 6163 6375 7261 6379 5f73 636f 7265 2c20  accuracy_score, 
-00004cb0: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
-00004cc0: 2c20 7072 6563 6973 696f 6e5f 7363 6f72  , precision_scor
-00004cd0: 652c 2072 6563 616c 6c5f 7363 6f72 650d  e, recall_score.
-00004ce0: 0a20 2020 2066 726f 6d20 6974 6572 746f  .    from iterto
-00004cf0: 6f6c 7320 696d 706f 7274 2070 726f 6475  ols import produ
-00004d00: 6374 0d0a 2020 2020 696d 706f 7274 206e  ct..    import n
-00004d10: 756d 7079 2061 7320 6e70 0d0a 0d0a 2020  umpy as np....  
-00004d20: 2020 6966 2070 6172 616d 735f 746f 5f74    if params_to_t
-00004d30: 7279 2069 7320 4e6f 6e65 3a0d 0a20 2020  ry is None:..   
-00004d40: 2020 2020 2070 6172 616d 735f 746f 5f74       params_to_t
-00004d50: 7279 203d 207b 0d0a 2020 2020 2020 2020  ry = {..        
-00004d60: 2020 2020 2773 6f6c 7665 7227 3a20 5b27      'solver': ['
-00004d70: 6c62 6667 7327 2c20 2761 6461 6d27 5d2c  lbfgs', 'adam'],
-00004d80: 0d0a 2020 2020 2020 2020 2020 2020 2761  ..            'a
-00004d90: 6374 6976 6174 696f 6e27 3a20 5b27 7265  ctivation': ['re
-00004da0: 6c75 272c 2027 7461 6e68 272c 2027 6c6f  lu', 'tanh', 'lo
-00004db0: 6769 7374 6963 275d 2c0d 0a20 2020 2020  gistic'],..     
-00004dc0: 2020 2020 2020 2027 616c 7068 6127 3a20         'alpha': 
-00004dd0: 5b30 2e30 3030 312c 2030 2e30 3031 2c20  [0.0001, 0.001, 
-00004de0: 302e 3031 5d2c 0d0a 2020 2020 2020 2020  0.01],..        
-00004df0: 2020 2020 276c 6561 726e 696e 675f 7261      'learning_ra
-00004e00: 7465 5f69 6e69 7427 3a20 5b30 2e30 3030  te_init': [0.000
-00004e10: 312c 2030 2e30 3030 352c 2030 2e30 3031  1, 0.0005, 0.001
-00004e20: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00004e30: 276d 6178 5f69 7465 7227 3a20 5b35 3030  'max_iter': [500
-00004e40: 302c 2031 3030 3030 2c20 3135 3030 305d  0, 10000, 15000]
-00004e50: 0d0a 2020 2020 2020 2020 7d0d 0a0d 0a20  ..        }.... 
-00004e60: 2020 2070 6172 616d 5f63 6f6d 6269 6e61     param_combina
-00004e70: 7469 6f6e 7320 3d20 6c69 7374 2870 726f  tions = list(pro
-00004e80: 6475 6374 282a 7061 7261 6d73 5f74 6f5f  duct(*params_to_
-00004e90: 7472 792e 7661 6c75 6573 2829 2929 0d0a  try.values()))..
-00004ea0: 0d0a 2020 2020 6966 206e 756d 5f63 6f6d  ..    if num_com
-00004eb0: 6269 6e61 7469 6f6e 7320 6973 204e 6f6e  binations is Non
-00004ec0: 653a 0d0a 2020 2020 2020 2020 6e75 6d5f  e:..        num_
-00004ed0: 636f 6d62 696e 6174 696f 6e73 203d 2031  combinations = 1
-00004ee0: 300d 0a20 2020 2065 6c69 6620 6e75 6d5f  0..    elif num_
-00004ef0: 636f 6d62 696e 6174 696f 6e73 203d 3d20  combinations == 
-00004f00: 276d 6178 273a 0d0a 2020 2020 2020 2020  'max':..        
-00004f10: 6e75 6d5f 636f 6d62 696e 6174 696f 6e73  num_combinations
-00004f20: 203d 206c 656e 2870 6172 616d 5f63 6f6d   = len(param_com
-00004f30: 6269 6e61 7469 6f6e 7329 0d0a 0d0a 2020  binations)....  
-00004f40: 2020 6265 7374 5f6d 6f64 656c 203d 204e    best_model = N
-00004f50: 6f6e 650d 0a20 2020 2062 6573 745f 7061  one..    best_pa
-00004f60: 7261 6d73 203d 204e 6f6e 650d 0a20 2020  rams = None..   
-00004f70: 2062 6573 745f 7363 6f72 6520 3d20 2d6e   best_score = -n
-00004f80: 702e 696e 6620 6966 206f 7074 696d 697a  p.inf if optimiz
-00004f90: 6174 696f 6e5f 7461 7267 6574 203d 3d20  ation_target == 
-00004fa0: 2761 6363 7572 6163 7927 2065 6c73 6520  'accuracy' else 
-00004fb0: 6e70 2e69 6e66 0d0a 0d0a 2020 2020 666f  np.inf....    fo
-00004fc0: 7220 6920 696e 2072 616e 6765 286e 756d  r i in range(num
-00004fd0: 5f63 6f6d 6269 6e61 7469 6f6e 7329 3a0d  _combinations):.
-00004fe0: 0a20 2020 2020 2020 2063 686f 7365 6e5f  .        chosen_
-00004ff0: 7061 7261 6d73 203d 2064 6963 7428 7a69  params = dict(zi
-00005000: 7028 7061 7261 6d73 5f74 6f5f 7472 792e  p(params_to_try.
-00005010: 6b65 7973 2829 2c20 7061 7261 6d5f 636f  keys(), param_co
-00005020: 6d62 696e 6174 696f 6e73 5b6e 702e 7261  mbinations[np.ra
-00005030: 6e64 6f6d 2e63 686f 6963 6528 6c65 6e28  ndom.choice(len(
-00005040: 7061 7261 6d5f 636f 6d62 696e 6174 696f  param_combinatio
-00005050: 6e73 2929 5d29 290d 0a0d 0a20 2020 2020  ns))]))....     
-00005060: 2020 206d 6c70 203d 204d 4c50 436c 6173     mlp = MLPClas
-00005070: 7369 6669 6572 2872 616e 646f 6d5f 7374  sifier(random_st
-00005080: 6174 653d 7261 6e64 6f6d 5f73 7461 7465  ate=random_state
-00005090: 2c20 2a2a 6368 6f73 656e 5f70 6172 616d  , **chosen_param
-000050a0: 7329 0d0a 2020 2020 2020 2020 6d6c 702e  s)..        mlp.
-000050b0: 6669 7428 585f 7472 6169 6e2c 2079 5f74  fit(X_train, y_t
-000050c0: 7261 696e 290d 0a0d 0a20 2020 2020 2020  rain)....       
-000050d0: 2079 5f70 7265 6420 3d20 6d6c 702e 7072   y_pred = mlp.pr
-000050e0: 6564 6963 7428 585f 7465 7374 290d 0a20  edict(X_test).. 
-000050f0: 2020 2020 2020 2063 6d20 3d20 636f 6e66         cm = conf
-00005100: 7573 696f 6e5f 6d61 7472 6978 2879 5f74  usion_matrix(y_t
-00005110: 6573 742c 2079 5f70 7265 6429 0d0a 2020  est, y_pred)..  
-00005120: 2020 2020 2020 6661 6c73 655f 6e65 6761        false_nega
-00005130: 7469 7665 7320 3d20 636d 5b31 5d5b 305d  tives = cm[1][0]
-00005140: 0d0a 2020 2020 2020 2020 6163 6375 7261  ..        accura
-00005150: 6379 203d 2061 6363 7572 6163 795f 7363  cy = accuracy_sc
-00005160: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
-00005170: 6564 290d 0a0d 0a20 2020 2020 2020 2069  ed)....        i
-00005180: 6620 6f70 7469 6d69 7a61 7469 6f6e 5f74  f optimization_t
-00005190: 6172 6765 7420 3d3d 2027 6163 6375 7261  arget == 'accura
-000051a0: 6379 273a 0d0a 2020 2020 2020 2020 2020  cy':..          
-000051b0: 2020 7363 6f72 6520 3d20 6163 6375 7261    score = accura
-000051c0: 6379 0d0a 2020 2020 2020 2020 2020 2020  cy..            
-000051d0: 6265 7474 6572 203d 2073 636f 7265 203e  better = score >
-000051e0: 2062 6573 745f 7363 6f72 650d 0a20 2020   best_score..   
-000051f0: 2020 2020 2065 6c69 6620 6f70 7469 6d69       elif optimi
-00005200: 7a61 7469 6f6e 5f74 6172 6765 7420 3d3d  zation_target ==
-00005210: 2027 6d69 6e69 6d69 7a65 5f66 616c 7365   'minimize_false
-00005220: 5f6e 6567 6174 6976 6573 273a 0d0a 2020  _negatives':..  
-00005230: 2020 2020 2020 2020 2020 7363 6f72 6520            score 
-00005240: 3d20 6661 6c73 655f 6e65 6761 7469 7665  = false_negative
-00005250: 730d 0a20 2020 2020 2020 2020 2020 2062  s..            b
-00005260: 6574 7465 7220 3d20 7363 6f72 6520 3c20  etter = score < 
-00005270: 6265 7374 5f73 636f 7265 0d0a 2020 2020  best_score..    
-00005280: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00005290: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000052a0: 7565 4572 726f 7228 2249 6e76 616c 6964  ueError("Invalid
-000052b0: 206f 7074 696d 697a 6174 696f 6e5f 7461   optimization_ta
-000052c0: 7267 6574 2e20 4368 6f6f 7365 2027 6163  rget. Choose 'ac
-000052d0: 6375 7261 6379 2720 6f72 2027 6d69 6e69  curacy' or 'mini
-000052e0: 6d69 7a65 5f66 616c 7365 5f6e 6567 6174  mize_false_negat
-000052f0: 6976 6573 272e 2229 0d0a 0d0a 2020 2020  ives'.")....    
-00005300: 2020 2020 6966 2062 6574 7465 723a 0d0a      if better:..
-00005310: 2020 2020 2020 2020 2020 2020 6265 7374              best
-00005320: 5f6d 6f64 656c 203d 206d 6c70 0d0a 2020  _model = mlp..  
-00005330: 2020 2020 2020 2020 2020 6265 7374 5f70            best_p
-00005340: 6172 616d 7320 3d20 6368 6f73 656e 5f70  arams = chosen_p
-00005350: 6172 616d 730d 0a20 2020 2020 2020 2020  arams..         
-00005360: 2020 2062 6573 745f 7363 6f72 6520 3d20     best_score = 
-00005370: 7363 6f72 650d 0a0d 0a20 2020 2070 7269  score....    pri
-00005380: 6e74 2822 4265 7374 2068 7970 6572 7061  nt("Best hyperpa
-00005390: 7261 6d65 7465 7273 3a22 290d 0a20 2020  rameters:")..   
-000053a0: 2070 7269 6e74 2862 6573 745f 7061 7261   print(best_para
-000053b0: 6d73 290d 0a20 2020 2070 7269 6e74 2862  ms)..    print(b
-000053c0: 6573 745f 6d6f 6465 6c29 0d0a 2020 2020  est_model)..    
-000053d0: 6265 7374 5f6d 6f64 656c 5f73 7472 203d  best_model_str =
-000053e0: 2066 224d 4c50 203d 204d 4c50 436c 6173   f"MLP = MLPClas
-000053f0: 7369 6669 6572 2861 6374 6976 6174 696f  sifier(activatio
-00005400: 6e3d 277b 6265 7374 5f70 6172 616d 735b  n='{best_params[
-00005410: 2761 6374 6976 6174 696f 6e27 5d7d 272c  'activation']}',
-00005420: 2061 6c70 6861 3d7b 6265 7374 5f70 6172   alpha={best_par
-00005430: 616d 735b 2761 6c70 6861 275d 7d2c 2022  ams['alpha']}, "
-00005440: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
-00005450: 2020 2020 2020 2020 2066 226c 6561 726e           f"learn
-00005460: 696e 675f 7261 7465 5f69 6e69 743d 7b62  ing_rate_init={b
-00005470: 6573 745f 7061 7261 6d73 5b27 6c65 6172  est_params['lear
-00005480: 6e69 6e67 5f72 6174 655f 696e 6974 275d  ning_rate_init']
-00005490: 7d2c 206d 6178 5f69 7465 723d 7b62 6573  }, max_iter={bes
-000054a0: 745f 7061 7261 6d73 5b27 6d61 785f 6974  t_params['max_it
-000054b0: 6572 275d 7d2c 2022 205c 0d0a 2020 2020  er']}, " \..    
-000054c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054d0: 2066 2273 6f6c 7665 723d 277b 6265 7374   f"solver='{best
-000054e0: 5f70 6172 616d 735b 2773 6f6c 7665 7227  _params['solver'
-000054f0: 5d7d 272c 2072 616e 646f 6d5f 7374 6174  ]}', random_stat
-00005500: 653d 3129 220d 0a20 2020 2070 7269 6e74  e=1)"..    print
-00005510: 2862 6573 745f 6d6f 6465 6c5f 7374 7229  (best_model_str)
-00005520: 0d0a 0d0a 2020 2020 795f 7072 6564 203d  ....    y_pred =
-00005530: 2062 6573 745f 6d6f 6465 6c2e 7072 6564   best_model.pred
-00005540: 6963 7428 585f 7465 7374 290d 0a0d 0a20  ict(X_test).... 
-00005550: 2020 2070 7269 6e74 2866 2241 6363 7572     print(f"Accur
-00005560: 6163 7920 666f 7220 6265 7374 206d 6f64  acy for best mod
-00005570: 656c 3a20 7b61 6363 7572 6163 795f 7363  el: {accuracy_sc
-00005580: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
-00005590: 6564 297d 2229 0d0a 2020 2020 7072 696e  ed)}")..    prin
-000055a0: 7428 6622 436f 6e66 7573 696f 6e20 6d61  t(f"Confusion ma
-000055b0: 7472 6978 2066 6f72 2062 6573 7420 6d6f  trix for best mo
-000055c0: 6465 6c3a 5c6e 7b63 6f6e 6675 7369 6f6e  del:\n{confusion
-000055d0: 5f6d 6174 7269 7828 795f 7465 7374 2c20  _matrix(y_test, 
-000055e0: 795f 7072 6564 297d 2229 0d0a 2020 2020  y_pred)}")..    
-000055f0: 7072 696e 7428 6622 5072 6563 6973 696f  print(f"Precisio
-00005600: 6e20 666f 7220 6265 7374 206d 6f64 656c  n for best model
-00005610: 3a20 7b70 7265 6369 7369 6f6e 5f73 636f  : {precision_sco
-00005620: 7265 2879 5f74 6573 742c 2079 5f70 7265  re(y_test, y_pre
-00005630: 6429 7d22 290d 0a20 2020 2070 7269 6e74  d)}")..    print
-00005640: 2866 2252 6563 616c 6c20 666f 7220 6265  (f"Recall for be
-00005650: 7374 206d 6f64 656c 3a20 7b72 6563 616c  st model: {recal
-00005660: 6c5f 7363 6f72 6528 795f 7465 7374 2c20  l_score(y_test, 
-00005670: 795f 7072 6564 297d 2229 0d0a 0d0a 2020  y_pred)}")....  
-00005680: 2020 7265 7475 726e 2062 6573 745f 6d6f    return best_mo
-00005690: 6465 6c2c 2062 6573 745f 7061 7261 6d73  del, best_params
-000056a0: 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a  ................
-000056b0: 6465 6620 7475 6e65 5f4d 4c50 725f 7061  def tune_MLPr_pa
-000056c0: 7261 6d65 7465 7273 2858 5f74 7261 696e  rameters(X_train
-000056d0: 2c20 585f 7465 7374 2c20 795f 7472 6169  , X_test, y_trai
-000056e0: 6e2c 2079 5f74 6573 742c 2070 6172 616d  n, y_test, param
-000056f0: 735f 746f 5f74 7279 3d4e 6f6e 652c 206e  s_to_try=None, n
-00005700: 756d 5f63 6f6d 6269 6e61 7469 6f6e 733d  um_combinations=
-00005710: 4e6f 6e65 2c20 7261 6e64 6f6d 5f73 7461  None, random_sta
-00005720: 7465 3d31 293a 0d0a 2020 2020 6672 6f6d  te=1):..    from
-00005730: 2073 6b6c 6561 726e 2e6e 6575 7261 6c5f   sklearn.neural_
-00005740: 6e65 7477 6f72 6b20 696d 706f 7274 204d  network import M
-00005750: 4c50 5265 6772 6573 736f 720d 0a20 2020  LPRegressor..   
-00005760: 2066 726f 6d20 736b 6c65 6172 6e2e 6d65   from sklearn.me
-00005770: 7472 6963 7320 696d 706f 7274 206d 6561  trics import mea
-00005780: 6e5f 7371 7561 7265 645f 6572 726f 722c  n_squared_error,
-00005790: 2072 325f 7363 6f72 650d 0a20 2020 2066   r2_score..    f
-000057a0: 726f 6d20 6974 6572 746f 6f6c 7320 696d  rom itertools im
-000057b0: 706f 7274 2070 726f 6475 6374 0d0a 2020  port product..  
-000057c0: 2020 696d 706f 7274 206e 756d 7079 2061    import numpy a
-000057d0: 7320 6e70 0d0a 0d0a 2020 2020 6966 2070  s np....    if p
-000057e0: 6172 616d 735f 746f 5f74 7279 2069 7320  arams_to_try is 
-000057f0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2070  None:..        p
-00005800: 6172 616d 735f 746f 5f74 7279 203d 207b  arams_to_try = {
-00005810: 0d0a 2020 2020 2020 2020 2020 2020 2773  ..            's
-00005820: 6f6c 7665 7227 3a20 5b27 6c62 6667 7327  olver': ['lbfgs'
-00005830: 2c20 2761 6461 6d27 5d2c 0d0a 2020 2020  , 'adam'],..    
-00005840: 2020 2020 2020 2020 2761 6374 6976 6174          'activat
-00005850: 696f 6e27 3a20 5b27 7265 6c75 272c 2027  ion': ['relu', '
-00005860: 7461 6e68 272c 2027 6c6f 6769 7374 6963  tanh', 'logistic
-00005870: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
-00005880: 2027 616c 7068 6127 3a20 5b30 2e30 3030   'alpha': [0.000
-00005890: 312c 2030 2e30 3031 2c20 302e 3031 5d2c  1, 0.001, 0.01],
-000058a0: 0d0a 2020 2020 2020 2020 2020 2020 276c  ..            'l
-000058b0: 6561 726e 696e 675f 7261 7465 5f69 6e69  earning_rate_ini
-000058c0: 7427 3a20 5b30 2e30 3030 312c 2030 2e30  t': [0.0001, 0.0
-000058d0: 3030 352c 2030 2e30 3031 5d2c 0d0a 2020  005, 0.001],..  
-000058e0: 2020 2020 2020 2020 2020 276d 6178 5f69            'max_i
-000058f0: 7465 7227 3a20 5b35 3030 302c 2031 3030  ter': [5000, 100
-00005900: 3030 2c20 3135 3030 305d 0d0a 2020 2020  00, 15000]..    
-00005910: 2020 2020 7d0d 0a0d 0a20 2020 2070 6172      }....    par
-00005920: 616d 5f63 6f6d 6269 6e61 7469 6f6e 7320  am_combinations 
-00005930: 3d20 6c69 7374 2870 726f 6475 6374 282a  = list(product(*
-00005940: 7061 7261 6d73 5f74 6f5f 7472 792e 7661  params_to_try.va
-00005950: 6c75 6573 2829 2929 0d0a 0d0a 2020 2020  lues()))....    
-00005960: 6966 206e 756d 5f63 6f6d 6269 6e61 7469  if num_combinati
-00005970: 6f6e 7320 6973 204e 6f6e 653a 0d0a 2020  ons is None:..  
-00005980: 2020 2020 2020 6e75 6d5f 636f 6d62 696e        num_combin
-00005990: 6174 696f 6e73 203d 2031 300d 0a20 2020  ations = 10..   
-000059a0: 2065 6c69 6620 6e75 6d5f 636f 6d62 696e   elif num_combin
-000059b0: 6174 696f 6e73 203d 3d20 276d 6178 273a  ations == 'max':
-000059c0: 0d0a 2020 2020 2020 2020 6e75 6d5f 636f  ..        num_co
-000059d0: 6d62 696e 6174 696f 6e73 203d 206c 656e  mbinations = len
-000059e0: 2870 6172 616d 5f63 6f6d 6269 6e61 7469  (param_combinati
-000059f0: 6f6e 7329 0d0a 0d0a 2020 2020 6265 7374  ons)....    best
-00005a00: 5f6d 6f64 656c 203d 204e 6f6e 650d 0a20  _model = None.. 
-00005a10: 2020 2062 6573 745f 7061 7261 6d73 203d     best_params =
-00005a20: 204e 6f6e 650d 0a20 2020 2062 6573 745f   None..    best_
-00005a30: 6d73 6520 3d20 6e70 2e69 6e66 0d0a 0d0a  mse = np.inf....
-00005a40: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00005a50: 6765 286e 756d 5f63 6f6d 6269 6e61 7469  ge(num_combinati
-00005a60: 6f6e 7329 3a0d 0a20 2020 2020 2020 2063  ons):..        c
-00005a70: 686f 7365 6e5f 7061 7261 6d73 203d 2064  hosen_params = d
-00005a80: 6963 7428 7a69 7028 7061 7261 6d73 5f74  ict(zip(params_t
-00005a90: 6f5f 7472 792e 6b65 7973 2829 2c20 7061  o_try.keys(), pa
-00005aa0: 7261 6d5f 636f 6d62 696e 6174 696f 6e73  ram_combinations
-00005ab0: 5b6e 702e 7261 6e64 6f6d 2e63 686f 6963  [np.random.choic
-00005ac0: 6528 6c65 6e28 7061 7261 6d5f 636f 6d62  e(len(param_comb
-00005ad0: 696e 6174 696f 6e73 2929 5d29 290d 0a0d  inations))]))...
-00005ae0: 0a20 2020 2020 2020 206d 6c70 203d 204d  .        mlp = M
-00005af0: 4c50 5265 6772 6573 736f 7228 7261 6e64  LPRegressor(rand
-00005b00: 6f6d 5f73 7461 7465 3d72 616e 646f 6d5f  om_state=random_
-00005b10: 7374 6174 652c 202a 2a63 686f 7365 6e5f  state, **chosen_
-00005b20: 7061 7261 6d73 290d 0a20 2020 2020 2020  params)..       
-00005b30: 206d 6c70 2e66 6974 2858 5f74 7261 696e   mlp.fit(X_train
-00005b40: 2c20 795f 7472 6169 6e29 0d0a 0d0a 2020  , y_train)....  
-00005b50: 2020 2020 2020 795f 7072 6564 203d 206d        y_pred = m
-00005b60: 6c70 2e70 7265 6469 6374 2858 5f74 6573  lp.predict(X_tes
-00005b70: 7429 0d0a 2020 2020 2020 2020 6d73 6520  t)..        mse 
-00005b80: 3d20 6d65 616e 5f73 7175 6172 6564 5f65  = mean_squared_e
-00005b90: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
-00005ba0: 7265 6429 0d0a 2020 2020 2020 2020 7072  red)..        pr
-00005bb0: 696e 7428 6622 4d65 616e 2073 7175 6172  int(f"Mean squar
-00005bc0: 6564 2065 7272 6f72 2066 6f72 2070 6172  ed error for par
-00005bd0: 616d 6574 6572 7320 7b63 686f 7365 6e5f  ameters {chosen_
-00005be0: 7061 7261 6d73 7d3a 207b 6d73 657d 2229  params}: {mse}")
-00005bf0: 0d0a 0d0a 2020 2020 2020 2020 6966 206d  ....        if m
-00005c00: 7365 203c 2062 6573 745f 6d73 653a 0d0a  se < best_mse:..
-00005c10: 2020 2020 2020 2020 2020 2020 6265 7374              best
-00005c20: 5f6d 6f64 656c 203d 206d 6c70 0d0a 2020  _model = mlp..  
-00005c30: 2020 2020 2020 2020 2020 6265 7374 5f70            best_p
-00005c40: 6172 616d 7320 3d20 6368 6f73 656e 5f70  arams = chosen_p
-00005c50: 6172 616d 730d 0a20 2020 2020 2020 2020  arams..         
-00005c60: 2020 2062 6573 745f 6d73 6520 3d20 6d73     best_mse = ms
-00005c70: 650d 0a0d 0a20 2020 2070 7269 6e74 2822  e....    print("
-00005c80: 4265 7374 2068 7970 6572 7061 7261 6d65  Best hyperparame
-00005c90: 7465 7273 3a22 290d 0a20 2020 2070 7269  ters:")..    pri
-00005ca0: 6e74 2862 6573 745f 7061 7261 6d73 290d  nt(best_params).
-00005cb0: 0a20 2020 2070 7269 6e74 2862 6573 745f  .    print(best_
-00005cc0: 6d6f 6465 6c29 0d0a 2020 2020 6265 7374  model)..    best
-00005cd0: 5f6d 6f64 656c 5f73 7472 203d 2066 224d  _model_str = f"M
-00005ce0: 4c50 203d 204d 4c50 5265 6772 6573 736f  LP = MLPRegresso
-00005cf0: 7228 6163 7469 7661 7469 6f6e 3d27 7b62  r(activation='{b
-00005d00: 6573 745f 7061 7261 6d73 5b27 6163 7469  est_params['acti
-00005d10: 7661 7469 6f6e 275d 7d27 2c20 616c 7068  vation']}', alph
-00005d20: 613d 7b62 6573 745f 7061 7261 6d73 5b27  a={best_params['
-00005d30: 616c 7068 6127 5d7d 2c20 2220 5c0d 0a20  alpha']}, " \.. 
-00005d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d50: 2020 2020 6622 6c65 6172 6e69 6e67 5f72      f"learning_r
-00005d60: 6174 655f 696e 6974 3d7b 6265 7374 5f70  ate_init={best_p
-00005d70: 6172 616d 735b 276c 6561 726e 696e 675f  arams['learning_
-00005d80: 7261 7465 5f69 6e69 7427 5d7d 2c20 6d61  rate_init']}, ma
-00005d90: 785f 6974 6572 3d7b 6265 7374 5f70 6172  x_iter={best_par
-00005da0: 616d 735b 276d 6178 5f69 7465 7227 5d7d  ams['max_iter']}
-00005db0: 2c20 2220 5c0d 0a20 2020 2020 2020 2020  , " \..         
-00005dc0: 2020 2020 2020 2020 2020 2020 6622 736f              f"so
-00005dd0: 6c76 6572 3d27 7b62 6573 745f 7061 7261  lver='{best_para
-00005de0: 6d73 5b27 736f 6c76 6572 275d 7d27 2c20  ms['solver']}', 
-00005df0: 7261 6e64 6f6d 5f73 7461 7465 3d31 2922  random_state=1)"
-00005e00: 0d0a 2020 2020 7072 696e 7428 6265 7374  ..    print(best
-00005e10: 5f6d 6f64 656c 5f73 7472 290d 0a0d 0a20  _model_str).... 
-00005e20: 2020 2079 5f70 7265 6420 3d20 6265 7374     y_pred = best
-00005e30: 5f6d 6f64 656c 2e70 7265 6469 6374 2858  _model.predict(X
-00005e40: 5f74 6573 7429 0d0a 2020 2020 0d0a 2020  _test)..    ..  
-00005e50: 2020 7072 696e 7428 6622 4d65 616e 2073    print(f"Mean s
-00005e60: 7175 6172 6564 2065 7272 6f72 2066 6f72  quared error for
-00005e70: 2062 6573 7420 6d6f 6465 6c3a 207b 6d65   best model: {me
-00005e80: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00005e90: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
-00005ea0: 7d22 290d 0a20 2020 2070 7269 6e74 2866  }")..    print(f
-00005eb0: 2252 3220 7363 6f72 6520 666f 7220 6265  "R2 score for be
-00005ec0: 7374 206d 6f64 656c 3a20 7b72 325f 7363  st model: {r2_sc
-00005ed0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
-00005ee0: 6564 297d 2229 0d0a 2020 2020 7072 696e  ed)}")..    prin
-00005ef0: 7428 6622 524d 5345 2073 636f 7265 2066  t(f"RMSE score f
-00005f00: 6f72 2062 6573 7420 6d6f 6465 6c3a 207b  or best model: {
-00005f10: 6e70 2e73 7172 7428 6d65 616e 5f73 7175  np.sqrt(mean_squ
-00005f20: 6172 6564 5f65 7272 6f72 2879 5f74 6573  ared_error(y_tes
-00005f30: 742c 2079 5f70 7265 6429 297d 2229 0d0a  t, y_pred))}")..
-00005f40: 0d0a 2020 2020 7265 7475 726e 2062 6573  ..    return bes
-00005f50: 745f 6d6f 6465 6c2c 2062 6573 745f 7061  t_model, best_pa
-00005f60: 7261 6d73 0d0a 0d0a 0d0a 0d0a            rams........
+000004c0: 2020 2069 6d70 6f72 7420 7061 6e64 6173     import pandas
+000004d0: 2061 7320 7064 0d0a 2020 2020 696d 706f   as pd..    impo
+000004e0: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
+000004f0: 706c 6f74 2061 7320 706c 740d 0a20 2020  plot as plt..   
+00000500: 2066 6967 2c20 6178 7320 3d20 706c 742e   fig, axs = plt.
+00000510: 7375 6270 6c6f 7473 286c 656e 2863 6f6c  subplots(len(col
+00000520: 756d 6e73 292c 2032 2c20 6669 6773 697a  umns), 2, figsiz
+00000530: 653d 2831 322c 206c 656e 2863 6f6c 756d  e=(12, len(colum
+00000540: 6e73 2920 2a20 3429 290d 0a0d 0a20 2020  ns) * 4))....   
+00000550: 2066 6f72 2069 2c20 636f 6c20 696e 2065   for i, col in e
+00000560: 6e75 6d65 7261 7465 2863 6f6c 756d 6e73  numerate(columns
+00000570: 293a 0d0a 2020 2020 2020 2020 6178 735b  ):..        axs[
+00000580: 692c 2030 5d2e 706c 6f74 2864 6174 615b  i, 0].plot(data[
+00000590: 636f 6c5d 2e76 616c 7565 7329 0d0a 2020  col].values)..  
+000005a0: 2020 2020 2020 6178 735b 692c 2030 5d2e        axs[i, 0].
+000005b0: 7365 745f 7469 746c 6528 6622 7b63 6f6c  set_title(f"{col
+000005c0: 7d20 2d20 5469 6d65 2053 6572 6965 7322  } - Time Series"
+000005d0: 290d 0a20 2020 2020 2020 2061 7873 5b69  )..        axs[i
+000005e0: 2c20 305d 2e73 6574 5f78 6c61 6265 6c28  , 0].set_xlabel(
+000005f0: 2249 6e64 6578 2229 0d0a 2020 2020 2020  "Index")..      
+00000600: 2020 6178 735b 692c 2030 5d2e 7365 745f    axs[i, 0].set_
+00000610: 796c 6162 656c 2822 5661 6c75 6522 290d  ylabel("Value").
+00000620: 0a0d 0a20 2020 2020 2020 2061 7873 5b69  ...        axs[i
+00000630: 2c20 315d 2e68 6973 7428 6461 7461 5b63  , 1].hist(data[c
+00000640: 6f6c 5d2c 2062 696e 733d 3230 290d 0a20  ol], bins=20).. 
+00000650: 2020 2020 2020 2061 7873 5b69 2c20 315d         axs[i, 1]
+00000660: 2e73 6574 5f74 6974 6c65 2866 227b 636f  .set_title(f"{co
+00000670: 6c7d 202d 2048 6973 746f 6772 616d 2229  l} - Histogram")
+00000680: 0d0a 2020 2020 2020 2020 6178 735b 692c  ..        axs[i,
+00000690: 2031 5d2e 7365 745f 786c 6162 656c 2822   1].set_xlabel("
+000006a0: 5661 6c75 6522 290d 0a20 2020 2020 2020  Value")..       
+000006b0: 2061 7873 5b69 2c20 315d 2e73 6574 5f79   axs[i, 1].set_y
+000006c0: 6c61 6265 6c28 2246 7265 7175 656e 6379  label("Frequency
+000006d0: 2229 0d0a 0d0a 2020 2020 706c 742e 7469  ")....    plt.ti
+000006e0: 6768 745f 6c61 796f 7574 2829 0d0a 0d0a  ght_layout()....
+000006f0: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
+00000700: 6967 7369 7a65 3d28 3132 2c20 3629 290d  igsize=(12, 6)).
+00000710: 0a20 2020 2066 6f72 2063 6f6c 2069 6e20  .    for col in 
+00000720: 636f 6c75 6d6e 733a 0d0a 2020 2020 2020  columns:..      
+00000730: 2020 706c 742e 706c 6f74 2864 6174 615b    plt.plot(data[
+00000740: 636f 6c5d 2e76 616c 7565 732c 206c 6162  col].values, lab
+00000750: 656c 3d63 6f6c 290d 0a20 2020 2070 6c74  el=col)..    plt
+00000760: 2e74 6974 6c65 2822 5469 6d65 2053 6572  .title("Time Ser
+00000770: 6965 7320 436f 6d70 6172 6973 6f6e 2229  ies Comparison")
+00000780: 0d0a 2020 2020 706c 742e 786c 6162 656c  ..    plt.xlabel
+00000790: 2822 496e 6465 7822 290d 0a20 2020 2070  ("Index")..    p
+000007a0: 6c74 2e79 6c61 6265 6c28 2256 616c 7565  lt.ylabel("Value
+000007b0: 2229 0d0a 2020 2020 706c 742e 6c65 6765  ")..    plt.lege
+000007c0: 6e64 2829 0d0a 0d0a 2020 2020 706c 742e  nd()....    plt.
+000007d0: 7368 6f77 2829 0d0a 0d0a 0d0a 0d0a 0d0a  show()..........
+000007e0: 6465 6620 706c 6f74 5f74 6172 6765 745f  def plot_target_
+000007f0: 7673 5f6f 7468 6572 7328 6461 7461 2c20  vs_others(data, 
+00000800: 7461 7267 6574 5f76 6172 6961 626c 6529  target_variable)
+00000810: 3a0d 0a20 2020 2069 6d70 6f72 7420 7061  :..    import pa
+00000820: 6e64 6173 2061 7320 7064 0d0a 2020 2020  ndas as pd..    
+00000830: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
+00000840: 622e 7079 706c 6f74 2061 7320 706c 740d  b.pyplot as plt.
+00000850: 0a20 2020 2074 6172 6765 7420 3d20 6461  .    target = da
+00000860: 7461 5b74 6172 6765 745f 7661 7269 6162  ta[target_variab
+00000870: 6c65 5d0d 0a20 2020 206f 7468 6572 5f76  le]..    other_v
+00000880: 6172 6961 626c 6573 203d 2064 6174 612e  ariables = data.
+00000890: 6472 6f70 2863 6f6c 756d 6e73 3d74 6172  drop(columns=tar
+000008a0: 6765 745f 7661 7269 6162 6c65 292e 636f  get_variable).co
+000008b0: 6c75 6d6e 730d 0a20 2020 200d 0a20 2020  lumns..    ..   
+000008c0: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
+000008d0: 697a 653d 2831 322c 2036 2929 0d0a 2020  ize=(12, 6))..  
+000008e0: 2020 706c 742e 706c 6f74 2872 616e 6765    plt.plot(range
+000008f0: 286c 656e 2874 6172 6765 7429 292c 2074  (len(target)), t
+00000900: 6172 6765 742c 206c 6162 656c 3d74 6172  arget, label=tar
+00000910: 6765 745f 7661 7269 6162 6c65 290d 0a20  get_variable).. 
+00000920: 2020 2070 6c74 2e74 6974 6c65 2866 227b     plt.title(f"{
+00000930: 7461 7267 6574 5f76 6172 6961 626c 657d  target_variable}
+00000940: 202d 2054 696d 6520 5365 7269 6573 2229   - Time Series")
+00000950: 0d0a 2020 2020 706c 742e 786c 6162 656c  ..    plt.xlabel
+00000960: 2822 4461 7461 2050 6f69 6e74 2229 0d0a  ("Data Point")..
+00000970: 2020 2020 706c 742e 796c 6162 656c 2822      plt.ylabel("
+00000980: 5661 6c75 6522 290d 0a20 2020 2070 6c74  Value")..    plt
+00000990: 2e6c 6567 656e 6428 290d 0a20 2020 2070  .legend()..    p
+000009a0: 6c74 2e73 686f 7728 290d 0a20 2020 200d  lt.show()..    .
+000009b0: 0a20 2020 2066 6f72 2076 6172 6961 626c  .    for variabl
+000009c0: 6520 696e 206f 7468 6572 5f76 6172 6961  e in other_varia
+000009d0: 626c 6573 3a0d 0a20 2020 2020 2020 2070  bles:..        p
+000009e0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
+000009f0: 653d 2831 322c 2036 2929 0d0a 2020 2020  e=(12, 6))..    
+00000a00: 2020 2020 706c 742e 706c 6f74 2872 616e      plt.plot(ran
+00000a10: 6765 286c 656e 2874 6172 6765 7429 292c  ge(len(target)),
+00000a20: 2074 6172 6765 742c 206c 6162 656c 3d74   target, label=t
+00000a30: 6172 6765 745f 7661 7269 6162 6c65 290d  arget_variable).
+00000a40: 0a20 2020 2020 2020 2070 6c74 2e70 6c6f  .        plt.plo
+00000a50: 7428 7261 6e67 6528 6c65 6e28 6461 7461  t(range(len(data
+00000a60: 5b76 6172 6961 626c 655d 2929 2c20 6461  [variable])), da
+00000a70: 7461 5b76 6172 6961 626c 655d 2c20 6c61  ta[variable], la
+00000a80: 6265 6c3d 7661 7269 6162 6c65 290d 0a20  bel=variable).. 
+00000a90: 2020 2020 2020 2070 6c74 2e74 6974 6c65         plt.title
+00000aa0: 2866 227b 7461 7267 6574 5f76 6172 6961  (f"{target_varia
+00000ab0: 626c 657d 2076 7320 7b76 6172 6961 626c  ble} vs {variabl
+00000ac0: 657d 202d 2054 696d 6520 5365 7269 6573  e} - Time Series
+00000ad0: 2229 0d0a 2020 2020 2020 2020 706c 742e  ")..        plt.
+00000ae0: 786c 6162 656c 2822 4461 7461 2050 6f69  xlabel("Data Poi
+00000af0: 6e74 2229 0d0a 2020 2020 2020 2020 706c  nt")..        pl
+00000b00: 742e 796c 6162 656c 2822 5661 6c75 6522  t.ylabel("Value"
+00000b10: 290d 0a20 2020 2020 2020 2070 6c74 2e6c  )..        plt.l
+00000b20: 6567 656e 6428 290d 0a20 2020 2020 2020  egend()..       
+00000b30: 2070 6c74 2e73 686f 7728 290d 0a0d 0a0d   plt.show().....
+00000b40: 0a64 6566 2070 6c6f 745f 7461 7267 6574  .def plot_target
+00000b50: 5f76 735f 6f74 6865 7273 5f6e 6f72 6d61  _vs_others_norma
+00000b60: 6c69 7a65 6428 6461 7461 2c20 7461 7267  lized(data, targ
+00000b70: 6574 5f76 6172 6961 626c 6529 3a0d 0a20  et_variable):.. 
+00000b80: 2020 2069 6d70 6f72 7420 7061 6e64 6173     import pandas
+00000b90: 2061 7320 7064 0d0a 2020 2020 696d 706f   as pd..    impo
+00000ba0: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
+00000bb0: 706c 6f74 2061 7320 706c 740d 0a20 2020  plot as plt..   
+00000bc0: 2066 726f 6d20 736b 6c65 6172 6e2e 7072   from sklearn.pr
+00000bd0: 6570 726f 6365 7373 696e 6720 696d 706f  eprocessing impo
+00000be0: 7274 204d 696e 4d61 7853 6361 6c65 720d  rt MinMaxScaler.
+00000bf0: 0a20 2020 2074 6172 6765 7420 3d20 6461  .    target = da
+00000c00: 7461 5b74 6172 6765 745f 7661 7269 6162  ta[target_variab
+00000c10: 6c65 5d0d 0a20 2020 206f 7468 6572 5f76  le]..    other_v
+00000c20: 6172 6961 626c 6573 203d 2064 6174 612e  ariables = data.
+00000c30: 6472 6f70 2863 6f6c 756d 6e73 3d74 6172  drop(columns=tar
+00000c40: 6765 745f 7661 7269 6162 6c65 292e 636f  get_variable).co
+00000c50: 6c75 6d6e 730d 0a20 2020 200d 0a20 2020  lumns..    ..   
+00000c60: 2064 6174 615f 7769 7468 6f75 745f 7461   data_without_ta
+00000c70: 7267 6574 203d 2064 6174 612e 6472 6f70  rget = data.drop
+00000c80: 2863 6f6c 756d 6e73 3d74 6172 6765 745f  (columns=target_
+00000c90: 7661 7269 6162 6c65 290d 0a20 2020 200d  variable)..    .
+00000ca0: 0a20 2020 2073 6361 6c65 7220 3d20 4d69  .    scaler = Mi
+00000cb0: 6e4d 6178 5363 616c 6572 2829 0d0a 2020  nMaxScaler()..  
+00000cc0: 2020 6e6f 726d 616c 697a 6564 5f64 6174    normalized_dat
+00000cd0: 6120 3d20 7363 616c 6572 2e66 6974 5f74  a = scaler.fit_t
+00000ce0: 7261 6e73 666f 726d 2864 6174 615f 7769  ransform(data_wi
+00000cf0: 7468 6f75 745f 7461 7267 6574 290d 0a20  thout_target).. 
+00000d00: 2020 200d 0a20 2020 2074 6172 6765 745f     ..    target_
+00000d10: 7363 616c 6572 203d 204d 696e 4d61 7853  scaler = MinMaxS
+00000d20: 6361 6c65 7228 290d 0a20 2020 206e 6f72  caler()..    nor
+00000d30: 6d61 6c69 7a65 645f 7461 7267 6574 203d  malized_target =
+00000d40: 2074 6172 6765 745f 7363 616c 6572 2e66   target_scaler.f
+00000d50: 6974 5f74 7261 6e73 666f 726d 2874 6172  it_transform(tar
+00000d60: 6765 742e 7661 6c75 6573 2e72 6573 6861  get.values.resha
+00000d70: 7065 282d 312c 2031 2929 0d0a 2020 2020  pe(-1, 1))..    
+00000d80: 0d0a 2020 2020 706c 742e 6669 6775 7265  ..    plt.figure
+00000d90: 2866 6967 7369 7a65 3d28 3132 2c20 3629  (figsize=(12, 6)
+00000da0: 290d 0a20 2020 2070 6c74 2e70 6c6f 7428  )..    plt.plot(
+00000db0: 7261 6e67 6528 6c65 6e28 6e6f 726d 616c  range(len(normal
+00000dc0: 697a 6564 5f74 6172 6765 7429 292c 206e  ized_target)), n
+00000dd0: 6f72 6d61 6c69 7a65 645f 7461 7267 6574  ormalized_target
+00000de0: 2c20 6c61 6265 6c3d 7461 7267 6574 5f76  , label=target_v
+00000df0: 6172 6961 626c 6529 0d0a 2020 2020 706c  ariable)..    pl
+00000e00: 742e 7469 746c 6528 6622 7b74 6172 6765  t.title(f"{targe
+00000e10: 745f 7661 7269 6162 6c65 7d20 2d20 5469  t_variable} - Ti
+00000e20: 6d65 2053 6572 6965 7320 284e 6f72 6d61  me Series (Norma
+00000e30: 6c69 7a65 6429 2229 0d0a 2020 2020 706c  lized)")..    pl
+00000e40: 742e 786c 6162 656c 2822 4461 7461 2050  t.xlabel("Data P
+00000e50: 6f69 6e74 2229 0d0a 2020 2020 706c 742e  oint")..    plt.
+00000e60: 796c 6162 656c 2822 4e6f 726d 616c 697a  ylabel("Normaliz
+00000e70: 6564 2056 616c 7565 2229 0d0a 2020 2020  ed Value")..    
+00000e80: 706c 742e 6c65 6765 6e64 2829 0d0a 2020  plt.legend()..  
+00000e90: 2020 706c 742e 7368 6f77 2829 0d0a 2020    plt.show()..  
+00000ea0: 2020 0d0a 2020 2020 666f 7220 7661 7269    ..    for vari
+00000eb0: 6162 6c65 2069 6e20 6f74 6865 725f 7661  able in other_va
+00000ec0: 7269 6162 6c65 733a 0d0a 2020 2020 2020  riables:..      
+00000ed0: 2020 7661 7269 6162 6c65 5f69 6e64 6578    variable_index
+00000ee0: 203d 2064 6174 612e 636f 6c75 6d6e 732e   = data.columns.
+00000ef0: 6765 745f 6c6f 6328 7661 7269 6162 6c65  get_loc(variable
+00000f00: 290d 0a20 2020 2020 2020 206e 6f72 6d61  )..        norma
+00000f10: 6c69 7a65 645f 7661 7269 6162 6c65 203d  lized_variable =
+00000f20: 206e 6f72 6d61 6c69 7a65 645f 6461 7461   normalized_data
+00000f30: 5b3a 2c20 7661 7269 6162 6c65 5f69 6e64  [:, variable_ind
+00000f40: 6578 5d0d 0a20 2020 2020 2020 200d 0a20  ex]..        .. 
+00000f50: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
+00000f60: 6528 6669 6773 697a 653d 2831 322c 2036  e(figsize=(12, 6
+00000f70: 2929 0d0a 2020 2020 2020 2020 706c 742e  ))..        plt.
+00000f80: 706c 6f74 2872 616e 6765 286c 656e 286e  plot(range(len(n
+00000f90: 6f72 6d61 6c69 7a65 645f 7461 7267 6574  ormalized_target
+00000fa0: 2929 2c20 6e6f 726d 616c 697a 6564 5f74  )), normalized_t
+00000fb0: 6172 6765 742c 206c 6162 656c 3d74 6172  arget, label=tar
+00000fc0: 6765 745f 7661 7269 6162 6c65 290d 0a20  get_variable).. 
+00000fd0: 2020 2020 2020 2070 6c74 2e70 6c6f 7428         plt.plot(
+00000fe0: 7261 6e67 6528 6c65 6e28 6461 7461 2929  range(len(data))
+00000ff0: 2c20 6e6f 726d 616c 697a 6564 5f76 6172  , normalized_var
+00001000: 6961 626c 652c 206c 6162 656c 3d76 6172  iable, label=var
+00001010: 6961 626c 6529 0d0a 2020 2020 2020 2020  iable)..        
+00001020: 706c 742e 7469 746c 6528 6622 7b74 6172  plt.title(f"{tar
+00001030: 6765 745f 7661 7269 6162 6c65 7d20 7673  get_variable} vs
+00001040: 207b 7661 7269 6162 6c65 7d20 2d20 5469   {variable} - Ti
+00001050: 6d65 2053 6572 6965 7320 284e 6f72 6d61  me Series (Norma
+00001060: 6c69 7a65 6429 2229 0d0a 2020 2020 2020  lized)")..      
+00001070: 2020 706c 742e 786c 6162 656c 2822 4461    plt.xlabel("Da
+00001080: 7461 2050 6f69 6e74 2229 0d0a 2020 2020  ta Point")..    
+00001090: 2020 2020 706c 742e 796c 6162 656c 2822      plt.ylabel("
+000010a0: 4e6f 726d 616c 697a 6564 2056 616c 7565  Normalized Value
+000010b0: 2229 0d0a 2020 2020 2020 2020 706c 742e  ")..        plt.
+000010c0: 6c65 6765 6e64 2829 0d0a 2020 2020 2020  legend()..      
+000010d0: 2020 706c 742e 7368 6f77 2829 0d0a 0d0a    plt.show()....
+000010e0: 0d0a 2020 2020 0d0a 6465 6620 6669 6e64  ..    ..def find
+000010f0: 5f62 6573 745f 6d6f 6465 6c5f 636c 6173  _best_model_clas
+00001100: 7369 6669 6361 7469 6f6e 2864 665f 585f  sification(df_X_
+00001110: 7472 6169 6e2c 2064 665f 585f 7465 7374  train, df_X_test
+00001120: 2c20 6466 5f79 5f74 7261 696e 2c20 6466  , df_y_train, df
+00001130: 5f79 5f74 6573 7429 3a0d 0a20 2020 200d  _y_test):..    .
+00001140: 0a20 2020 2069 6d70 6f72 7420 6e75 6d70  .    import nump
+00001150: 7920 6173 206e 700d 0a20 2020 2069 6d70  y as np..    imp
+00001160: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+00001170: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
+00001180: 726e 2e6c 696e 6561 725f 6d6f 6465 6c20  rn.linear_model 
+00001190: 696d 706f 7274 204c 6f67 6973 7469 6352  import LogisticR
+000011a0: 6567 7265 7373 696f 6e2c 2052 6964 6765  egression, Ridge
+000011b0: 436c 6173 7369 6669 6572 2c20 5061 7373  Classifier, Pass
+000011c0: 6976 6541 6767 7265 7373 6976 6543 6c61  iveAggressiveCla
+000011d0: 7373 6966 6965 722c 2050 6572 6365 7074  ssifier, Percept
+000011e0: 726f 6e0d 0a20 2020 2066 726f 6d20 736b  ron..    from sk
+000011f0: 6c65 6172 6e2e 7472 6565 2069 6d70 6f72  learn.tree impor
+00001200: 7420 4465 6369 7369 6f6e 5472 6565 436c  t DecisionTreeCl
+00001210: 6173 7369 6669 6572 0d0a 2020 2020 6672  assifier..    fr
+00001220: 6f6d 2073 6b6c 6561 726e 2e65 6e73 656d  om sklearn.ensem
+00001230: 626c 6520 696d 706f 7274 2052 616e 646f  ble import Rando
+00001240: 6d46 6f72 6573 7443 6c61 7373 6966 6965  mForestClassifie
+00001250: 722c 2047 7261 6469 656e 7442 6f6f 7374  r, GradientBoost
+00001260: 696e 6743 6c61 7373 6966 6965 722c 2041  ingClassifier, A
+00001270: 6461 426f 6f73 7443 6c61 7373 6966 6965  daBoostClassifie
+00001280: 722c 2045 7874 7261 5472 6565 7343 6c61  r, ExtraTreesCla
+00001290: 7373 6966 6965 722c 2042 6167 6769 6e67  ssifier, Bagging
+000012a0: 436c 6173 7369 6669 6572 2c20 4973 6f6c  Classifier, Isol
+000012b0: 6174 696f 6e46 6f72 6573 742c 2053 7461  ationForest, Sta
+000012c0: 636b 696e 6743 6c61 7373 6966 6965 720d  ckingClassifier.
+000012d0: 0a20 2020 2066 726f 6d20 736b 6c65 6172  .    from sklear
+000012e0: 6e2e 7376 6d20 696d 706f 7274 2053 5643  n.svm import SVC
+000012f0: 2c20 4f6e 6543 6c61 7373 5356 4d0d 0a20  , OneClassSVM.. 
+00001300: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
+00001310: 6e65 6967 6862 6f72 7320 696d 706f 7274  neighbors import
+00001320: 204b 4e65 6967 6862 6f72 7343 6c61 7373   KNeighborsClass
+00001330: 6966 6965 722c 204e 6561 7265 7374 4365  ifier, NearestCe
+00001340: 6e74 726f 6964 0d0a 2020 2020 6672 6f6d  ntroid..    from
+00001350: 2073 6b6c 6561 726e 2e6e 6169 7665 5f62   sklearn.naive_b
+00001360: 6179 6573 2069 6d70 6f72 7420 4761 7573  ayes import Gaus
+00001370: 7369 616e 4e42 2c20 4265 726e 6f75 6c6c  sianNB, Bernoull
+00001380: 694e 420d 0a20 2020 2066 726f 6d20 736b  iNB..    from sk
+00001390: 6c65 6172 6e2e 6e65 7572 616c 5f6e 6574  learn.neural_net
+000013a0: 776f 726b 2069 6d70 6f72 7420 4d4c 5043  work import MLPC
+000013b0: 6c61 7373 6966 6965 720d 0a20 2020 2066  lassifier..    f
+000013c0: 726f 6d20 736b 6c65 6172 6e2e 6469 7363  rom sklearn.disc
+000013d0: 7269 6d69 6e61 6e74 5f61 6e61 6c79 7369  riminant_analysi
+000013e0: 7320 696d 706f 7274 2051 7561 6472 6174  s import Quadrat
+000013f0: 6963 4469 7363 7269 6d69 6e61 6e74 416e  icDiscriminantAn
+00001400: 616c 7973 6973 2c20 4c69 6e65 6172 4469  alysis, LinearDi
+00001410: 7363 7269 6d69 6e61 6e74 416e 616c 7973  scriminantAnalys
+00001420: 6973 0d0a 2020 2020 6672 6f6d 2073 6b6c  is..    from skl
+00001430: 6561 726e 2e63 6c75 7374 6572 2069 6d70  earn.cluster imp
+00001440: 6f72 7420 4b4d 6561 6e73 0d0a 2020 2020  ort KMeans..    
+00001450: 6672 6f6d 2078 6762 6f6f 7374 2069 6d70  from xgboost imp
+00001460: 6f72 7420 5847 4243 6c61 7373 6966 6965  ort XGBClassifie
+00001470: 720d 0a20 2020 2066 726f 6d20 6c69 6768  r..    from ligh
+00001480: 7467 626d 2069 6d70 6f72 7420 4c47 424d  tgbm import LGBM
+00001490: 436c 6173 7369 6669 6572 0d0a 2020 2020  Classifier..    
+000014a0: 6672 6f6d 2063 6174 626f 6f73 7420 696d  from catboost im
+000014b0: 706f 7274 2043 6174 426f 6f73 7443 6c61  port CatBoostCla
+000014c0: 7373 6966 6965 720d 0a20 2020 2066 726f  ssifier..    fro
+000014d0: 6d20 696d 626c 6561 726e 2e65 6e73 656d  m imblearn.ensem
+000014e0: 626c 6520 696d 706f 7274 2042 616c 616e  ble import Balan
+000014f0: 6365 6452 616e 646f 6d46 6f72 6573 7443  cedRandomForestC
+00001500: 6c61 7373 6966 6965 720d 0a20 2020 2066  lassifier..    f
+00001510: 726f 6d20 736b 6c65 6172 6e20 696d 706f  rom sklearn impo
+00001520: 7274 206d 6574 7269 6373 0d0a 2020 2020  rt metrics..    
+00001530: 0d0a 2020 2020 6d6f 6465 6c73 203d 205b  ..    models = [
+00001540: 0d0a 2020 2020 2020 2020 2822 4c6f 6769  ..        ("Logi
+00001550: 7374 6963 2052 6567 7265 7373 696f 6e22  stic Regression"
+00001560: 2c20 4c6f 6769 7374 6963 5265 6772 6573  , LogisticRegres
+00001570: 7369 6f6e 286d 6178 5f69 7465 723d 3130  sion(max_iter=10
+00001580: 3030 2929 2c0d 0a20 2020 2020 2020 2028  00)),..        (
+00001590: 2244 6563 6973 696f 6e20 5472 6565 222c  "Decision Tree",
+000015a0: 2044 6563 6973 696f 6e54 7265 6543 6c61   DecisionTreeCla
+000015b0: 7373 6966 6965 7228 2929 2c0d 0a20 2020  ssifier()),..   
+000015c0: 2020 2020 2028 2252 616e 646f 6d20 466f       ("Random Fo
+000015d0: 7265 7374 222c 2052 616e 646f 6d46 6f72  rest", RandomFor
+000015e0: 6573 7443 6c61 7373 6966 6965 7228 2929  estClassifier())
+000015f0: 2c0d 0a20 2020 2020 2020 2028 2247 7261  ,..        ("Gra
+00001600: 6469 656e 7420 426f 6f73 7469 6e67 222c  dient Boosting",
+00001610: 2047 7261 6469 656e 7442 6f6f 7374 696e   GradientBoostin
+00001620: 6743 6c61 7373 6966 6965 7228 2929 2c0d  gClassifier()),.
+00001630: 0a20 2020 2020 2020 2028 2258 4742 6f6f  .        ("XGBoo
+00001640: 7374 222c 2058 4742 436c 6173 7369 6669  st", XGBClassifi
+00001650: 6572 2865 7661 6c5f 6d65 7472 6963 3d22  er(eval_metric="
+00001660: 6c6f 676c 6f73 7322 2929 2c0d 0a20 2020  logloss")),..   
+00001670: 2020 2020 2028 224c 6967 6874 4742 4d22       ("LightGBM"
+00001680: 2c20 4c47 424d 436c 6173 7369 6669 6572  , LGBMClassifier
+00001690: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
+000016a0: 5375 7070 6f72 7420 5665 6374 6f72 204d  Support Vector M
+000016b0: 6163 6869 6e65 222c 2053 5643 2829 292c  achine", SVC()),
+000016c0: 0d0a 2020 2020 2020 2020 2822 4b2d 4e65  ..        ("K-Ne
+000016d0: 6172 6573 7420 4e65 6967 6862 6f72 7322  arest Neighbors"
+000016e0: 2c20 4b4e 6569 6768 626f 7273 436c 6173  , KNeighborsClas
+000016f0: 7369 6669 6572 2829 292c 0d0a 2020 2020  sifier()),..    
+00001700: 2020 2020 2822 4e61 6976 6520 4261 7965      ("Naive Baye
+00001710: 7322 2c20 4761 7573 7369 616e 4e42 2829  s", GaussianNB()
+00001720: 292c 0d0a 2020 2020 2020 2020 2822 4d75  ),..        ("Mu
+00001730: 6c74 692d 6c61 7965 7220 5065 7263 6570  lti-layer Percep
+00001740: 7472 6f6e 222c 204d 4c50 436c 6173 7369  tron", MLPClassi
+00001750: 6669 6572 286d 6178 5f69 7465 723d 3130  fier(max_iter=10
+00001760: 3030 2929 2c0d 0a20 2020 2020 2020 2028  00)),..        (
+00001770: 2241 6461 426f 6f73 7422 2c20 4164 6142  "AdaBoost", AdaB
+00001780: 6f6f 7374 436c 6173 7369 6669 6572 2829  oostClassifier()
+00001790: 292c 0d0a 2020 2020 2020 2020 2822 4578  ),..        ("Ex
+000017a0: 7472 6120 5472 6565 7322 2c20 4578 7472  tra Trees", Extr
+000017b0: 6154 7265 6573 436c 6173 7369 6669 6572  aTreesClassifier
+000017c0: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
+000017d0: 5269 6467 6520 436c 6173 7369 6669 6572  Ridge Classifier
+000017e0: 222c 2052 6964 6765 436c 6173 7369 6669  ", RidgeClassifi
+000017f0: 6572 2829 292c 0d0a 2020 2020 2020 2020  er()),..        
+00001800: 2822 5175 6164 7261 7469 6320 4469 7363  ("Quadratic Disc
+00001810: 7269 6d69 6e61 6e74 2041 6e61 6c79 7369  riminant Analysi
+00001820: 7322 2c20 5175 6164 7261 7469 6344 6973  s", QuadraticDis
+00001830: 6372 696d 696e 616e 7441 6e61 6c79 7369  criminantAnalysi
+00001840: 7328 2929 2c0d 0a20 2020 2020 2020 2028  s()),..        (
+00001850: 2243 6174 426f 6f73 7422 2c20 4361 7442  "CatBoost", CatB
+00001860: 6f6f 7374 436c 6173 7369 6669 6572 2876  oostClassifier(v
+00001870: 6572 626f 7365 3d30 2c20 7261 6e64 6f6d  erbose=0, random
+00001880: 5f73 6565 643d 3432 2929 2c0d 0a20 2020  _seed=42)),..   
+00001890: 2020 2020 2028 2242 616c 616e 6365 6420       ("Balanced 
+000018a0: 5261 6e64 6f6d 2046 6f72 6573 7422 2c20  Random Forest", 
+000018b0: 4261 6c61 6e63 6564 5261 6e64 6f6d 466f  BalancedRandomFo
+000018c0: 7265 7374 436c 6173 7369 6669 6572 2829  restClassifier()
+000018d0: 292c 0d0a 2020 2020 2020 2020 2822 4c69  ),..        ("Li
+000018e0: 6e65 6172 2044 6973 6372 696d 696e 616e  near Discriminan
+000018f0: 7420 416e 616c 7973 6973 222c 204c 696e  t Analysis", Lin
+00001900: 6561 7244 6973 6372 696d 696e 616e 7441  earDiscriminantA
+00001910: 6e61 6c79 7369 7328 2929 2c0d 0a20 2020  nalysis()),..   
+00001920: 2020 2020 2028 224e 6561 7265 7374 2043       ("Nearest C
+00001930: 656e 7472 6f69 6420 436c 6173 7369 6669  entroid Classifi
+00001940: 6572 222c 204e 6561 7265 7374 4365 6e74  er", NearestCent
+00001950: 726f 6964 2829 292c 0d0a 2020 2020 2020  roid()),..      
+00001960: 2020 2822 5061 7373 6976 6520 4167 6772    ("Passive Aggr
+00001970: 6573 7369 7665 2043 6c61 7373 6966 6965  essive Classifie
+00001980: 7222 2c20 5061 7373 6976 6541 6767 7265  r", PassiveAggre
+00001990: 7373 6976 6543 6c61 7373 6966 6965 7228  ssiveClassifier(
+000019a0: 2929 2c0d 0a20 2020 2020 2020 2028 2250  )),..        ("P
+000019b0: 6572 6365 7074 726f 6e22 2c20 5065 7263  erceptron", Perc
+000019c0: 6570 7472 6f6e 2829 292c 0d0a 2020 2020  eptron()),..    
+000019d0: 2020 2020 2822 4265 726e 6f75 6c6c 6920      ("Bernoulli 
+000019e0: 4e61 6976 6520 4261 7965 7322 2c20 4265  Naive Bayes", Be
+000019f0: 726e 6f75 6c6c 694e 4228 2929 2c0d 0a20  rnoulliNB()),.. 
+00001a00: 2020 2020 2020 2028 2242 6167 6769 6e67         ("Bagging
+00001a10: 2043 6c61 7373 6966 6965 7222 2c20 4261   Classifier", Ba
+00001a20: 6767 696e 6743 6c61 7373 6966 6965 7228  ggingClassifier(
+00001a30: 2929 2c0d 0a20 2020 2020 2020 2023 2041  )),..        # A
+00001a40: 6464 2061 2062 6173 6520 6573 7469 6d61  dd a base estima
+00001a50: 746f 7220 666f 7220 5374 6163 6b69 6e67  tor for Stacking
+00001a60: 436c 6173 7369 6669 6572 0d0a 2020 2020  Classifier..    
+00001a70: 2020 2020 2822 5374 6163 6b69 6e67 2043      ("Stacking C
+00001a80: 6c61 7373 6966 6965 7222 2c20 5374 6163  lassifier", Stac
+00001a90: 6b69 6e67 436c 6173 7369 6669 6572 2865  kingClassifier(e
+00001aa0: 7374 696d 6174 6f72 733d 5b28 276c 7227  stimators=[('lr'
+00001ab0: 2c20 4c6f 6769 7374 6963 5265 6772 6573  , LogisticRegres
+00001ac0: 7369 6f6e 2829 292c 2028 2764 7427 2c20  sion()), ('dt', 
+00001ad0: 4465 6369 7369 6f6e 5472 6565 436c 6173  DecisionTreeClas
+00001ae0: 7369 6669 6572 2829 295d 2929 2c0d 0a20  sifier())])),.. 
+00001af0: 2020 205d 0d0a 0d0a 0d0a 2020 2020 6265     ]......    be
+00001b00: 7374 5f6d 6f64 656c 203d 204e 6f6e 650d  st_model = None.
+00001b10: 0a20 2020 2062 6573 745f 6163 6375 7261  .    best_accura
+00001b20: 6379 203d 202d 310d 0a20 2020 2062 6573  cy = -1..    bes
+00001b30: 745f 6d6f 6465 6c5f 696e 7374 616e 6365  t_model_instance
+00001b40: 203d 204e 6f6e 650d 0a0d 0a20 2020 2066   = None....    f
+00001b50: 6f72 206e 616d 652c 206d 6f64 656c 2069  or name, model i
+00001b60: 6e20 6d6f 6465 6c73 3a0d 0a20 2020 2020  n models:..     
+00001b70: 2020 206d 6f64 656c 2e66 6974 2864 665f     model.fit(df_
+00001b80: 585f 7472 6169 6e2c 2064 665f 795f 7472  X_train, df_y_tr
+00001b90: 6169 6e29 0d0a 2020 2020 2020 2020 795f  ain)..        y_
+00001ba0: 7072 6564 5f62 696e 6172 7920 3d20 6d6f  pred_binary = mo
+00001bb0: 6465 6c2e 7072 6564 6963 7428 6466 5f58  del.predict(df_X
+00001bc0: 5f74 6573 7429 0d0a 0d0a 2020 2020 2020  _test)....      
+00001bd0: 2020 6966 206e 616d 6520 696e 205b 2249    if name in ["I
+00001be0: 736f 6c61 7469 6f6e 2046 6f72 6573 7422  solation Forest"
+00001bf0: 2c20 224f 6e65 2d43 6c61 7373 2053 564d  , "One-Class SVM
+00001c00: 222c 2022 4b2d 4d65 616e 7322 5d3a 0d0a  ", "K-Means"]:..
+00001c10: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
+00001c20: 6564 5f62 696e 6172 7920 3d20 6e70 2e77  ed_binary = np.w
+00001c30: 6865 7265 2879 5f70 7265 645f 6269 6e61  here(y_pred_bina
+00001c40: 7279 203d 3d20 2d31 2c20 302c 2079 5f70  ry == -1, 0, y_p
+00001c50: 7265 645f 6269 6e61 7279 290d 0a0d 0a20  red_binary).... 
+00001c60: 2020 2020 2020 2070 7269 6e74 286e 616d         print(nam
+00001c70: 6520 2b20 2220 4d6f 6465 6c3a 2229 0d0a  e + " Model:")..
+00001c80: 2020 2020 2020 2020 636f 6e66 7573 696f          confusio
+00001c90: 6e5f 6d61 7472 6978 203d 206d 6574 7269  n_matrix = metri
+00001ca0: 6373 2e63 6f6e 6675 7369 6f6e 5f6d 6174  cs.confusion_mat
+00001cb0: 7269 7828 6466 5f79 5f74 6573 742c 2079  rix(df_y_test, y
+00001cc0: 5f70 7265 645f 6269 6e61 7279 290d 0a20  _pred_binary).. 
+00001cd0: 2020 2020 2020 2070 7269 6e74 2822 436f         print("Co
+00001ce0: 6e66 7573 696f 6e20 4d61 7472 6978 3a22  nfusion Matrix:"
+00001cf0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+00001d00: 2863 6f6e 6675 7369 6f6e 5f6d 6174 7269  (confusion_matri
+00001d10: 7829 0d0a 0d0a 2020 2020 2020 2020 6163  x)....        ac
+00001d20: 6375 7261 6379 203d 206d 6574 7269 6373  curacy = metrics
+00001d30: 2e61 6363 7572 6163 795f 7363 6f72 6528  .accuracy_score(
+00001d40: 6466 5f79 5f74 6573 742c 2079 5f70 7265  df_y_test, y_pre
+00001d50: 645f 6269 6e61 7279 290d 0a20 2020 2020  d_binary)..     
+00001d60: 2020 2070 7265 6369 7369 6f6e 203d 206d     precision = m
+00001d70: 6574 7269 6373 2e70 7265 6369 7369 6f6e  etrics.precision
+00001d80: 5f73 636f 7265 2864 665f 795f 7465 7374  _score(df_y_test
+00001d90: 2c20 795f 7072 6564 5f62 696e 6172 7929  , y_pred_binary)
+00001da0: 0d0a 2020 2020 2020 2020 7265 6361 6c6c  ..        recall
+00001db0: 203d 206d 6574 7269 6373 2e72 6563 616c   = metrics.recal
+00001dc0: 6c5f 7363 6f72 6528 6466 5f79 5f74 6573  l_score(df_y_tes
+00001dd0: 742c 2079 5f70 7265 645f 6269 6e61 7279  t, y_pred_binary
+00001de0: 290d 0a20 2020 2020 2020 2063 6c61 7373  )..        class
+00001df0: 6966 6963 6174 696f 6e5f 7265 706f 7274  ification_report
+00001e00: 203d 206d 6574 7269 6373 2e63 6c61 7373   = metrics.class
+00001e10: 6966 6963 6174 696f 6e5f 7265 706f 7274  ification_report
+00001e20: 2864 665f 795f 7465 7374 2c20 795f 7072  (df_y_test, y_pr
+00001e30: 6564 5f62 696e 6172 7929 0d0a 0d0a 2020  ed_binary)....  
+00001e40: 2020 2020 2020 7072 696e 7428 2241 6363        print("Acc
+00001e50: 7572 6163 793a 222c 2061 6363 7572 6163  uracy:", accurac
+00001e60: 7929 0d0a 2020 2020 2020 2020 7072 696e  y)..        prin
+00001e70: 7428 2250 7265 6369 7369 6f6e 3a22 2c20  t("Precision:", 
+00001e80: 7072 6563 6973 696f 6e29 0d0a 2020 2020  precision)..    
+00001e90: 2020 2020 7072 696e 7428 2252 6563 616c      print("Recal
+00001ea0: 6c3a 222c 2072 6563 616c 6c29 0d0a 2020  l:", recall)..  
+00001eb0: 2020 2020 2020 7072 696e 7428 636c 6173        print(clas
+00001ec0: 7369 6669 6361 7469 6f6e 5f72 6570 6f72  sification_repor
+00001ed0: 7429 0d0a 0d0a 2020 2020 2020 2020 6966  t)....        if
+00001ee0: 2061 6363 7572 6163 7920 3e20 6265 7374   accuracy > best
+00001ef0: 5f61 6363 7572 6163 793a 0d0a 2020 2020  _accuracy:..    
+00001f00: 2020 2020 2020 2020 6265 7374 5f61 6363          best_acc
+00001f10: 7572 6163 7920 3d20 6163 6375 7261 6379  uracy = accuracy
+00001f20: 0d0a 2020 2020 2020 2020 2020 2020 6265  ..            be
+00001f30: 7374 5f6d 6f64 656c 203d 206e 616d 650d  st_model = name.
+00001f40: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
+00001f50: 745f 6d6f 6465 6c5f 696e 7374 616e 6365  t_model_instance
+00001f60: 203d 206d 6f64 656c 0d0a 0d0a 2020 2020   = model....    
+00001f70: 7072 696e 7428 2254 6865 2062 6573 7420  print("The best 
+00001f80: 6d6f 6465 6c20 6973 3a22 2c20 6265 7374  model is:", best
+00001f90: 5f6d 6f64 656c 2c20 2277 6974 6820 616e  _model, "with an
+00001fa0: 2061 6363 7572 6163 7920 6f66 222c 2062   accuracy of", b
+00001fb0: 6573 745f 6163 6375 7261 6379 290d 0a0d  est_accuracy)...
+00001fc0: 0a20 2020 2023 2050 7269 6e74 2074 6865  .    # Print the
+00001fd0: 2063 6f6e 6675 7369 6f6e 206d 6174 7269   confusion matri
+00001fe0: 7820 666f 7220 7468 6520 6265 7374 206d  x for the best m
+00001ff0: 6f64 656c 0d0a 2020 2020 795f 7072 6564  odel..    y_pred
+00002000: 5f62 6573 7420 3d20 6265 7374 5f6d 6f64  _best = best_mod
+00002010: 656c 5f69 6e73 7461 6e63 652e 7072 6564  el_instance.pred
+00002020: 6963 7428 6466 5f58 5f74 6573 7429 0d0a  ict(df_X_test)..
+00002030: 2020 2020 6966 2062 6573 745f 6d6f 6465      if best_mode
+00002040: 6c20 696e 205b 2249 736f 6c61 7469 6f6e  l in ["Isolation
+00002050: 2046 6f72 6573 7422 2c20 224f 6e65 2d43   Forest", "One-C
+00002060: 6c61 7373 2053 564d 222c 2022 4b2d 4d65  lass SVM", "K-Me
+00002070: 616e 7322 5d3a 0d0a 2020 2020 2020 2020  ans"]:..        
+00002080: 795f 7072 6564 5f62 6573 7420 3d20 6e70  y_pred_best = np
+00002090: 2e77 6865 7265 2879 5f70 7265 645f 6265  .where(y_pred_be
+000020a0: 7374 203d 3d20 2d31 2c20 302c 2079 5f70  st == -1, 0, y_p
+000020b0: 7265 645f 6265 7374 290d 0a20 2020 2070  red_best)..    p
+000020c0: 7269 6e74 2822 436f 6e66 7573 696f 6e20  rint("Confusion 
+000020d0: 4d61 7472 6978 206f 6620 7468 6520 6265  Matrix of the be
+000020e0: 7374 206d 6f64 656c 3a22 290d 0a20 2020  st model:")..   
+000020f0: 2070 7269 6e74 286d 6574 7269 6373 2e63   print(metrics.c
+00002100: 6f6e 6675 7369 6f6e 5f6d 6174 7269 7828  onfusion_matrix(
+00002110: 6466 5f79 5f74 6573 742c 2079 5f70 7265  df_y_test, y_pre
+00002120: 645f 6265 7374 2929 0d0a 2020 2020 0d0a  d_best))..    ..
+00002130: 2020 2020 0d0a 6465 6620 6669 6e64 5f62      ..def find_b
+00002140: 6573 745f 6d6f 6465 6c5f 7265 6772 6573  est_model_regres
+00002150: 7369 6f6e 2864 665f 585f 7472 6169 6e2c  sion(df_X_train,
+00002160: 2064 665f 585f 7465 7374 2c20 6466 5f79   df_X_test, df_y
+00002170: 5f74 7261 696e 2c20 6466 5f79 5f74 6573  _train, df_y_tes
+00002180: 7429 3a0d 0a20 2020 200d 0a20 2020 2069  t):..    ..    i
+00002190: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+000021a0: 700d 0a20 2020 2069 6d70 6f72 7420 7061  p..    import pa
+000021b0: 6e64 6173 2061 7320 7064 0d0a 2020 2020  ndas as pd..    
+000021c0: 6672 6f6d 2073 6b6c 6561 726e 2e6c 696e  from sklearn.lin
+000021d0: 6561 725f 6d6f 6465 6c20 696d 706f 7274  ear_model import
+000021e0: 204c 696e 6561 7252 6567 7265 7373 696f   LinearRegressio
+000021f0: 6e2c 2052 6964 6765 2c20 4c61 7373 6f2c  n, Ridge, Lasso,
+00002200: 2045 6c61 7374 6963 4e65 742c 2042 6179   ElasticNet, Bay
+00002210: 6573 6961 6e52 6964 6765 2c20 5347 4452  esianRidge, SGDR
+00002220: 6567 7265 7373 6f72 0d0a 2020 2020 6672  egressor..    fr
+00002230: 6f6d 2073 6b6c 6561 726e 2e74 7265 6520  om sklearn.tree 
+00002240: 696d 706f 7274 2044 6563 6973 696f 6e54  import DecisionT
+00002250: 7265 6552 6567 7265 7373 6f72 0d0a 2020  reeRegressor..  
+00002260: 2020 6672 6f6d 2073 6b6c 6561 726e 2e65    from sklearn.e
+00002270: 6e73 656d 626c 6520 696d 706f 7274 2052  nsemble import R
+00002280: 616e 646f 6d46 6f72 6573 7452 6567 7265  andomForestRegre
+00002290: 7373 6f72 2c20 4772 6164 6965 6e74 426f  ssor, GradientBo
+000022a0: 6f73 7469 6e67 5265 6772 6573 736f 722c  ostingRegressor,
+000022b0: 2041 6461 426f 6f73 7452 6567 7265 7373   AdaBoostRegress
+000022c0: 6f72 2c20 4578 7472 6154 7265 6573 5265  or, ExtraTreesRe
+000022d0: 6772 6573 736f 722c 2042 6167 6769 6e67  gressor, Bagging
+000022e0: 5265 6772 6573 736f 720d 0a20 2020 2066  Regressor..    f
+000022f0: 726f 6d20 736b 6c65 6172 6e2e 7376 6d20  rom sklearn.svm 
+00002300: 696d 706f 7274 2053 5652 0d0a 2020 2020  import SVR..    
+00002310: 6672 6f6d 2073 6b6c 6561 726e 2e6e 6569  from sklearn.nei
+00002320: 6768 626f 7273 2069 6d70 6f72 7420 4b4e  ghbors import KN
+00002330: 6569 6768 626f 7273 5265 6772 6573 736f  eighborsRegresso
+00002340: 720d 0a20 2020 2066 726f 6d20 736b 6c65  r..    from skle
+00002350: 6172 6e2e 6e65 7572 616c 5f6e 6574 776f  arn.neural_netwo
+00002360: 726b 2069 6d70 6f72 7420 4d4c 5052 6567  rk import MLPReg
+00002370: 7265 7373 6f72 0d0a 2020 2020 6672 6f6d  ressor..    from
+00002380: 2078 6762 6f6f 7374 2069 6d70 6f72 7420   xgboost import 
+00002390: 5847 4252 6567 7265 7373 6f72 0d0a 2020  XGBRegressor..  
+000023a0: 2020 6672 6f6d 206c 6967 6874 6762 6d20    from lightgbm 
+000023b0: 696d 706f 7274 204c 4742 4d52 6567 7265  import LGBMRegre
+000023c0: 7373 6f72 0d0a 2020 2020 6672 6f6d 2063  ssor..    from c
+000023d0: 6174 626f 6f73 7420 696d 706f 7274 2043  atboost import C
+000023e0: 6174 426f 6f73 7452 6567 7265 7373 6f72  atBoostRegressor
+000023f0: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
+00002400: 726e 2069 6d70 6f72 7420 6d65 7472 6963  rn import metric
+00002410: 730d 0a0d 0a20 2020 206d 6f64 656c 7320  s....    models 
+00002420: 3d20 5b0d 0a20 2020 2020 2020 2028 224c  = [..        ("L
+00002430: 696e 6561 7220 5265 6772 6573 7369 6f6e  inear Regression
+00002440: 222c 204c 696e 6561 7252 6567 7265 7373  ", LinearRegress
+00002450: 696f 6e28 2929 2c0d 0a20 2020 2020 2020  ion()),..       
+00002460: 2028 2252 6964 6765 2052 6567 7265 7373   ("Ridge Regress
+00002470: 696f 6e22 2c20 5269 6467 6528 2929 2c0d  ion", Ridge()),.
+00002480: 0a20 2020 2020 2020 2028 224c 6173 736f  .        ("Lasso
+00002490: 2052 6567 7265 7373 696f 6e22 2c20 4c61   Regression", La
+000024a0: 7373 6f28 2929 2c0d 0a20 2020 2020 2020  sso()),..       
+000024b0: 2028 2245 6c61 7374 6963 4e65 7420 5265   ("ElasticNet Re
+000024c0: 6772 6573 7369 6f6e 222c 2045 6c61 7374  gression", Elast
+000024d0: 6963 4e65 7428 2929 2c0d 0a20 2020 2020  icNet()),..     
+000024e0: 2020 2028 2242 6179 6573 6961 6e20 5269     ("Bayesian Ri
+000024f0: 6467 6520 5265 6772 6573 7369 6f6e 222c  dge Regression",
+00002500: 2042 6179 6573 6961 6e52 6964 6765 2829   BayesianRidge()
+00002510: 292c 0d0a 2020 2020 2020 2020 2822 4465  ),..        ("De
+00002520: 6369 7369 6f6e 2054 7265 6520 5265 6772  cision Tree Regr
+00002530: 6573 736f 7222 2c20 4465 6369 7369 6f6e  essor", Decision
+00002540: 5472 6565 5265 6772 6573 736f 7228 2929  TreeRegressor())
+00002550: 2c0d 0a20 2020 2020 2020 2028 2252 616e  ,..        ("Ran
+00002560: 646f 6d20 466f 7265 7374 2052 6567 7265  dom Forest Regre
+00002570: 7373 6f72 222c 2052 616e 646f 6d46 6f72  ssor", RandomFor
+00002580: 6573 7452 6567 7265 7373 6f72 2829 292c  estRegressor()),
+00002590: 0d0a 2020 2020 2020 2020 2822 4772 6164  ..        ("Grad
+000025a0: 6965 6e74 2042 6f6f 7374 696e 6720 5265  ient Boosting Re
+000025b0: 6772 6573 736f 7222 2c20 4772 6164 6965  gressor", Gradie
+000025c0: 6e74 426f 6f73 7469 6e67 5265 6772 6573  ntBoostingRegres
+000025d0: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
+000025e0: 2028 2258 4742 6f6f 7374 2052 6567 7265   ("XGBoost Regre
+000025f0: 7373 6f72 222c 2058 4742 5265 6772 6573  ssor", XGBRegres
+00002600: 736f 7228 6576 616c 5f6d 6574 7269 633d  sor(eval_metric=
+00002610: 2272 6d73 6522 2929 2c0d 0a20 2020 2020  "rmse")),..     
+00002620: 2020 2028 224c 6967 6874 4742 4d20 5265     ("LightGBM Re
+00002630: 6772 6573 736f 7222 2c20 4c47 424d 5265  gressor", LGBMRe
+00002640: 6772 6573 736f 7228 2929 2c0d 0a20 2020  gressor()),..   
+00002650: 2020 2020 2028 2253 7570 706f 7274 2056       ("Support V
+00002660: 6563 746f 7220 5265 6772 6573 736f 7222  ector Regressor"
+00002670: 2c20 5356 5228 2929 2c0d 0a20 2020 2020  , SVR()),..     
+00002680: 2020 2028 224b 2d4e 6561 7265 7374 204e     ("K-Nearest N
+00002690: 6569 6768 626f 7273 2052 6567 7265 7373  eighbors Regress
+000026a0: 6f72 222c 204b 4e65 6967 6862 6f72 7352  or", KNeighborsR
+000026b0: 6567 7265 7373 6f72 2829 292c 0d0a 2020  egressor()),..  
+000026c0: 2020 2020 2020 2822 4d75 6c74 692d 6c61        ("Multi-la
+000026d0: 7965 7220 5065 7263 6570 7472 6f6e 2052  yer Perceptron R
+000026e0: 6567 7265 7373 6f72 222c 204d 4c50 5265  egressor", MLPRe
+000026f0: 6772 6573 736f 7228 6d61 785f 6974 6572  gressor(max_iter
+00002700: 3d31 3030 3029 292c 0d0a 2020 2020 2020  =1000)),..      
+00002710: 2020 2822 4164 6142 6f6f 7374 2052 6567    ("AdaBoost Reg
+00002720: 7265 7373 6f72 222c 2041 6461 426f 6f73  ressor", AdaBoos
+00002730: 7452 6567 7265 7373 6f72 2829 292c 0d0a  tRegressor()),..
+00002740: 2020 2020 2020 2020 2822 4578 7472 6120          ("Extra 
+00002750: 5472 6565 7320 5265 6772 6573 736f 7222  Trees Regressor"
+00002760: 2c20 4578 7472 6154 7265 6573 5265 6772  , ExtraTreesRegr
+00002770: 6573 736f 7228 2929 2c0d 0a20 2020 2020  essor()),..     
+00002780: 2020 2028 2253 746f 6368 6173 7469 6320     ("Stochastic 
+00002790: 4772 6164 6965 6e74 2044 6573 6365 6e74  Gradient Descent
+000027a0: 2052 6567 7265 7373 6f72 222c 2053 4744   Regressor", SGD
+000027b0: 5265 6772 6573 736f 7228 2929 2c0d 0a20  Regressor()),.. 
+000027c0: 2020 2020 2020 2028 2242 6167 6769 6e67         ("Bagging
+000027d0: 2052 6567 7265 7373 6f72 222c 2042 6167   Regressor", Bag
+000027e0: 6769 6e67 5265 6772 6573 736f 7228 2929  gingRegressor())
+000027f0: 2c0d 0a20 2020 2020 2020 2028 2243 6174  ,..        ("Cat
+00002800: 426f 6f73 7420 5265 6772 6573 736f 7222  Boost Regressor"
+00002810: 2c20 4361 7442 6f6f 7374 5265 6772 6573  , CatBoostRegres
+00002820: 736f 7228 7665 7262 6f73 653d 302c 2072  sor(verbose=0, r
+00002830: 616e 646f 6d5f 7365 6564 3d34 3229 292c  andom_seed=42)),
+00002840: 0d0a 2020 2020 5d0d 0a0d 0a20 2020 2062  ..    ]....    b
+00002850: 6573 745f 6d6f 6465 6c20 3d20 4e6f 6e65  est_model = None
+00002860: 0d0a 2020 2020 6265 7374 5f6d 7365 203d  ..    best_mse =
+00002870: 2066 6c6f 6174 2822 696e 6622 290d 0a20   float("inf").. 
+00002880: 2020 2062 6573 745f 6d6f 6465 6c5f 696e     best_model_in
+00002890: 7374 616e 6365 203d 204e 6f6e 650d 0a0d  stance = None...
+000028a0: 0a20 2020 2066 6f72 206e 616d 652c 206d  .    for name, m
+000028b0: 6f64 656c 2069 6e20 6d6f 6465 6c73 3a0d  odel in models:.
+000028c0: 0a20 2020 2020 2020 206d 6f64 656c 2e66  .        model.f
+000028d0: 6974 2864 665f 585f 7472 6169 6e2c 2064  it(df_X_train, d
+000028e0: 665f 795f 7472 6169 6e29 0d0a 2020 2020  f_y_train)..    
+000028f0: 2020 2020 795f 7072 6564 203d 206d 6f64      y_pred = mod
+00002900: 656c 2e70 7265 6469 6374 2864 665f 585f  el.predict(df_X_
+00002910: 7465 7374 290d 0a0d 0a20 2020 2020 2020  test)....       
+00002920: 2070 7269 6e74 286e 616d 6520 2b20 2220   print(name + " 
+00002930: 4d6f 6465 6c3a 2229 0d0a 2020 2020 2020  Model:")..      
+00002940: 2020 6d73 6520 3d20 6d65 7472 6963 732e    mse = metrics.
+00002950: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
+00002960: 6f72 2864 665f 795f 7465 7374 2c20 795f  or(df_y_test, y_
+00002970: 7072 6564 290d 0a20 2020 2020 2020 2072  pred)..        r
+00002980: 6d73 6520 3d20 6e70 2e73 7172 7428 6d73  mse = np.sqrt(ms
+00002990: 6529 0d0a 2020 2020 2020 2020 7232 203d  e)..        r2 =
+000029a0: 206d 6574 7269 6373 2e72 325f 7363 6f72   metrics.r2_scor
+000029b0: 6528 6466 5f79 5f74 6573 742c 2079 5f70  e(df_y_test, y_p
+000029c0: 7265 6429 0d0a 0d0a 2020 2020 2020 2020  red)....        
+000029d0: 7072 696e 7428 224d 6561 6e20 5371 7561  print("Mean Squa
+000029e0: 7265 6420 4572 726f 723a 222c 206d 7365  red Error:", mse
+000029f0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+00002a00: 2822 526f 6f74 204d 6561 6e20 5371 7561  ("Root Mean Squa
+00002a10: 7265 6420 4572 726f 723a 222c 2072 6d73  red Error:", rms
+00002a20: 6529 0d0a 2020 2020 2020 2020 7072 696e  e)..        prin
+00002a30: 7428 2252 2d73 7175 6172 6564 3a22 2c20  t("R-squared:", 
+00002a40: 7232 290d 0a20 2020 2020 2020 2070 7269  r2)..        pri
+00002a50: 6e74 2829 0d0a 0d0a 2020 2020 2020 2020  nt()....        
+00002a60: 6966 206d 7365 203c 2062 6573 745f 6d73  if mse < best_ms
+00002a70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00002a80: 6265 7374 5f6d 7365 203d 206d 7365 0d0a  best_mse = mse..
+00002a90: 2020 2020 2020 2020 2020 2020 6265 7374              best
+00002aa0: 5f6d 6f64 656c 203d 206e 616d 650d 0a20  _model = name.. 
+00002ab0: 2020 2020 2020 2020 2020 2062 6573 745f             best_
+00002ac0: 6d6f 6465 6c5f 696e 7374 616e 6365 203d  model_instance =
+00002ad0: 206d 6f64 656c 0d0a 0d0a 2020 2020 7072   model....    pr
+00002ae0: 696e 7428 2254 6865 2062 6573 7420 6d6f  int("The best mo
+00002af0: 6465 6c20 6973 3a22 2c20 6265 7374 5f6d  del is:", best_m
+00002b00: 6f64 656c 2c20 2277 6974 6820 6120 4d65  odel, "with a Me
+00002b10: 616e 2053 7175 6172 6564 2045 7272 6f72  an Squared Error
+00002b20: 206f 6622 2c20 6265 7374 5f6d 7365 290d   of", best_mse).
+00002b30: 0a0d 0a20 2020 2023 2050 7269 6e74 2074  ...    # Print t
+00002b40: 6865 206d 6574 7269 6373 2066 6f72 2074  he metrics for t
+00002b50: 6865 2062 6573 7420 6d6f 6465 6c0d 0a20  he best model.. 
+00002b60: 2020 2079 5f70 7265 645f 6265 7374 203d     y_pred_best =
+00002b70: 2062 6573 745f 6d6f 6465 6c5f 696e 7374   best_model_inst
+00002b80: 616e 6365 2e70 7265 6469 6374 2864 665f  ance.predict(df_
+00002b90: 585f 7465 7374 290d 0a20 2020 2062 6573  X_test)..    bes
+00002ba0: 745f 726d 7365 203d 206e 702e 7371 7274  t_rmse = np.sqrt
+00002bb0: 2862 6573 745f 6d73 6529 0d0a 2020 2020  (best_mse)..    
+00002bc0: 6265 7374 5f72 3220 3d20 6d65 7472 6963  best_r2 = metric
+00002bd0: 732e 7232 5f73 636f 7265 2864 665f 795f  s.r2_score(df_y_
+00002be0: 7465 7374 2c20 795f 7072 6564 5f62 6573  test, y_pred_bes
+00002bf0: 7429 0d0a 2020 2020 7072 696e 7428 224d  t)..    print("M
+00002c00: 6574 7269 6373 206f 6620 7468 6520 6265  etrics of the be
+00002c10: 7374 206d 6f64 656c 3a22 290d 0a20 2020  st model:")..   
+00002c20: 2070 7269 6e74 2822 4d65 616e 2053 7175   print("Mean Squ
+00002c30: 6172 6564 2045 7272 6f72 3a22 2c20 6265  ared Error:", be
+00002c40: 7374 5f6d 7365 290d 0a20 2020 2070 7269  st_mse)..    pri
+00002c50: 6e74 2822 526f 6f74 204d 6561 6e20 5371  nt("Root Mean Sq
+00002c60: 7561 7265 6420 4572 726f 723a 222c 2062  uared Error:", b
+00002c70: 6573 745f 726d 7365 290d 0a20 2020 2070  est_rmse)..    p
+00002c80: 7269 6e74 2822 522d 7371 7561 7265 643a  rint("R-squared:
+00002c90: 222c 2062 6573 745f 7232 290d 0a0d 0a0d  ", best_r2).....
+00002ca0: 0a0d 0a64 6566 2066 696e 645f 6265 7374  ...def find_best
+00002cb0: 5f63 6c75 7374 6572 696e 675f 616c 676f  _clustering_algo
+00002cc0: 7269 7468 6d28 6461 7461 2c20 7363 616c  rithm(data, scal
+00002cd0: 696e 673d 5472 7565 2c20 6e5f 636c 7573  ing=True, n_clus
+00002ce0: 7465 7273 3d4e 6f6e 652c 2076 6973 7561  ters=None, visua
+00002cf0: 6c69 7a65 3d54 7275 652c 2074 6573 745f  lize=True, test_
+00002d00: 6665 6174 7572 655f 636f 6d62 696e 6174  feature_combinat
+00002d10: 696f 6e73 3d46 616c 7365 293a 0d0a 2020  ions=False):..  
+00002d20: 2020 696d 706f 7274 206e 756d 7079 2061    import numpy a
+00002d30: 7320 6e70 0d0a 2020 2020 696d 706f 7274  s np..    import
+00002d40: 2069 7465 7274 6f6f 6c73 0d0a 2020 2020   itertools..    
+00002d50: 6672 6f6d 2073 6b6c 6561 726e 2e70 7265  from sklearn.pre
+00002d60: 7072 6f63 6573 7369 6e67 2069 6d70 6f72  processing impor
+00002d70: 7420 5374 616e 6461 7264 5363 616c 6572  t StandardScaler
+00002d80: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
+00002d90: 726e 2e63 6c75 7374 6572 2069 6d70 6f72  rn.cluster impor
+00002da0: 7420 4b4d 6561 6e73 2c20 4d69 6e69 4261  t KMeans, MiniBa
+00002db0: 7463 684b 4d65 616e 732c 2041 6666 696e  tchKMeans, Affin
+00002dc0: 6974 7950 726f 7061 6761 7469 6f6e 2c20  ityPropagation, 
+00002dd0: 4d65 616e 5368 6966 742c 2065 7374 696d  MeanShift, estim
+00002de0: 6174 655f 6261 6e64 7769 6474 680d 0a20  ate_bandwidth.. 
+00002df0: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
+00002e00: 636c 7573 7465 7220 696d 706f 7274 2053  cluster import S
+00002e10: 7065 6374 7261 6c43 6c75 7374 6572 696e  pectralClusterin
+00002e20: 672c 2041 6767 6c6f 6d65 7261 7469 7665  g, Agglomerative
+00002e30: 436c 7573 7465 7269 6e67 2c20 4442 5343  Clustering, DBSC
+00002e40: 414e 2c20 4f50 5449 4353 2c20 4269 7263  AN, OPTICS, Birc
+00002e50: 680d 0a20 2020 2066 726f 6d20 736b 6c65  h..    from skle
+00002e60: 6172 6e2e 6d69 7874 7572 6520 696d 706f  arn.mixture impo
+00002e70: 7274 2047 6175 7373 6961 6e4d 6978 7475  rt GaussianMixtu
+00002e80: 7265 0d0a 2020 2020 6672 6f6d 2073 6b6c  re..    from skl
+00002e90: 6561 726e 2e64 6563 6f6d 706f 7369 7469  earn.decompositi
+00002ea0: 6f6e 2069 6d70 6f72 7420 5043 410d 0a20  on import PCA.. 
+00002eb0: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
+00002ec0: 6d65 7472 6963 7320 696d 706f 7274 2073  metrics import s
+00002ed0: 696c 686f 7565 7474 655f 7363 6f72 650d  ilhouette_score.
+00002ee0: 0a20 2020 2069 6d70 6f72 7420 6d61 7470  .    import matp
+00002ef0: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
+00002f00: 2070 6c74 0d0a 0d0a 2020 2020 6966 2073   plt....    if s
+00002f10: 6361 6c69 6e67 3a0d 0a20 2020 2020 2020  caling:..       
+00002f20: 2073 6361 6c65 7220 3d20 5374 616e 6461   scaler = Standa
+00002f30: 7264 5363 616c 6572 2829 0d0a 2020 2020  rdScaler()..    
+00002f40: 2020 2020 6461 7461 203d 2073 6361 6c65      data = scale
+00002f50: 722e 6669 745f 7472 616e 7366 6f72 6d28  r.fit_transform(
+00002f60: 6461 7461 290d 0a0d 0a20 2020 2069 6620  data)....    if 
+00002f70: 7465 7374 5f66 6561 7475 7265 5f63 6f6d  test_feature_com
+00002f80: 6269 6e61 7469 6f6e 733a 0d0a 2020 2020  binations:..    
+00002f90: 2020 2020 7072 696e 7428 225c 6e54 6573      print("\nTes
+00002fa0: 7469 6e67 2064 6966 6665 7265 6e74 2066  ting different f
+00002fb0: 6561 7475 7265 2063 6f6d 6269 6e61 7469  eature combinati
+00002fc0: 6f6e 733a 2229 0d0a 2020 2020 2020 2020  ons:")..        
+00002fd0: 666f 7220 6e75 6d5f 6665 6174 7572 6573  for num_features
+00002fe0: 2069 6e20 7261 6e67 6528 312c 2064 6174   in range(1, dat
+00002ff0: 612e 7368 6170 655b 315d 202b 2031 293a  a.shape[1] + 1):
+00003000: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00003010: 7220 6665 6174 7572 655f 636f 6d62 696e  r feature_combin
+00003020: 6174 696f 6e20 696e 2069 7465 7274 6f6f  ation in itertoo
+00003030: 6c73 2e63 6f6d 6269 6e61 7469 6f6e 7328  ls.combinations(
+00003040: 7261 6e67 6528 6461 7461 2e73 6861 7065  range(data.shape
+00003050: 5b31 5d29 2c20 6e75 6d5f 6665 6174 7572  [1]), num_featur
+00003060: 6573 293a 0d0a 2020 2020 2020 2020 2020  es):..          
+00003070: 2020 2020 2020 7265 6475 6365 645f 6461        reduced_da
+00003080: 7461 203d 2064 6174 615b 3a2c 2066 6561  ta = data[:, fea
+00003090: 7475 7265 5f63 6f6d 6269 6e61 7469 6f6e  ture_combination
+000030a0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000030b0: 2020 205f 2c20 5f2c 2073 636f 7265 203d     _, _, score =
+000030c0: 2066 696e 645f 6265 7374 5f63 6c75 7374   find_best_clust
+000030d0: 6572 696e 675f 616c 676f 7269 7468 6d28  ering_algorithm(
+000030e0: 7265 6475 6365 645f 6461 7461 2c20 7363  reduced_data, sc
+000030f0: 616c 696e 673d 4661 6c73 652c 206e 5f63  aling=False, n_c
+00003100: 6c75 7374 6572 733d 6e5f 636c 7573 7465  lusters=n_cluste
+00003110: 7273 2c20 7669 7375 616c 697a 653d 4661  rs, visualize=Fa
+00003120: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
+00003130: 2020 2020 2020 7072 696e 7428 6622 5369        print(f"Si
+00003140: 6c68 6f75 6574 7465 2073 636f 7265 2066  lhouette score f
+00003150: 6f72 2066 6561 7475 7265 7320 7b66 6561  or features {fea
+00003160: 7475 7265 5f63 6f6d 6269 6e61 7469 6f6e  ture_combination
+00003170: 7d3a 207b 7363 6f72 657d 2229 0d0a 0d0a  }: {score}")....
+00003180: 2020 2020 636c 7573 7465 7269 6e67 5f61      clustering_a
+00003190: 6c67 6f72 6974 686d 7320 3d20 5b0d 0a20  lgorithms = [.. 
+000031a0: 2020 2020 2020 2028 224b 4d65 616e 7322         ("KMeans"
+000031b0: 2c20 4b4d 6561 6e73 286e 5f63 6c75 7374  , KMeans(n_clust
+000031c0: 6572 733d 6e5f 636c 7573 7465 7273 2920  ers=n_clusters) 
+000031d0: 6966 206e 5f63 6c75 7374 6572 7320 656c  if n_clusters el
+000031e0: 7365 204b 4d65 616e 7328 2929 2c0d 0a20  se KMeans()),.. 
+000031f0: 2020 2020 2020 2028 224d 696e 6942 6174         ("MiniBat
+00003200: 6368 4b4d 6561 6e73 222c 204d 696e 6942  chKMeans", MiniB
+00003210: 6174 6368 4b4d 6561 6e73 286e 5f63 6c75  atchKMeans(n_clu
+00003220: 7374 6572 733d 6e5f 636c 7573 7465 7273  sters=n_clusters
+00003230: 2920 6966 206e 5f63 6c75 7374 6572 7320  ) if n_clusters 
+00003240: 656c 7365 204d 696e 6942 6174 6368 4b4d  else MiniBatchKM
+00003250: 6561 6e73 2829 292c 0d0a 2020 2020 2020  eans()),..      
+00003260: 2020 2822 4166 6669 6e69 7479 5072 6f70    ("AffinityProp
+00003270: 6167 6174 696f 6e22 2c20 4166 6669 6e69  agation", Affini
+00003280: 7479 5072 6f70 6167 6174 696f 6e28 2929  tyPropagation())
+00003290: 2c0d 0a20 2020 2020 2020 2028 224d 6561  ,..        ("Mea
+000032a0: 6e53 6869 6674 222c 204d 6561 6e53 6869  nShift", MeanShi
+000032b0: 6674 2862 616e 6477 6964 7468 3d65 7374  ft(bandwidth=est
+000032c0: 696d 6174 655f 6261 6e64 7769 6474 6828  imate_bandwidth(
+000032d0: 6461 7461 2c20 6e5f 7361 6d70 6c65 733d  data, n_samples=
+000032e0: 6e5f 636c 7573 7465 7273 2929 2069 6620  n_clusters)) if 
+000032f0: 6e5f 636c 7573 7465 7273 2065 6c73 6520  n_clusters else 
+00003300: 4d65 616e 5368 6966 7428 2929 2c0d 0a20  MeanShift()),.. 
+00003310: 2020 2020 2020 2028 2253 7065 6374 7261         ("Spectra
+00003320: 6c43 6c75 7374 6572 696e 6722 2c20 5370  lClustering", Sp
+00003330: 6563 7472 616c 436c 7573 7465 7269 6e67  ectralClustering
+00003340: 286e 5f63 6c75 7374 6572 733d 6e5f 636c  (n_clusters=n_cl
+00003350: 7573 7465 7273 2920 6966 206e 5f63 6c75  usters) if n_clu
+00003360: 7374 6572 7320 656c 7365 2053 7065 6374  sters else Spect
+00003370: 7261 6c43 6c75 7374 6572 696e 6728 2929  ralClustering())
+00003380: 2c0d 0a20 2020 2020 2020 2028 2241 6767  ,..        ("Agg
+00003390: 6c6f 6d65 7261 7469 7665 436c 7573 7465  lomerativeCluste
+000033a0: 7269 6e67 222c 2041 6767 6c6f 6d65 7261  ring", Agglomera
+000033b0: 7469 7665 436c 7573 7465 7269 6e67 286e  tiveClustering(n
+000033c0: 5f63 6c75 7374 6572 733d 6e5f 636c 7573  _clusters=n_clus
+000033d0: 7465 7273 2920 6966 206e 5f63 6c75 7374  ters) if n_clust
+000033e0: 6572 7320 656c 7365 2041 6767 6c6f 6d65  ers else Agglome
+000033f0: 7261 7469 7665 436c 7573 7465 7269 6e67  rativeClustering
+00003400: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
+00003410: 4442 5343 414e 222c 2044 4253 4341 4e28  DBSCAN", DBSCAN(
+00003420: 2929 2c0d 0a20 2020 2020 2020 2028 224f  )),..        ("O
+00003430: 5054 4943 5322 2c20 4f50 5449 4353 2829  PTICS", OPTICS()
+00003440: 292c 0d0a 2020 2020 2020 2020 2822 4269  ),..        ("Bi
+00003450: 7263 6822 2c20 4269 7263 6828 6e5f 636c  rch", Birch(n_cl
+00003460: 7573 7465 7273 3d6e 5f63 6c75 7374 6572  usters=n_cluster
+00003470: 7329 2069 6620 6e5f 636c 7573 7465 7273  s) if n_clusters
+00003480: 2065 6c73 6520 4269 7263 6828 2929 2c0d   else Birch()),.
+00003490: 0a20 2020 2020 2020 2028 2247 6175 7373  .        ("Gauss
+000034a0: 6961 6e4d 6978 7475 7265 222c 2047 6175  ianMixture", Gau
+000034b0: 7373 6961 6e4d 6978 7475 7265 286e 5f63  ssianMixture(n_c
+000034c0: 6f6d 706f 6e65 6e74 733d 6e5f 636c 7573  omponents=n_clus
+000034d0: 7465 7273 2920 6966 206e 5f63 6c75 7374  ters) if n_clust
+000034e0: 6572 7320 656c 7365 2047 6175 7373 6961  ers else Gaussia
+000034f0: 6e4d 6978 7475 7265 2829 290d 0a20 2020  nMixture())..   
+00003500: 205d 0d0a 0d0a 2020 2020 6265 7374 5f61   ]....    best_a
+00003510: 6c67 6f72 6974 686d 203d 204e 6f6e 650d  lgorithm = None.
+00003520: 0a20 2020 2062 6573 745f 616c 676f 7269  .    best_algori
+00003530: 7468 6d5f 6e61 6d65 203d 2022 220d 0a20  thm_name = "".. 
+00003540: 2020 2062 6573 745f 7363 6f72 6520 3d20     best_score = 
+00003550: 2d6e 702e 696e 660d 0a0d 0a20 2020 2066  -np.inf....    f
+00003560: 6f72 206e 616d 652c 2061 6c67 6f72 6974  or name, algorit
+00003570: 686d 2069 6e20 636c 7573 7465 7269 6e67  hm in clustering
+00003580: 5f61 6c67 6f72 6974 686d 733a 0d0a 2020  _algorithms:..  
+00003590: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+000035a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+000035b0: 7461 6e63 6528 616c 676f 7269 7468 6d2c  tance(algorithm,
+000035c0: 2047 6175 7373 6961 6e4d 6978 7475 7265   GaussianMixture
+000035d0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000035e0: 2020 2020 616c 676f 7269 7468 6d2e 6669      algorithm.fi
+000035f0: 7428 6461 7461 290d 0a20 2020 2020 2020  t(data)..       
+00003600: 2020 2020 2020 2020 206c 6162 656c 7320           labels 
+00003610: 3d20 616c 676f 7269 7468 6d2e 7072 6564  = algorithm.pred
+00003620: 6963 7428 6461 7461 290d 0a20 2020 2020  ict(data)..     
+00003630: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00003640: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00003650: 6265 6c73 203d 2061 6c67 6f72 6974 686d  bels = algorithm
+00003660: 2e66 6974 5f70 7265 6469 6374 2864 6174  .fit_predict(dat
+00003670: 6129 0d0a 0d0a 2020 2020 2020 2020 2020  a)....          
+00003680: 2020 6966 206c 656e 286e 702e 756e 6971    if len(np.uniq
+00003690: 7565 286c 6162 656c 7329 2920 3e20 313a  ue(labels)) > 1:
+000036a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000036b0: 2020 7363 6f72 6520 3d20 7369 6c68 6f75    score = silhou
+000036c0: 6574 7465 5f73 636f 7265 2864 6174 612c  ette_score(data,
+000036d0: 206c 6162 656c 7329 0d0a 2020 2020 2020   labels)..      
+000036e0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000036f0: 6622 7b6e 616d 657d 2041 6c67 6f72 6974  f"{name} Algorit
+00003700: 686d 3a22 290d 0a20 2020 2020 2020 2020  hm:")..         
+00003710: 2020 2020 2020 2070 7269 6e74 2822 5369         print("Si
+00003720: 6c68 6f75 6574 7465 2053 636f 7265 3a22  lhouette Score:"
+00003730: 2c20 7363 6f72 6529 0d0a 2020 2020 2020  , score)..      
+00003740: 2020 2020 2020 2020 2020 6966 2073 636f            if sco
+00003750: 7265 203e 2062 6573 745f 7363 6f72 653a  re > best_score:
+00003760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003770: 2020 2020 2020 6265 7374 5f73 636f 7265        best_score
+00003780: 203d 2073 636f 7265 0d0a 2020 2020 2020   = score..      
+00003790: 2020 2020 2020 2020 2020 2020 2020 6265                be
+000037a0: 7374 5f61 6c67 6f72 6974 686d 203d 2061  st_algorithm = a
+000037b0: 6c67 6f72 6974 686d 0d0a 2020 2020 2020  lgorithm..      
+000037c0: 2020 2020 2020 2020 2020 2020 2020 6265                be
+000037d0: 7374 5f61 6c67 6f72 6974 686d 5f6e 616d  st_algorithm_nam
+000037e0: 6520 3d20 6e61 6d65 0d0a 2020 2020 2020  e = name..      
+000037f0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+00003800: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
+00003810: 2020 2020 2020 7072 696e 7428 6622 416e        print(f"An
+00003820: 2065 7272 6f72 206f 6363 7572 7265 6420   error occurred 
+00003830: 7768 696c 6520 7072 6f63 6573 7369 6e67  while processing
+00003840: 207b 6e61 6d65 7d3a 207b 657d 2229 0d0a   {name}: {e}")..
+00003850: 0d0a 2020 2020 7072 696e 7428 2254 6865  ..    print("The
+00003860: 2062 6573 7420 636c 7573 7465 7269 6e67   best clustering
+00003870: 2061 6c67 6f72 6974 686d 2069 733a 222c   algorithm is:",
+00003880: 2062 6573 745f 616c 676f 7269 7468 6d5f   best_algorithm_
+00003890: 6e61 6d65 2c20 2277 6974 6820 6120 7369  name, "with a si
+000038a0: 6c68 6f75 6574 7465 2073 636f 7265 206f  lhouette score o
+000038b0: 6622 2c20 6265 7374 5f73 636f 7265 290d  f", best_score).
+000038c0: 0a20 2020 2070 6361 203d 2050 4341 286e  .    pca = PCA(n
+000038d0: 5f63 6f6d 706f 6e65 6e74 733d 3229 0d0a  _components=2)..
+000038e0: 2020 2020 585f 7063 6120 3d20 7063 612e      X_pca = pca.
+000038f0: 6669 745f 7472 616e 7366 6f72 6d28 6461  fit_transform(da
+00003900: 7461 290d 0a0d 0a20 2020 2069 6620 6973  ta)....    if is
+00003910: 696e 7374 616e 6365 2862 6573 745f 616c  instance(best_al
+00003920: 676f 7269 7468 6d2c 2047 6175 7373 6961  gorithm, Gaussia
+00003930: 6e4d 6978 7475 7265 293a 0d0a 2020 2020  nMixture):..    
+00003940: 2020 2020 6265 7374 5f61 6c67 6f72 6974      best_algorit
+00003950: 686d 2e66 6974 2864 6174 6129 0d0a 2020  hm.fit(data)..  
+00003960: 2020 2020 2020 636c 7573 7465 725f 6c61        cluster_la
+00003970: 6265 6c73 203d 2062 6573 745f 616c 676f  bels = best_algo
+00003980: 7269 7468 6d2e 7072 6564 6963 7428 6461  rithm.predict(da
+00003990: 7461 290d 0a20 2020 2065 6c73 653a 0d0a  ta)..    else:..
+000039a0: 2020 2020 2020 2020 636c 7573 7465 725f          cluster_
+000039b0: 6c61 6265 6c73 203d 2062 6573 745f 616c  labels = best_al
+000039c0: 676f 7269 7468 6d2e 6669 745f 7072 6564  gorithm.fit_pred
+000039d0: 6963 7428 6461 7461 290d 0a0d 0a20 2020  ict(data)....   
+000039e0: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
+000039f0: 697a 653d 2831 302c 2036 2929 0d0a 2020  ize=(10, 6))..  
+00003a00: 2020 706c 742e 7363 6174 7465 7228 585f    plt.scatter(X_
+00003a10: 7063 615b 3a2c 2030 5d2c 2058 5f70 6361  pca[:, 0], X_pca
+00003a20: 5b3a 2c20 315d 2c20 633d 636c 7573 7465  [:, 1], c=cluste
+00003a30: 725f 6c61 6265 6c73 2c20 636d 6170 3d27  r_labels, cmap='
+00003a40: 7669 7269 6469 7327 2c20 6564 6765 636f  viridis', edgeco
+00003a50: 6c6f 7273 3d27 6b27 2c20 733d 3530 290d  lors='k', s=50).
+00003a60: 0a20 2020 200d 0a20 2020 2070 6c74 2e74  .    ..    plt.t
+00003a70: 6974 6c65 2827 5363 6174 7465 7220 506c  itle('Scatter Pl
+00003a80: 6f74 2066 6f72 2074 6865 2042 6573 7420  ot for the Best 
+00003a90: 436c 7573 7465 7269 6e67 204d 6f64 656c  Clustering Model
+00003aa0: 3a20 2720 2b20 6265 7374 5f61 6c67 6f72  : ' + best_algor
+00003ab0: 6974 686d 5f6e 616d 6529 0d0a 2020 2020  ithm_name)..    
+00003ac0: 706c 742e 786c 6162 656c 2827 5072 696e  plt.xlabel('Prin
+00003ad0: 6369 7061 6c20 436f 6d70 6f6e 656e 7420  cipal Component 
+00003ae0: 3127 290d 0a20 2020 2070 6c74 2e79 6c61  1')..    plt.yla
+00003af0: 6265 6c28 2750 7269 6e63 6970 616c 2043  bel('Principal C
+00003b00: 6f6d 706f 6e65 6e74 2032 2729 0d0a 2020  omponent 2')..  
+00003b10: 2020 706c 742e 7368 6f77 2829 0d0a 2020    plt.show()..  
+00003b20: 2020 7265 7475 726e 2062 6573 745f 616c    return best_al
+00003b30: 676f 7269 7468 6d5f 6e61 6d65 2c20 6265  gorithm_name, be
+00003b40: 7374 5f61 6c67 6f72 6974 686d 2c20 6265  st_algorithm, be
+00003b50: 7374 5f73 636f 7265 0d0a 0d0a 0d0a 6465  st_score......de
+00003b60: 6620 6669 6e64 5f62 6573 745f 6d6f 6465  f find_best_mode
+00003b70: 6c5f 7265 6772 6573 7369 6f6e 5f32 2858  l_regression_2(X
+00003b80: 2c20 792c 2074 6573 745f 7369 7a65 3d30  , y, test_size=0
+00003b90: 2e32 2c20 7261 6e64 6f6d 5f73 7461 7465  .2, random_state
+00003ba0: 3d34 322c 2063 763d 3529 3a0d 0a20 2020  =42, cv=5):..   
+00003bb0: 200d 0a20 2020 2069 6d70 6f72 7420 6e75   ..    import nu
+00003bc0: 6d70 7920 6173 206e 700d 0a20 2020 2069  mpy as np..    i
+00003bd0: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
+00003be0: 7064 0d0a 2020 2020 6672 6f6d 2073 6b6c  pd..    from skl
+00003bf0: 6561 726e 2e6c 696e 6561 725f 6d6f 6465  earn.linear_mode
+00003c00: 6c20 696d 706f 7274 204c 696e 6561 7252  l import LinearR
+00003c10: 6567 7265 7373 696f 6e2c 2052 6964 6765  egression, Ridge
+00003c20: 2c20 4c61 7373 6f2c 2045 6c61 7374 6963  , Lasso, Elastic
+00003c30: 4e65 742c 2042 6179 6573 6961 6e52 6964  Net, BayesianRid
+00003c40: 6765 2c20 5347 4452 6567 7265 7373 6f72  ge, SGDRegressor
+00003c50: 0d0a 2020 2020 6672 6f6d 2073 6b6c 6561  ..    from sklea
+00003c60: 726e 2e74 7265 6520 696d 706f 7274 2044  rn.tree import D
+00003c70: 6563 6973 696f 6e54 7265 6552 6567 7265  ecisionTreeRegre
+00003c80: 7373 6f72 0d0a 2020 2020 6672 6f6d 2073  ssor..    from s
+00003c90: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
+00003ca0: 696d 706f 7274 2052 616e 646f 6d46 6f72  import RandomFor
+00003cb0: 6573 7452 6567 7265 7373 6f72 2c20 4772  estRegressor, Gr
+00003cc0: 6164 6965 6e74 426f 6f73 7469 6e67 5265  adientBoostingRe
+00003cd0: 6772 6573 736f 722c 2041 6461 426f 6f73  gressor, AdaBoos
+00003ce0: 7452 6567 7265 7373 6f72 2c20 4578 7472  tRegressor, Extr
+00003cf0: 6154 7265 6573 5265 6772 6573 736f 722c  aTreesRegressor,
+00003d00: 2042 6167 6769 6e67 5265 6772 6573 736f   BaggingRegresso
+00003d10: 720d 0a20 2020 2066 726f 6d20 736b 6c65  r..    from skle
+00003d20: 6172 6e2e 7376 6d20 696d 706f 7274 2053  arn.svm import S
+00003d30: 5652 0d0a 2020 2020 6672 6f6d 2073 6b6c  VR..    from skl
+00003d40: 6561 726e 2e6e 6569 6768 626f 7273 2069  earn.neighbors i
+00003d50: 6d70 6f72 7420 4b4e 6569 6768 626f 7273  mport KNeighbors
+00003d60: 5265 6772 6573 736f 720d 0a20 2020 2066  Regressor..    f
+00003d70: 726f 6d20 736b 6c65 6172 6e2e 6e65 7572  rom sklearn.neur
+00003d80: 616c 5f6e 6574 776f 726b 2069 6d70 6f72  al_network impor
+00003d90: 7420 4d4c 5052 6567 7265 7373 6f72 0d0a  t MLPRegressor..
+00003da0: 2020 2020 6672 6f6d 2078 6762 6f6f 7374      from xgboost
+00003db0: 2069 6d70 6f72 7420 5847 4252 6567 7265   import XGBRegre
+00003dc0: 7373 6f72 0d0a 2020 2020 6672 6f6d 206c  ssor..    from l
+00003dd0: 6967 6874 6762 6d20 696d 706f 7274 204c  ightgbm import L
+00003de0: 4742 4d52 6567 7265 7373 6f72 0d0a 2020  GBMRegressor..  
+00003df0: 2020 6672 6f6d 2063 6174 626f 6f73 7420    from catboost 
+00003e00: 696d 706f 7274 2043 6174 426f 6f73 7452  import CatBoostR
+00003e10: 6567 7265 7373 6f72 0d0a 2020 2020 6672  egressor..    fr
+00003e20: 6f6d 2073 6b6c 6561 726e 2069 6d70 6f72  om sklearn impor
+00003e30: 7420 6d65 7472 6963 730d 0a20 2020 2066  t metrics..    f
+00003e40: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+00003e50: 6963 7320 696d 706f 7274 206d 6561 6e5f  ics import mean_
+00003e60: 7371 7561 7265 645f 6572 726f 722c 2072  squared_error, r
+00003e70: 325f 7363 6f72 650d 0a20 2020 2066 726f  2_score..    fro
+00003e80: 6d20 736b 6c65 6172 6e2e 6d6f 6465 6c5f  m sklearn.model_
+00003e90: 7365 6c65 6374 696f 6e20 696d 706f 7274  selection import
+00003ea0: 2074 7261 696e 5f74 6573 745f 7370 6c69   train_test_spli
+00003eb0: 742c 2063 726f 7373 5f76 616c 5f73 636f  t, cross_val_sco
+00003ec0: 7265 2c20 6c65 6172 6e69 6e67 5f63 7572  re, learning_cur
+00003ed0: 7665 0d0a 2020 2020 696d 706f 7274 206d  ve..    import m
+00003ee0: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
+00003ef0: 2061 7320 706c 740d 0a0d 0a20 2020 206d   as plt....    m
+00003f00: 6f64 656c 7320 3d20 5b0d 0a20 2020 2020  odels = [..     
+00003f10: 2020 2028 224c 696e 6561 7220 5265 6772     ("Linear Regr
+00003f20: 6573 7369 6f6e 222c 204c 696e 6561 7252  ession", LinearR
+00003f30: 6567 7265 7373 696f 6e28 2929 2c0d 0a20  egression()),.. 
+00003f40: 2020 2020 2020 2028 2252 6964 6765 2052         ("Ridge R
+00003f50: 6567 7265 7373 696f 6e22 2c20 5269 6467  egression", Ridg
+00003f60: 6528 2929 2c0d 0a20 2020 2020 2020 2028  e()),..        (
+00003f70: 224c 6173 736f 2052 6567 7265 7373 696f  "Lasso Regressio
+00003f80: 6e22 2c20 4c61 7373 6f28 2929 2c0d 0a20  n", Lasso()),.. 
+00003f90: 2020 2020 2020 2028 2245 6c61 7374 6963         ("Elastic
+00003fa0: 4e65 7420 5265 6772 6573 7369 6f6e 222c  Net Regression",
+00003fb0: 2045 6c61 7374 6963 4e65 7428 2929 2c0d   ElasticNet()),.
+00003fc0: 0a20 2020 2020 2020 2028 2242 6179 6573  .        ("Bayes
+00003fd0: 6961 6e20 5269 6467 6520 5265 6772 6573  ian Ridge Regres
+00003fe0: 7369 6f6e 222c 2042 6179 6573 6961 6e52  sion", BayesianR
+00003ff0: 6964 6765 2829 292c 0d0a 2020 2020 2020  idge()),..      
+00004000: 2020 2822 4465 6369 7369 6f6e 2054 7265    ("Decision Tre
+00004010: 6520 5265 6772 6573 736f 7222 2c20 4465  e Regressor", De
+00004020: 6369 7369 6f6e 5472 6565 5265 6772 6573  cisionTreeRegres
+00004030: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
+00004040: 2028 2252 616e 646f 6d20 466f 7265 7374   ("Random Forest
+00004050: 2052 6567 7265 7373 6f72 222c 2052 616e   Regressor", Ran
+00004060: 646f 6d46 6f72 6573 7452 6567 7265 7373  domForestRegress
+00004070: 6f72 2829 292c 0d0a 2020 2020 2020 2020  or()),..        
+00004080: 2822 4772 6164 6965 6e74 2042 6f6f 7374  ("Gradient Boost
+00004090: 696e 6720 5265 6772 6573 736f 7222 2c20  ing Regressor", 
+000040a0: 4772 6164 6965 6e74 426f 6f73 7469 6e67  GradientBoosting
+000040b0: 5265 6772 6573 736f 7228 2929 2c0d 0a20  Regressor()),.. 
+000040c0: 2020 2020 2020 2028 2258 4742 6f6f 7374         ("XGBoost
+000040d0: 2052 6567 7265 7373 6f72 222c 2058 4742   Regressor", XGB
+000040e0: 5265 6772 6573 736f 7228 6576 616c 5f6d  Regressor(eval_m
+000040f0: 6574 7269 633d 2272 6d73 6522 2929 2c0d  etric="rmse")),.
+00004100: 0a20 2020 2020 2020 2028 224c 6967 6874  .        ("Light
+00004110: 4742 4d20 5265 6772 6573 736f 7222 2c20  GBM Regressor", 
+00004120: 4c47 424d 5265 6772 6573 736f 7228 2929  LGBMRegressor())
+00004130: 2c0d 0a20 2020 2020 2020 2028 2253 7570  ,..        ("Sup
+00004140: 706f 7274 2056 6563 746f 7220 5265 6772  port Vector Regr
+00004150: 6573 736f 7222 2c20 5356 5228 2929 2c0d  essor", SVR()),.
+00004160: 0a20 2020 2020 2020 2028 224b 2d4e 6561  .        ("K-Nea
+00004170: 7265 7374 204e 6569 6768 626f 7273 2052  rest Neighbors R
+00004180: 6567 7265 7373 6f72 222c 204b 4e65 6967  egressor", KNeig
+00004190: 6862 6f72 7352 6567 7265 7373 6f72 2829  hborsRegressor()
+000041a0: 292c 0d0a 2020 2020 2020 2020 2822 4d75  ),..        ("Mu
+000041b0: 6c74 692d 6c61 7965 7220 5065 7263 6570  lti-layer Percep
+000041c0: 7472 6f6e 2052 6567 7265 7373 6f72 222c  tron Regressor",
+000041d0: 204d 4c50 5265 6772 6573 736f 7228 6d61   MLPRegressor(ma
+000041e0: 785f 6974 6572 3d31 3030 3029 292c 0d0a  x_iter=1000)),..
+000041f0: 2020 2020 2020 2020 2822 4164 6142 6f6f          ("AdaBoo
+00004200: 7374 2052 6567 7265 7373 6f72 222c 2041  st Regressor", A
+00004210: 6461 426f 6f73 7452 6567 7265 7373 6f72  daBoostRegressor
+00004220: 2829 292c 0d0a 2020 2020 2020 2020 2822  ()),..        ("
+00004230: 4578 7472 6120 5472 6565 7320 5265 6772  Extra Trees Regr
+00004240: 6573 736f 7222 2c20 4578 7472 6154 7265  essor", ExtraTre
+00004250: 6573 5265 6772 6573 736f 7228 2929 2c0d  esRegressor()),.
+00004260: 0a20 2020 2020 2020 2028 2253 746f 6368  .        ("Stoch
+00004270: 6173 7469 6320 4772 6164 6965 6e74 2044  astic Gradient D
+00004280: 6573 6365 6e74 2052 6567 7265 7373 6f72  escent Regressor
+00004290: 222c 2053 4744 5265 6772 6573 736f 7228  ", SGDRegressor(
+000042a0: 2929 2c0d 0a20 2020 2020 2020 2028 2242  )),..        ("B
+000042b0: 6167 6769 6e67 2052 6567 7265 7373 6f72  agging Regressor
+000042c0: 222c 2042 6167 6769 6e67 5265 6772 6573  ", BaggingRegres
+000042d0: 736f 7228 2929 2c0d 0a20 2020 2020 2020  sor()),..       
+000042e0: 2028 2243 6174 426f 6f73 7420 5265 6772   ("CatBoost Regr
+000042f0: 6573 736f 7222 2c20 4361 7442 6f6f 7374  essor", CatBoost
+00004300: 5265 6772 6573 736f 7228 7665 7262 6f73  Regressor(verbos
+00004310: 653d 302c 2072 616e 646f 6d5f 7365 6564  e=0, random_seed
+00004320: 3d34 3229 292c 0d0a 2020 2020 5d0d 0a0d  =42)),..    ]...
+00004330: 0a20 2020 206e 5f73 616d 706c 6573 203d  .    n_samples =
+00004340: 2058 2e73 6861 7065 5b30 5d0d 0a20 2020   X.shape[0]..   
+00004350: 2061 646a 7573 7465 645f 7465 7374 5f73   adjusted_test_s
+00004360: 697a 6520 3d20 696e 7428 7465 7374 5f73  ize = int(test_s
+00004370: 697a 6520 2a20 6e5f 7361 6d70 6c65 7329  ize * n_samples)
+00004380: 0d0a 0d0a 2020 2020 6265 7374 5f6d 6f64  ....    best_mod
+00004390: 656c 203d 204e 6f6e 650d 0a20 2020 2062  el = None..    b
+000043a0: 6573 745f 6d73 6520 3d20 666c 6f61 7428  est_mse = float(
+000043b0: 2269 6e66 2229 0d0a 2020 2020 6265 7374  "inf")..    best
+000043c0: 5f6d 6f64 656c 5f69 6e73 7461 6e63 6520  _model_instance 
+000043d0: 3d20 4e6f 6e65 0d0a 0d0a 2020 2020 666f  = None....    fo
+000043e0: 7220 6e61 6d65 2c20 6d6f 6465 6c20 696e  r name, model in
+000043f0: 206d 6f64 656c 733a 0d0a 2020 2020 2020   models:..      
+00004400: 2020 585f 7472 6169 6e2c 2058 5f74 6573    X_train, X_tes
+00004410: 742c 2079 5f74 7261 696e 2c20 795f 7465  t, y_train, y_te
+00004420: 7374 203d 2074 7261 696e 5f74 6573 745f  st = train_test_
+00004430: 7370 6c69 7428 582c 2079 2c20 7465 7374  split(X, y, test
+00004440: 5f73 697a 653d 7465 7374 5f73 697a 652c  _size=test_size,
+00004450: 2072 616e 646f 6d5f 7374 6174 653d 7261   random_state=ra
+00004460: 6e64 6f6d 5f73 7461 7465 290d 0a20 2020  ndom_state)..   
+00004470: 2020 2020 2058 5f74 7261 696e 2c20 585f       X_train, X_
+00004480: 7661 6c2c 2079 5f74 7261 696e 2c20 795f  val, y_train, y_
+00004490: 7661 6c20 3d20 7472 6169 6e5f 7465 7374  val = train_test
+000044a0: 5f73 706c 6974 2858 5f74 7261 696e 2c20  _split(X_train, 
+000044b0: 795f 7472 6169 6e2c 2074 6573 745f 7369  y_train, test_si
+000044c0: 7a65 3d74 6573 745f 7369 7a65 2c20 7261  ze=test_size, ra
+000044d0: 6e64 6f6d 5f73 7461 7465 3d72 616e 646f  ndom_state=rando
+000044e0: 6d5f 7374 6174 6529 0d0a 2020 2020 2020  m_state)..      
+000044f0: 2020 6d6f 6465 6c2e 6669 7428 585f 7472    model.fit(X_tr
+00004500: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
+00004510: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00004520: 2070 7269 6e74 286e 616d 6520 2b20 2220   print(name + " 
+00004530: 4d6f 6465 6c3a 2229 0d0a 2020 2020 2020  Model:")..      
+00004540: 2020 6576 616c 7561 7465 5f6d 6f64 656c    evaluate_model
+00004550: 286d 6f64 656c 2c20 582c 2079 2c20 7465  (model, X, y, te
+00004560: 7374 5f73 697a 653d 6164 6a75 7374 6564  st_size=adjusted
+00004570: 5f74 6573 745f 7369 7a65 2c20 7261 6e64  _test_size, rand
+00004580: 6f6d 5f73 7461 7465 3d72 616e 646f 6d5f  om_state=random_
+00004590: 7374 6174 652c 2063 763d 6376 290d 0a20  state, cv=cv).. 
+000045a0: 2020 2020 2020 2070 7269 6e74 2829 0d0a         print()..
+000045b0: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
+000045c0: 203d 206d 6f64 656c 2e70 7265 6469 6374   = model.predict
+000045d0: 2858 5f74 6573 7429 0d0a 2020 2020 2020  (X_test)..      
+000045e0: 2020 6d73 6520 3d20 6d65 616e 5f73 7175    mse = mean_squ
+000045f0: 6172 6564 5f65 7272 6f72 2879 5f74 6573  ared_error(y_tes
+00004600: 742c 2079 5f70 7265 6429 0d0a 2020 2020  t, y_pred)..    
+00004610: 2020 2020 726d 7365 203d 206e 702e 7371      rmse = np.sq
+00004620: 7274 286d 7365 290d 0a20 2020 2020 2020  rt(mse)..       
+00004630: 2072 3220 3d20 7232 5f73 636f 7265 2879   r2 = r2_score(y
+00004640: 5f74 6573 742c 2079 5f70 7265 6429 0d0a  _test, y_pred)..
+00004650: 0d0a 2020 2020 2020 2020 6966 206d 7365  ..        if mse
+00004660: 203c 2062 6573 745f 6d73 653a 0d0a 2020   < best_mse:..  
+00004670: 2020 2020 2020 2020 2020 6265 7374 5f6d            best_m
+00004680: 7365 203d 206d 7365 0d0a 2020 2020 2020  se = mse..      
+00004690: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
+000046a0: 203d 206e 616d 650d 0a20 2020 2020 2020   = name..       
+000046b0: 2020 2020 2062 6573 745f 6d6f 6465 6c5f       best_model_
+000046c0: 696e 7374 616e 6365 203d 206d 6f64 656c  instance = model
+000046d0: 0d0a 0d0a 2020 2020 7072 696e 7428 2254  ....    print("T
+000046e0: 6865 2062 6573 7420 6d6f 6465 6c20 6973  he best model is
+000046f0: 3a22 2c20 6265 7374 5f6d 6f64 656c 2c20  :", best_model, 
+00004700: 2277 6974 6820 6120 4d65 616e 2053 7175  "with a Mean Squ
+00004710: 6172 6564 2045 7272 6f72 206f 6622 2c20  ared Error of", 
+00004720: 6265 7374 5f6d 7365 290d 0a0d 0a20 2020  best_mse)....   
+00004730: 2023 2050 7269 6e74 2074 6865 206d 6574   # Print the met
+00004740: 7269 6373 2066 6f72 2074 6865 2062 6573  rics for the bes
+00004750: 7420 6d6f 6465 6c0d 0a20 2020 2058 5f74  t model..    X_t
+00004760: 7261 696e 2c20 585f 7465 7374 2c20 795f  rain, X_test, y_
+00004770: 7472 6169 6e2c 2079 5f74 6573 7420 3d20  train, y_test = 
+00004780: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
+00004790: 2858 2c20 792c 2074 6573 745f 7369 7a65  (X, y, test_size
+000047a0: 3d74 6573 745f 7369 7a65 2c20 7261 6e64  =test_size, rand
+000047b0: 6f6d 5f73 7461 7465 3d72 616e 646f 6d5f  om_state=random_
+000047c0: 7374 6174 6529 0d0a 2020 2020 585f 7472  state)..    X_tr
+000047d0: 6169 6e2c 2058 5f76 616c 2c20 795f 7472  ain, X_val, y_tr
+000047e0: 6169 6e2c 2079 5f76 616c 203d 2074 7261  ain, y_val = tra
+000047f0: 696e 5f74 6573 745f 7370 6c69 7428 585f  in_test_split(X_
+00004800: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
+00004810: 7465 7374 5f73 697a 653d 7465 7374 5f73  test_size=test_s
+00004820: 697a 652c 2072 616e 646f 6d5f 7374 6174  ize, random_stat
+00004830: 653d 7261 6e64 6f6d 5f73 7461 7465 290d  e=random_state).
+00004840: 0a20 2020 2023 2046 6974 2074 6865 2062  .    # Fit the b
+00004850: 6573 7420 6d6f 6465 6c20 6f6e 2074 6865  est model on the
+00004860: 2074 7261 696e 696e 6720 6461 7461 0d0a   training data..
+00004870: 2020 2020 6265 7374 5f6d 6f64 656c 5f69      best_model_i
+00004880: 6e73 7461 6e63 652e 6669 7428 585f 7472  nstance.fit(X_tr
+00004890: 6169 6e2c 2079 5f74 7261 696e 290d 0a0d  ain, y_train)...
+000048a0: 0a20 2020 2023 2050 7265 6469 6374 696f  .    # Predictio
+000048b0: 6e73 0d0a 2020 2020 795f 7072 6564 5f62  ns..    y_pred_b
+000048c0: 6573 7420 3d20 6265 7374 5f6d 6f64 656c  est = best_model
+000048d0: 5f69 6e73 7461 6e63 652e 7072 6564 6963  _instance.predic
+000048e0: 7428 585f 7465 7374 290d 0a20 2020 2062  t(X_test)..    b
+000048f0: 6573 745f 726d 7365 203d 206e 702e 7371  est_rmse = np.sq
+00004900: 7274 2862 6573 745f 6d73 6529 0d0a 2020  rt(best_mse)..  
+00004910: 2020 6265 7374 5f72 3220 3d20 7232 5f73    best_r2 = r2_s
+00004920: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
+00004930: 7265 645f 6265 7374 290d 0a0d 0a20 2020  red_best)....   
+00004940: 2070 7269 6e74 2822 4d65 7472 6963 7320   print("Metrics 
+00004950: 6f66 2074 6865 2062 6573 7420 6d6f 6465  of the best mode
+00004960: 6c3a 2229 0d0a 2020 2020 7072 696e 7428  l:")..    print(
+00004970: 224d 6561 6e20 5371 7561 7265 6420 4572  "Mean Squared Er
+00004980: 726f 723a 222c 2062 6573 745f 6d73 6529  ror:", best_mse)
+00004990: 0d0a 2020 2020 7072 696e 7428 2252 6f6f  ..    print("Roo
+000049a0: 7420 4d65 616e 2053 7175 6172 6564 2045  t Mean Squared E
+000049b0: 7272 6f72 3a22 2c20 6265 7374 5f72 6d73  rror:", best_rms
+000049c0: 6529 0d0a 2020 2020 7072 696e 7428 2252  e)..    print("R
+000049d0: 2d73 7175 6172 6564 3a22 2c20 6265 7374  -squared:", best
+000049e0: 5f72 3229 0d0a 0d0a 2020 2020 2320 4c65  _r2)....    # Le
+000049f0: 6172 6e69 6e67 2063 7572 7665 2066 6f72  arning curve for
+00004a00: 2074 6865 2062 6573 7420 6d6f 6465 6c0d   the best model.
+00004a10: 0a20 2020 2074 7261 696e 5f73 697a 6573  .    train_sizes
+00004a20: 2c20 7472 6169 6e5f 7363 6f72 6573 2c20  , train_scores, 
+00004a30: 7661 6c5f 7363 6f72 6573 203d 206c 6561  val_scores = lea
+00004a40: 726e 696e 675f 6375 7276 6528 6265 7374  rning_curve(best
+00004a50: 5f6d 6f64 656c 5f69 6e73 7461 6e63 652c  _model_instance,
+00004a60: 2058 5f74 7261 696e 2c20 795f 7472 6169   X_train, y_trai
+00004a70: 6e2c 2063 763d 6376 2c20 7363 6f72 696e  n, cv=cv, scorin
+00004a80: 673d 276e 6567 5f6d 6561 6e5f 7371 7561  g='neg_mean_squa
+00004a90: 7265 645f 6572 726f 7227 290d 0a20 2020  red_error')..   
+00004aa0: 2074 7261 696e 5f73 636f 7265 7320 3d20   train_scores = 
+00004ab0: 6e70 2e73 7172 7428 2d74 7261 696e 5f73  np.sqrt(-train_s
+00004ac0: 636f 7265 7329 2e6d 6561 6e28 6178 6973  cores).mean(axis
+00004ad0: 3d31 290d 0a20 2020 2076 616c 5f73 636f  =1)..    val_sco
+00004ae0: 7265 7320 3d20 6e70 2e73 7172 7428 2d76  res = np.sqrt(-v
+00004af0: 616c 5f73 636f 7265 7329 2e6d 6561 6e28  al_scores).mean(
+00004b00: 6178 6973 3d31 290d 0a0d 0a20 2020 2070  axis=1)....    p
+00004b10: 6c74 2e70 6c6f 7428 7472 6169 6e5f 7369  lt.plot(train_si
+00004b20: 7a65 732c 2074 7261 696e 5f73 636f 7265  zes, train_score
+00004b30: 732c 2027 6f2d 272c 206c 6162 656c 3d22  s, 'o-', label="
+00004b40: 5472 6169 6e69 6e67 2073 636f 7265 2229  Training score")
+00004b50: 0d0a 2020 2020 706c 742e 706c 6f74 2874  ..    plt.plot(t
+00004b60: 7261 696e 5f73 697a 6573 2c20 7661 6c5f  rain_sizes, val_
+00004b70: 7363 6f72 6573 2c20 276f 2d27 2c20 6c61  scores, 'o-', la
+00004b80: 6265 6c3d 2256 616c 6964 6174 696f 6e20  bel="Validation 
+00004b90: 7363 6f72 6522 290d 0a20 2020 2070 6c74  score")..    plt
+00004ba0: 2e78 6c61 6265 6c28 2254 7261 696e 696e  .xlabel("Trainin
+00004bb0: 6720 7365 7420 7369 7a65 2229 0d0a 2020  g set size")..  
+00004bc0: 2020 706c 742e 796c 6162 656c 2822 524d    plt.ylabel("RM
+00004bd0: 5345 2229 0d0a 2020 2020 706c 742e 6c65  SE")..    plt.le
+00004be0: 6765 6e64 2829 0d0a 2020 2020 706c 742e  gend()..    plt.
+00004bf0: 7368 6f77 2829 0d0a 0d0a 2020 2020 7265  show()....    re
+00004c00: 7475 726e 2062 6573 745f 6d6f 6465 6c5f  turn best_model_
+00004c10: 696e 7374 616e 6365 0d0a 0d0a 0d0a 0d0a  instance........
+00004c20: 0d0a 6465 6620 7475 6e65 5f4d 4c50 635f  ..def tune_MLPc_
+00004c30: 7061 7261 6d65 7465 7273 2858 5f74 7261  parameters(X_tra
+00004c40: 696e 2c20 585f 7465 7374 2c20 795f 7472  in, X_test, y_tr
+00004c50: 6169 6e2c 2079 5f74 6573 742c 2070 6172  ain, y_test, par
+00004c60: 616d 735f 746f 5f74 7279 3d4e 6f6e 652c  ams_to_try=None,
+00004c70: 206e 756d 5f63 6f6d 6269 6e61 7469 6f6e   num_combination
+00004c80: 733d 4e6f 6e65 2c20 7261 6e64 6f6d 5f73  s=None, random_s
+00004c90: 7461 7465 3d31 2c20 6f70 7469 6d69 7a61  tate=1, optimiza
+00004ca0: 7469 6f6e 5f74 6172 6765 743d 2761 6363  tion_target='acc
+00004cb0: 7572 6163 7927 293a 0d0a 2020 2020 6672  uracy'):..    fr
+00004cc0: 6f6d 2073 6b6c 6561 726e 2e6e 6575 7261  om sklearn.neura
+00004cd0: 6c5f 6e65 7477 6f72 6b20 696d 706f 7274  l_network import
+00004ce0: 204d 4c50 436c 6173 7369 6669 6572 0d0a   MLPClassifier..
+00004cf0: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
+00004d00: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+00004d10: 6163 6375 7261 6379 5f73 636f 7265 2c20  accuracy_score, 
+00004d20: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
+00004d30: 2c20 7072 6563 6973 696f 6e5f 7363 6f72  , precision_scor
+00004d40: 652c 2072 6563 616c 6c5f 7363 6f72 650d  e, recall_score.
+00004d50: 0a20 2020 2066 726f 6d20 6974 6572 746f  .    from iterto
+00004d60: 6f6c 7320 696d 706f 7274 2070 726f 6475  ols import produ
+00004d70: 6374 0d0a 2020 2020 696d 706f 7274 206e  ct..    import n
+00004d80: 756d 7079 2061 7320 6e70 0d0a 0d0a 2020  umpy as np....  
+00004d90: 2020 6966 2070 6172 616d 735f 746f 5f74    if params_to_t
+00004da0: 7279 2069 7320 4e6f 6e65 3a0d 0a20 2020  ry is None:..   
+00004db0: 2020 2020 2070 6172 616d 735f 746f 5f74       params_to_t
+00004dc0: 7279 203d 207b 0d0a 2020 2020 2020 2020  ry = {..        
+00004dd0: 2020 2020 2773 6f6c 7665 7227 3a20 5b27      'solver': ['
+00004de0: 6c62 6667 7327 2c20 2761 6461 6d27 5d2c  lbfgs', 'adam'],
+00004df0: 0d0a 2020 2020 2020 2020 2020 2020 2761  ..            'a
+00004e00: 6374 6976 6174 696f 6e27 3a20 5b27 7265  ctivation': ['re
+00004e10: 6c75 272c 2027 7461 6e68 272c 2027 6c6f  lu', 'tanh', 'lo
+00004e20: 6769 7374 6963 275d 2c0d 0a20 2020 2020  gistic'],..     
+00004e30: 2020 2020 2020 2027 616c 7068 6127 3a20         'alpha': 
+00004e40: 5b30 2e30 3030 312c 2030 2e30 3031 2c20  [0.0001, 0.001, 
+00004e50: 302e 3031 5d2c 0d0a 2020 2020 2020 2020  0.01],..        
+00004e60: 2020 2020 276c 6561 726e 696e 675f 7261      'learning_ra
+00004e70: 7465 5f69 6e69 7427 3a20 5b30 2e30 3030  te_init': [0.000
+00004e80: 312c 2030 2e30 3030 352c 2030 2e30 3031  1, 0.0005, 0.001
+00004e90: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00004ea0: 276d 6178 5f69 7465 7227 3a20 5b35 3030  'max_iter': [500
+00004eb0: 302c 2031 3030 3030 2c20 3135 3030 305d  0, 10000, 15000]
+00004ec0: 0d0a 2020 2020 2020 2020 7d0d 0a0d 0a20  ..        }.... 
+00004ed0: 2020 2070 6172 616d 5f63 6f6d 6269 6e61     param_combina
+00004ee0: 7469 6f6e 7320 3d20 6c69 7374 2870 726f  tions = list(pro
+00004ef0: 6475 6374 282a 7061 7261 6d73 5f74 6f5f  duct(*params_to_
+00004f00: 7472 792e 7661 6c75 6573 2829 2929 0d0a  try.values()))..
+00004f10: 0d0a 2020 2020 6966 206e 756d 5f63 6f6d  ..    if num_com
+00004f20: 6269 6e61 7469 6f6e 7320 6973 204e 6f6e  binations is Non
+00004f30: 653a 0d0a 2020 2020 2020 2020 6e75 6d5f  e:..        num_
+00004f40: 636f 6d62 696e 6174 696f 6e73 203d 2031  combinations = 1
+00004f50: 300d 0a20 2020 2065 6c69 6620 6e75 6d5f  0..    elif num_
+00004f60: 636f 6d62 696e 6174 696f 6e73 203d 3d20  combinations == 
+00004f70: 276d 6178 273a 0d0a 2020 2020 2020 2020  'max':..        
+00004f80: 6e75 6d5f 636f 6d62 696e 6174 696f 6e73  num_combinations
+00004f90: 203d 206c 656e 2870 6172 616d 5f63 6f6d   = len(param_com
+00004fa0: 6269 6e61 7469 6f6e 7329 0d0a 0d0a 2020  binations)....  
+00004fb0: 2020 6265 7374 5f6d 6f64 656c 203d 204e    best_model = N
+00004fc0: 6f6e 650d 0a20 2020 2062 6573 745f 7061  one..    best_pa
+00004fd0: 7261 6d73 203d 204e 6f6e 650d 0a20 2020  rams = None..   
+00004fe0: 2062 6573 745f 7363 6f72 6520 3d20 2d6e   best_score = -n
+00004ff0: 702e 696e 6620 6966 206f 7074 696d 697a  p.inf if optimiz
+00005000: 6174 696f 6e5f 7461 7267 6574 203d 3d20  ation_target == 
+00005010: 2761 6363 7572 6163 7927 2065 6c73 6520  'accuracy' else 
+00005020: 6e70 2e69 6e66 0d0a 0d0a 2020 2020 666f  np.inf....    fo
+00005030: 7220 6920 696e 2072 616e 6765 286e 756d  r i in range(num
+00005040: 5f63 6f6d 6269 6e61 7469 6f6e 7329 3a0d  _combinations):.
+00005050: 0a20 2020 2020 2020 2063 686f 7365 6e5f  .        chosen_
+00005060: 7061 7261 6d73 203d 2064 6963 7428 7a69  params = dict(zi
+00005070: 7028 7061 7261 6d73 5f74 6f5f 7472 792e  p(params_to_try.
+00005080: 6b65 7973 2829 2c20 7061 7261 6d5f 636f  keys(), param_co
+00005090: 6d62 696e 6174 696f 6e73 5b6e 702e 7261  mbinations[np.ra
+000050a0: 6e64 6f6d 2e63 686f 6963 6528 6c65 6e28  ndom.choice(len(
+000050b0: 7061 7261 6d5f 636f 6d62 696e 6174 696f  param_combinatio
+000050c0: 6e73 2929 5d29 290d 0a0d 0a20 2020 2020  ns))]))....     
+000050d0: 2020 206d 6c70 203d 204d 4c50 436c 6173     mlp = MLPClas
+000050e0: 7369 6669 6572 2872 616e 646f 6d5f 7374  sifier(random_st
+000050f0: 6174 653d 7261 6e64 6f6d 5f73 7461 7465  ate=random_state
+00005100: 2c20 2a2a 6368 6f73 656e 5f70 6172 616d  , **chosen_param
+00005110: 7329 0d0a 2020 2020 2020 2020 6d6c 702e  s)..        mlp.
+00005120: 6669 7428 585f 7472 6169 6e2c 2079 5f74  fit(X_train, y_t
+00005130: 7261 696e 290d 0a0d 0a20 2020 2020 2020  rain)....       
+00005140: 2079 5f70 7265 6420 3d20 6d6c 702e 7072   y_pred = mlp.pr
+00005150: 6564 6963 7428 585f 7465 7374 290d 0a20  edict(X_test).. 
+00005160: 2020 2020 2020 2063 6d20 3d20 636f 6e66         cm = conf
+00005170: 7573 696f 6e5f 6d61 7472 6978 2879 5f74  usion_matrix(y_t
+00005180: 6573 742c 2079 5f70 7265 6429 0d0a 2020  est, y_pred)..  
+00005190: 2020 2020 2020 6661 6c73 655f 6e65 6761        false_nega
+000051a0: 7469 7665 7320 3d20 636d 5b31 5d5b 305d  tives = cm[1][0]
+000051b0: 0d0a 2020 2020 2020 2020 6163 6375 7261  ..        accura
+000051c0: 6379 203d 2061 6363 7572 6163 795f 7363  cy = accuracy_sc
+000051d0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+000051e0: 6564 290d 0a0d 0a20 2020 2020 2020 2069  ed)....        i
+000051f0: 6620 6f70 7469 6d69 7a61 7469 6f6e 5f74  f optimization_t
+00005200: 6172 6765 7420 3d3d 2027 6163 6375 7261  arget == 'accura
+00005210: 6379 273a 0d0a 2020 2020 2020 2020 2020  cy':..          
+00005220: 2020 7363 6f72 6520 3d20 6163 6375 7261    score = accura
+00005230: 6379 0d0a 2020 2020 2020 2020 2020 2020  cy..            
+00005240: 6265 7474 6572 203d 2073 636f 7265 203e  better = score >
+00005250: 2062 6573 745f 7363 6f72 650d 0a20 2020   best_score..   
+00005260: 2020 2020 2065 6c69 6620 6f70 7469 6d69       elif optimi
+00005270: 7a61 7469 6f6e 5f74 6172 6765 7420 3d3d  zation_target ==
+00005280: 2027 6d69 6e69 6d69 7a65 5f66 616c 7365   'minimize_false
+00005290: 5f6e 6567 6174 6976 6573 273a 0d0a 2020  _negatives':..  
+000052a0: 2020 2020 2020 2020 2020 7363 6f72 6520            score 
+000052b0: 3d20 6661 6c73 655f 6e65 6761 7469 7665  = false_negative
+000052c0: 730d 0a20 2020 2020 2020 2020 2020 2062  s..            b
+000052d0: 6574 7465 7220 3d20 7363 6f72 6520 3c20  etter = score < 
+000052e0: 6265 7374 5f73 636f 7265 0d0a 2020 2020  best_score..    
+000052f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00005300: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00005310: 7565 4572 726f 7228 2249 6e76 616c 6964  ueError("Invalid
+00005320: 206f 7074 696d 697a 6174 696f 6e5f 7461   optimization_ta
+00005330: 7267 6574 2e20 4368 6f6f 7365 2027 6163  rget. Choose 'ac
+00005340: 6375 7261 6379 2720 6f72 2027 6d69 6e69  curacy' or 'mini
+00005350: 6d69 7a65 5f66 616c 7365 5f6e 6567 6174  mize_false_negat
+00005360: 6976 6573 272e 2229 0d0a 0d0a 2020 2020  ives'.")....    
+00005370: 2020 2020 6966 2062 6574 7465 723a 0d0a      if better:..
+00005380: 2020 2020 2020 2020 2020 2020 6265 7374              best
+00005390: 5f6d 6f64 656c 203d 206d 6c70 0d0a 2020  _model = mlp..  
+000053a0: 2020 2020 2020 2020 2020 6265 7374 5f70            best_p
+000053b0: 6172 616d 7320 3d20 6368 6f73 656e 5f70  arams = chosen_p
+000053c0: 6172 616d 730d 0a20 2020 2020 2020 2020  arams..         
+000053d0: 2020 2062 6573 745f 7363 6f72 6520 3d20     best_score = 
+000053e0: 7363 6f72 650d 0a0d 0a20 2020 2070 7269  score....    pri
+000053f0: 6e74 2822 4265 7374 2068 7970 6572 7061  nt("Best hyperpa
+00005400: 7261 6d65 7465 7273 3a22 290d 0a20 2020  rameters:")..   
+00005410: 2070 7269 6e74 2862 6573 745f 7061 7261   print(best_para
+00005420: 6d73 290d 0a20 2020 2070 7269 6e74 2862  ms)..    print(b
+00005430: 6573 745f 6d6f 6465 6c29 0d0a 2020 2020  est_model)..    
+00005440: 6265 7374 5f6d 6f64 656c 5f73 7472 203d  best_model_str =
+00005450: 2066 224d 4c50 203d 204d 4c50 436c 6173   f"MLP = MLPClas
+00005460: 7369 6669 6572 2861 6374 6976 6174 696f  sifier(activatio
+00005470: 6e3d 277b 6265 7374 5f70 6172 616d 735b  n='{best_params[
+00005480: 2761 6374 6976 6174 696f 6e27 5d7d 272c  'activation']}',
+00005490: 2061 6c70 6861 3d7b 6265 7374 5f70 6172   alpha={best_par
+000054a0: 616d 735b 2761 6c70 6861 275d 7d2c 2022  ams['alpha']}, "
+000054b0: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+000054c0: 2020 2020 2020 2020 2066 226c 6561 726e           f"learn
+000054d0: 696e 675f 7261 7465 5f69 6e69 743d 7b62  ing_rate_init={b
+000054e0: 6573 745f 7061 7261 6d73 5b27 6c65 6172  est_params['lear
+000054f0: 6e69 6e67 5f72 6174 655f 696e 6974 275d  ning_rate_init']
+00005500: 7d2c 206d 6178 5f69 7465 723d 7b62 6573  }, max_iter={bes
+00005510: 745f 7061 7261 6d73 5b27 6d61 785f 6974  t_params['max_it
+00005520: 6572 275d 7d2c 2022 205c 0d0a 2020 2020  er']}, " \..    
+00005530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005540: 2066 2273 6f6c 7665 723d 277b 6265 7374   f"solver='{best
+00005550: 5f70 6172 616d 735b 2773 6f6c 7665 7227  _params['solver'
+00005560: 5d7d 272c 2072 616e 646f 6d5f 7374 6174  ]}', random_stat
+00005570: 653d 3129 220d 0a20 2020 2070 7269 6e74  e=1)"..    print
+00005580: 2862 6573 745f 6d6f 6465 6c5f 7374 7229  (best_model_str)
+00005590: 0d0a 0d0a 2020 2020 795f 7072 6564 203d  ....    y_pred =
+000055a0: 2062 6573 745f 6d6f 6465 6c2e 7072 6564   best_model.pred
+000055b0: 6963 7428 585f 7465 7374 290d 0a0d 0a20  ict(X_test).... 
+000055c0: 2020 2070 7269 6e74 2866 2241 6363 7572     print(f"Accur
+000055d0: 6163 7920 666f 7220 6265 7374 206d 6f64  acy for best mod
+000055e0: 656c 3a20 7b61 6363 7572 6163 795f 7363  el: {accuracy_sc
+000055f0: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+00005600: 6564 297d 2229 0d0a 2020 2020 7072 696e  ed)}")..    prin
+00005610: 7428 6622 436f 6e66 7573 696f 6e20 6d61  t(f"Confusion ma
+00005620: 7472 6978 2066 6f72 2062 6573 7420 6d6f  trix for best mo
+00005630: 6465 6c3a 5c6e 7b63 6f6e 6675 7369 6f6e  del:\n{confusion
+00005640: 5f6d 6174 7269 7828 795f 7465 7374 2c20  _matrix(y_test, 
+00005650: 795f 7072 6564 297d 2229 0d0a 2020 2020  y_pred)}")..    
+00005660: 7072 696e 7428 6622 5072 6563 6973 696f  print(f"Precisio
+00005670: 6e20 666f 7220 6265 7374 206d 6f64 656c  n for best model
+00005680: 3a20 7b70 7265 6369 7369 6f6e 5f73 636f  : {precision_sco
+00005690: 7265 2879 5f74 6573 742c 2079 5f70 7265  re(y_test, y_pre
+000056a0: 6429 7d22 290d 0a20 2020 2070 7269 6e74  d)}")..    print
+000056b0: 2866 2252 6563 616c 6c20 666f 7220 6265  (f"Recall for be
+000056c0: 7374 206d 6f64 656c 3a20 7b72 6563 616c  st model: {recal
+000056d0: 6c5f 7363 6f72 6528 795f 7465 7374 2c20  l_score(y_test, 
+000056e0: 795f 7072 6564 297d 2229 0d0a 0d0a 2020  y_pred)}")....  
+000056f0: 2020 7265 7475 726e 2062 6573 745f 6d6f    return best_mo
+00005700: 6465 6c2c 2062 6573 745f 7061 7261 6d73  del, best_params
+00005710: 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a  ................
+00005720: 6465 6620 7475 6e65 5f4d 4c50 725f 7061  def tune_MLPr_pa
+00005730: 7261 6d65 7465 7273 2858 5f74 7261 696e  rameters(X_train
+00005740: 2c20 585f 7465 7374 2c20 795f 7472 6169  , X_test, y_trai
+00005750: 6e2c 2079 5f74 6573 742c 2070 6172 616d  n, y_test, param
+00005760: 735f 746f 5f74 7279 3d4e 6f6e 652c 206e  s_to_try=None, n
+00005770: 756d 5f63 6f6d 6269 6e61 7469 6f6e 733d  um_combinations=
+00005780: 4e6f 6e65 2c20 7261 6e64 6f6d 5f73 7461  None, random_sta
+00005790: 7465 3d31 293a 0d0a 2020 2020 6672 6f6d  te=1):..    from
+000057a0: 2073 6b6c 6561 726e 2e6e 6575 7261 6c5f   sklearn.neural_
+000057b0: 6e65 7477 6f72 6b20 696d 706f 7274 204d  network import M
+000057c0: 4c50 5265 6772 6573 736f 720d 0a20 2020  LPRegressor..   
+000057d0: 2066 726f 6d20 736b 6c65 6172 6e2e 6d65   from sklearn.me
+000057e0: 7472 6963 7320 696d 706f 7274 206d 6561  trics import mea
+000057f0: 6e5f 7371 7561 7265 645f 6572 726f 722c  n_squared_error,
+00005800: 2072 325f 7363 6f72 650d 0a20 2020 2066   r2_score..    f
+00005810: 726f 6d20 6974 6572 746f 6f6c 7320 696d  rom itertools im
+00005820: 706f 7274 2070 726f 6475 6374 0d0a 2020  port product..  
+00005830: 2020 696d 706f 7274 206e 756d 7079 2061    import numpy a
+00005840: 7320 6e70 0d0a 0d0a 2020 2020 6966 2070  s np....    if p
+00005850: 6172 616d 735f 746f 5f74 7279 2069 7320  arams_to_try is 
+00005860: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2070  None:..        p
+00005870: 6172 616d 735f 746f 5f74 7279 203d 207b  arams_to_try = {
+00005880: 0d0a 2020 2020 2020 2020 2020 2020 2773  ..            's
+00005890: 6f6c 7665 7227 3a20 5b27 6c62 6667 7327  olver': ['lbfgs'
+000058a0: 2c20 2761 6461 6d27 5d2c 0d0a 2020 2020  , 'adam'],..    
+000058b0: 2020 2020 2020 2020 2761 6374 6976 6174          'activat
+000058c0: 696f 6e27 3a20 5b27 7265 6c75 272c 2027  ion': ['relu', '
+000058d0: 7461 6e68 272c 2027 6c6f 6769 7374 6963  tanh', 'logistic
+000058e0: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
+000058f0: 2027 616c 7068 6127 3a20 5b30 2e30 3030   'alpha': [0.000
+00005900: 312c 2030 2e30 3031 2c20 302e 3031 5d2c  1, 0.001, 0.01],
+00005910: 0d0a 2020 2020 2020 2020 2020 2020 276c  ..            'l
+00005920: 6561 726e 696e 675f 7261 7465 5f69 6e69  earning_rate_ini
+00005930: 7427 3a20 5b30 2e30 3030 312c 2030 2e30  t': [0.0001, 0.0
+00005940: 3030 352c 2030 2e30 3031 5d2c 0d0a 2020  005, 0.001],..  
+00005950: 2020 2020 2020 2020 2020 276d 6178 5f69            'max_i
+00005960: 7465 7227 3a20 5b35 3030 302c 2031 3030  ter': [5000, 100
+00005970: 3030 2c20 3135 3030 305d 0d0a 2020 2020  00, 15000]..    
+00005980: 2020 2020 7d0d 0a0d 0a20 2020 2070 6172      }....    par
+00005990: 616d 5f63 6f6d 6269 6e61 7469 6f6e 7320  am_combinations 
+000059a0: 3d20 6c69 7374 2870 726f 6475 6374 282a  = list(product(*
+000059b0: 7061 7261 6d73 5f74 6f5f 7472 792e 7661  params_to_try.va
+000059c0: 6c75 6573 2829 2929 0d0a 0d0a 2020 2020  lues()))....    
+000059d0: 6966 206e 756d 5f63 6f6d 6269 6e61 7469  if num_combinati
+000059e0: 6f6e 7320 6973 204e 6f6e 653a 0d0a 2020  ons is None:..  
+000059f0: 2020 2020 2020 6e75 6d5f 636f 6d62 696e        num_combin
+00005a00: 6174 696f 6e73 203d 2031 300d 0a20 2020  ations = 10..   
+00005a10: 2065 6c69 6620 6e75 6d5f 636f 6d62 696e   elif num_combin
+00005a20: 6174 696f 6e73 203d 3d20 276d 6178 273a  ations == 'max':
+00005a30: 0d0a 2020 2020 2020 2020 6e75 6d5f 636f  ..        num_co
+00005a40: 6d62 696e 6174 696f 6e73 203d 206c 656e  mbinations = len
+00005a50: 2870 6172 616d 5f63 6f6d 6269 6e61 7469  (param_combinati
+00005a60: 6f6e 7329 0d0a 0d0a 2020 2020 6265 7374  ons)....    best
+00005a70: 5f6d 6f64 656c 203d 204e 6f6e 650d 0a20  _model = None.. 
+00005a80: 2020 2062 6573 745f 7061 7261 6d73 203d     best_params =
+00005a90: 204e 6f6e 650d 0a20 2020 2062 6573 745f   None..    best_
+00005aa0: 6d73 6520 3d20 6e70 2e69 6e66 0d0a 0d0a  mse = np.inf....
+00005ab0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00005ac0: 6765 286e 756d 5f63 6f6d 6269 6e61 7469  ge(num_combinati
+00005ad0: 6f6e 7329 3a0d 0a20 2020 2020 2020 2063  ons):..        c
+00005ae0: 686f 7365 6e5f 7061 7261 6d73 203d 2064  hosen_params = d
+00005af0: 6963 7428 7a69 7028 7061 7261 6d73 5f74  ict(zip(params_t
+00005b00: 6f5f 7472 792e 6b65 7973 2829 2c20 7061  o_try.keys(), pa
+00005b10: 7261 6d5f 636f 6d62 696e 6174 696f 6e73  ram_combinations
+00005b20: 5b6e 702e 7261 6e64 6f6d 2e63 686f 6963  [np.random.choic
+00005b30: 6528 6c65 6e28 7061 7261 6d5f 636f 6d62  e(len(param_comb
+00005b40: 696e 6174 696f 6e73 2929 5d29 290d 0a0d  inations))]))...
+00005b50: 0a20 2020 2020 2020 206d 6c70 203d 204d  .        mlp = M
+00005b60: 4c50 5265 6772 6573 736f 7228 7261 6e64  LPRegressor(rand
+00005b70: 6f6d 5f73 7461 7465 3d72 616e 646f 6d5f  om_state=random_
+00005b80: 7374 6174 652c 202a 2a63 686f 7365 6e5f  state, **chosen_
+00005b90: 7061 7261 6d73 290d 0a20 2020 2020 2020  params)..       
+00005ba0: 206d 6c70 2e66 6974 2858 5f74 7261 696e   mlp.fit(X_train
+00005bb0: 2c20 795f 7472 6169 6e29 0d0a 0d0a 2020  , y_train)....  
+00005bc0: 2020 2020 2020 795f 7072 6564 203d 206d        y_pred = m
+00005bd0: 6c70 2e70 7265 6469 6374 2858 5f74 6573  lp.predict(X_tes
+00005be0: 7429 0d0a 2020 2020 2020 2020 6d73 6520  t)..        mse 
+00005bf0: 3d20 6d65 616e 5f73 7175 6172 6564 5f65  = mean_squared_e
+00005c00: 7272 6f72 2879 5f74 6573 742c 2079 5f70  rror(y_test, y_p
+00005c10: 7265 6429 0d0a 2020 2020 2020 2020 7072  red)..        pr
+00005c20: 696e 7428 6622 4d65 616e 2073 7175 6172  int(f"Mean squar
+00005c30: 6564 2065 7272 6f72 2066 6f72 2070 6172  ed error for par
+00005c40: 616d 6574 6572 7320 7b63 686f 7365 6e5f  ameters {chosen_
+00005c50: 7061 7261 6d73 7d3a 207b 6d73 657d 2229  params}: {mse}")
+00005c60: 0d0a 0d0a 2020 2020 2020 2020 6966 206d  ....        if m
+00005c70: 7365 203c 2062 6573 745f 6d73 653a 0d0a  se < best_mse:..
+00005c80: 2020 2020 2020 2020 2020 2020 6265 7374              best
+00005c90: 5f6d 6f64 656c 203d 206d 6c70 0d0a 2020  _model = mlp..  
+00005ca0: 2020 2020 2020 2020 2020 6265 7374 5f70            best_p
+00005cb0: 6172 616d 7320 3d20 6368 6f73 656e 5f70  arams = chosen_p
+00005cc0: 6172 616d 730d 0a20 2020 2020 2020 2020  arams..         
+00005cd0: 2020 2062 6573 745f 6d73 6520 3d20 6d73     best_mse = ms
+00005ce0: 650d 0a0d 0a20 2020 2070 7269 6e74 2822  e....    print("
+00005cf0: 4265 7374 2068 7970 6572 7061 7261 6d65  Best hyperparame
+00005d00: 7465 7273 3a22 290d 0a20 2020 2070 7269  ters:")..    pri
+00005d10: 6e74 2862 6573 745f 7061 7261 6d73 290d  nt(best_params).
+00005d20: 0a20 2020 2070 7269 6e74 2862 6573 745f  .    print(best_
+00005d30: 6d6f 6465 6c29 0d0a 2020 2020 6265 7374  model)..    best
+00005d40: 5f6d 6f64 656c 5f73 7472 203d 2066 224d  _model_str = f"M
+00005d50: 4c50 203d 204d 4c50 5265 6772 6573 736f  LP = MLPRegresso
+00005d60: 7228 6163 7469 7661 7469 6f6e 3d27 7b62  r(activation='{b
+00005d70: 6573 745f 7061 7261 6d73 5b27 6163 7469  est_params['acti
+00005d80: 7661 7469 6f6e 275d 7d27 2c20 616c 7068  vation']}', alph
+00005d90: 613d 7b62 6573 745f 7061 7261 6d73 5b27  a={best_params['
+00005da0: 616c 7068 6127 5d7d 2c20 2220 5c0d 0a20  alpha']}, " \.. 
+00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dc0: 2020 2020 6622 6c65 6172 6e69 6e67 5f72      f"learning_r
+00005dd0: 6174 655f 696e 6974 3d7b 6265 7374 5f70  ate_init={best_p
+00005de0: 6172 616d 735b 276c 6561 726e 696e 675f  arams['learning_
+00005df0: 7261 7465 5f69 6e69 7427 5d7d 2c20 6d61  rate_init']}, ma
+00005e00: 785f 6974 6572 3d7b 6265 7374 5f70 6172  x_iter={best_par
+00005e10: 616d 735b 276d 6178 5f69 7465 7227 5d7d  ams['max_iter']}
+00005e20: 2c20 2220 5c0d 0a20 2020 2020 2020 2020  , " \..         
+00005e30: 2020 2020 2020 2020 2020 2020 6622 736f              f"so
+00005e40: 6c76 6572 3d27 7b62 6573 745f 7061 7261  lver='{best_para
+00005e50: 6d73 5b27 736f 6c76 6572 275d 7d27 2c20  ms['solver']}', 
+00005e60: 7261 6e64 6f6d 5f73 7461 7465 3d31 2922  random_state=1)"
+00005e70: 0d0a 2020 2020 7072 696e 7428 6265 7374  ..    print(best
+00005e80: 5f6d 6f64 656c 5f73 7472 290d 0a0d 0a20  _model_str).... 
+00005e90: 2020 2079 5f70 7265 6420 3d20 6265 7374     y_pred = best
+00005ea0: 5f6d 6f64 656c 2e70 7265 6469 6374 2858  _model.predict(X
+00005eb0: 5f74 6573 7429 0d0a 2020 2020 0d0a 2020  _test)..    ..  
+00005ec0: 2020 7072 696e 7428 6622 4d65 616e 2073    print(f"Mean s
+00005ed0: 7175 6172 6564 2065 7272 6f72 2066 6f72  quared error for
+00005ee0: 2062 6573 7420 6d6f 6465 6c3a 207b 6d65   best model: {me
+00005ef0: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
+00005f00: 2879 5f74 6573 742c 2079 5f70 7265 6429  (y_test, y_pred)
+00005f10: 7d22 290d 0a20 2020 2070 7269 6e74 2866  }")..    print(f
+00005f20: 2252 3220 7363 6f72 6520 666f 7220 6265  "R2 score for be
+00005f30: 7374 206d 6f64 656c 3a20 7b72 325f 7363  st model: {r2_sc
+00005f40: 6f72 6528 795f 7465 7374 2c20 795f 7072  ore(y_test, y_pr
+00005f50: 6564 297d 2229 0d0a 2020 2020 7072 696e  ed)}")..    prin
+00005f60: 7428 6622 524d 5345 2073 636f 7265 2066  t(f"RMSE score f
+00005f70: 6f72 2062 6573 7420 6d6f 6465 6c3a 207b  or best model: {
+00005f80: 6e70 2e73 7172 7428 6d65 616e 5f73 7175  np.sqrt(mean_squ
+00005f90: 6172 6564 5f65 7272 6f72 2879 5f74 6573  ared_error(y_tes
+00005fa0: 742c 2079 5f70 7265 6429 297d 2229 0d0a  t, y_pred))}")..
+00005fb0: 0d0a 2020 2020 7265 7475 726e 2062 6573  ..    return bes
+00005fc0: 745f 6d6f 6465 6c2c 2062 6573 745f 7061  t_model, best_pa
+00005fd0: 7261 6d73 0d0a 0d0a 0d0a 0d0a            rams........
```

### Comparing `OMGITSLACKO-0.1.8/OMGITSLACKO/tozsdefunctions.py` & `OMGITSLACKO-0.1.9/OMGITSLACKO/tozsdefunctions.py`

 * *Files identical despite different names*

